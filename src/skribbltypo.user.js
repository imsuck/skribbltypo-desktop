// ==UserScript==
// @name         skribbltypo
// @namespace    vite-plugin-monkey
// @version      28.0.3 stable-usc
// @author       tobeh
// @description  The toolbox for everything you need on skribbl.io
// @updateURL    https://get.typo.rip/userscript/skribbltypo.user.js
// @match        https://skribbl.io/*
// @grant        GM_addStyle
// @run-at       document-start
// ==/UserScript==

(e=>{if(typeof GM_addStyle=="function"){GM_addStyle(e);return}const t=document.createElement("style");t.textContent=e,document.head.append(t)})(' div.svelte-kfudwd.svelte-kfudwd{display:flex;justify-content:flex-start;align-items:center;gap:.5em;cursor:pointer;padding:.2em}div.disabled.svelte-kfudwd.svelte-kfudwd{opacity:.5;pointer-events:none}div.svelte-kfudwd img.svelte-kfudwd{height:1.5em;aspect-ratio:1;filter:drop-shadow(3px 3px 0px rgba(0,0,0,.3));-webkit-user-select:none;user-select:none}div.svelte-kfudwd span.svelte-kfudwd{-webkit-user-select:none;user-select:none;font-weight:600}b.svelte-rvotkt{font-size:1.1rem}.typo-numeric-setting.svelte-i0zktq.svelte-i0zktq{display:grid;align-items:center;grid-template-columns:auto auto;grid-template-rows:auto auto auto}.typo-numeric-setting.svelte-i0zktq b.svelte-i0zktq{font-size:1.1rem}.typo-numeric-setting.svelte-i0zktq input.svelte-i0zktq:invalid{border-color:unset}.typo-numeric-setting.svelte-i0zktq input[type=number].svelte-i0zktq{width:10ex}.typo-numeric-setting.svelte-i0zktq input[type=range].svelte-i0zktq{grid-column:span 2}.typo-numeric-setting.svelte-zlhfg4.svelte-zlhfg4{display:flex;flex-direction:column;justify-items:stretch;gap:.5rem}.typo-numeric-setting.svelte-zlhfg4 b.svelte-zlhfg4{font-size:1.1rem}.typo-text-setting.svelte-xq58hp.svelte-xq58hp{display:grid;align-items:center;grid-template-columns:auto auto;grid-template-rows:auto auto}.typo-text-setting.svelte-xq58hp b.svelte-xq58hp{font-size:1.1rem}.typo-text-setting.svelte-xq58hp input.svelte-xq58hp:invalid{border-color:unset}.typo-text-setting.svelte-xq58hp input.svelte-xq58hp{grid-column:span 2}.color-picker.svelte-1x2m4l5.svelte-1x2m4l5.svelte-1x2m4l5{color:var(--COLOR_PANEL_TEXT);-webkit-user-select:none;user-select:none;display:flex;flex-direction:column;gap:.5rem;width:100%}.color-picker.svelte-1x2m4l5 .picker-header.svelte-1x2m4l5.svelte-1x2m4l5{display:flex;width:100%;flex-direction:row;gap:1rem;align-items:center;justify-content:center}.color-picker.svelte-1x2m4l5 .picker-header.svelte-1x2m4l5>img.svelte-1x2m4l5{-webkit-user-select:none;user-select:none;height:1.2rem;width:1.2rem;filter:drop-shadow(3px 3px 0px rgba(0,0,0,.3))}.color-picker.svelte-1x2m4l5 .picker-header h3.svelte-1x2m4l5.svelte-1x2m4l5{margin-bottom:0}.color-picker.svelte-1x2m4l5 .color-rect.svelte-1x2m4l5.svelte-1x2m4l5{width:100%;aspect-ratio:1;position:relative;cursor:crosshair;border-radius:3px}.color-picker.svelte-1x2m4l5 .color-rect .color-thumb.svelte-1x2m4l5.svelte-1x2m4l5{position:absolute;width:1rem;height:1rem;border-radius:50%;background-color:#fff}.color-picker.svelte-1x2m4l5 .color-rect .color-thumb.listen.svelte-1x2m4l5.svelte-1x2m4l5{display:none}.color-picker.svelte-1x2m4l5 .hue-rect.svelte-1x2m4l5.svelte-1x2m4l5{width:100%;height:1rem;position:relative;cursor:pointer;border-radius:3px;background:linear-gradient(to right,#ff0400,#ffc300 12.5%,#fff200,#dcff00 18.75%,#7dff00,#1dff00 31.25%,#00ff13,#00ff42 37.5%,#00fdff,#003eff 62.5%,#000fff,#2100ff 68.75%,#8000ff,#e000ff 81.25%,#f0e,#ff00bf 87.5%,red)}.color-picker.svelte-1x2m4l5 .hue-rect .hue-thumb.svelte-1x2m4l5.svelte-1x2m4l5{position:absolute;width:1rem;height:1rem;border-radius:50%;background-color:#fff}.color-picker.svelte-1x2m4l5 .alpha-rect.svelte-1x2m4l5.svelte-1x2m4l5{width:100%;height:1rem;position:relative;cursor:pointer;border-radius:3px}.color-picker.svelte-1x2m4l5 .alpha-rect .alpha-thumb.svelte-1x2m4l5.svelte-1x2m4l5{position:absolute;width:1rem;height:1rem;border-radius:50%;background-color:#fff}@keyframes svelte-1bdf7g-slideIn{0%{transform:scaleY(0);opacity:0}to{transform:scaleY(1);opacity:100}}@keyframes svelte-1bdf7g-slideOut{0%{transform:scaleY(1);opacity:100}to{transform:scaleY(0);opacity:0}}.typo-color-picker-button.svelte-1bdf7g.svelte-1bdf7g{aspect-ratio:1;position:relative}.typo-color-picker-button.svelte-1bdf7g .color-picker-button-content.svelte-1bdf7g{position:absolute;top:0;right:0;bottom:0;left:0;cursor:pointer}.typo-color-picker-button.svelte-1bdf7g .color-picker-popout.svelte-1bdf7g{position:absolute;z-index:10;width:20em;border-radius:10px;padding:1rem;background-color:var(--COLOR_PANEL_HI);filter:drop-shadow(0 5px 10px rgba(0,0,0,.3));animation:svelte-1bdf7g-slideIn .08s ease-out}.typo-color-picker-button.svelte-1bdf7g .color-picker-popout.closing.svelte-1bdf7g{animation:svelte-1bdf7g-slideOut .08s ease-out forwards}.typo-text-setting.svelte-1pjx4sn.svelte-1pjx4sn{gap:.5rem;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start}.typo-text-setting.svelte-1pjx4sn b.svelte-1pjx4sn{font-size:1.1rem}.typo-chat-controls{grid-area:chat;display:flex;justify-items:center;justify-content:end;gap:.5rem;margin-top:.5rem;margin-right:.5rem;margin-left:auto;height:min-content;z-index:1;-webkit-user-select:none;user-select:none}.typo-controls.svelte-1c97t9h.svelte-1c97t9h{position:fixed;display:flex;align-items:center;gap:.5em;z-index:100}.typo-controls.topleft.svelte-1c97t9h.svelte-1c97t9h{left:.5em;top:.5em}.typo-controls.topright.svelte-1c97t9h.svelte-1c97t9h{right:.5em;top:.5em}.typo-controls.bottomright.svelte-1c97t9h.svelte-1c97t9h{right:.5em;bottom:.5em}.typo-controls.bottomleft.svelte-1c97t9h.svelte-1c97t9h{left:.5em;bottom:.5em}.typo-controls.vertical.svelte-1c97t9h.svelte-1c97t9h{flex-direction:column}.typo-controls.horizontal.svelte-1c97t9h.svelte-1c97t9h{flex-direction:row}@media (max-aspect-ratio: 1){.typo-controls.svelte-1c97t9h:not(.expanded)>:not(.typo-controls-mobile-expand){display:none}}.typo-controls.svelte-1c97t9h .typo-controls-mobile-expand.svelte-1c97t9h{display:none}@media (max-aspect-ratio: 1){.typo-controls.svelte-1c97t9h .typo-controls-mobile-expand.svelte-1c97t9h{display:grid;place-content:center;height:2rem;aspect-ratio:1;border-radius:100%;background-color:var(--COLOR_PANEL_HI);background-size:1.2rem;background-position:center;background-repeat:no-repeat;cursor:pointer;-webkit-user-select:none;user-select:none;opacity:.9}}.typo-customizer-actions.svelte-2foe7d{position:absolute;display:flex;flex-direction:column;gap:4px;top:40px;right:4px}@media (max-aspect-ratio: 1){.typo-customizer-actions.svelte-2foe7d{gap:1.25vh;top:7.5vh;right:1.25vh}}.typo-toast-container{position:fixed;left:0;right:0;top:0;height:0;overflow:visible;z-index:10000;display:flex;flex-direction:column;align-items:center;gap:1rem;padding-top:1rem}#home .panel.typo-panel:has(.typo-panel-tab:empty:nth-child(2)) .panel-header.svelte-14yq9xv .svelte-14yq9xv:nth-child(1){display:none}#home .panel.typo-panel:has(.typo-panel-tab:empty:nth-child(3)) .panel-header.svelte-14yq9xv .svelte-14yq9xv:nth-child(2){display:none}#home .panel.typo-panel:has(.typo-panel-tab:empty:nth-child(4)) .panel-header.svelte-14yq9xv .svelte-14yq9xv:nth-child(3){display:none}#home .panel.typo-panel:has(.typo-panel-tab:empty:nth-child(5)) .panel-header.svelte-14yq9xv .svelte-14yq9xv:nth-child(4){display:none}#home .panel.typo-panel:not(:has(.typo-panel-tab:not(:empty))){display:none}#home .panel.panel-right{margin-left:20px}@media (max-aspect-ratio: 1){#home .panel.panel-right{margin-left:0;order:2}}#home .panel.panel-left{margin-right:20px}@media (max-aspect-ratio: 1){#home .panel.panel-left{margin-right:0;order:3}}#home .panel.typo-panel{flex:0 0 400px;max-height:calc(400px - 2em);margin-top:2em;display:flex;flex-direction:column;align-items:normal;justify-content:flex-start;color:var(--COLOR_PANEL_TEXT)}#home .panel.typo-panel .panel-header.svelte-14yq9xv.svelte-14yq9xv{display:flex;justify-content:space-between;font-weight:600}#home .panel.typo-panel .panel-header.svelte-14yq9xv h2.svelte-14yq9xv{cursor:pointer}#home .panel.typo-panel .panel-header.svelte-14yq9xv h2.inactive.svelte-14yq9xv{opacity:.5}#home .panel.typo-panel .typo-panel-tab.svelte-14yq9xv.svelte-14yq9xv{margin-top:1rem;overflow:auto;flex-grow:1}#home .panel.typo-panel>div.svelte-14yq9xv.svelte-14yq9xv:empty{display:none}.typo-toolbar{grid-area:4/3/4/3;border-radius:3px;background-color:var(--COLOR_CHAT_BG_BASE);display:flex;align-items:center;justify-content:space-evenly}@media (max-aspect-ratio: 1){.typo-toolbar{display:none}}.typo-toolbar:empty{display:none}#game-canvas #game-rate.typo-icons :is(.like,.dislike){background-repeat:no-repeat;background-size:90%;background-position:center}#game-canvas #game-rate.typo-icons .like,#game-wrapper:has(#game-rate.typo-icons) .player-bubble .icon[style*=thumbsup]{background-image:var(--file-img-thumbsup-gif)!important}#game-canvas #game-rate.typo-icons .dislike,#game-wrapper:has(#game-rate.typo-icons) .player-bubble .icon[style*=thumbsdown]{background-image:var(--file-img-thumbsdown-gif)!important}@keyframes svelte-c1csua-bounceload{0%{transform:scale(.5)}to{transform:translate(-40%) scale(1.5)}}div.svelte-c1csua.svelte-c1csua{display:flex;justify-content:center;align-items:center;gap:.5em;padding:.8em}div.svelte-c1csua .icon.svelte-c1csua{display:inline-block;height:1.5em;aspect-ratio:1;background-image:url(/img/size.gif);background-size:1em;background-repeat:no-repeat;background-position:center;transform:scale(1.5);filter:drop-shadow(3px 3px 0 rgba(0,0,0,.3));animation:svelte-c1csua-bounceload .5s infinite;animation-direction:alternate;animation-timing-function:ease-in-out;transform-origin:center;margin-right:.5em;margin-left:.5em}div.svelte-c1csua span.svelte-c1csua{color:var(--COLOR_PANEL_TEXT);font-weight:700}.typo-icon-button.svelte-b0w31n.svelte-b0w31n{-webkit-user-select:none;user-select:none;display:block;cursor:pointer;filter:drop-shadow(3px 3px 0px rgba(0,0,0,.3))}.typo-icon-button.disabled.svelte-b0w31n.svelte-b0w31n{pointer-events:none;opacity:.5}.typo-icon-button.svelte-b0w31n img.svelte-b0w31n{aspect-ratio:1;transform:translateY(0);transition:transform 65ms ease-in-out}.typo-icon-button.svelte-b0w31n:hover img.effect.svelte-b0w31n{transform:translateY(-3px)}.typo-icon-button.greyscale.svelte-b0w31n img.svelte-b0w31n{filter:grayscale(.7);opacity:.7}.typo-icon-button.greyscale.svelte-b0w31n img.svelte-b0w31n:hover{filter:grayscale(0);opacity:1}@keyframes svelte-12e6hb5-slideIn{0%{transform:translateY(-50vh);opacity:0}to{transform:translateY(0);opacity:100}}@keyframes svelte-12e6hb5-slideOut{0%{transform:translateY(0);opacity:100}to{transform:translateY(-50vh);opacity:0}}.typo-toast.svelte-12e6hb5.svelte-12e6hb5{padding:1rem 3rem 1rem 1rem;background-color:var(--COLOR_PANEL_HI);border-radius:5px;color:var(--COLOR_PANEL_TEXT);filter:drop-shadow(0 5px 10px rgba(0,0,0,.3));min-width:clamp(20rem,20rem,80%);position:relative;animation:svelte-12e6hb5-slideIn .15s ease-out;display:flex;flex-direction:column;align-items:flex-start;white-space-collapse:preserve;gap:.5rem}.typo-toast.closing.svelte-12e6hb5.svelte-12e6hb5{animation:svelte-12e6hb5-slideOut .15s ease-out forwards}.typo-toast.loading.svelte-12e6hb5.svelte-12e6hb5{cursor:progress}.typo-toast.svelte-12e6hb5 form.svelte-12e6hb5{display:flex;width:100%}.typo-toast.svelte-12e6hb5 form input[type=submit].svelte-12e6hb5{display:none}.typo-toast.svelte-12e6hb5 .typo-toast-confirm.svelte-12e6hb5{width:100%;display:flex;flex-direction:row;gap:1rem}.typo-toast.svelte-12e6hb5 .typo-toast-confirm span.svelte-12e6hb5{display:flex;flex-direction:row;gap:.5rem;cursor:pointer;align-items:center}.typo-toast.svelte-12e6hb5 .close-toast.svelte-12e6hb5{position:absolute;right:.5rem;top:0;font-weight:900;opacity:.7;cursor:pointer;font-size:2rem}.typo-chat-message.svelte-1q3466u.svelte-1q3466u{display:flex;flex-direction:row;align-items:center}.typo-chat-message.svelte-1q3466u b.info.svelte-1q3466u{color:var(--COLOR_CHAT_TEXT_DRAWING)}.typo-chat-message.svelte-1q3466u b.error.svelte-1q3466u{color:var(--COLOR_CHAT_TEXT_LEAVE)}.typo-chat-message.svelte-1q3466u b.success.svelte-1q3466u{color:var(--COLOR_CHAT_TEXT_GUESSED)}.typo-chat-message.svelte-1q3466u b.normal.svelte-1q3466u{color:var(--COLOR_CHAT_TEXT_BASE)}.typo-chat-message.svelte-1q3466u span.svelte-1q3466u{white-space:preserve}.typo-avatar-container.svelte-ma71bf.svelte-ma71bf{width:var(--typo-avatar-container-size);aspect-ratio:1;position:relative;z-index:0}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.svelte-ma71bf{position:absolute}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.svelte-ma71bf:is(.color,.mouth,.eyes,.special){background-repeat:no-repeat}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.svelte-ma71bf:is(.color,.mouth,.eyes){top:0;right:0;bottom:0;left:0}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.color.svelte-ma71bf{z-index:0;background-image:url(https://skribbl.io/img/avatar/color_atlas.gif)}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.mouth.svelte-ma71bf{z-index:1;background-image:url(https://skribbl.io/img/avatar/mouth_atlas.gif)}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.eyes.svelte-ma71bf{z-index:2;background-image:url(https://skribbl.io/img/avatar/eyes_atlas.gif)}.typo-avatar-container.svelte-ma71bf .typo-avatar-layer.special.svelte-ma71bf{z-index:3;background-image:url(https://skribbl.io/img/avatar/special_atlas.gif);inset:calc(-1 * var(--typo-avatar-container-size) * 32 / 48 / 2)}@keyframes svelte-1lmlzvv-slideIn{0%{transform:scaleY(0);opacity:0}to{transform:scaleY(1);opacity:100}}@keyframes svelte-1lmlzvv-slideOut{0%{transform:scaleY(1);opacity:100}to{transform:scaleY(0);opacity:0}}.typo-area-flyout.svelte-1lmlzvv.svelte-1lmlzvv.svelte-1lmlzvv{position:relative;color:var(--COLOR_PANEL_TEXT);z-index:1;border-radius:10px;padding:1em;animation:svelte-1lmlzvv-slideIn .08s ease-out;display:flex;gap:1rem;flex-direction:column;align-items:center}.typo-area-flyout.align-top.svelte-1lmlzvv.svelte-1lmlzvv.svelte-1lmlzvv{align-self:start;transform-origin:top}.typo-area-flyout.align-bottom.svelte-1lmlzvv.svelte-1lmlzvv.svelte-1lmlzvv{align-self:end;transform-origin:bottom}.typo-area-flyout.closing.svelte-1lmlzvv.svelte-1lmlzvv.svelte-1lmlzvv{animation:svelte-1lmlzvv-slideOut .08s ease-out forwards}.typo-area-flyout.svelte-1lmlzvv.svelte-1lmlzvv.svelte-1lmlzvv:after{animation:svelte-1lmlzvv-slideIn .08s ease-out;background:var(--COLOR_PANEL_BG);content:"";position:absolute;top:0;right:0;bottom:0;left:0;border-radius:10px;z-index:-1;transform:none!important;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.typo-area-flyout.closing.svelte-1lmlzvv.svelte-1lmlzvv.svelte-1lmlzvv:after{animation:svelte-1lmlzvv-slideOut .08s ease-out forwards}.typo-area-flyout.svelte-1lmlzvv .close-explicit.svelte-1lmlzvv.svelte-1lmlzvv{position:absolute;top:0;right:.5rem;font-size:1.5rem;font-weight:900;cursor:pointer;z-index:1}.typo-area-flyout.svelte-1lmlzvv>h3.svelte-1lmlzvv.svelte-1lmlzvv{display:flex;gap:1em;align-items:center}.typo-area-flyout.svelte-1lmlzvv>h3.svelte-1lmlzvv>img.svelte-1lmlzvv{-webkit-user-select:none;user-select:none;height:1.8em;width:1.8em;filter:drop-shadow(3px 3px 0px rgba(0,0,0,.3))}.typo-area-flyout.svelte-1lmlzvv>.content.svelte-1lmlzvv.svelte-1lmlzvv{width:100%;overflow-y:auto}.typo-area-flyout.svelte-1lmlzvv>.content.padding.svelte-1lmlzvv.svelte-1lmlzvv{padding:0 1em}.typo-command-preview.svelte-19nsl5m.svelte-19nsl5m{display:flex;flex-direction:column;gap:1rem}.typo-command-preview.svelte-19nsl5m.svelte-19nsl5m:not(:has(.typo-command-result)){gap:.2rem}.typo-command-preview.svelte-19nsl5m .typo-command-result.svelte-19nsl5m{display:flex;flex-direction:column;gap:.2rem}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-synopsis.svelte-19nsl5m{display:flex;gap:.4rem;flex-wrap:wrap;align-items:center}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-synopsis .typo-command-result-arg.svelte-19nsl5m{background-color:var(--COLOR_PANEL_BG);padding:.2rem;border-radius:3px;opacity:.5}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-synopsis .typo-command-result-arg.current.svelte-19nsl5m{opacity:1}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-synopsis .typo-command-result-id.svelte-19nsl5m{padding:.2rem;border-radius:3px;font-weight:bolder}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-synopsis .typo-command-result-id.current.svelte-19nsl5m{background-color:var(--COLOR_PANEL_BG)}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-description .typo-command-result-param-type.svelte-19nsl5m{display:block;opacity:.7}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-state.svelte-19nsl5m{display:flex;gap:.5rem;align-items:center;margin-top:.3rem;opacity:.7}.typo-command-preview.svelte-19nsl5m .typo-command-result .typo-command-result-state img.svelte-19nsl5m{height:1.3rem}.chat-form:has(#typo-command-input) input:not(#typo-command-input){display:none}#game-chat:has(.typo-emojis-enabled) .typo-emoji-container{display:inline-flex;flex-wrap:wrap;align-items:center;gap:1ex}#game-chat:has(.typo-emojis-enabled) .typo-emoji-container .typo-emoji{background-image:var(--typo-emoji-url);color:transparent;overflow:hidden;width:1.5em;height:1.5em;background-size:contain;background-repeat:no-repeat;background-position:center;display:inline-block;image-rendering:auto}#game-chat:has(.typo-emojis-enabled) .typo-emoji-container .typo-emoji::selection{background-color:transparent;color:transparent}.typo-emoji-tooltip-img{display:inline-block;width:auto;height:auto;max-width:5em;image-rendering:auto}.typo-command-preview.svelte-198xt5o.svelte-198xt5o{display:flex;flex-wrap:wrap;flex-direction:row;gap:.5ex;justify-content:space-evenly}.typo-command-preview.svelte-198xt5o .emoji-picker-candidate.svelte-198xt5o{height:2.5em;aspect-ratio:1;image-rendering:auto;cursor:pointer;transition:transform .1s}.typo-command-preview.svelte-198xt5o .emoji-picker-candidate.svelte-198xt5o:hover{transform:scale(.9)}.typo-emoji-picker-hint.svelte-198xt5o.svelte-198xt5o{text-align:center;margin-bottom:1em;font-weight:600;text-overflow:ellipsis;overflow:hidden}form.chat-form.typo-extended input{padding-right:2.5em}.typo-ping-info.svelte-1bj7vfk{position:absolute;top:-1.2em;right:.2em;opacity:.5;font-weight:700;font-size:.8em;color:var(--COLOR_CHAT_TEXT_BASE)}.typo-chat-profile-link{cursor:pointer}.typo-flat-button.svelte-1nuwppq.svelte-1nuwppq{padding:.5rem;border-radius:.5em;position:relative;-webkit-user-select:none;user-select:none;font-weight:700;text-shadow:1px 1px 0 rgba(0,0,0,.168627451)}.typo-flat-button.disabled.svelte-1nuwppq.svelte-1nuwppq{pointer-events:none;opacity:.5}.typo-flat-button.green.svelte-1nuwppq.svelte-1nuwppq{background-color:var(--COLOR_BUTTON_SUBMIT_BG);color:var(--COLOR_BUTTON_SUBMIT_TEXT)}.typo-flat-button.orange.svelte-1nuwppq.svelte-1nuwppq{background-color:var(--COLOR_BUTTON_DANGER_BG);color:var(--COLOR_BUTTON_DANGER_TEXT)}.typo-flat-button.blue.svelte-1nuwppq.svelte-1nuwppq{background-color:var(--COLOR_BUTTON_NORMAL_BG);color:var(--COLOR_BUTTON_NORMAL_TEXT)}.typo-flat-button.svelte-1nuwppq>span.svelte-1nuwppq{z-index:2;position:relative}.typo-flat-button.svelte-1nuwppq.svelte-1nuwppq:after{position:absolute;top:0;right:0;bottom:0;left:0;content:"";z-index:0;opacity:0;background:#000;transition:opacity .1s;border-radius:.5em}.typo-flat-button.svelte-1nuwppq.svelte-1nuwppq:hover:after{opacity:.1}.typo-quickreact-focus.svelte-yvtrmi.svelte-yvtrmi:focus{outline:none}.typo-quickreact-keys.svelte-yvtrmi.svelte-yvtrmi{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.typo-quickreact-keys.svelte-yvtrmi b.svelte-yvtrmi{grid-column:span 2;text-align:center}@keyframes svelte-lwvpkp-slideIn{0%{transform:translateY(50vh);opacity:0}to{transform:translateY(0);opacity:100}}@keyframes svelte-lwvpkp-slideOut{0%{transform:translateY(0);opacity:100}to{transform:translateY(50vh);opacity:0}}@keyframes svelte-lwvpkp-fadeIn{0%{opacity:0}to{opacity:100}}@keyframes svelte-lwvpkp-fadeOut{0%{opacity:100}to{opacity:0}}div.content.svelte-lwvpkp.svelte-lwvpkp.svelte-lwvpkp{position:fixed;top:10vh;right:0;bottom:0;left:0;max-width:100vw;background:var(--COLOR_PANEL_BG);z-index:9999;animation:svelte-lwvpkp-slideIn .15s ease-out;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;flex-direction:column;align-items:center;color:var(--COLOR_PANEL_TEXT)}div.content.closing.svelte-lwvpkp.svelte-lwvpkp.svelte-lwvpkp{animation:svelte-lwvpkp-slideOut .15s ease-out forwards}div.content.svelte-lwvpkp .content-title.svelte-lwvpkp.svelte-lwvpkp{display:flex;justify-content:space-between;width:100%;align-items:center;padding-left:2em;padding-right:2em}div.content.svelte-lwvpkp .content-title.svelte-lwvpkp>div.svelte-lwvpkp:last-child{-webkit-user-select:none;user-select:none;position:relative;top:-2vh;cursor:pointer;font-weight:700;font-size:2.5rem;opacity:.7}div.content.svelte-lwvpkp .content-title.svelte-lwvpkp>div.svelte-lwvpkp:last-child:hover{opacity:1}div.content.svelte-lwvpkp .content-wrapper.svelte-lwvpkp.svelte-lwvpkp{overscroll-behavior:none;display:flex;flex-direction:column;overflow-y:scroll;width:100%;align-items:stretch;flex-grow:1;padding:0 .5rem}div.content-top.svelte-lwvpkp.svelte-lwvpkp.svelte-lwvpkp{position:fixed;top:calc(7vh + 1px);z-index:9999;background:var(--COLOR_PANEL_BG);clip-path:polygon(100% 0,0% 100%,100% 100%);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border:none;height:3vh;width:100vw;animation:svelte-lwvpkp-slideIn .15s ease-out}div.content-top.closing.svelte-lwvpkp.svelte-lwvpkp.svelte-lwvpkp{animation:svelte-lwvpkp-slideOut .15s ease-out forwards}div.backdrop.svelte-lwvpkp.svelte-lwvpkp.svelte-lwvpkp{position:fixed;top:0;right:0;bottom:0;left:0;background:#00000080;z-index:9998;animation:svelte-lwvpkp-fadeIn .15s ease-out}div.backdrop.closing.svelte-lwvpkp.svelte-lwvpkp.svelte-lwvpkp{animation:svelte-lwvpkp-fadeOut .15s ease-out forwards}body:has(.typo-modal){overflow:hidden}@keyframes svelte-1n76u56-slideIn{0%{transform:translateY(50vh);opacity:0}to{transform:translateY(0);opacity:100}}@keyframes svelte-1n76u56-slideOut{0%{transform:translateY(0);opacity:100}to{transform:translateY(50vh);opacity:0}}@keyframes svelte-1n76u56-fadeIn{0%{opacity:0}to{opacity:100}}@keyframes svelte-1n76u56-fadeOut{0%{opacity:100}to{opacity:0}}div.content.svelte-1n76u56.svelte-1n76u56.svelte-1n76u56{background:var(--COLOR_PANEL_BG);animation:svelte-1n76u56-slideIn .15s ease-out;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);max-height:calc(100vh - 4rem);max-width:calc(100vh - 4rem);display:flex;flex-direction:column;align-items:center;color:var(--COLOR_PANEL_TEXT);padding:2rem;border-radius:3px}div.content.closing.svelte-1n76u56.svelte-1n76u56.svelte-1n76u56{animation:svelte-1n76u56-slideOut .15s ease-out forwards}div.content.svelte-1n76u56 .content-title.svelte-1n76u56.svelte-1n76u56{display:flex;justify-content:space-between;width:100%;align-items:center;padding-left:2em;padding-right:2em}div.content.svelte-1n76u56 .content-title.svelte-1n76u56>div.svelte-1n76u56:last-child{-webkit-user-select:none;user-select:none;position:relative;top:-2vh;right:-2rem;cursor:pointer;font-weight:700;font-size:2.5rem;opacity:.7}div.content.svelte-1n76u56 .content-title.svelte-1n76u56>div.svelte-1n76u56:last-child:hover{opacity:1}div.content.svelte-1n76u56 .content-wrapper.svelte-1n76u56.svelte-1n76u56{overscroll-behavior:none;display:flex;flex-direction:column;overflow-y:scroll;width:100%;flex-grow:1;align-items:stretch;padding:0 .5rem}div.backdrop.svelte-1n76u56.svelte-1n76u56.svelte-1n76u56{position:fixed;top:0;right:0;bottom:0;left:0;background:#00000080;z-index:9999;animation:svelte-1n76u56-fadeIn .15s ease-out;display:grid;place-content:center;padding:3rem}div.backdrop.closing.svelte-1n76u56.svelte-1n76u56.svelte-1n76u56{animation:svelte-1n76u56-fadeOut .15s ease-out forwards}.typo-gallery-grid.svelte-skb05m.svelte-skb05m.svelte-skb05m{display:grid;grid-template-columns:20rem auto;gap:2rem;width:100%;padding-left:2rem;padding-right:2rem;padding-top:2rem;flex-grow:1;overflow:hidden}.typo-gallery-grid.svelte-skb05m h3.svelte-skb05m.svelte-skb05m{text-align:center}.typo-gallery-grid.svelte-skb05m .gallery-sidebar.svelte-skb05m.svelte-skb05m{display:flex;flex-direction:column;gap:.5rem;border-right:1px solid var(--COLOR_PANEL_BORDER_FOCUS);padding-right:2rem;margin-bottom:2rem;transition:opacity .06s;grid-area:1/1/1/1}.typo-gallery-grid.svelte-skb05m .gallery-sidebar.svelte-skb05m>.svelte-skb05m:not(span,.navigate-page){margin-bottom:1rem}.typo-gallery-grid.svelte-skb05m .gallery-sidebar .navigate-page.svelte-skb05m.svelte-skb05m{width:100%;justify-content:space-between;display:flex;gap:1rem;align-items:center;margin-top:auto}.typo-gallery-grid.svelte-skb05m .gallery-sidebar .navigate-page span.svelte-skb05m.svelte-skb05m{font-weight:600;-webkit-user-select:none;user-select:none}.typo-gallery-grid.svelte-skb05m .gallery-sidebar.present.svelte-skb05m.svelte-skb05m{opacity:0;pointer-events:none}.typo-gallery-grid.svelte-skb05m .gallery-results.svelte-skb05m.svelte-skb05m{height:100%;overflow:auto;display:grid;grid-template-columns:repeat(auto-fill,20rem);gap:1rem;justify-content:space-between;margin-bottom:2rem;grid-area:1/2/1/2;transition:opacity .06s}.typo-gallery-grid.svelte-skb05m .gallery-results img.svelte-skb05m.svelte-skb05m{width:100%;cursor:pointer;border-radius:3px}.typo-gallery-grid.svelte-skb05m .gallery-results .loading.svelte-skb05m.svelte-skb05m{grid-column:1/-1;display:grid}.typo-gallery-grid.svelte-skb05m .gallery-results.present.svelte-skb05m.svelte-skb05m{opacity:0;pointer-events:none}.typo-gallery-grid.svelte-skb05m .present-image.svelte-skb05m.svelte-skb05m{grid-area:1/2/1/2;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;overflow:auto}.typo-gallery-grid.svelte-skb05m .present-image img.svelte-skb05m.svelte-skb05m{border-radius:3px}.typo-gallery-grid.svelte-skb05m .present-sidebar.svelte-skb05m.svelte-skb05m{display:flex;flex-direction:column;gap:.5rem;border-right:1px solid var(--COLOR_PANEL_BORDER_FOCUS);padding-right:2rem;margin-bottom:2rem;grid-area:1/1/1/1}.typo-gallery-grid.svelte-skb05m .present-sidebar .exit-present.svelte-skb05m.svelte-skb05m{cursor:pointer;display:flex;gap:1rem;justify-content:center;align-items:center;font-weight:600;margin-top:auto}.typo-themes-browser-header.svelte-17gbclg.svelte-17gbclg{padding-bottom:1rem;text-align:center}.typo-themes-browser-list.svelte-17gbclg.svelte-17gbclg{display:flex;flex-direction:row;gap:1rem;flex-wrap:wrap;justify-content:center}.typo-themes-browser-item.svelte-17gbclg.svelte-17gbclg{background-color:var(--COLOR_PANEL_HI);border-radius:3px;padding:1rem;gap:1rem;justify-content:start;align-items:center;width:clamp(min(100%,30em),min(100%,30em),max(100%,30em));display:grid;grid-template-columns:auto 1fr}.typo-themes-browser-item.svelte-17gbclg span.svelte-17gbclg{opacity:.5}.typo-themes-browser-item.svelte-17gbclg div.svelte-17gbclg{justify-self:end}.typo-themes-editor.svelte-1gh1qig.svelte-1gh1qig{display:flex;flex-direction:column;height:100%}.typo-themes-editor-header.svelte-1gh1qig.svelte-1gh1qig{padding-bottom:1rem;text-align:center}.typo-themes-editor-content.svelte-1gh1qig.svelte-1gh1qig{display:flex;flex-direction:column;gap:2rem;align-items:start;padding:0 2rem;overflow:auto}details.svelte-1gh1qig.svelte-1gh1qig{border-radius:3px;padding:.5rem 1rem}details[open].svelte-1gh1qig.svelte-1gh1qig{background-color:var(--COLOR_PANEL_HI)}details[open].svelte-1gh1qig summary.svelte-1gh1qig{margin-bottom:.5rem}summary.svelte-1gh1qig.svelte-1gh1qig{font-weight:700;cursor:pointer;-webkit-user-select:none;user-select:none;font-size:1.2rem}.typo-themes-editor-content-section.svelte-1gh1qig.svelte-1gh1qig{display:flex;flex-direction:row;gap:3rem;flex-wrap:wrap;align-items:center;width:100%;padding-bottom:.5rem}.typo-themes-editor-content-section.svelte-1gh1qig .group.svelte-1gh1qig{display:flex;flex-direction:row;gap:1rem;align-items:center}.typo-themes-editor-content-section.svelte-1gh1qig .group.svelte-1gh1qig:vertical{flex-direction:column}.typo-themes-editor-content-section.svelte-1gh1qig .group input.svelte-1gh1qig{width:auto;box-sizing:border-box}.color-pickers.svelte-1gh1qig.svelte-1gh1qig,.style-hooks.svelte-1gh1qig.svelte-1gh1qig{display:grid;grid-template-columns:auto auto;grid-gap:.5rem 2rem}.typo-themes-list-header.svelte-wdh6rb.svelte-wdh6rb.svelte-wdh6rb{padding-bottom:1rem;text-align:center}.typo-themes-list-list.svelte-wdh6rb.svelte-wdh6rb.svelte-wdh6rb{display:flex;flex-direction:row;gap:1rem;flex-wrap:wrap;justify-content:center}.typo-themes-list-item.svelte-wdh6rb.svelte-wdh6rb.svelte-wdh6rb{background-color:var(--COLOR_PANEL_HI);border-radius:3px;padding:1rem;gap:1rem;justify-content:center;align-items:start;display:flex;flex-direction:column;width:clamp(min(100%,20em),min(100%,20em),max(100%,20em))}.typo-themes-list-item.svelte-wdh6rb .active-marker.svelte-wdh6rb.svelte-wdh6rb{display:flex;gap:.5rem;align-items:center}.typo-themes-list-item.svelte-wdh6rb .active-marker img.svelte-wdh6rb.svelte-wdh6rb{height:1.5rem;aspect-ratio:1}.typo-themes-list-item.svelte-wdh6rb>div.svelte-wdh6rb.svelte-wdh6rb{display:flex;flex-direction:row;gap:1rem;width:100%}.typo-themes-list-item.svelte-wdh6rb>div span.svelte-wdh6rb.svelte-wdh6rb{opacity:.5}.typo-themes-list-item.svelte-wdh6rb>div.svelte-wdh6rb>.svelte-wdh6rb:last-child:not(:first-child){flex-grow:1;text-align:end}.typo-themes-content.svelte-1ikbg14.svelte-1ikbg14{padding:1rem;width:100%;height:100%;display:flex;flex-direction:column;overflow:auto}.typo-themes-navigation.svelte-1ikbg14.svelte-1ikbg14{display:flex;align-items:center;justify-content:center;gap:2rem;margin-top:1rem;margin-bottom:2rem}.typo-themes-navigation.svelte-1ikbg14 h3.svelte-1ikbg14{opacity:.5;cursor:pointer}.typo-themes-navigation.svelte-1ikbg14 h3.selected.svelte-1ikbg14{opacity:1}.typo-themes-tab.svelte-1ikbg14.svelte-1ikbg14{overflow:auto}.typo-palette-builder-container.svelte-nspiqx.svelte-nspiqx{background-color:var(--COLOR_PANEL_HI);border-radius:3px;gap:2rem;padding:1rem;display:grid;grid-template-columns:auto auto;flex-direction:column}.typo-palette-builder-container.svelte-nspiqx .typo-palette-builder-inputs.svelte-nspiqx{display:flex;flex-direction:column;gap:.5rem}.typo-palette-builder-container.svelte-nspiqx .typo-palette-builder-inputs b.svelte-nspiqx{margin-top:.5rem}.typo-palette-builder-container.svelte-nspiqx .typo-palette-builder-actions.svelte-nspiqx{display:flex;flex-direction:column;gap:.5rem}.typo-palette-builder-container.svelte-nspiqx .typo-palette-builder-colors.svelte-nspiqx{display:grid;gap:.2rem}.typo-color-palette-manage-list.svelte-vvz4gm{display:flex;flex-direction:row-reverse;gap:1rem;flex-wrap:wrap;justify-content:flex-end}#game-toolbar .typo-palette.colors.svelte-1mmx4c4.svelte-1mmx4c4{height:fit-content}.typo-palette-picker.svelte-1mmx4c4.svelte-1mmx4c4{display:grid;overflow:hidden;border-radius:var(--BORDER_RADIUS);max-width:calc(13 * var(--UNIT) / 2);overflow-x:auto}.typo-palette-picker.svelte-1mmx4c4 .typo-palette-picker-item.svelte-1mmx4c4{aspect-ratio:1;height:calc(var(--UNIT) / 2);cursor:pointer;position:relative}.typo-palette-picker.svelte-1mmx4c4 .typo-palette-picker-item.svelte-1mmx4c4:after{content:"";position:absolute;left:2px;top:2px;right:2px;bottom:2px;border-radius:3px}.typo-palette-picker.svelte-1mmx4c4 .typo-palette-picker-item.svelte-1mmx4c4:hover:after{border-width:3px;border-style:solid;border-color:#0009}.typo-palette-switcher.svelte-144p318.svelte-144p318{display:flex;flex-direction:column;gap:.5rem}.typo-palette-switcher.svelte-144p318 .typo-palette-switcher-item.svelte-144p318{background-color:var(--COLOR_PANEL_BG);border-radius:5px;cursor:pointer;padding:.5em}.color-tools.svelte-iqw7hb.svelte-iqw7hb{height:var(--UNIT);width:calc(var(--UNIT) / 2)}.color-tools.svelte-iqw7hb .pipette.svelte-iqw7hb,.color-tools.svelte-iqw7hb .picker.svelte-iqw7hb{height:50%;width:100%;color:var(--COLOR_TOOL_TEXT);background-color:var(--COLOR_TOOL_BASE);cursor:pointer;background-size:contain;background-position:center;background-repeat:no-repeat}.color-tools.svelte-iqw7hb .pipette.svelte-iqw7hb:hover,.color-tools.svelte-iqw7hb .picker.svelte-iqw7hb:hover{background-color:var(--COLOR_TOOL_HOVER)}.color-tools.svelte-iqw7hb .pipette.selected.svelte-iqw7hb{background-color:var(--COLOR_TOOL_ACTIVE)}.color-tools.svelte-iqw7hb .pipette.svelte-iqw7hb{border-bottom:1px solid lightgray;background-image:var(--file-img-crosshair-gif);border-radius:var(--BORDER_RADIUS) var(--BORDER_RADIUS) 0 0}.color-tools.svelte-iqw7hb .picker.svelte-iqw7hb{border-top:1px solid lightgray;background-image:var(--file-img-inspect-gif);border-radius:0 0 var(--BORDER_RADIUS) var(--BORDER_RADIUS)}canvas.svelte-18097wc{border-radius:3px;width:10rem}@keyframes svelte-15kb90n-drop-in{0%{transform:translateY(-50%);opacity:0}to{transform:translateY(0);opacity:1}}.typo-drop.svelte-15kb90n{position:absolute;bottom:5px;height:48px;aspect-ratio:1;background-size:cover;background-position:center;cursor:pointer;-webkit-user-select:none;user-select:none;animation:svelte-15kb90n-drop-in .05s ease-in forwards}.typo-drop-claims.svelte-qhyy9.svelte-qhyy9{display:flex;flex-direction:column;gap:.5rem}.typo-drop-claims.svelte-qhyy9 .typo-drop-claims-claim.svelte-qhyy9{display:flex;gap:.4rem}@keyframes svelte-dq3z80-warn-blink{0%{opacity:1}25%{opacity:0}50%{opacity:0}75%{opacity:1}to{opacity:1}}#game-word .hints{position:relative}.typo-hints-overlay.svelte-dq3z80.svelte-dq3z80{position:absolute;display:flex;gap:.08em;z-index:10}.typo-hints-overlay.warning.svelte-dq3z80.svelte-dq3z80{z-index:11;animation:svelte-dq3z80-warn-blink .7s infinite}.typo-hints-overlay.warning.svelte-dq3z80 .overlay-character.warning.svelte-dq3z80{opacity:1;color:red;background-color:var(--COLOR_CHAT_BG_BASE)}.typo-hints-overlay.warning.svelte-dq3z80 .overlay-character.svelte-dq3z80:not(.warning){opacity:0}.typo-hints-overlay.correct.svelte-dq3z80 .overlay-character.warning.svelte-dq3z80{opacity:0}.typo-hints-overlay.svelte-dq3z80 .overlay-character.svelte-dq3z80{width:1ch;color:inherit;opacity:.6}.typo-hints-overlay.svelte-dq3z80 .overlay-character.hidden.svelte-dq3z80{opacity:0}.agent-content.svelte-z5nxkg.svelte-z5nxkg{z-index:1;width:100%;display:flex;flex-direction:column;gap:1rem;position:relative}.agent-content.svelte-z5nxkg>img.svelte-z5nxkg{width:100%;border-radius:3px;cursor:pointer}.agent-inputs.svelte-z5nxkg.svelte-z5nxkg{display:flex;gap:1rem}.agent-inputs.svelte-z5nxkg input.svelte-z5nxkg{flex-grow:1}.status-info.svelte-1y63bp4.svelte-1y63bp4,.typo-lobby-status-settings.svelte-1y63bp4.svelte-1y63bp4{display:flex;flex-direction:column;gap:1rem}.typo-lobby-status-settings.svelte-1y63bp4 .status-settings.svelte-1y63bp4{display:flex;gap:1rem;flex-direction:column}.typo-cabin.svelte-10x5c2g.svelte-10x5c2g{height:100%;overflow:auto;position:relative}.typo-cabin.svelte-10x5c2g .typo-cabin-saving.svelte-10x5c2g{position:absolute;top:0;right:0;bottom:0;left:0;display:none;place-content:center;z-index:2}.typo-cabin.loading.svelte-10x5c2g .typo-cabin-saving.svelte-10x5c2g{display:grid}.typo-cabin.loading.svelte-10x5c2g .typo-cabin-picker.svelte-10x5c2g{opacity:.2}.typo-cabin.svelte-10x5c2g .typo-cabin-scroll.svelte-10x5c2g{height:100%;overflow:auto;padding-right:.5rem}.typo-cabin-picker.svelte-10x5c2g.svelte-10x5c2g{display:grid;grid-template-columns:1fr 1fr 1fr;grid-gap:.5rem}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene.svelte-10x5c2g{order:0;grid-column:span 3;width:100%;aspect-ratio:3;background-color:var(--COLOR_PANEL_BG);border-radius:5px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.5rem;overflow:hidden;transition:transform .1s;cursor:pointer;-webkit-user-select:none;user-select:none;position:relative}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene .typo-cabin-scene-thumb.svelte-10x5c2g{position:absolute;top:0;right:0;bottom:0;left:0;background-size:cover;background-position:center;background-repeat:no-repeat;z-index:0;opacity:1;transition:opacity .1s}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene.svelte-10x5c2g:hover{transform:scale(.95)}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene:hover .typo-cabin-scene-info.svelte-10x5c2g{opacity:1}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene:hover .typo-cabin-scene-thumb.svelte-10x5c2g{opacity:.2}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene .typo-cabin-scene-info.svelte-10x5c2g{opacity:0;text-align:center;font-size:.8rem;transition:opacity .1s;z-index:1}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-scene .typo-cabin-scene-info.visible.svelte-10x5c2g{opacity:1}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot.svelte-10x5c2g{background-color:var(--COLOR_PANEL_BG);border-radius:5px;width:100%;aspect-ratio:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.5rem;overflow:hidden;transition:transform .1s;cursor:pointer;-webkit-user-select:none;user-select:none;position:relative}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot .typo-cabin-slot-thumb.svelte-10x5c2g{position:absolute;top:0;right:0;bottom:0;left:0;background-size:cover;background-position:center;background-repeat:no-repeat;z-index:0;opacity:1;transition:opacity .1s}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot.svelte-10x5c2g:hover:not(.dragging){transform:scale(.9)}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot:hover:not(.dragging) .typo-cabin-slot-info.svelte-10x5c2g{opacity:1}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot:hover:not(.dragging) .typo-cabin-slot-thumb.svelte-10x5c2g{opacity:.2}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot .typo-cabin-slot-info.svelte-10x5c2g{opacity:0;text-align:center;font-size:.8rem;transition:opacity .1s;z-index:1}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot .typo-cabin-slot-info.visible.svelte-10x5c2g{opacity:1}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot.locked.svelte-10x5c2g{cursor:not-allowed}.typo-cabin-picker.svelte-10x5c2g .typo-cabin-slot.locked .typo-cabin-slot-info.svelte-10x5c2g{opacity:.9}.typo-sprite-picker.svelte-1bcvdme.svelte-1bcvdme{display:flex;flex-direction:column;width:100%;align-items:center;gap:2rem;margin-bottom:2rem;overflow:auto}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-filter.svelte-1bcvdme{display:flex;flex-direction:row;gap:2rem;align-items:center;justify-content:center}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-filter input.svelte-1bcvdme{width:auto}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-list.svelte-1bcvdme{flex-grow:1;width:100%;overflow:auto;display:grid;grid-template-columns:repeat(auto-fit,8rem);gap:1rem;padding:0 2rem}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-list .typo-sprite-picker-sprite.svelte-1bcvdme{background-color:var(--COLOR_PANEL_BG);border-radius:5px;display:flex;flex-direction:column;gap:.1rem;padding:.1rem;align-items:center;cursor:pointer;transition:transform .1s;aspect-ratio:1}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-list .typo-sprite-picker-sprite.svelte-1bcvdme:hover{transform:scale(.9)}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-list .typo-sprite-picker-sprite .typo-sprite-picker-sprite-thumb.svelte-1bcvdme{width:5rem;aspect-ratio:1;background-size:cover}.typo-sprite-picker.svelte-1bcvdme .typo-sprite-picker-list .typo-sprite-picker-sprite span.svelte-1bcvdme{font-size:.9rem;opacity:.9;text-align:center}.typo-scene-picker.svelte-1s2xvs0.svelte-1s2xvs0{display:flex;flex-direction:column;width:100%;align-items:center;gap:2rem;margin-bottom:2rem;overflow:auto}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list.svelte-1s2xvs0{flex-grow:1;width:100%;overflow:auto;display:flex;align-items:center;flex-direction:column;gap:1rem;padding:0 2rem}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list .typo-scene-picker-scene.svelte-1s2xvs0{background-color:var(--COLOR_PANEL_BG);border-radius:3px;display:flex;flex-direction:column;gap:.1rem;padding:.4rem;align-items:center;cursor:pointer;transition:transform .1s}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list .typo-scene-picker-scene.svelte-1s2xvs0:hover{transform:scale(.9)}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list .typo-scene-picker-scene .typo-scene-picker-scene-thumb.svelte-1s2xvs0{width:20rem;max-width:90%;aspect-ratio:3;background-size:cover;border-radius:3px}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list .typo-scene-picker-scene span.svelte-1s2xvs0{font-size:.9rem;opacity:.9;text-align:center}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list .typo-scene-picker-scene span.id.svelte-1s2xvs0{opacity:.5}.typo-scene-picker.svelte-1s2xvs0 .typo-scene-picker-list .typo-scene-picker-scene span.name.svelte-1s2xvs0{font-weight:700}div.panel-changelog.svelte-eh7e5t.svelte-eh7e5t{display:flex;flex-direction:column;justify-content:center;padding:0 .5rem}div.panel-changelog.svelte-eh7e5t>.changelog.svelte-eh7e5t{white-space:pre;text-wrap:pretty}div.panel-changelog.svelte-eh7e5t>.changelog .change.svelte-eh7e5t{display:flex;flex-direction:column;gap:.5rem;padding:.5rem 0}div.panel-changelog.svelte-eh7e5t>.changelog .change.svelte-eh7e5t:has(.details){cursor:pointer}div.panel-changelog.svelte-eh7e5t>.changelog .change .details.svelte-eh7e5t{font-size:.8rem;opacity:.7}div.panel-changelog.svelte-eh7e5t>.changelog .change.svelte-eh7e5t:not(:last-child){border-bottom:1px solid var(--COLOR_PANEL_BORDER_FOCUS)}div.panel-changelog.svelte-eh7e5t>.changelog .change .title.svelte-eh7e5t{display:flex;justify-content:space-between;gap:1rem;align-items:center}div.panel-changelog.svelte-eh7e5t>.changelog .change .title span.svelte-eh7e5t{font-size:.8rem;opacity:.7}div.panel-changelog.svelte-eh7e5t .typo-version.svelte-eh7e5t{font-size:.8rem;opacity:.7}.details.svelte-mkybs6{padding:0 1rem}.details.svelte-mkybs6 li{margin-left:1rem}.details.svelte-mkybs6 :is(p,ul,ol){margin-bottom:1.5rem}.info.svelte-mkybs6{display:flex;gap:1.5rem;justify-content:center;font-size:.8em;opacity:.8}.typo-lobbies-discord.svelte-tkvjrc.svelte-tkvjrc.svelte-tkvjrc{display:flex;flex-direction:column;gap:.5rem;padding-bottom:1rem;padding-right:.5rem}.typo-lobbies-discord.svelte-tkvjrc .typo-lobbies-discord-buttons.svelte-tkvjrc.svelte-tkvjrc{display:flex;flex-wrap:wrap;gap:.5rem}.typo-lobbies-discovered.svelte-tkvjrc.svelte-tkvjrc.svelte-tkvjrc{padding-top:1rem;display:flex;flex-direction:column;gap:.5rem;padding-right:.5rem;border-top:1px solid var(--COLOR_PANEL_BORDER_FOCUS)}.typo-lobbies-discovered.svelte-tkvjrc .typo-lobbies-discovered-buttons.svelte-tkvjrc.svelte-tkvjrc{display:flex;flex-direction:column-reverse;gap:.5rem}.typo-lobbies-discovered.svelte-tkvjrc .typo-lobbies-discovered-buttons.svelte-tkvjrc>div.svelte-tkvjrc{display:grid;grid-template-columns:auto auto;grid-template-rows:1fr 1fr;gap:1rem;row-gap:0;place-items:center;background-color:var(--COLOR_PANEL_BG);padding:.2rem;border-radius:3px;font-size:.9rem;cursor:pointer;-webkit-user-select:none;user-select:none}.typo-lobbies-discovered.svelte-tkvjrc .typo-lobbies-discovered-buttons>div.svelte-tkvjrc b.svelte-tkvjrc{opacity:.7;justify-self:baseline}.typo-lobbies-discovered.svelte-tkvjrc .typo-lobbies-discovered-buttons>div.svelte-tkvjrc span.svelte-tkvjrc{grid-column:2/2;grid-row:1/3}div.typo-news.svelte-1x3jcfi.svelte-1x3jcfi{display:flex;flex-direction:column;justify-content:center;padding:0 .5rem}div.typo-news.svelte-1x3jcfi>.news.svelte-1x3jcfi{white-space:pre;text-wrap:pretty;display:flex;flex-direction:column}div.typo-news.svelte-1x3jcfi>.news .announcement.svelte-1x3jcfi{display:flex;flex-direction:column;gap:.5rem;padding:.5rem 0}div.typo-news.svelte-1x3jcfi>.news .announcement.svelte-1x3jcfi:not(:last-child){border-bottom:1px solid var(--COLOR_PANEL_BORDER_FOCUS)}div.typo-news.svelte-1x3jcfi>.news .announcement .title.svelte-1x3jcfi{display:flex;justify-content:space-between;gap:1rem;align-items:center}div.typo-news.svelte-1x3jcfi>.news .announcement .title span.svelte-1x3jcfi{font-size:.8rem;opacity:.7}@keyframes svelte-1s7wcc7-appear{0%{opacity:0;scale:0}to{opacity:1;scale:1}}.typo-tooltip.svelte-1s7wcc7.svelte-1s7wcc7{position:fixed;display:flex;z-index:10000;align-items:center;animation:svelte-1s7wcc7-appear .1s forwards ease-out;pointer-events:none;transform-origin:0 0}.typo-tooltip.svelte-1s7wcc7 .typo-tooltip-title.svelte-1s7wcc7{background-color:var(--COLOR_TOOL_TIP_BG);color:var(--COLOR_PANEL_TEXT);border-radius:var(--BORDER_RADIUS);padding:7px;text-shadow:1px 1px 0 rgba(0,0,0,.2196078431);text-align:center;font-size:13px;font-weight:700;white-space:pre}.typo-tooltip.svelte-1s7wcc7 .typo-tooltip-arrow.svelte-1s7wcc7{height:0;width:0}.typo-tooltip.E.svelte-1s7wcc7.svelte-1s7wcc7{transform:translateY(-50%);flex-direction:row}.typo-tooltip.E.svelte-1s7wcc7 .typo-tooltip-arrow.svelte-1s7wcc7{border-right:10px solid var(--COLOR_TOOL_TIP_BG);border-top:10px solid transparent;border-bottom:10px solid transparent}.typo-tooltip.S.svelte-1s7wcc7.svelte-1s7wcc7{transform:translate(-50%);flex-direction:column}.typo-tooltip.S.svelte-1s7wcc7 .typo-tooltip-arrow.svelte-1s7wcc7{border-bottom:10px solid var(--COLOR_TOOL_TIP_BG);border-left:10px solid transparent;border-right:10px solid transparent}.typo-tooltip.N.svelte-1s7wcc7.svelte-1s7wcc7{flex-direction:column-reverse;transform:translate(-50%) translateY(-100%)}.typo-tooltip.N.svelte-1s7wcc7 .typo-tooltip-arrow.svelte-1s7wcc7{border-top:10px solid var(--COLOR_TOOL_TIP_BG);border-left:10px solid transparent;border-right:10px solid transparent}.typo-tooltip.W.svelte-1s7wcc7.svelte-1s7wcc7{flex-direction:row-reverse;transform:translate(-100%) translateY(-50%)}.typo-tooltip.W.svelte-1s7wcc7 .typo-tooltip-arrow.svelte-1s7wcc7{border-left:10px solid var(--COLOR_TOOL_TIP_BG);border-top:10px solid transparent;border-bottom:10px solid transparent}#home .panel.member-info.svelte-j680fu.svelte-j680fu.svelte-j680fu.svelte-j680fu{display:flex;flex-direction:column;gap:1em;padding:1em;width:100%;margin-bottom:10px;color:var(--COLOR_PANEL_TEXT)}#home .panel.member-info.svelte-j680fu img.typo-icon.svelte-j680fu.svelte-j680fu.svelte-j680fu{height:1.2em;image-rendering:auto;aspect-ratio:1;content:var(--file-img-typo-gif)}#home .panel.member-info.svelte-j680fu>.member-login.svelte-j680fu.svelte-j680fu.svelte-j680fu{display:flex;align-items:center;gap:1rem;font-weight:700;font-size:.9rem;cursor:pointer;opacity:.7}#home .panel.member-info.svelte-j680fu>.member-info-header.svelte-j680fu.svelte-j680fu.svelte-j680fu{display:flex;justify-content:space-between;align-items:center}#home .panel.member-info.svelte-j680fu>.member-info-header.svelte-j680fu>span.svelte-j680fu.svelte-j680fu,#home .panel.member-info.svelte-j680fu>.member-info-header.svelte-j680fu>a.svelte-j680fu.svelte-j680fu{display:flex;align-items:center;gap:.5em;font-weight:700;font-size:.9rem;cursor:pointer;opacity:.7;color:inherit;text-decoration:none}#home .panel.member-info.svelte-j680fu>.member-info-stats.svelte-j680fu.svelte-j680fu.svelte-j680fu{display:flex;justify-content:space-evenly}#home .panel.member-info.svelte-j680fu>.member-info-stats.svelte-j680fu>div.svelte-j680fu.svelte-j680fu{display:flex;gap:.2em}#home .panel.member-info.svelte-j680fu>.member-info-stats.svelte-j680fu>div.svelte-j680fu>div.stat-icon.svelte-j680fu{height:1.5rem;aspect-ratio:1;background-position:center;background-size:cover;background-repeat:no-repeat}#home .panel.member-info.svelte-j680fu>.member-info-stats.svelte-j680fu>div.svelte-j680fu>span.svelte-j680fu{font-weight:700}#home .panel.member-info.svelte-j680fu>.member-info-stats.svelte-j680fu>div.svelte-j680fu>span.svelte-j680fu:nth-child(2){opacity:.8}@keyframes svelte-1593rkb-iconAppear{0%{opacity:.3;transform:scale(0) translateY(30px)}50%{opacity:1}to{opacity:0;transform:scale(1) translateY(-30px)}}.typo-onboarding-emote.svelte-1593rkb{height:30px;aspect-ratio:1;animation:svelte-1593rkb-iconAppear 2.5s forwards ease-out;position:absolute;-webkit-user-select:none;user-select:none}p.svelte-115f3km.svelte-115f3km,ul.svelte-115f3km.svelte-115f3km,h3.svelte-115f3km.svelte-115f3km,h4.svelte-115f3km.svelte-115f3km{margin-bottom:1rem}p.svelte-115f3km>.svelte-115f3km,ul.svelte-115f3km>.svelte-115f3km{text-align:start}a.svelte-115f3km.svelte-115f3km{cursor:pointer;font-weight:700}p.svelte-1d2n9p6,ul.svelte-1d2n9p6,h3.svelte-1d2n9p6,h4.svelte-1d2n9p6{margin-bottom:1rem}a.svelte-1d2n9p6{cursor:pointer;font-weight:700}.typo-onboarding-wrapper.svelte-bu1e3.svelte-bu1e3{display:flex;align-items:center;flex-direction:column;margin:1rem}.typo-onboarding-hero.svelte-bu1e3.svelte-bu1e3{display:grid;place-content:center;position:relative;padding:100px 300px;margin:40px 40px 2rem;transition:padding .4s,margin-top .4s}@media (max-aspect-ratio: 1){.typo-onboarding-hero.svelte-bu1e3.svelte-bu1e3{padding:4rem 0 0}}.typo-onboarding-hero.hidden.svelte-bu1e3.svelte-bu1e3{margin-top:0;padding:0}.typo-onboarding-hero.svelte-bu1e3>div.svelte-bu1e3{text-align:center;position:relative}.typo-onboarding-hero.svelte-bu1e3:hover:not(.hidden) .beta-credits.svelte-bu1e3{opacity:.5}.typo-onboarding-hero.svelte-bu1e3 .beta-credits.svelte-bu1e3{position:absolute;bottom:0;width:100%;opacity:0;-webkit-user-select:none;user-select:none;transition:opacity .4s;transition-delay:.5s;text-align:center;font-size:.8rem;z-index:10}.onboarding-tabs.svelte-bu1e3.svelte-bu1e3{display:flex;gap:1rem;justify-content:center}.onboarding-tabs.svelte-bu1e3 h4.svelte-bu1e3{cursor:pointer;padding:1rem;opacity:.5;-webkit-user-select:none;user-select:none;text-align:center}.onboarding-tabs.svelte-bu1e3 h4.active.svelte-bu1e3{opacity:1}.typo-onboarding-presets.svelte-bu1e3.svelte-bu1e3{display:flex;flex-direction:column;gap:1rem;align-items:center}.typo-onboarding-presets.svelte-bu1e3 .typo-onboarding-preset.svelte-bu1e3{position:relative;cursor:pointer;background-color:var(--COLOR_PANEL_HI);border-radius:3px;padding:1rem;display:flex;flex-direction:column;gap:1rem;width:clamp(min(40em,100%),min(40em,100%),max(40em,100%));transition:transform .2s}.typo-onboarding-presets.svelte-bu1e3 .typo-onboarding-preset.svelte-bu1e3:hover{transform:translate(1rem)}.typo-onboarding-presets.svelte-bu1e3 .typo-onboarding-preset.svelte-bu1e3:hover:before{opacity:1}.typo-onboarding-presets.svelte-bu1e3 .typo-onboarding-preset.svelte-bu1e3:before{content:"";background-image:var(--file-img-arrow-right-gif);background-repeat:no-repeat;background-size:contain;width:2.5rem;background-position:center;position:absolute;top:0;bottom:0;left:-3.5rem;opacity:0;transition:opacity .2s;pointer-events:none}.typo-onboarding-checklist-wrapper.svelte-bu1e3.svelte-bu1e3{display:flex;flex-direction:column;align-items:stretch}.typo-onboarding-checklist-wrapper.svelte-bu1e3 .typo-onboarding-checklist.svelte-bu1e3{display:flex;flex-direction:column;gap:1rem;align-items:center;margin-top:1rem}.typo-onboarding-checklist-wrapper.svelte-bu1e3 .typo-onboarding-checklist .typo-onboarding-task.svelte-bu1e3{cursor:pointer;background-color:var(--COLOR_PANEL_HI);border-radius:3px;padding:1rem;display:flex;flex-direction:column;gap:1rem;width:clamp(min(40em,100%),min(40em,100%),max(40em,100%))}.typo-onboarding-checklist-wrapper.svelte-bu1e3 .typo-onboarding-checklist .typo-onboarding-task.done.svelte-bu1e3{cursor:auto}.typo-onboarding-checklist-wrapper.svelte-bu1e3 .typo-onboarding-checklist .typo-onboarding-task.done .description.svelte-bu1e3{opacity:.5}.typo-onboarding-checklist-wrapper.svelte-bu1e3 .typo-onboarding-checklist .typo-onboarding-task .details.svelte-bu1e3{display:flex;gap:1rem}.typo-onboarding-extras.svelte-bu1e3.svelte-bu1e3{display:flex;flex-direction:row;gap:3rem;align-self:stretch;padding:0 2rem 2rem}@media (max-aspect-ratio: 1){.typo-onboarding-extras.svelte-bu1e3.svelte-bu1e3{flex-direction:column}}.typo-onboarding-extras.svelte-bu1e3 .typo-onboarding-extras-sections.svelte-bu1e3{display:flex;flex-direction:column;gap:1rem}.typo-onboarding-extras.svelte-bu1e3 .typo-onboarding-extras-sections b.svelte-bu1e3{cursor:pointer;opacity:.5;-webkit-user-select:none;user-select:none}.typo-onboarding-extras.svelte-bu1e3 .typo-onboarding-extras-sections b.active.svelte-bu1e3{opacity:1}.typo-onboarding-extras.svelte-bu1e3 .typo-onboarding-extras-content.svelte-bu1e3{flex-grow:1;display:flex;flex-direction:column;align-items:center}.typo-profiles.svelte-16buojm.svelte-16buojm{display:flex;flex-direction:column;gap:1rem;align-items:stretch;width:fit-content}.typo-profiles.svelte-16buojm .typo-profile.svelte-16buojm{display:flex;position:relative;gap:1rem;cursor:pointer;border-radius:3px;padding:.5rem;align-items:center;background-color:var(--COLOR_PANEL_HI);transition:transform .2s;justify-content:space-between}.typo-profiles.svelte-16buojm .typo-profile.svelte-16buojm:hover{transform:translate(1rem)}.typo-profiles.svelte-16buojm .typo-profile.svelte-16buojm:hover:before{opacity:1}.typo-profiles.svelte-16buojm .typo-profile.svelte-16buojm:before{content:"";background-image:var(--file-img-arrow-right-gif);background-repeat:no-repeat;background-size:contain;width:2rem;background-position:center;position:absolute;top:0;bottom:0;left:-3rem;opacity:0;transition:opacity .2s;pointer-events:none}.typo-feature-settings-hotkey.svelte-10zlzgr.svelte-10zlzgr{background-color:var(--COLOR_PANEL_HI);display:grid;grid-template-columns:auto auto auto auto;grid-template-rows:1fr 1fr;flex-direction:column;border-radius:3px;gap:1rem;padding:1rem;align-items:center}.typo-feature-settings-hotkey.svelte-10zlzgr .inputs-disabled-hint.svelte-10zlzgr{font-size:.8rem;opacity:.7}.typo-feature-settings-hotkey.svelte-10zlzgr .button-container.svelte-10zlzgr{font-size:1em}.typo-feature-settings-command.svelte-lvvgs4.svelte-lvvgs4{background-color:var(--COLOR_PANEL_HI);display:grid;grid-template-columns:auto auto auto auto;grid-template-rows:1fr 1fr;flex-direction:column;border-radius:3px;gap:1rem;padding:1rem;align-items:center}.typo-feature-settings-command.svelte-lvvgs4 .button-container.svelte-lvvgs4{font-size:1em}.typo-feature-settings-title.svelte-1njssi3.svelte-1njssi3{width:100%;display:grid;grid-template-columns:1fr 1fr 1fr;align-items:center}.typo-feature-settings-title.svelte-1njssi3 .typo-feature-settings-hero.svelte-1njssi3{opacity:.7;font-weight:600;justify-self:start}.typo-feature-settings-title.svelte-1njssi3 .typo-feature-settings-back.svelte-1njssi3{cursor:pointer;opacity:.7;font-weight:600;justify-self:end}.typo-feature-settings-title.svelte-1njssi3 .typo-feature-settings-back.svelte-1njssi3:hover{opacity:1}.typo-feature-settings-title.svelte-1njssi3>h1.svelte-1njssi3{justify-self:center}.typo-feature-settings-summary.svelte-1njssi3.svelte-1njssi3{text-align:center}.typo-feature-settings-info.svelte-1njssi3.svelte-1njssi3,.typo-feature-settings-management.svelte-1njssi3.svelte-1njssi3,.typo-feature-settings-hotkeys.svelte-1njssi3.svelte-1njssi3,.typo-feature-settings-default.svelte-1njssi3.svelte-1njssi3{width:100%;display:flex;flex-direction:column}.typo-feature-settings-info.svelte-1njssi3 h2.svelte-1njssi3,.typo-feature-settings-management.svelte-1njssi3 h2.svelte-1njssi3,.typo-feature-settings-hotkeys.svelte-1njssi3 h2.svelte-1njssi3,.typo-feature-settings-default.svelte-1njssi3 h2.svelte-1njssi3{margin-bottom:.5em}.typo-feature-settings-default.svelte-1njssi3 .typo-feature-settings-default-list.svelte-1njssi3{display:flex;flex-direction:row;flex-wrap:wrap;gap:2rem}.typo-feature-settings-default.svelte-1njssi3 .typo-feature-settings-default-list .typo-feature-settings-default-item.svelte-1njssi3{min-width:clamp(20em,20em,100%);max-width:clamp(20em,20em,100%);background-color:var(--COLOR_PANEL_HI);border-radius:3px;display:flex;flex-direction:column;gap:1rem;padding:1rem;flex:1 1 0px;position:relative}.typo-feature-settings-hotkeys-list.svelte-1njssi3.svelte-1njssi3,.typo-feature-settings-commands-list.svelte-1njssi3.svelte-1njssi3{display:flex;flex-direction:row;gap:1rem;flex-wrap:wrap}.typo-feature-item.svelte-xje42n.svelte-xje42n{min-width:clamp(20em,20em,100%);max-width:clamp(20em,20em,100%);background-color:var(--COLOR_PANEL_HI);border-radius:3px;display:flex;flex-direction:column;gap:1rem;padding:1rem;flex:1 1 0px;position:relative}.typo-feature-item.hidden.svelte-xje42n.svelte-xje42n{display:none}.typo-feature-item.svelte-xje42n .feature-tags.svelte-xje42n{opacity:.5;font-size:.9rem;text-transform:lowercase}.typo-feature-item.devMode.svelte-xje42n .feature-id.svelte-xje42n{display:block;position:absolute;bottom:0;right:0;-webkit-user-select:none;user-select:none;opacity:.5;padding:.2rem}.typo-feature-item.svelte-xje42n .feature-id.svelte-xje42n{display:none}.typo-feature-item.svelte-xje42n .description.svelte-xje42n{flex-grow:1;display:flex;gap:1rem;align-items:center;-webkit-user-select:none;user-select:none}.typo-feature-item.svelte-xje42n .description[role=button].svelte-xje42n{cursor:pointer}.typo-feature-item.svelte-xje42n .description img.svelte-xje42n{filter:grayscale(100%);opacity:.7;width:1.5em;height:1.5em}.typo-feature-item.svelte-xje42n .description img.svelte-xje42n:hover{filter:grayscale(0%);opacity:1}.typo-feature-item.svelte-xje42n .name-toggle.svelte-xje42n{display:flex;align-items:center;gap:1rem;font-weight:700;font-size:1.2rem;cursor:pointer;-webkit-user-select:none;user-select:none}.typo-feature-item.svelte-xje42n .name-toggle.locked.svelte-xje42n{cursor:not-allowed}.typo-feature-item.svelte-xje42n .name-toggle.locked img.svelte-xje42n{filter:grayscale(100%);opacity:.7}.typo-feature-item.svelte-xje42n .name-toggle img.svelte-xje42n{width:1.5em;height:1.5em;filter:drop-shadow(3px 3px 0px rgba(0,0,0,.3))}.typo-feature-item.svelte-xje42n .name-toggle span.svelte-xje42n:last-child{font-size:1rem;opacity:.5;margin-left:auto;text-transform:uppercase}.typo-features-container.svelte-1ly2c3r.svelte-1ly2c3r{position:relative;width:100%;flex-grow:1;overflow-x:hidden}.typo-features-info.svelte-1ly2c3r.svelte-1ly2c3r{max-width:clamp(40em,40em,100%);text-align:left;padding-bottom:2em}.typo-features-filter.svelte-1ly2c3r.svelte-1ly2c3r{display:grid;gap:1rem;grid-template-columns:auto auto;padding-bottom:2em;align-items:center}.typo-features-filter.svelte-1ly2c3r .filters.svelte-1ly2c3r{display:flex;flex-wrap:wrap;gap:1rem}.typo-features-filter.svelte-1ly2c3r .filter.svelte-1ly2c3r{text-transform:lowercase;cursor:pointer;padding:.3rem;background-color:var(--COLOR_PANEL_HI);border-radius:3px;opacity:.6}.typo-features-filter.svelte-1ly2c3r .filter.selected.svelte-1ly2c3r{opacity:1}.typo-feature-settings.svelte-1ly2c3r.svelte-1ly2c3r{position:absolute;top:0;right:0;bottom:0;left:0;display:flex;flex-direction:column;gap:2rem;margin:0 2em 2em;padding:2em;overflow:auto;transform:translate(-100vw);transition:transform .1s ease-in-out;border-radius:3px}.typo-feature-settings.settingsVisible.svelte-1ly2c3r.svelte-1ly2c3r{transform:translate(0)}.typo-features.svelte-1ly2c3r.svelte-1ly2c3r{display:flex;flex-direction:column;align-items:center;position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(0);transition:transform .1s ease-in-out}.typo-features.settingsVisible.svelte-1ly2c3r.svelte-1ly2c3r{transform:translate(100vw)}.typo-features.svelte-1ly2c3r .typo-features-list.svelte-1ly2c3r{width:100%;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center;gap:2rem;margin:0 2rem;padding-bottom:2rem;overflow:auto}#game-toolbar:has(.typo-brush-lab-switch.expanded){grid-template-rows:max-content}#game-toolbar:not(:has(.typo-brush-lab-switch.expanded))>.typo-brush-lab-group{display:none}.typo-brush-lab-group.svelte-p5jc91.svelte-p5jc91{display:flex;flex-direction:row;align-items:center;gap:2rem;grid-row:2}.typo-brush-lab-group.svelte-p5jc91 .typo-brush-lab-mods.svelte-p5jc91,.typo-brush-lab-group.svelte-p5jc91 .typo-brush-lab-tools.svelte-p5jc91{display:flex;flex-direction:row;gap:.5rem}.item-selection.svelte-fdmon8.svelte-fdmon8{display:grid;grid-template-columns:auto 1fr;flex-grow:1;width:100%;padding:1rem 2rem;gap:2rem}.item-selection.svelte-fdmon8 .item-sidebar.svelte-fdmon8{display:flex;flex-direction:column;gap:1rem;padding-right:2rem;height:100%;border-right:1px solid var(--COLOR_PANEL_BORDER_FOCUS);overflow:auto}.item-selection.svelte-fdmon8 .item-sidebar h3.svelte-fdmon8{opacity:.5}.item-selection.svelte-fdmon8 .item-sidebar .item-sidebar-entry.svelte-fdmon8{display:flex;gap:.5rem;align-items:center;cursor:pointer}.item-selection.svelte-fdmon8 .item-sidebar .item-sidebar-entry img.svelte-fdmon8{height:2rem}.item-selection.svelte-fdmon8 .item-details.svelte-fdmon8{display:flex;flex-direction:column;gap:1rem}.item-selection.svelte-fdmon8 .item-details .item-title.svelte-fdmon8{display:flex;align-items:center;gap:2rem}.item-selection.svelte-fdmon8 .item-details .item-title b.svelte-fdmon8{opacity:.5}.item-selection.svelte-fdmon8 .item-details .item-details-settings-list.svelte-fdmon8{display:flex;flex-direction:row;flex-wrap:wrap;gap:2rem}.item-selection.svelte-fdmon8 .item-details .item-details-settings-list .item-details-settings-item.svelte-fdmon8{min-width:clamp(20em,20em,100%);max-width:clamp(20em,20em,100%);background-color:var(--COLOR_PANEL_HI);border-radius:3px;display:flex;flex-direction:column;gap:1rem;padding:1rem;flex:1 1 0px;position:relative}.description.svelte-fdmon8.svelte-fdmon8{text-align:center}.typo-stats-chart.svelte-10kahpp.svelte-10kahpp{display:flex;flex-direction:column;gap:1rem}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-caption.svelte-10kahpp{text-align:center}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-selection.svelte-10kahpp{display:grid;grid-template-columns:auto auto;gap:1rem;align-items:center;justify-items:right}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-selection label.svelte-10kahpp{font-weight:700}.typo-stats-chart.svelte-10kahpp canvas.hidden.svelte-10kahpp{display:none}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-players.svelte-10kahpp{display:flex;flex-direction:row;flex-wrap:wrap;gap:.5rem}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-table.svelte-10kahpp{display:flex;flex-direction:column;gap:1rem;justify-content:start}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-table table.svelte-10kahpp{width:100%;border-collapse:collapse}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-table table th.svelte-10kahpp,.typo-stats-chart.svelte-10kahpp .typo-stats-chart-table table td.svelte-10kahpp{border:1px solid var(--COLOR_PANEL_TEXT);padding:8px;text-align:left}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-table table th.svelte-10kahpp{font-weight:700}.typo-stats-chart.svelte-10kahpp .typo-stats-chart-table table tr.svelte-10kahpp:nth-child(2n){background-color:#0003}input[type=number].svelte-1bkcudg{width:7ex}.typo-chat-summary-stats.svelte-13zbhcg.svelte-13zbhcg.svelte-13zbhcg{display:flex;flex-direction:column;gap:.3rem;width:100%}.typo-chat-summary-stats.svelte-13zbhcg>b.svelte-13zbhcg.svelte-13zbhcg{justify-self:flex-end;color:var(--COLOR_CHAT_TEXT_DRAWING)}.typo-chat-summary-stats.svelte-13zbhcg .chat-summary-stats-category ol.svelte-13zbhcg.svelte-13zbhcg{list-style-type:decimal;list-style-position:inside}.typo-chat-summary-stats.svelte-13zbhcg .chat-summary-stats-category ol li.svelte-13zbhcg.svelte-13zbhcg::marker{opacity:.8}.typo-chat-summary-stats.svelte-13zbhcg .chat-summary-stats-nav.svelte-13zbhcg.svelte-13zbhcg{justify-self:stretch;display:flex;align-items:center;gap:.2rem;justify-content:start;-webkit-user-select:none;user-select:none}.typo-chat-summary-stats.svelte-13zbhcg .chat-summary-stats-nav .chat-summary-stats-nav-arrow.svelte-13zbhcg.svelte-13zbhcg{transform:rotate(90deg)}.typo-chat-summary-stats.svelte-13zbhcg .chat-summary-stats-nav.svelte-13zbhcg>div.svelte-13zbhcg:last-child{margin-left:auto}.typo-logs-export.svelte-oun24t.svelte-oun24t,.typo-logs-logger-list.svelte-oun24t.svelte-oun24t,.typo-logs-overwrite.svelte-oun24t.svelte-oun24t{display:flex;flex-direction:row;flex-wrap:wrap;gap:1rem;margin:1rem;align-items:center}.typo-logs-logger-list.svelte-oun24t .typo-logs-logger.svelte-oun24t{min-width:clamp(10em,auto,100%);max-width:clamp(10em,auto,100%);background-color:var(--COLOR_PANEL_HI);display:flex;flex-direction:column;border-radius:3px;gap:1rem;padding:1rem}.typo-logs-logger-list.svelte-oun24t .typo-logs-logger.hidden.svelte-oun24t{display:none}.typo-lobby-filters.svelte-lqoucf.svelte-lqoucf{display:flex;flex-direction:column;overflow:auto;height:100%;gap:1rem}.typo-lobby-filters.svelte-lqoucf .typo-lobby-filters-header.svelte-lqoucf{display:flex;justify-content:space-between;align-items:center}.typo-lobby-filters.svelte-lqoucf .typo-lobby-filters-list.svelte-lqoucf{flex-grow:1;display:flex;flex-wrap:wrap;gap:1rem;align-content:flex-start;overflow:auto}.typo-lobby-filters.svelte-lqoucf .typo-lobby-filters-list .typo-lobby-filters-item.svelte-lqoucf{display:flex;align-items:center;gap:.5rem;padding:.2rem;background-color:var(--COLOR_PANEL_HI);border-radius:3px}.typo-lobby-filters.svelte-lqoucf .typo-lobby-filters-list .typo-lobby-filters-item .typo-lobby-filters-item-remove.svelte-lqoucf{opacity:0;transition:opacity .1s}.typo-lobby-filters.svelte-lqoucf .typo-lobby-filters-list .typo-lobby-filters-item:hover .typo-lobby-filters-item-remove.svelte-lqoucf{opacity:1}.typo-filter-form.svelte-9ect24.svelte-9ect24{display:flex;flex-direction:column;gap:2rem}.typo-filter-form.svelte-9ect24 .typo-filter-form-inputs.svelte-9ect24{display:flex;flex-direction:column;gap:1rem}.typo-filter-form.svelte-9ect24 .typo-filter-form-inputs .typo-filter-form-row.svelte-9ect24{display:flex;gap:1rem;align-items:center}.typo-filter-form.svelte-9ect24 .typo-filter-form-inputs .typo-filter-form-row input[type=text].svelte-9ect24{width:auto;flex-grow:1}.typo-filter-form.svelte-9ect24 .typo-filter-form-inputs .typo-filter-form-row input[type=number].svelte-9ect24{width:5rem}.typo-filter-search.svelte-1apd7dj.svelte-1apd7dj.svelte-1apd7dj{display:flex;flex-direction:column;gap:2rem;max-width:min(50vw,100%)}.typo-filter-search.svelte-1apd7dj .typo-filter-search-list.svelte-1apd7dj.svelte-1apd7dj{display:flex;flex-direction:row;flex-wrap:wrap;gap:1rem;justify-content:center}.typo-filter-search.svelte-1apd7dj .typo-filter-search-list .typo-filter-search-list-item.svelte-1apd7dj.svelte-1apd7dj{display:flex;flex-direction:column;gap:.5rem;background-color:var(--COLOR_PANEL_HI);border-radius:3px;padding:.5rem}.typo-filter-search.svelte-1apd7dj .typo-filter-search-list .typo-filter-search-list-item.lobby.svelte-1apd7dj.svelte-1apd7dj{cursor:pointer}.typo-filter-search.svelte-1apd7dj .typo-filter-search-list .typo-filter-search-list-item.svelte-1apd7dj>b.svelte-1apd7dj{flex-grow:1;text-align:center}.typo-filter-search.svelte-1apd7dj .typo-filter-search-list .typo-filter-search-list-item .typo-filter-search-list-item-description.svelte-1apd7dj.svelte-1apd7dj{white-space:preserve}.typo-ping-suggestion-popover.svelte-1m0uu0k.svelte-1m0uu0k{display:flex;flex-direction:column}.typo-ping-suggestion-popover.svelte-1m0uu0k button.svelte-1m0uu0k{background-color:transparent;border-radius:3px}.typo-ping-suggestion-popover.svelte-1m0uu0k button.selected.svelte-1m0uu0k{background-color:#fff3}.viplist-mgr.svelte-a9egna.svelte-a9egna.svelte-a9egna{max-width:500px;background-color:var(--COLOR_PANEL_HI);border-radius:3px;padding:10px}.viplist-list.svelte-a9egna.svelte-a9egna.svelte-a9egna{background-color:#fff4;border-radius:5px;padding:8px 16px 8px 8px;margin:8px 0}.viplist-person.svelte-a9egna.svelte-a9egna.svelte-a9egna{display:flex;flex-direction:row;gap:5px;align-items:center;margin-bottom:3px}.viplist-person.svelte-a9egna>div.svelte-a9egna.svelte-a9egna{flex-grow:1}.viplist-person.svelte-a9egna>div.svelte-a9egna.svelte-a9egna:not(:first-child){max-width:70px}.viplist-add.svelte-a9egna.svelte-a9egna.svelte-a9egna{display:flex;flex-direction:column;margin-top:2px}.viplist-add.svelte-a9egna>div.svelte-a9egna.svelte-a9egna{display:flex;flex-direction:row;gap:3px;margin-bottom:5px}.viplist-add.svelte-a9egna>div.svelte-a9egna>input.svelte-a9egna{width:0}.viplist-add.svelte-a9egna>div.svelte-a9egna>input.svelte-a9egna:first-child{flex-grow:1}.viplist-add.svelte-a9egna>div.svelte-a9egna>input.svelte-a9egna:last-child{width:100px}b.svelte-a9egna.svelte-a9egna.svelte-a9egna{font-size:1.1em}#game-players .player .player-icons .typo-awards-icon.svelte-19i0k4m{height:20px;width:20px;align-self:flex-end}@keyframes svelte-aldc0m-award-presentation{0%{opacity:0;background-size:100%}25%{opacity:1;background-size:30px}50%{opacity:1;background-size:48px}to{opacity:0;background-size:48px}}.typo-awards-icon.svelte-aldc0m{position:absolute;top:60px;right:4px}.typo-awards-presentation.svelte-aldc0m{position:absolute;top:0;right:0;bottom:0;left:0;background-position:center;background-repeat:no-repeat;pointer-events:none;animation:svelte-aldc0m-award-presentation 3s ease-out forwards}.typo-award-picker.svelte-9q5vog.svelte-9q5vog{display:flex;flex-direction:column;height:100%;width:100%;align-items:center;gap:2rem;margin-bottom:2rem;overflow:auto}.typo-award-picker.svelte-9q5vog .typo-award-picker-list.svelte-9q5vog{flex-grow:1;width:100%;overflow:auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(6rem,1fr));gap:1rem;padding:0 2rem}.typo-award-picker.svelte-9q5vog .typo-award-picker-list .typo-award-picker-award.svelte-9q5vog{background-color:var(--COLOR_PANEL_BG);border-radius:5px;display:flex;flex-direction:column;gap:.1rem;padding:.1rem;align-items:center;cursor:pointer;transition:transform .1s}.typo-award-picker.svelte-9q5vog .typo-award-picker-list .typo-award-picker-award.svelte-9q5vog:hover{transform:scale(.9)}.typo-award-picker.svelte-9q5vog .typo-award-picker-list .typo-award-picker-award .typo-award-picker-award-thumb.svelte-9q5vog{width:4rem;aspect-ratio:1;background-size:cover}.typo-award-picker.svelte-9q5vog .typo-award-picker-list .typo-award-picker-award span.svelte-9q5vog{font-size:.9rem;opacity:.9;text-align:center}.typo-player-scene.svelte-eg9tl1{position:absolute;top:0;right:0;bottom:0;left:0;background-repeat:no-repeat;background-size:cover;background-position:center;z-index:-1}.sprite-slot.svelte-1uuttlm{position:absolute;left:-33%;top:-33%;width:166%;height:166%;background-repeat:no-repeat;background-size:contain}.typo-toolbar-challenges-list.svelte-wy9tne.svelte-wy9tne{display:flex;flex-direction:column;width:100%;align-items:stretch;gap:1rem}.typo-toolbar-challenges-list.svelte-wy9tne .challenge.svelte-wy9tne{display:flex;flex-direction:column}.typo-toolbar-challenges-list.svelte-wy9tne .challenge span.svelte-wy9tne{padding-left:2rem}.typo-toolbar-imagelab-actions.svelte-1tv05w9.svelte-1tv05w9{display:flex;flex-direction:column;width:100%;align-items:stretch;gap:.7rem}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .lockedHint.svelte-1tv05w9{display:flex;gap:1rem;align-items:center;margin-bottom:1rem;width:100%}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .lockedHint span.svelte-1tv05w9{flex-grow:1;-webkit-user-select:none;user-select:none;font-weight:600;opacity:.8}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .saved-commands.svelte-1tv05w9{display:flex;gap:1rem;align-items:center}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .saved-commands.locked.svelte-1tv05w9>:last-child{pointer-events:none;opacity:.5}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .saved-commands.svelte-1tv05w9>:last-child{flex-grow:1}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .saved-commands .remove.svelte-1tv05w9{filter:grayscale(.7);transition:filter 60ms}.typo-toolbar-imagelab-actions.svelte-1tv05w9 .saved-commands .remove.svelte-1tv05w9:hover{filter:grayscale(0)}.typo-imagelab-position-picker.svelte-zwzp7f{display:flex;flex-direction:column;gap:.5rem}.typo-image-post.svelte-f411i0.svelte-f411i0{display:flex;flex-direction:column;width:100%;align-items:stretch;gap:1em}.typo-image-post.svelte-f411i0 img.svelte-f411i0{border-radius:3px}.typo-image-post.svelte-f411i0 .navigate-image.svelte-f411i0{display:flex;justify-content:space-between;align-items:center}.typo-image-post.svelte-f411i0 .not-logged-in.svelte-f411i0,.typo-image-post.svelte-f411i0 .typo-post-info.svelte-f411i0{font-weight:600;opacity:.7}.typo-toolbar-save-actions.svelte-1xyzs78{display:flex;flex-direction:column;width:100%;align-items:stretch;gap:1em}.lobby-navigation.svelte-yw7ztm.svelte-yw7ztm{gap:1rem;display:flex;position:absolute;width:fit-content;right:50px;padding-right:1rem;height:100%;align-items:center}.lobby-navigation.svelte-yw7ztm .lobby-exit.svelte-yw7ztm,.lobby-navigation.svelte-yw7ztm .lobby-next.svelte-yw7ztm{content:var(--file-img-arrow-small-gif);cursor:pointer;height:42px;aspect-ratio:1;transition:scale .1s ease-in-out}.lobby-navigation.svelte-yw7ztm .lobby-exit.svelte-yw7ztm:hover,.lobby-navigation.svelte-yw7ztm .lobby-next.svelte-yw7ztm:hover{scale:1.1}.lobby-navigation.svelte-yw7ztm .lobby-exit.svelte-yw7ztm{filter:drop-shadow(rgba(0,0,0,.3) 3px 3px 0px) sepia(1) saturate(5) brightness(.8) hue-rotate(324deg)}.lobby-navigation.svelte-yw7ztm .lobby-next.svelte-yw7ztm{transform:rotateY(180deg);filter:drop-shadow(rgba(0,0,0,.3) -3px 3px 0px) sepia(1) saturate(5) brightness(.7) hue-rotate(56deg)}h2,h3{margin-top:0}:root{--COLOR_BUTTON_DANGER_BG: hsl(44, 81%, 51%);--COLOR_BUTTON_SUBMIT_BG: hsl(110, 75%, 55%);--COLOR_BUTTON_NORMAL_BG: hsl(208, 80%, 54%);--COLOR_BUTTON_DANGER_TEXT: hsl(0, 0%, 100%);--COLOR_BUTTON_SUBMIT_TEXT: hsl(0, 0%, 100%);--COLOR_BUTTON_NORMAL_TEXT: hsl(0, 0%, 100%)}.color-scrollbar::-webkit-scrollbar,.color-scrollbar ::-webkit-scrollbar{width:14px;border-radius:7px;background-color:var(--COLOR_PANEL_LO)}.color-scrollbar::-webkit-scrollbar-thumb,.color-scrollbar ::-webkit-scrollbar-thumb{border-radius:7px;background-color:var(--COLOR_PANEL_HI)}input.typo[type=text]{border-radius:.5rem;font-weight:600;padding:.5rem}img{display:block}.tool[data-tooltip="No Tool"]{display:none}#game-players{z-index:1}html:not([data-typo_loading_screen_disabled=true]) body>*{opacity:0;transition:opacity .2s;transition-delay:.1s}html:not([data-typo_loading_screen_disabled=true]) body[data-typo_loaded=true]>*{opacity:1}html:not([data-typo_loading_screen_disabled=true]) body:after{display:grid;place-content:center;content:"";position:fixed;top:0;left:0;width:100vw;height:100vh;opacity:1;transition:opacity .2s;background-image:var(--file-img-wand-gif);background-size:10rem;background-repeat:no-repeat;background-position:center;pointer-events:none}html:not([data-typo_loading_screen_disabled=true]) body[data-typo_loaded=true]:after{opacity:0} ');

(function () {
  'use strict';

  var $S=Object.defineProperty;var YS=r=>{throw TypeError(r)};var XE=(r,e,t)=>e in r?$S(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e)=>$S(r,"name",{value:e,configurable:!0});var f=(r,e,t)=>XE(r,typeof e!="symbol"?e+"":e,t),qE=(r,e,t)=>e.has(r)||YS("Cannot "+t);var zS=(r,e,t)=>e.has(r)?YS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);var Fu=(r,e,t)=>(qE(r,e,"access private method"),t);const od=new WeakMap;function KE(r,e,t,n){return r.reverse().forEach(i=>{n=i(e,t,n)||n;}),n}c(KE,"decorateProperty");function eM(r,e){return r.reverse().forEach(t=>{const n=t(e);n&&(e=n);}),e}c(eM,"decorateConstructor");function tM(r,e,t,n){if(!Array.isArray(r)||r.length===0)throw new TypeError;if(t!==void 0)return KE(r,e,t,n);if(typeof e=="function")return eM(r,e)}c(tM,"decorate");function xT(r,e){return od.get(r)&&od.get(r).get(e)}c(xT,"getMetadataMap");function sd(r,e,t){if(e===void 0)throw new TypeError;const n=xT(e,t);return n&&n.get(r)}c(sd,"ordinaryGetOwnMetadata");function nM(r,e){const t=od.get(r)||new Map;od.set(r,t);const n=t.get(e)||new Map;return t.set(e,n),n}c(nM,"createMetadataMap");function ZT(r,e,t,n){if(n&&!["string","symbol"].includes(typeof n))throw new TypeError;(xT(t,n)||nM(t,n)).set(r,e);}c(ZT,"ordinaryDefineOwnMetadata");function Fg(r,e,t){return sd(r,e,t)?sd(r,e,t):Object.getPrototypeOf(e)?Fg(r,Object.getPrototypeOf(e),t):void 0}c(Fg,"ordinaryGetMetadata");function iM(r,e){return c(function(n,i){ZT(r,e,n,i);},"decorator")}c(iM,"metadata");function rM(r,e,t){return Fg(r,e,t)}c(rM,"getMetadata");function oM(r,e,t){return sd(r,e,t)}c(oM,"getOwnMetadata");function sM(r,e,t){return !!sd(r,e,t)}c(sM,"hasOwnMetadata");function aM(r,e,t){return !!Fg(r,e,t)}c(aM,"hasMetadata");function lM(r,e,t,n){ZT(r,e,t,n);}c(lM,"defineMetadata");const cM={decorate:tM,defineMetadata:lM,getMetadata:rM,getOwnMetadata:oM,hasMetadata:aM,hasOwnMetadata:sM,metadata:iM};Object.assign(Reflect,cM);const Lb=class Lb{constructor(e,t,n,i,o){f(this,"_db");this._profileListStore=t,this._currentProfileStore=n,this._settingsStore=i,this._tokenStore=o,this._db=this.init(e);}async init(e){return await(await e).get(this._currentProfileStore,"current_profile")===void 0&&await(await e).put(this._currentProfileStore,"Default","current_profile"),(await(await e).getAllKeys(this._profileListStore)).length===0&&await(await e).put(this._profileListStore,{},"Default"),e}async getProfiles(){return (await(await this._db).getAllKeys(this._profileListStore)).map(e=>e.toString())}async getCurrentProfile(){return await(await this._db).get(this._currentProfileStore,"current_profile")}async createAndActivateProfile(e){const t=await this.getCurrentProfile(),n=await this.exportCurrentProfile();await this.setSavedProfile(t,n),await(await this._db).put(this._currentProfileStore,e,"current_profile"),await this.setSavedProfile(e,{token:null,settings:[]}),await this.loadProfile({token:null,settings:[]});}async switchToProfile(e){const t=await this.getCurrentProfile(),n=await this.exportCurrentProfile();await this.setSavedProfile(t,n),await this.loadProfile(await this.getSavedProfile(e)),await(await this._db).put(this._currentProfileStore,e,"current_profile");}async deleteProfile(e){if(await this.getCurrentProfile()===e)throw new Error("Cannot delete current profile");await(await this._db).delete(this._profileListStore,e);}async getSavedProfile(e){return await(await this._db).get(this._profileListStore,e)??{token:null,settings:{}}}async setSavedProfile(e,t){await(await this._db).put(this._profileListStore,t,e);}async exportCurrentProfile(){const e=await(await this._db).getAllKeys(this._settingsStore),t=new Map;for(const n of e.map(i=>i.toString())){const i=await(await this._db).get(this._settingsStore,n);t.set(n,i);}return {token:await(await this._db).get(this._tokenStore,"token"),settings:Array.from(t.entries())}}async loadProfile(e){await(await this._db).clear(this._settingsStore),await(await this._db).put(this._tokenStore,e.token,"token");for(const[t,n]of e.settings)await(await this._db).put(this._settingsStore,n,t);}};c(Lb,"TypoProfileStore");let Cf=Lb;const If=c((r,e)=>e.some(t=>r instanceof t),"instanceOfAny");let US,BS;function uM(){return US||(US=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}c(uM,"getIdbProxyableTypes");function dM(){return BS||(BS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}c(dM,"getCursorAdvanceMethods");const Tf=new WeakMap,hf=new WeakMap,fh=new WeakMap;function hM(r){const e=new Promise((t,n)=>{const i=c(()=>{r.removeEventListener("success",o),r.removeEventListener("error",s);},"unlisten"),o=c(()=>{t(qr(r.result)),i();},"success"),s=c(()=>{n(r.error),i();},"error");r.addEventListener("success",o),r.addEventListener("error",s);});return fh.set(e,r),e}c(hM,"promisifyRequest");function fM(r){if(Tf.has(r))return;const e=new Promise((t,n)=>{const i=c(()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s);},"unlisten"),o=c(()=>{t(),i();},"complete"),s=c(()=>{n(r.error||new DOMException("AbortError","AbortError")),i();},"error");r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s);});Tf.set(r,e);}c(fM,"cacheDonePromiseForTransaction");let Df={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Tf.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qr(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function VT(r){Df=r(Df);}c(VT,"replaceTraps");function pM(r){return dM().includes(r)?function(...e){return r.apply(Ef(this),e),qr(this.request)}:function(...e){return qr(r.apply(Ef(this),e))}}c(pM,"wrapFunction");function mM(r){return typeof r=="function"?pM(r):(r instanceof IDBTransaction&&fM(r),If(r,uM())?new Proxy(r,Df):r)}c(mM,"transformCachableValue");function qr(r){if(r instanceof IDBRequest)return hM(r);if(hf.has(r))return hf.get(r);const e=mM(r);return e!==r&&(hf.set(r,e),fh.set(e,r)),e}c(qr,"wrap");const Ef=c(r=>fh.get(r),"unwrap");function gM(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=qr(s);return n&&s.addEventListener("upgradeneeded",l=>{n(qr(s.result),l.oldVersion,l.newVersion,qr(s.transaction),l);}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u));}).catch(()=>{}),a}c(gM,"openDB");const bM=["get","getKey","getAll","getAllKeys","count"],vM=["put","add","delete","clear"],ff=new Map;function xS(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(ff.get(e))return ff.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=vM.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||bM.includes(t)))return;const o=c(async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&l.done]))[0]},"method");return ff.set(e,o),o}c(xS,"getMethod");VT(r=>({...r,get:c((e,t,n)=>xS(e,t)||r.get(e,t,n),"get"),has:c((e,t)=>!!xS(e,t)||r.has(e,t),"has")}));const _M=["continue","continuePrimaryKey","advance"],ZS={},Mf=new WeakMap,JT=new WeakMap,yM={get(r,e){if(!_M.includes(e))return r[e];let t=ZS[e];return t||(t=ZS[e]=function(...n){Mf.set(this,JT.get(this)[e](...n));}),t}};async function*wM(...r){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...r)),!e)return;e=e;const t=new Proxy(e,yM);for(JT.set(t,e),fh.set(t,Ef(e));e;)yield t,e=await(Mf.get(t)||e.continue()),Mf.delete(t);}c(wM,"iterate");function VS(r,e){return e===Symbol.asyncIterator&&If(r,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&If(r,[IDBIndex,IDBObjectStore])}c(VS,"isIteratorProp");VT(r=>({...r,get(e,t,n){return VS(e,t)?wM:r.get(e,t,n)},has(e,t){return VS(e,t)||r.has(e,t)}}));const SM={version:"28.0.3",versionName:"28.0.3 stable-usc",runtime:"userscript"},AM=`((h, c, d, O) => {
  let P = 28,
    Y = 57,
    z = 51,
    a = [P, Y, z],
    B = 0,
    U = 1,
    H = 2,
    _ = 5,
    G = 0,
    K = 1,
    F = 2,
    V = 3,
    j = 4,
    Z = 5,
    X = 6,
    J = 7,
    Q = 1,
    ee = 2,
    te = {
      LANG: 0,
      SLOTS: 1,
      DRAWTIME: 2,
      ROUNDS: 3,
      WORDCOUNT: 4,
      HINTCOUNT: 5,
      WORDMODE: 6,
      CUSTOMWORDSONLY: 7
    },
    ne = {
      NORMAL: 0,
      HIDDEN: 1,
      COMBINATION: 2
    }
// TYPOMOD 
    // desc: create re-useable functions
    , typo = {
      /* mod sequence injection for custom draw commands */
      msi: {

        reset: () => {
          typo.msi.mod.selected = undefined;
          typo.msi.mod.buffer = undefined;
          typo.msi.mod.apply = undefined
        },

        /* incoming draw commands are part of an injected mod */
        mod: {
          selected: undefined, /* index of selected mod */
          buffer: undefined, /* buffer to construct mod */
          apply: undefined /* function to apply constructed mod */
        },

        modes: [

          /* custom color mode */
          (buffer) => {
            return (command) => {

              /* skip if buffer empty */
              if(buffer.length === 0) return command;

              /* if brush or fill */
              if(command[0] <= 1) {
                command[1] = buffer[0];
              }

              return command;
            }
          }
        ],

        fromSenaryDoubleDecimalBase: (senary, decimal1, decimal0) => {
          return decimal0 + decimal1 * 10 + Number.parseInt(senary.toString(), 6) * 100;
        },

        fromOctalDoubleDecimalBase: (octal, decimal1, decimal0) => {
          return decimal0 + decimal1 * 10 + Number.parseInt(octal.toString(), 8) * 100;
        },

        /* bases of data: width x height x width x height -> odd sdd odd sdd */
        parseInjectedSequence: (odd1, sdd1, odd0, sdd0) => {
          const parseDigits = (num) => {
            const str = num.toString().padStart(3, '0');
            return [str[0], str[1], str[2]].map(Number);
          };

          const [sdd0_s, sdd0_d1, sdd0_d0] = parseDigits(sdd0);
          const [odd0_o, odd0_d1, odd0_d0] = parseDigits(odd0);
          const [sdd1_s, sdd1_d1, sdd1_d0] = parseDigits(sdd1);
          const [odd1_o, odd1_d1, odd1_d0] = parseDigits(odd1);

          return typo.msi.fromSenaryDoubleDecimalBase(sdd0_s, sdd0_d1, sdd0_d0)
            + 600 * typo.msi.fromOctalDoubleDecimalBase(odd0_o, odd0_d1, odd0_d0)
            + 600 * 800 * typo.msi.fromSenaryDoubleDecimalBase(sdd1_s, sdd1_d1, sdd1_d0)
            + 600 * 800 * 600 * typo.msi.fromOctalDoubleDecimalBase(odd1_o, odd1_d1, odd1_d0);
        },

        toSenaryDoubleDecimalBase: (number) => {
          const senary = Math.floor(number / 100);
          const decimal1 = Math.floor((number % 100) / 10);
          const decimal0 = number % 10;
          return [senary, decimal1, decimal0];
        },

        toOctalDoubleDecimalBase: (number) => {
          const octal = Math.floor(number / 100);
          const decimal1 = Math.floor((number % 100) / 10);
          const decimal0 = number % 10;
          return [octal, decimal1, decimal0];
        },

        toInjectedSequence: (number) => {
          const odd1 = Math.floor(number / (600 * 800 * 600));
          const sdd1 = Math.floor((number % (600 * 800 * 600)) / (600 * 800));
          const odd0 = Math.floor((number % (600 * 800)) / 600);
          const sdd0 = number % 600;

          const sdd0Array = typo.msi.toSenaryDoubleDecimalBase(sdd0);
          const odd0Array = typo.msi.toOctalDoubleDecimalBase(odd0);
          const sdd1Array = typo.msi.toSenaryDoubleDecimalBase(sdd1);
          const odd1Array = typo.msi.toOctalDoubleDecimalBase(odd1);

          return [
            odd1Array[0] * 100 + odd1Array[1] * 10 + odd1Array[2],
            sdd1Array[0] * 100 + sdd1Array[1] * 10 + sdd1Array[2],
            odd0Array[0] * 100 + odd0Array[1] * 10 + odd0Array[2],
            sdd0Array[0] * 100 + sdd0Array[1] * 10 + sdd0Array[2]
          ];
        },

        /* if tool = 0 (brush), color 0, size 4, and all coords 0 -> MSI init/finish signal */
        isMSIInitSignal: (command) => {
          return (command[0] === 0 && command[1] === 0 && command[2] === 5 && command[3] === 0 && command[4] === 0 && command[5] === 0 && command[6] === 0);
        },

        /* if tool = 0 (brush), color 0, size 40 and all coords 0 -> MSI reset signal */
        isResetSignal: (command) => {
          return (command[0] === 0 && command[1] === 0 && command[2] === 39 && command[3] === 0 && command[4] === 0 && command[5] === 0 && command[6] === 0);
        },

        processIncomingCommand: (command) => {
          const msiInitSignal = typo.msi.isMSIInitSignal(command);
          const resetSignal = typo.msi.isResetSignal(command);
          const processingMode = typo.msi.mod.selected === undefined && Array.isArray(typo.msi.mod.buffer);
          const processingBuffer = typo.msi.mod.selected !== undefined && typo.msi.mod.apply === undefined && Array.isArray(typo.msi.mod.buffer);
          const mod = typo.msi.mod.apply;

          if(resetSignal){
            /*console.log("MSI reset signal received.");*/
            typo.msi.mod.selected = undefined;
            typo.msi.mod.buffer = undefined;
            typo.msi.mod.apply = undefined;
            return undefined;
          }

          if(msiInitSignal && !processingBuffer) {
            /*console.log("MSI init signal received.");*/
            typo.msi.mod.selected = undefined;
            typo.msi.mod.buffer = [];
            typo.msi.mod.apply = undefined;
            return undefined;
          }

          if(msiInitSignal && processingBuffer) {
            /*console.log("MSI finish signal received.");*/
            typo.msi.mod.apply = typo.msi.mod.selected(typo.msi.mod.buffer);
            return undefined;
          }

          if(processingMode){
            const mode = typo.msi.parseInjectedSequence(command[3], command[4], command[5], command[6]);
            /*console.log("MSI mode selection received.", mode);*/
            typo.msi.mod.selected = (typo.msi.modes[mode - 1] ?? (() => c => c));
            return undefined;
          }

          if(processingBuffer){
            const packet = typo.msi.parseInjectedSequence(command[3], command[4], command[5], command[6]);
            /*console.log("MSI buffer processing.", packet);*/
            typo.msi.mod.buffer.push(packet);
            return undefined;
          }

          if(mod){
            /*console.log("MSI mod applying.");*/
            return typo.msi.mod.apply(command);
          }

          return command;
        }
      },

      msiColorSwitch: {
        currentCode: undefined,
        closeColors: {},
        getClosestSkribblColor: code => {
          const existing = typo.msiColorSwitch.closeColors[code];
          if(existing !== undefined) return existing;

          const rgb = typo.typoCodeToRgb(code);
          const lab = typo.rgbToLab(rgb);
          const distance = (c1, c2) =>
            Math.sqrt(
              Math.pow(c1[0] - c2[0], 2) +
              Math.pow(c1[1] - c2[1], 2) +
              Math.pow(c1[2] - c2[2], 2)
            );

          const colors = kt.map(c => typo.rgbToLab(c));
          const color = colors.reduce((closestIndex, color, index) =>
              distance(lab, color) < distance(lab, colors[closestIndex]) ? index : closestIndex
            , 0);
          typo.msiColorSwitch.closeColors[code] = color;
          return color;
        },
        ensureColorSequence: command => {
          const color = command[1];

          /* sanitize color to black for non-typo users */
          if(color >= 10000){
            command[1] = typo.msiColorSwitch.getClosestSkribblColor(color);
          }

          /* if color is typo color and not already initiated */
          if(color >= 10000 && color !== typo.msiColorSwitch.currentCode){
            typo.msiColorSwitch.currentCode = color;
            const codeData = typo.msi.toInjectedSequence(color);
            const sequence = [
              [0, 0, 5, 0,0,0,0],
              [0, 0, 5, 0,0,0,1],
              [0, 0, 5, ...codeData],
              [0, 0, 5, 0,0,0,0]
            ];
            return sequence;
          }

          /* if color is original but typo color initiated */
          if(color < 10000 && typo.msiColorSwitch.currentCode !== undefined){
            typo.msiColorSwitch.currentCode = undefined;
            return [[0, 0, 39, 0,0,0,0]];
          }

          return undefined;
        },
        insertColorSwitches: (commands) => {
          inserted = [];
          for (let i = 0; i < commands.length; i++) {
            const command = commands[i];
            const t = typo.msiColorSwitch.ensureColorSequence(command);
            if(t !== undefined) inserted.push(...t);
            inserted.push(command);
          }

          commands.splice(0, commands.length, ...inserted);
        }
      },
      messagePort: (()=>{
        const channel = new MessageChannel();
        window.postMessage("skribblMessagePort", "*", [channel.port2]);
        return channel.port1;
      })(),
      emitPort: (()=>{
        const channel = new MessageChannel();
        window.postMessage("skribblEmitPort", "*", [channel.port2]);
        return channel.port1;
      })(),
      joinLobby: undefined,
      createFakeUser: (id = 0, name = "", avatar = [], score = 0, guessed = false) => {
        // IDENTIFY x.value.split: #home .container-name-lang input -> Kn
        // IDENTIFY x.avatar: [Math.round(100 * Math.random()) % -> l
        return {
          id: id,
          name: name.length != 0 ? name : (Kn.value.split("#")[0] != "" ? Kn.value.split("#")[0] : "Player"),
          avatar: avatar.length == 0 ? l.avatar : avatar,
          score: score,
          guessed: guessed
        };
      },
      createFakeLobbyData: (
        settings = ["PRACTISE", "en", 1, 1, 80, 3, 3, 2, 0, false],
        id = null,
        me = 0,
        owner = 0,
        users = [],
        state = { id: 4, type: 0, time: 0, data: { id: 0, word: "Anything" } }) => {
        if (users.length == 0) users = [typo.createFakeUser()];
        return {
          settings: settings,
          id: id,
          me: me,
          owner: owner,
          round: 0,
          users: users,
          state: state
        };
      },
      disconnect: undefined,
      skipCursorUpdate: false,
      lockManualClear: false,
      lastConnect: 0,
      initListeners: (() => {
        let abort = false;
        document.addEventListener("lockManualClear", (event) => typo.lockManualClear = event.detail === true);
        document.addEventListener("selectSkribblTool", (event) => Tt(event.detail));
        document.addEventListener("selectSkribblSize", (event) => At(event.detail));
        document.addEventListener("clearDrawing", () => Ft());
        document.addEventListener("abortJoin", () => abort = true);
        document.addEventListener("disableCursorUpdates", e => {
          typo.skipCursorUpdate = e.detail === true;
          if(e.detail === false) yt(); // update cursor when updates reenabled
        });
        document.addEventListener("joinLobby", (e) => {
          abort = false;
          let timeoutdiff = Date.now() - (typo.lastConnect == 0 ? Date.now() : typo.lastConnect);
          // Xn(true);
          setTimeout(() => {
            if (abort) return;
            typo.lastConnect = Date.now();
            // Vn.dispatchEvent(new Event("click"));
            // IDENTIFY x.dispatchEvent: querySelector("#home .panel .button-play") -> BTNPLAY
            // ##PRIVATELBBY## = !1
            // IDENTIFY: x:  = !1
            window.history.pushState({path: window.location.origin + '?' + (e.detail ?? "")}, '', window.location.origin + '?' + (e.detail ?? ""));
            // ##JOINLOBBY##(e.detail?.join ? e.detail.join : "");
            // IDENTIFY x(e.det..): ? "id=" + -> JOINLOBBY
            typo.joinLobby();
            window.history.pushState({path: window.location.origin}, '', window.location.origin);
            // Jn(false);
            // IDENTIFY x(false): querySelector("#load").style.display -> LOADING
            document.dispatchEvent(new Event("joinedLobby"));
          }, timeoutdiff < 2000 ? 2000 - timeoutdiff : 0);
        });
        document.addEventListener("leaveLobby", () => {
          if (typo.disconnect) typo.disconnect();
          else ua() | document.dispatchEvent(new Event("leftLobby"));
          // IDENTIFY x(): querySelector("#home").style.display = "" -> GOHOME
        });
        document.addEventListener("setColor", (e) => {
          let rgb = e.detail.code < 10000 ? kt[e.detail.code] : typo.typoCodeToRgb(e.detail.code);
          let match = kt.findIndex(color => color[0] == rgb[0] && color[1] == rgb[1] && color[2] == rgb[2]);
          // IDENTIFY [0, 59, 120], -> COLORS
          let code = match >= 0 ? match : e.detail.code;
          if (e.detail.secondary) Wt(code);
          // IDENTIFY x(e.detail.code): querySelector("#color-preview-secondary").style.fill -> SECFILL
          else Nt(code);
          // IDENTIFY x(e.detail.code): querySelector("#color-preview-primary").style.fill -> PRIMFILL
        });
        document.addEventListener("performDrawCommand", (e) => {
          v.push(e.detail);
          pt.push(v.length);
          // IDENTIFY x.push(e.detail): .getContext("2d"), x = [] -> PUSHCMD
          Gt(jt(e.detail));
          // IDENTIFY: x(y(e.detail)): bounds: AND Math.floor(Math.ceil -> PERFOUTER, PERFINNER
        });
        document.addEventListener("collapseUndoActions", (e) => {
          const shrinkCount = e.detail;
          const firstCollapsedIndex = pt.length - shrinkCount + 1;
          const collapsed = pt.slice(0, firstCollapsedIndex);
          const lastCollapsedIndex = collapsed.length === 0 ? 0 : collapsed.length - 1
          collapsed[lastCollapsedIndex] = pt[pt.length - 1];
          pt = collapsed;
        });
      })(),
      rgbToXyz: (R, G, B) => {
        let r = R / 255;
        let g = G / 255;
        let b = B / 255;

        r = (r > 0.04045) ? Math.pow((r + 0.055) / 1.055, 2.4) : (r / 12.92);
        g = (g > 0.04045) ? Math.pow((g + 0.055) / 1.055, 2.4) : (g / 12.92);
        b = (b > 0.04045) ? Math.pow((b + 0.055) / 1.055, 2.4) : (b / 12.92);

        let x = r * 0.4124 + g * 0.3576 + b * 0.1805;
        let y = r * 0.2126 + g * 0.7152 + b * 0.0722;
        let z = r * 0.0193 + g * 0.1192 + b * 0.9505;

        return [x, y, z];
      },
      xyzToLab: (x, y, z) => {
        const REF_X = 0.95047;
        const REF_Y = 1.00000;
        const REF_Z = 1.08883;

        let fx = f(x / REF_X);
        let fy = f(y / REF_Y);
        let fz = f(z / REF_Z);

        let L = 116 * fy - 16;
        let a = 500 * (fx - fy);
        let b = 200 * (fy - fz);

        return [L, a, b];

        function f(value) {
          return (value > 0.008856)
            ? Math.pow(value, 1 / 3)
            : (7.787 * value) + (16 / 116);
        }
      },
      rgbToLab: ([R, G, B]) => {
        const [x, y, z] = typo.rgbToXyz(R, G, B);
        return typo.xyzToLab(x, y, z);
      },
      hexToRgb: (hex) => {
        let arrBuff = new ArrayBuffer(4);
        let vw = new DataView(arrBuff);
        vw.setUint32(0, parseInt(hex, 16), false);
        let arrByte = new Uint8Array(arrBuff);
        return [arrByte[1], arrByte[2], arrByte[3]];
      },
      rgbToHex: (r, g, b) => {
        return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
      },
      typoCodeToRgb: (code) => {
        let sanitizedCode = Number(code);

        if (!Number.isFinite(sanitizedCode)) {
          sanitizedCode = 10000;
        }

        sanitizedCode = Math.trunc(sanitizedCode);

        const decimal = sanitizedCode - 10000;

        return [
          (decimal >> 16) & 255, // Red
          (decimal >> 8) & 255,  // Green
          decimal & 255          // Blue
        ];
      }
    }
  // TYPOEND,
  ae = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
  if (h.localStorageAvailable = !1, void 0 !== d) try {
    d.setItem("feature_test", "yes"), "yes" === d.getItem("feature_test") && (d.removeItem("feature_test"), h.localStorageAvailable = !0)
  } catch (e) {}
  var u = [];

  function oe(e) {
    for (var t = 0; t < u.length; t++)
      if (u[t].name == e) return u[t]
  }

  function re(e, t, n, a, o) {
    var r, i, l = t,
      s = (h.localStorageAvailable && (r = d.getItem("hotkey_" + e)) && (t = r), oe(e));
    return s ? (s.key = t, s.def = l, s.desc = n) : (s = {
      name: e,
      desc: n,
      key: t,
      def: l,
      listing: $("item"),
      changed: [],
      cb: []
    }, u.push(s), Ve(r = $("key", s.name), "text"), s.listing.appendChild(r), (i = c.createElement("input")).value = s.key, s.listing.appendChild(i), D(i, "keydown", function(e) {
      for (var t = e.key, n = 0; n < u.length; n++)
        if (u[n].key == t) return void e.preventDefault();
      i.value = t, s.key = t;
      for (n = 0; n < s.changed.length; n++) s.changed[n](s);
      return ie(), e.preventDefault(), !1
    }), g[p].querySelector("#hotkey-list").appendChild(s.listing)), a && s.cb.push(a), o && s.changed.push(o), s
  }

  function ie() {
    if (h.localStorageAvailable)
      for (var e = 0; e < u.length; e++) h.localStorage.setItem("hotkey_" + u[e].name, u[e].key)
  }
  var l = {
    avatar: [Math.round(100 * Math.random()) % P, Math.round(100 * Math.random()) % Y, Math.round(100 * Math.random()) % z, -1],
    volume: 100,
    dark: 0,
    filterChat: 1,
    pressureSensitivity: 1,
    displayLang: "en",
    undefined,
    mobileChatLayout: "bottom",
    chatBubbles: 0
  };

  function e(e, t) {
    e = d.getItem(e);
    return null == e ? t : e
  }

  function le() {
    h.localStorageAvailable ? (d.setItem("name", Kn.value), d.setItem("lang", Fn.value), d.setItem("displaylang", l.displayLang), d.setItem("volume", l.volume), d.setItem("dark", 1 == l.dark ? 1 : 0), d.setItem("filter", 1 == l.filterChat ? 1 : 0), d.setItem("pressure", 1 == l.pressureSensitivity ? 1 : 0), d.setItem("ava", JSON.stringify(l.avatar)), d.setItem("mobileChatLayout", l.mobileChatLayout), d.setItem("keyboard", Ye.value), d.setItem("keyboardlayout", ze.value), d.setItem("chatBubbles", l.chatBubbles), console.log("Settings saved.")) : console.log("Settings not saved. LocalStorage unavailable.")
  }

  function D(e, t, n) {
    for (var a, o = e, r = ("string" == typeof e ? o = c.querySelectorAll(e) : "[object Array]" !== (a = Object.prototype.toString.call(e)) && "[object NodeList]" !== a && "[object HTMLCollection]" !== a && (o = [e]), t.split(" ")), i = 0; i < o.length; i++)
      for (var l = 0; l < r.length; l++) o[i].addEventListener(r[l], n)
  }

  function $(e, t) {
    var n = c.createElement("div");
    if (void 0 !== e)
      for (var a = e.split(" "), o = 0; o < a.length; o++) n.classList.add(a[o]);
    return void 0 !== t && (n.textContent = t), n
  }

  function se(e, t, n) {
    var a = c.createElement(e);
    if (void 0 !== t)
      for (var o = t.split(" "), r = 0; r < o.length; r++) a.classList.add(o[r]);
    return void 0 !== n && (a.textContent = n), a
  }

  function ce(e) {
    for (; e.firstChild;) e.removeChild(e.firstChild)
  }

  function de(e, t) {
    var n = $("avatar"),
      a = $("color"),
      o = $("eyes"),
      r = $("mouth"),
      i = $("special"),
      l = $("owner");
    return l.style.display = t ? "block" : "none", n.appendChild(a), n.appendChild(o), n.appendChild(r), n.appendChild(i), n.appendChild(l), n.parts = [a, o, r], ue(n, e), n
  }

  function ue(e, t) {
    function n(e, t, n) {
      var a = -t % n * 100,
        t = 100 * -Math.floor(t / n);
      e.style.backgroundPosition = a + "% " + t + "%"
    }
    var a = t[0] % P,
      o = t[1] % Y,
      r = t[2] % z,
      t = t[3],
      a = (n(e.querySelector(".color"), a, 10), n(e.querySelector(".eyes"), o, 10), n(e.querySelector(".mouth"), r, 10), e.querySelector(".special"));
    0 <= t ? (a.style.display = "", n(a, t, 10)) : a.style.display = "none"
  }

  function he(e, t) {
    e.querySelector(".owner").style.display = t ? "block" : "none"
  }

  function pe(e, t) {
    e.className = "avatar";
    for (var n of t) e.classList.add("filter-" + n)
  }

  function me(e, t, n, a) {
    var o = {
      element: $("dots"),
      dots: [],
      selected: 0,
      change: a
    };
    return e.appendChild(o.element), n.push(o.element), D(n, "DOMMouseScroll wheel", function(e) {
      var t;
      1 < o.dots.length && (t = -e.deltaY || e.wheelDeltaY, t = Math.sign(t), fe(o, Math.min(o.dots.length - 1, Math.max(0, o.selected - t)), !0), e.preventDefault(), e.stopPropagation())
    }), ge(o, t), o
  }

  function ge(e, t) {
    ce(e.element), e.dots = [];
    for (var n = 0; n < t; n++) {
      var a = $("dot");
      a.index = n, a.appendChild($("inner")), D(a, "click", function() {
        fe(e, this.index, !0)
      }), e.element.appendChild(a), e.dots.push(a)
    }
    e.selected < 0 && (e.selected = 0), t <= e.selected && (e.selected = t - 1), fe(e, e.selected, !1)
  }

  function fe(e, t, n) {
    if (0 <= t && t < e.dots.length) {
      e.selected = t;
      for (var a = 0; a < e.dots.length; a++) e.dots[a].classList.remove("active");
      e.dots[t].classList.add("active"), e.change(e, t, n)
    }
  }
  let s = 0,
    ye = 1,
    ve = 2,
    be = 3,
    p = 4,
    Se = 5;
  var m = c.querySelector("#modal"),
    ke = m.querySelector(".modal-title .text"),
    we = m.querySelector(".modal-content"),
    g = [];

  function Ce(e) {
    g[s].querySelector(".buttons button.mute").textContent = E(e ? "Unmute" : "Mute")
  }

  function qe(e, t) {
    m.style.display = "block";
    for (var n = 0; n < g.length; n++) g[n].style.display = "none";
    g[e].style.display = "flex";
    var a = g[e];
    switch (e) {
      case ye:
        ke.textContent = E("Something went wrong!"), a.querySelector(".message").textContent = t;
        break;
      case ve:
        ke.textContent = E("Disconnected!"), a.querySelector(".message").textContent = t;
        break;
      case s:
        ke.textContent = t.id == x ? E("$ (You)", t.name) : t.name;
        var o = (W(x).flags & k) == k,
          r = (t.flags & k) == k,
          i = a.querySelector(".buttons"),
          r = (i.style.display = t.id == x || r ? "none" : "flex", i.querySelector(".button-pair").style.display = x == En || o ? "flex" : "none", i.querySelector("button.report").style.display = t.reported ? "none" : "", Ce(t.muted), a.querySelector(".report-menu").style.display = "none", a.querySelector(".invite").style.display = x == t.id ? "flex" : "none", we.querySelector(".player")),
          o = (r.style.display = "", ce(r), de(t.avatar))
        ; /*id in popup*/ r.setAttribute("playerid", t.id);;
        he(o, En == t.id), pe(o, Ya(t)), r.appendChild(o);
        break;
      case Se:
        ke.textContent = E("Rooms"), roomsUpdate(t);
        break;
      case be:
        ke.textContent = E("Invite your friends!");
        break;
      case p:
        ke.textContent = E("Settings"), a.querySelector("#select-pressure-sensitivity").value = l.pressureSensitivity
    }
  }

  function xe() {
    m.style.display = "none"
  }
  g[s] = m.querySelector(".modal-container-player"), g[ye] = m.querySelector(".modal-container-info"), g[ve] = m.querySelector(".modal-container-info"), g[be] = m.querySelector(".modal-container-room"), g[p] = m.querySelector(".modal-container-settings"), D([m.querySelector(".close"), g[ye].querySelector("button.ok")], "click", xe);
  let Me = 0,
    Le = 2,
    De = 3,
    $e = 4,
    Ee = 5,
    Ae = 6,
    Ie = 7,
    Re = ["BASE", "GUESSED", "CLOSE", "DRAWING", "JOIN", "LEAVE", "OWNER", "GUESSCHAT"];

  function f(e) {
    return "var(--COLOR_CHAT_TEXT_" + Re[e] + ")"
  }

  function Te(e, t, n, a) {
    var o = c.createElement("p"),
      r = c.createElement("b"),
      a = (r.textContent = a ? e : e + ": ", o.appendChild(r), o.style.color = n, c.createElement("span"));
    return a.textContent = t, o.appendChild(a), o
  }

  function y(e, t, n, a) {
    var o, r = Te(e, t, n, a),
      i = Gn.scrollHeight - Gn.scrollTop - Gn.clientHeight <= 20;
    if (Gn.appendChild(r), i && (Gn.scrollTop = Gn.scrollHeight + 100), 0 < l.chatDeleteQuota)
      for (; Gn.childElementCount > l.chatDeleteQuota;) Gn.firstElementChild.remove();
    return (0 == l.chatBubbles || 1 == l.chatBubbles && M != x) && (o = Te(e, t, n, a), c.querySelector("#game-canvas .bubbles").appendChild(o), setTimeout(function() {
      o.remove()
    }, 2500)), r
  }
  var i = void 0,
    Ne = void 0;

  function We(e) {
    Oe();
    for (var t = (Ne = e).dataset.tooltip, n = e.dataset.tooltipdir || "N", a = ((i = $("tooltip")).appendChild($("tooltip-arrow")), i.appendChild($("tooltip-content", E(t))), !1), o = e; o;) {
      if ("fixed" == h.getComputedStyle(o).position) {
        a = !0;
        break
      }
      o = o.parentElement
    }
    i.style.position = a ? "fixed" : "absolute";
    var t = e.getBoundingClientRect(),
      e = ("E" == (n = "W" == (n = "S" == (n = "N" == n && t.top - h.scrollY < 48 ? "S" : n) && t.bottom - h.scrollY > c.documentElement.clientHeight - 48 ? "N" : n) && t.left - h.scrollX < 48 ? "E" : n) && t.right - h.scrollX > c.documentElement.clientWidth - 48 && (n = "W"), t.left),
      r = t.top;
    "N" == n && (e = (t.left + t.right) / 2), "S" == n && (e = (t.left + t.right) / 2, r = t.bottom), "E" == n && (e = t.right, r = (t.top + t.bottom) / 2), "W" == n && (r = (t.top + t.bottom) / 2), a || (e += h.scrollX, r += h.scrollY), i.classList.add(n), i.style.left = e + "px", i.style.top = r + "px", c.body.appendChild(i)
  }

  function Oe() {
    i && (i.remove(), Ne = i = void 0)
  }
  let Pe = [{
    code: "en",
    name: "English",
    layout: [
      ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"],
      ["A", "S", "D", "F", "G", "H", "J", "K", "L"],
      ["Z", "X", "C", "V", "B", "N", "M"]
    ]
  }, {
    code: "fr",
    name: "French",
    layout: [
      ["A", "Z", "E", "R", "T", "Y", "U", "I", "O", "P"],
      ["Q", "S", "D", "F", "G", "H", "J", "K", "L", "M"],
      ["W", "X", "C", "V", "B", "N", "", "", "", "", "'"]
    ]
  }, {
    code: "de",
    name: "German",
    layout: [
      ["Q", "W", "E", "R", "T", "Z", "U", "I", "O", "P", ""],
      ["A", "S", "D", "F", "G", "H", "J", "K", "L", "", ""],
      ["Y", "X", "C", "V", "B", "N", "M"]
    ]
  }, {
    code: "tr",
    name: "Turkish",
    layout: [
      ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P", "", ""],
      ["A", "S", "D", "F", "G", "H", "J", "K", "L", "", ""],
      ["Z", "X", "C", "V", "B", "N", "M", "", ""]
    ]
  }, {
    code: "ru",
    name: "Russian",
    layout: [
      ["", "", "", "", "", "", "", "", "", "", "", ""],
      ["", "", "", "", "", "", "", "", "", "", ""],
      ["", "", "", "", "", "", "", "", "", ""]
    ]
  }, {
    code: "es",
    name: "Spanish",
    layout: [
      ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"],
      ["A", "S", "D", "F", "G", "H", "J", "K", "L", ""],
      ["Z", "X", "C", "V", "B", "N", "M"]
    ]
  }];
  var Ye = c.querySelector("#select-mobile-keyboard-enabled"),
    ze = c.querySelector("#select-mobile-keyboard-layout"),
    Be = {
      elements: {
        main: c.querySelector("#game-keyboard"),
        input: c.querySelector("#game-keyboard .input"),
        rows: c.querySelector("#game-keyboard .keys"),
        caps: 0,
        keys: []
      },
      lang: 0,
      form: void 0,
      input: void 0,
      caps: !1,
      keys: [],
      rows: [],
      columns: 0,
      isOpen: !1,
      getKeyLowercase: function(e) {
        return e.toLocaleLowerCase(this.lang)
      },
      getKeyUppercase: function(e) {
        return e.toLocaleUpperCase(this.lang)
      },
      init: function(e) {
        this.lang = e.code, this.caps = !1, this.columns = 0, this.elements.keys = [], this.form = c.querySelector("#game-chat-input-mobile form"), this.input = this.form.querySelector("input"), ce(this.elements.rows);
        var t = e.layout,
          i = this;

        function n(e, t, n) {
          var a, o = se("button", "key"),
            r = "PointerEvent" in h ? "pointerdown" : "click";
          return Ue.has(t) ? (a = Ue.get(t), o.classList.add(a.class), o.appendChild(se("span", "material-icons", a.icon)), D(o, r, function(e) {
            a.callback(i), e.preventDefault()
          })) : (o.textContent = i.getKeyLowercase(t), D(o, r, function(e) {
            i.inputAdd(t), e.preventDefault()
          }), i.elements.keys.push(o)), n ? e.insertBefore(o, e.firstChild) : e.appendChild(o), o
        }
        for (var a = 0; a < t.length; a++) {
          current_row = i.addRow();
          for (var o = 0; o < t[a].length; o++) {
            var r = t[a][o];
            n(current_row, r)
          }
        }
        this.elements.caps = n(current_row, "caps", !0), n(current_row, "backspace"), current_row = i.addRow();
        for (var l = ["-", "space", ".", "enter"], o = 0; o < l.length; o++) n(current_row, l[o])
      },
      addRow: function() {
        var e = $("row");
        return this.elements.rows.appendChild(e), this.rows.push(e), e
      },
      inputChanged: function() {
        this.input.dispatchEvent(new Event("input", {
          bubbles: !0
        }))
      },
      inputAdd: function(e) {
        this.input.value += this.caps ? this.getKeyUppercase(e) : this.getKeyLowercase(e), this.inputChanged(), this.caps && this.toggleCaps()
      },
      enter: function() {
        0 < this.input.value.length && (this.form.requestSubmit(), this.input.value = "", this.inputChanged())
      },
      toggleCaps: function() {
        this.caps = !this.caps;
        for (var e = 0; e < this.elements.keys.length; e++) {
          var t = this.elements.keys[e];
          t.textContent = this.caps ? this.getKeyUppercase(t.textContent) : this.getKeyLowercase(t.textContent)
        }
        this.elements.caps.classList.toggle("enabled", this.caps)
      }
    };
  let Ue = new Map;

  function He() {
    1 == Ye.value ? (_n[1].setAttribute("readonly", ""), c.documentElement.dataset.mobileKeyboard = "") : (_n[1].removeAttribute("readonly"), delete c.documentElement.dataset.mobileKeyboard)
  }
  Ue.set("backspace", {
    class: "wide",
    icon: "backspace",
    callback: function(e) {
      0 < e.input.value.length && (e.input.value = e.input.value.slice(0, -1), e.inputChanged())
    }
  }), Ue.set("caps", {
    class: "wide",
    icon: "keyboard_capslock",
    callback: function(e) {
      e.toggleCaps()
    }
  }), Ue.set("enter", {
    class: "wide",
    icon: "keyboard_return",
    callback: function(e) {
      e.enter()
    }
  }), Ue.set("space", {
    class: "extra-wide",
    icon: "space_bar",
    callback: function(e) {
      e.input.value += " ", e.inputChanged()
    }
  });
  for (var t = 0; t < Pe.length; t++) {
    var _e = se("option");
    _e.textContent = Pe[t].name, _e.value = Pe[t].code, ze.appendChild(_e)
  }
  D(ze, "change", function(e) {
    for (var t = void 0, n = 0; n < Pe.length; n++) Pe[n].code == this.value && (t = Pe[n]);
    null != t && Be.init(t)
  }), D([Ye, ze], "change", function(e) {
    le(), He()
  }), D(Be.elements.main, "gesturestart gesturechange gestureend drag scroll", function(e) {
    return e.preventDefault(), !1
  }), Be.init(Pe[0]);
  var Ge = {},
    Ke = [];

  function Fe(e, t) {
    e = e[t];
    return null != e && "" != e ? e : t
  }

  function E(e, t) {
    var n = Fe(Ge[l.displayLang], e),
      a = "",
      o = 0;
    Array.isArray(t) || (t = [t]);
    for (var r = 0; r < n.length; r++) {
      var i = n.charAt(r);
      "$" == i ? (a += t[o], o++) : a += i
    }
    return a
  }

  function Ve(e, t) {
    if ("children" == t)
      for (var n = 0; n < e.children.length; n++) {
        var a = e.children[n].dataset.translate;
        Ve(e.children[n], null == a ? "text" : a)
      } else {
      var o = "";
      "text" == t && (o = e.textContent), 0 < (o = "placeholder" == t ? e.placeholder : o).length ? Ke.push({
        key: o,
        element: e,
        type: t
      }) : (console.log("Empty key passed to translate with!"), console.log(e))
    }
  }
  Ge.en = {}, Ge.de = {
    "You have been kicked!": "Du wurdest gekickt!",
    "You have been banned!": "Du wurdest gebannt!",
    "You muted '$'!": "Du hast '$' stummgeschalten!",
    "You unmuted '$'!": "Du hast die Stummschaltung fr '$' aufgehoben!",
    "You are on a kick cooldown!": "Du bist noch in der Kick Abklingzeit!",
    "You are banned from this room!": "Du bist von diesem Raum gebannt!",
    "You need at least 2 players to start the game!": "Du brauchst mind. 2 Spieler um das Spiel zu starten!",
    "Server restarting in about $ seconds!": "Server Neustart in ungefhr $ Sekunden!",
    "Spam detected! You're sending messages too quickly.": "Spam erkannt! Du sendest Nachrichten zu schnell.",
    "You can not votekick the lobby owner!": "Du kannst den Raumbesitzer nicht kicken!",
    "The word was '$'": "Das Wort war '$'",
    "$ is drawing now!": "$ zeichnet nun!",
    "$ is now the room owner!": "$ ist nun der Raumeigentmer!",
    "$ is voting to kick $ ($/$)": "$ mchte $ kicken ($/$)!",
    "$ joined the room!": "$ ist dem Raum beigetreten!",
    "$ left the room!": "$ hat den Raum verlassen!",
    "$ has been kicked!": "$ wurde gekickt!",
    "$ has been banned!": "$ wurde gebannt!",
    "$ guessed the word!": "$ hat das Wort erraten!",
    "$ liked the drawing!": "$ mag die Zeichnung!",
    "$ disliked the drawing!": "$ mag die Zeichnung nicht!",
    "$ is close!": "$ ist nah dran!",
    "$ is choosing a word!": "$ whlt ein Wort!",
    "$ won with a score of $!": "$ hat mit einem Punktestand von $ gewonnen!",
    "$ and $ won with a score of $!": "$ und $ haben mit einem Punktestand von $ gewonnen!",
    WAITING: "WARTEN",
    "DRAW THIS": "ZEICHNE",
    "WORD HIDDEN": "WORT VERSTECKT",
    "GUESS THIS": "RATE",
    "$ (You)": "$ (Du)",
    "$ points": "$ Punkte",
    "Room not found!": "Raum nicht gefunden!",
    "Room is full!": "Raum ist voll!",
    "No rooms found!": "Keine Rume gefunden!",
    "An unknown error ('$')": "Unbekannter Fehler ('$')",
    "Something went wrong!": "Etwas ist schief gelaufen!",
    "Disconnected!": "Verbindung getrennt!",
    "Connection lost!": "Verbindung verloren!",
    "Servers are currently undergoing maintenance!": "Server werden derzeit gewartet",
    "Please try again later!": "Bitte versuch es spter noch einmal!",
    "An unknown error occurred ('$')": "Ein unbekannter Fehler ist aufgetreten ('$')",
    Unmute: "Stumm. aufheben",
    Mute: "Stummschalten",
    Rooms: "Rume",
    Settings: "Einstellungen",
    "Not started": "Nicht gestartet",
    Round: "Runde",
    Rounds: "Runden",
    "Round $": "Runde $",
    "Round $ of $": "Runde $ von $",
    "Waiting for players...": "Auf Spieler warten...",
    "Game starting in a few seconds...": "Das Spiel beginnt in wenigen Sekunden...",
    "is the winner!": "hat gewonnen!",
    "are the winners!": "haben gewonnen!",
    "Nobody won!": "Niemand hat gewonnen!",
    "Choose a word": "Whle ein Wort",
    "The word was": "Das Wort war",
    User: "Spieler",
    Play: "Spielen",
    "Create Room": "Raum erstellen",
    "View Rooms": "Rume ansehen",
    "How to play": "Wie gespielt wird",
    About: "ber",
    News: "Neuigkeiten",
    "When it's your turn, choose a word you want to draw!": "Whle ein Wort, das du zeichnen willst, wenn du dran bist!",
    "Try to draw your choosen word! No spelling!": "Versuche nun dein Wort zu zeichnen. Kein Schreiben!",
    "Let other players try to guess your drawn word!": "Lass andere Mitspieler dein gezeichnetes Wort erraten!",
    "When it's not your turn, try to guess what other players are drawing!": "Wenn du nicht dran bist mit Zeichnen, versuche die Zeichnungen anderer zu erraten!",
    "Score the most points and be crowned the winner at the end!": "Sammel die meisten Punkte und werde zum Gewinner!",
    "is a free online multiplayer drawing and guessing pictionary game.": "ist ein kostenloses Mehrspieler-Zeichnen und Raten- / Montagsmaler-Spiel.",
    "A normal game consists of a few rounds, where every round a player has to draw their chosen word and others have to guess it to gain points!": "Ein normales Spiel besteht aus drei Runden, in welcher jeder Spieler sein gewhltes Wort zeichnen muss, whrend die Anderen es fr Punkte erraten mssen!",
    "The person with the most points at the end of the game, will then be crowned as the winner!": "Die Person mit dem hchsten Punktestand am Ende des Spiels wird als Sieger gekrnt!",
    "Have fun!": "Viel Spa!",
    "Invite your friends!": "Lad deine Freunde ein!",
    Copy: "Kopieren",
    "Hover over me to see the Invite link!": "Einladungslink hier anschauen!",
    "Click to copy the link to this room!": "Klicke um den Einladungslink zu kopieren!",
    Visibility: "Sichtbarkeit",
    Name: "Name",
    Players: "Spieler",
    Drawtime: "Zeit",
    Language: "Sprache",
    "Word Mode": "Wort-Modus",
    "Word Count ": "Wort-Anzahl",
    Hints: "Hinweise",
    "Custom words": "Eigene Wrter",
    "Minimum of 10 words. 1-32 characters per word! 10000 characters maximum. Separated by a , (comma)": "Minimum von 10 Wrtern. 1-32 Buchstaben pro Wort. 10000 Buchstaben maximal. Getrennt durch ein , (Komma)",
    "Use custom words only": "Nur eigene Wrter benutzen",
    "Start!": "Starten!",
    All: "Alle",
    Custom: "Benutzerdefiniert",
    Public: "ffentlich",
    Private: "Privat",
    Mode: "Modus",
    Normal: "Normal",
    Hidden: "Versteckt",
    Combination: "Kombination",
    "Please select the reasons for your report": "Bitte whlen Sie die Grnde fr Ihre Meldung",
    "Inappropriate Messages / Drawings": "Unangemessene Nachrichten / Zeichnungen",
    Spam: "Spam",
    "Botting / Cheating": "Botting / Cheating",
    "Your report for '$' has been sent!": "Deine Meldung fr '$' wurde abgesendet!",
    "Enter your name": "Gib dein Namen ein",
    "Filter rooms by name here...": "Suche nach Rume hier...",
    "Type your guess here...": "Rate das gesuchte Wort hier...",
    "Everyone guessed the word!": "Jeder hat das Wort erraten!",
    "The drawer left the game!": "Der Zeichner hat das Spiel verlassen!",
    "Time is up!": "Die Zeit ist abgelaufen!",
    Kick: "Kicken",
    Ban: "Bannen",
    Votekick: "Votekicken",
    Report: "Melden",
    "Randomize your Avatar!": "Zuflliger Avatar!",
    Brush: "Stift",
    Colorpick: "Pipette",
    Fill: "Fllen",
    Undo: "Rckgngig",
    Clear: "Lschen",
    "Mute audio": "Stummschalten",
    "Unmute audio": "Stumm. aufheben",
    "Turn the lights off": "Lichter ausmachen",
    "Turn the lights on": "Lichter anmachen",
    "Hotkeys & Misc.": "Tastenkrzel & Sonstiges",
    Hotkeys: "Tastenkrzel",
    Miscellaneous: "Sonstiges",
    "Display Language": "Anzeigesprache",
    "Filter bad words in chat": "Schlechte Wrter im Chat filtern",
    "Brush Pressure Sensitivity": "Stiftdruckempfindlichkeit",
    Reset: "Zurcksetzen",
    "Reset hotkeys to default": "Tastenkrzel zurcksetzen",
    On: "An",
    Off: "Aus"
  };
  let je = 0,
    Ze = 1,
    Xe = 0,
    Je = 4,
    Qe = 40;
  var et = [4, 10, 20, 32, 40],
    tt = c.querySelector("#game-toolbar"),
    nt = tt.querySelector(".toolbar-group-tools"),
    at = tt.querySelector(".toolbar-group-actions"),
    n = c.querySelector("#game-toolbar .sizes .size-preview"),
    ot = c.querySelector("#game-toolbar .sizes .container"),
    rt = c.querySelector("#game-toolbar .colors");

  function it(e, t) {
    var n, a, o, r = $("tool clickable"),
      i = (r.appendChild($("icon")), r.appendChild($("key")), t),
      l = (i.id = e, (i.element = r).toolIndex = e, r.querySelector(".icon").style.backgroundImage = "url(/img/" + t.graphic + ")", o = t.name, a = "S", (n = r).dataset.tooltip = o, n.dataset.tooltipdir = a, D(n, "pointerenter", function(e) {
        We(e.target)
      }), D(n, "pointerleave", function(e) {
        Oe()
      }), o = t.isAction ? (r.addEventListener("click", function(e) {
        Rt(this.toolIndex)
      }), at.appendChild(r), st[e] = i, re(t.name, t.keydef, "", function() {
        Rt(e)
      }, function(e) {
        l.textContent = e.key
      })) : (r.addEventListener("click", function(e) {
        Tt(this.toolIndex)
      }), nt.appendChild(r), lt[e] = i, re(t.name, t.keydef, "", function() {
        Tt(i.id)
      }, function(e) {
        l.textContent = e.key
      })), r.querySelector(".key"));
    l.textContent = o.key, t.hide && (r.style.display = "none")
  }
  var lt = [],
    st = (it(Xe, {
      isAction: !1,
      name: "Brush",
      keydef: "B",
      graphic: "pen.gif",
      cursor: 0
    }), it(1, {
      isAction: !1,
      name: "Fill",
      keydef: "F",
      graphic: "fill.gif",
      cursor: "url(/img/fill_cur.png) 7 38, default"
    }), []),
    C = (it(0, {
      isAction: !0,
      name: "Undo",
      keydef: "U",
      graphic: "undo.gif",
      action: function() {
        {
          var e;
          M == x && 0 < pt.length && (pt.pop(), 0 < pt.length ? (Ut(e = pt[pt.length - 1]), S && S.emit("data", {
            id: Ta,
            data: e
          })) : Ft())
        }
      }
    }), it(1, {
      isAction: !0,
      name: "Clear",
      keydef: "C",
      graphic: "clear.gif",
      action:
        () => typo.lockManualClear !== true && new /* this wicked way of function invoking lets me skip pathing in parentheses after the reference */ Ft
    })
      /*TYPOMOD DESC: add tool for deselect*/
      ,
      it(-1, {
        isAction: !1,
        name: "No Tool",
        graphic: "",
        keydef: "",
      })
      /*TYPOEND*/, c.querySelector("#game-canvas canvas")),
    ct = C.getContext("2d", {
      willReadFrequently: !0
    }),
    v = [],
    dt = 0,
    ut = 0,
    ht = [],
    r = [0, 9999, 9999, 0, 0],
    pt = [],
    b = [0, 0],
    mt = [0, 0],
    gt = 0,
    ft = c.createElement("canvas"),
    o = (ft.width = Qe + 2, ft.height = Qe + 2, ft.getContext("2d"));

  function yt() {

// TYPOMOD
// desc: dont update cursor when typo updates if very frequently to avoid performance drop
    if(typo.skipCursorUpdate === true) return;var e = lt[vt].cursor;
    if (L.id == j && M == x) {
      if (vt == Xe) {
        var t = ft.width,
          n = Ct;
        if (n <= 0) return;
        o.clearRect(0, 0, t, t);
// TYPOMOD
// desc: cursor with custom color
        var a = bt < 10000 ? kt[bt] : typo.typoCodeToRgb(bt);
// TYPOEND 

        a = [(a = 1 == l.dark ? [Math.floor(.75 * a[0]), Math.floor(.75 * a[1]), Math.floor(.75 * a[2])] : a)[0], a[1], a[2], .8];
        o.fillStyle = "rgba(" + a[0] + "," + a[1] + "," + a[2] + "," + a[3] + ")", o.beginPath(), o.arc(t / 2, t / 2, n / 2 - 1, 0, 2 * Math.PI), o.fill(), o.strokeStyle = "#FFF", o.beginPath(), o.arc(t / 2, t / 2, n / 2 - 1, 0, 2 * Math.PI), o.stroke(), o.strokeStyle = "#000", o.beginPath(), o.arc(t / 2, t / 2, n / 2, 0, 2 * Math.PI), o.stroke();
        a = t / 2, e = "url(" + ft.toDataURL() + ")" + a + " " + a + ", default"
      }
    } else e = "default";
    C.style.cursor = e
  }
  var vt = 0,
    bt = 0,
    St = 0,
    kt = [
      [255, 255, 255],
      [0, 0, 0],
      [193, 193, 193],
      [80, 80, 80],
      [239, 19, 11],
      [116, 11, 7],
      [255, 113, 0],
      [194, 56, 0],
      [255, 228, 0],
      [232, 162, 0],
      [0, 204, 0],
      [0, 70, 25],
      [0, 255, 145],
      [0, 120, 93],
      [0, 178, 255],
      [0, 86, 158],
      [35, 31, 211],
      [14, 8, 101],
      [163, 0, 186],
      [85, 0, 105],
      [223, 105, 167],
      [135, 53, 84],
      [255, 172, 142],
      [204, 119, 77],
      [160, 82, 45],
      [99, 48, 13]
    ],
    wt = ["White", "Black", "Light Gray", "Gray", "Red", "Dark Red", "Orange", "Dark Orange", "Yellow", "Dark Yellow", "Green", "Dark Green", "Mint", "Dark Mint", "Skyblue", "Dark Skyblue", "Seablue", "Dark Seablue", "Purple", "Dark Purple", "Pink", "Dark Pink", "Beige", "Dark Beige", "Brown", "Dark Brown"],
    Ct = 0,
    qt = -1,
    xt = [];

  function Mt(e) {
    return 20 + (e - Je) / (Qe - Je) * 80
  }
  for (t = 0; t < et.length; t++) {
    var Lt = $("size clickable"),
      Dt = $("icon"),
      $t = (Dt.style.backgroundSize = Mt(et[t]) + "%", {
        id: t,
        size: et[t],
        element: Lt,
        elementIcon: Dt
      });
    Lt.appendChild(Dt), ot.appendChild(Lt), Lt.size = $t, xt.push($t)
  }
  for (var Et = [$("top"), $("bottom")], t = 0; t < kt.length / 2; t++) Et[0].appendChild(Yt(2 * t)), Et[1].appendChild(Yt(2 * t + 1));
  for (t = 0; t < Et.length; t++) rt.appendChild(Et[t]);

  function At(e) {
    Ct = q(e, Je, Qe);
    for (var t = xt[xt.length - 1], n = t.size, a = 0; a < xt.length; a++) {
      var o = xt[a],
        r = Math.abs(Ct - o.size);
      r <= n && (n = r, t = o, 0), o.element.classList.remove("selected")
    }
    t.element.classList.add("selected"), tt.querySelector(".size-preview .icon").style.backgroundSize = Mt(Ct) + "%",
      document.dispatchEvent(new CustomEvent("skribblSizeChanged", { detail: Ct })), yt()
  }

  function It(e) {
    e.classList.remove("clicked"), e.offsetWidth, e.classList.add("clicked")
  }

  function Rt(e) {
    It(st[e].element), st[e].action()
  }

  function Tt(e, t) {

    /*toolidtarget*/ document.dispatchEvent(new CustomEvent("skribblToolChanged", {detail: e}));  It(lt[e].element), e == vt && !t || (lt[vt].element.classList.remove("selected"), lt[e].element.classList.add("selected"), vt = e, yt())
  }

  function Nt(e) {
    var t =
      e > 10000 ? zt(typo.typoCodeToRgb(e)) : zt(kt[e]);
    bt = e, c.querySelector("#color-preview-primary").style.fill = t
      , document.dispatchEvent(new CustomEvent("skribblColorChanged", {detail: t})), c.querySelector("#game-toolbar .color-preview-mobile").style.backgroundColor = t, yt()
  }

  function Wt(e) {
    var t =
      e > 10000 ? zt(typo.typoCodeToRgb(e)) : zt(kt[e]);
    St = e, c.querySelector("#color-preview-secondary").style.fill = t
      , document.dispatchEvent(new CustomEvent("skribblSecondaryColorChanged", {detail: t})), yt()
  }

  function Ot() {
    var e = bt;
    Nt(St), Wt(e)
  }

  function Pt() {
    ot.classList.remove("open")
  }

  function Yt(e) {
    var t = $("color");
    return t.style.backgroundColor = zt(kt[e]), t.colorIndex = e, t
  }

  function zt(e) {
    return "rgb(" + e[0] + "," + e[1] + "," + e[2] + ")"
  }

  function Bt(e) {
    /*TYPOMOD
    desc: if color code > 1000 -> customcolor*/if(e < 1000)
      e = q(e, 0, kt.length), e = kt[e];
    else e = typo.typoCodeToRgb(e);/* TYPOEND */
    return {
      r: e[0],
      g: e[1],
      b: e[2]
    }
  }

  function Ut(e) {
    if (v = v.slice(0, e), !(x != M && ut < e)) {
      r = _t();
      e = Math.floor(v.length / Ht);
      ht = ht.slice(0, e), Jt();
      for (var t = 0; t < ht.length; t++) {
        var n = ht[t];
        ct.putImageData(n.data, n.bounds[1], n.bounds[2])
      }
      for (t = ht.length * Ht; t < v.length; t++) Gt(jt(v[t]), v[t]);
      dt = Math.min(v.length, dt), ut = Math.min(v.length, ut)
    }
  }
  let Ht = 50;

  function _t() {
    return [0, 9999, 9999, 0, 0]
  }

  function Gt(e) {
    var t, n, a, o;
    r[0] += 1, r[1] = Math.min(r[1], e[0]), r[2] = Math.min(r[2], e[1]), r[3] = Math.max(r[3], e[2]), r[4] = Math.max(r[4], e[3]), r[0] >= Ht && (t = r[1], n = r[2], a = r[3], o = r[4], (a - t <= 0 || o - n <= 0) && (t = e[0], n = e[1], a = e[2], o = e[3]), e = ct.getImageData(t, n, a - t, o - n), ht.push({
      data: e,
      bounds: r
    }), r = _t())
  }

  function Kt(e) {
    return (e || 0 < v.length || 0 < pt.length || 0 < dt || 0 < ut) && (v = [], pt = [], dt = ut = 0, r = _t(), ht = [], Jt(), 1)
  }

  function Ft() {
    M == x && Kt() && S && S.emit("data", {
      id: Ra
    })
  }

  function Vt(e) {
    var t, n, a, o, r, i;
    ((t = e)[0] != je ? t[0] == Ze && 0 <= t[2] && t[2] < C.width && 0 <= t[3] && t[3] < C.height : (a = t[3], o = t[4], r = t[5], i = t[6], t = Math.ceil(t[2] / 2), n = (a + r) / 2, o = (o + i) / 2, r = Math.abs(r - a) / 2, a = Math.abs(i - i) / 2, (i = {
      x1: -(t + r),
      y1: -(t + r),
      x2: C.width + t + r,
      y2: C.height + t + a
    }).x1 < n && n < i.x2 && i.y1 < o && o < i.y2)) ? (v.push(e), x == M && Gt(jt(e))) : console.log("IGNORED COMMAND OUT OF CANVAS BOUNDS")
  }

  function jt(e) {
    var t = [0, 0, C.width, C.height];
    switch (e[0]) {
      case je:
        var n = q(Math.floor(e[2]), Je, Qe),
          a = Math.ceil(n / 2),
          o = q(Math.floor(e[3]), -a, C.width + a),
          r = q(Math.floor(e[4]), -a, C.height + a),
          i = q(Math.floor(e[5]), -a, C.width + a),
          a = q(Math.floor(e[6]), -a, C.height + a),
          l = Bt(e[1]);
        t[0] = q(o - n, 0, C.width), t[1] = q(r - n, 0, C.height), t[2] = q(i + n, 0, C.width), t[3] = q(a + n, 0, C.height), Xt(o, r, i, a, n, l.r, l.g, l.b);
        break;
      case Ze:
        var l = Bt(e[1]),
          o = q(Math.floor(e[2]), 0, C.width),
          r = q(Math.floor(e[3]), 0, C.height),
          i = o,
          a = r,
          s = l.r,
          c = l.g,
          d = l.b,
          u = ct.getImageData(0, 0, C.width, C.height),
          h = [
            [i, a]
          ],
          p = ((e, t, n) => 0 <= (n = 4 * (n * e.width + t)) && n < e.data.length ? [e.data[n], e.data[1 + n], e.data[2 + n]] : [0, 0, 0])(u, i, a);
        if (s != p[0] || c != p[1] || d != p[2]) {
          for (var m, g, f, y, v, b, S = function(e) {
            var t = u.data[e],
              n = u.data[e + 1],
              e = u.data[e + 2];
            return (t != s || n != c || e != d) && (t = Math.abs(t - p[0]), n = Math.abs(n - p[1]), e = Math.abs(e - p[2]), t < 3) && n < 3 && e < 3
          }, k = u.height, w = u.width; h.length;) {
            for (m = h.pop(), g = m[0], y = 4 * ((f = m[1]) * w + g); 0 <= f-- && S(y);) y -= 4 * w;
            for (y += 4 * w, ++f, b = v = !1; f++ < k - 1 && S(y);) Zt(u, y, s, c, d), 0 < g && (S(y - 4) ? v || (h.push([g - 1, f]), v = !0) : v = v && !1), g < w - 1 && (S(y + 4) ? b || (h.push([g + 1, f]), b = !0) : b = b && !1), y += 4 * w
          }
          ct.putImageData(u, 0, 0)
        }
    }
    return t
  }

  function q(e, t, n) {
    return e < t ? t : n < e ? n : e
  }

  function Zt(e, t, n, a, o) {
    0 <= t && t < e.data.length && (e.data[t] = n, e.data[t + 1] = a, e.data[t + 2] = o, e.data[t + 3] = 255)
  }

  function Xt(e, t, n, a, o, r, i, l) {
    function s(e, t) {
      for (var n = -c; n <= c; n++)
        for (var a, o = -c; o <= c; o++) n * n + o * o < d && 0 <= (a = 4 * ((t + o) * m.width + e + n)) && a < m.data.length && (m.data[a] = r, m.data[1 + a] = i, m.data[2 + a] = l, m.data[3 + a] = 255)
    }
    var c = Math.floor(o / 2),
      d = c * c,
      o = Math.min(e, n) - c,
      u = Math.min(t, a) - c,
      h = Math.max(e, n) + c,
      p = Math.max(t, a) + c,
      m = (e -= o, t -= u, n -= o, a -= u, ct.getImageData(o, u, h - o, p - u));
    if (e == n && t == a) s(e, t);
    else {
      s(e, t), s(n, a);
      var g = Math.abs(n - e),
        f = Math.abs(a - t),
        y = e < n ? 1 : -1,
        v = t < a ? 1 : -1,
        b = g - f;
      for (Math.floor(Math.max(0, c - 10) / 5); e != n || t != a;) {
        var S = b << 1; - f < S && (b -= f, e += y), S < g && (b += g, t += v), s(e, t)
      }
    }
    ct.putImageData(m, o, u)
  }

  function Jt() {
    /* TYPOMOD
             desc: store data before clear */
    const data = document.querySelector("#game-canvas canvas").toDataURL();
    /* TYPOEND */
    ct.fillStyle = "#FFF", ct.fillRect(0, 0, C.width, C.height)
    /* TYPOMOD
             desc: dispatch clear event */
    ;document.dispatchEvent(new CustomEvent("logCanvasClear", { detail: data }));
    /* TYPOEND */
  }

  function Qt(e) {
    if (L.id == j && M == x && -1 != qt) {
      var t = 0 == qt ? bt : St,
        n = null;
      if (e) {
        var e = ((e, t) => {
          for (var n = (e = ct.getImageData(e, t, 1, 1)).data[0], a = e.data[1], o = e.data[2], r = 0; r < kt.length; r++) {
            var i = kt[r];
            if (0 == i[0] - n && 0 == i[1] - a && 0 == i[2] - o) return r
          }
          /* TYPOMOD
                               desc: if color is not in array, convert to custom color */
          return r = parseInt(typo.rgbToHex(n, a, o), 16) + 10000;
          /* TYPOEND */
          return r
        })(b[0], b[1]);
        if (1 == vt) {
          if (e == t) return;
          e = t, l = b[0], s = b[1], n = [Ze, e, l, s]
        }
      }
      vt == Xe && (e = Ct, 0 <= gt && (e = (e - Je) * q(gt, 0, 1) + Je),
        /* TYPOMOD use typo pressure */
        (() => {
          if (0 <= gt && document.documentElement.dataset["typo_pressure_performance"]) {
            const pressure = eval(document.documentElement.dataset["typo_pressure_performance"])(gt);
            e = Math.max(4, Math.round(40 * pressure));
          }
        })(),l = Math.ceil(.5 * e), s = q(Math.floor(mt[0]), -l, C.width + l), o = q(Math.floor(mt[1]), -l, C.height + l), r = q(Math.floor(b[0]), -l, C.width + l), i = q(Math.floor(b[1]), -l, C.height + l), t = t, e = e, a = s, o = o, r = r, i = i, n = [je, t, e, a, o, r, i]), null != n && Vt(n)
    }
    var a, o, r, i, l, s
  }

  function en(e, t, n, a) {
    var o = C.getBoundingClientRect(),
      e = Math.floor((e - o.left) / o.width * C.width),
      t = Math.floor((t - o.top) / o.height * C.height);
    a ? (gt = n, mt[0] = b[0] = e, mt[1] = b[1] = t) : (mt[0] = b[0], mt[1] = b[1], gt = n, b[0] = e, b[1] = t)
  }

  function tn(e) {
    return 0 == e || 2 == e || 5 == e
  }

  function nn(e) {
    var t = "Left-/Rightclick to choose a color!\\n" + wt[this.colorIndex];
    c.querySelector("#game-toolbar .colors").dataset.tooltip = t, i && (i.querySelector(".tooltip-content").textContent = E(Ne.dataset.tooltip))
  }

  function an(e) {
    var t, n;
    t = this.colorIndex, n = 0 == e.button, ((n = e.altKey ? !n : n) ? Nt : Wt)(t)
  }
  D(tt, "contextmenu", function(e) {
    return e.preventDefault(), !1
  }), D("#game-toolbar .sizes .size", "click", function(e) {
    var t;
    t = this.size.id, It((t = xt[t]).element), At(t.size), Pt()
  }), D([C], "DOMMouseScroll wheel", function(e) {
    e.preventDefault();
    e = -e.deltaY || e.wheelDeltaY, e = Math.sign(e);
    At(Ct + 2 * e)
  }), re("Swap", "S", "Swap the primary and secondary color.", Ot), D(tt.querySelector(".color-preview"), "click", function(e) {
    Ot()
  }), D(tt.querySelector(".color-preview-mobile"), "click", function(e) {
    tt.querySelector(".colors").classList.toggle("open")
  }), D(n, "click", function(e) {
    ot.classList.toggle("open")
  }), D(c, "keydown", function(e) {
    if ("Enter" == e.code) return _n[0].focus(), 0;
    if ("input" == c.activeElement.tagName.toLowerCase() || "textarea" == c.activeElement.tagName.toLowerCase() || -1 != qt) return 0;
    for (var t = e.key.toLowerCase().replace("key", ""), n = 0; n < u.length; n++)
      if (u[n].key.toLowerCase() == t) {
        for (var a = 0; a < u[n].cb.length; a++) u[n].cb[a](u[n]);
        return void e.preventDefault()
      }
  }), D(C, "contextmenu", function(e) {
    return e.preventDefault(), !1
  });
  var on = null;
  "PointerEvent" in h ? (D("#game-toolbar .colors * .color", "pointerenter", nn), D("#game-toolbar .colors * .color", "pointerdown", an), D(C, "pointerdown", function(e) {
    var t, n, a, o;
    null == on && tn(e.button) && (h.getSelection ? h.getSelection().removeAllRanges() : c.selection && c.selection.empty(), t = 1 == l.pressureSensitivity && "pen" == e.pointerType, n = e.clientX, a = e.clientY, o = -1, t && (o = (ae && e.pressure, e.pressure)), on = e.pointerId, qt = e.button, C.setPointerCapture(e.pointerId), v.length, en(n, a, o, !0), Qt(!0))
  }), D(C, "pointermove", function(e) {
    var t, n;
    on !== e.pointerId || (() => {
      var e = performance.now();
      if (
        document.body.dataset.bypassFps !== 'true' &&e - ln < 1e3 / rn) return 1;
      ln = e
    })() || (t = 1 == l.pressureSensitivity && "pen" == e.pointerType, n = -1, en(e.clientX, e.clientY, n = t ? (ae && e.pressure, e.pressure) : n, !1), Qt(!1))
  }), D(C, "pointerup pointercancel", function(e) {
    on === e.pointerId && (sn != v.length && (sn = v.length, pt.push(sn)), on = null, qt = -1, C.releasePointerCapture(e.pointerId))
  })) : (D("#game-toolbar .colors * .color", "mouseenter", nn), D("#game-toolbar .colors * .color", "click", an), D(C, "mousedown", function(e) {
    tn(e.button) && (qt = e.button, v.length, en(e.clientX, e.clientY, -1, !0), Qt(!0))
  }), D(c, "mousemove", function(e) {
    en(e.clientX, e.clientY, -1, !1), Qt(!1)
  }), D(c, "mouseup", function(e) {
    -1 != qt && (sn != v.length && (sn = v.length, pt.push(sn)), qt = -1)
  }));
  let rn = 90;
  var S, ln = 0,
    sn = 0,
    cn = (setInterval(function() {
        var e, t, n;
        S && L.id == j && M == x && 0 < (e = v.length - dt) && (t = dt + 8, n = v.slice(dt, t), S.emit("data", {
          id: Ia,
          data: n
        }), dt = Math.min(t, v.length),
        false &&console.log(\`Sent \${n.length} commands. \${e} remaining.\`))
      },
      document.body.dataset.bypassCommandRate === 'true' ? 0 :50), setInterval(function() {
      S && L.id == j && M != x && ut < v.length && (Gt(jt(v[ut]), v[ut]), ut++)
    }, 1), c.querySelector("#game-canvas .overlay")),
    dn = c.querySelector("#game-canvas .overlay-content"),
    A = c.querySelector("#game-canvas .overlay-content .text"),
    un = c.querySelector("#game-canvas .overlay-content .words"),
    hn = c.querySelector("#game-canvas .overlay-content .reveal"),
    I = c.querySelector("#game-canvas .overlay-content .result"),
    pn = c.querySelector("#game-canvas .overlay-content .room"),
    mn = -100,
    gn = 0,
    fn = void 0;

  function yn(e, a, o) {
    var r, i, l = mn,
      s = gn,
      c = e.top - l,
      d = e.opacity - s;
    Math.abs(c) < .001 && Math.abs(d) < .001 ? o && o() : (r = void 0, i = 0, fn = h.requestAnimationFrame(function e(t) {
      var n = t - (r = null == r ? t : r),
        t = (r = t, (i = Math.min(i + n, a)) / a),
        n = (n = t) < .5 ? .5 * ((e, t) => e * e * ((t + 1) * e - t))(2 * n, 1.2 * 1.5) : .5 * (((e, t) => e * e * ((t + 1) * e + t))(2 * n - 2, 1.2 * 1.5) + 2);
      mn = l + c * n, gn = s + t * t * (3 - 2 * t) * d, dn.style.top = mn + "%", cn.style.opacity = gn, i == a ? o && o() : fn = h.requestAnimationFrame(e)
    }))
  }

  function vn(e) {
    e.classList.add("show")
  }
  /* TYPOMOD desc: add event handlers for typo features */
  document.addEventListener("joinPractice", () => {
    const data = typo.createFakeLobbyData();
    typo.messagePort.postMessage({ id: 10, data });
    //document.dispatchEvent(new CustomEvent("practiceJoined", {detail: data}));
    aa(data);

    S = new Proxy({},{
      emit: (...data) => typo.emitPort.postMessage(data),
      other: (...data) => void 0,
      get (target, prop) {
        if(prop === "emit"){
          return this.emit;
        }
        else return this.other;
      }
    });
  });
  /* TYPOEND */

  function bn(e) {
    for (var t = 0; t < dn.children.length; t++) dn.children[t].classList.remove("show");
    switch (e.id) {
      case J:
        vn(pn);
        break;
      case F:
        vn(A), A.textContent = E("Round $", e.data + 1);
        break;
      case G:
        vn(A), A.textContent = E("Waiting for players...");
        break;
      case K:
        vn(A), A.textContent = E("Game starting in a few seconds...");
        break;
      case Z:
        vn(hn), hn.querySelector("p span.word").textContent = e.data.word, hn.querySelector(".reason").textContent = (e => {
          switch (e) {
            case B:
              return E("Everyone guessed the word!");
            case H:
              return E("The drawer left the game!");
            case U:
              return E("Time is up!");
            case _:
              return E("Drawer got skipped!");
            default:
              return "Error!"
          }
        })(e.data.reason);
        for (var n = hn.querySelector(".player-container"), a = (ce(n), []), o = 0; o < e.data.scores.length; o += 3) {
          var r = e.data.scores[o + 0],
            i = (e.data.scores[o + 1], e.data.scores[o + 2]);
          (s = W(r)) && a.push({
            name: s.name,
            score: i
          })
        }
        a.sort(function(e, t) {
          return t.score - e.score
        });
        for (o = 0; o < Math.min(a.length, 12); o++) {
          var l = $("player"),
            s = a[o],
            c = (l.appendChild($("name", s.name)), $("score", (0 < s.score ? "+" : "") + s.score));
          s.score <= 0 && c.classList.add("zero"), l.appendChild(c), n.appendChild(l)
        }
        break;
      case X:
        vn(I);
        for (var d = [I.querySelector(".podest-1"), I.querySelector(".podest-2"), I.querySelector(".podest-3"), I.querySelector(".ranks")], o = 0; o < 4; o++) ce(d[o]);
        if (0 < e.data.length) {
          for (var u = [
            [],
            [],
            [],
            []
          ], o = 0; o < e.data.length; o++)(s = {
            player: W(r = e.data[o][0]),
            rank: e.data[o][1],
            title: e.data[o][2]
          }).player && u[Math.min(s.rank, 3)].push(s);
          for (var h = 0; h < 3; h++) {
            var p = u[h];
            if (0 < p.length) {
              var m = p.map(function(e) {
                  return e.player.name
                }).join(", "),
                g = p[0].player.score,
                f = d[h],
                l = $("avatar-container"),
                y = (f.appendChild(l), $("border"));
              y.appendChild($("rank-place", "#" + (h + 1))), y.appendChild($("rank-name", m)), y.appendChild($("rank-score", E("$ points", g))), f.appendChild(y), 0 == h && l.appendChild($("trophy"));
              for (o = 0; o < p.length; o++) pe(b = de((s = p[o]).player.avatar, 0 == h), Ya(s.player)), b.style.left = 15 * -(p.length - 1) + 30 * o + "%",
                b.setAttribute("playerid", s.player.id),0 == h && (b.classList.add("winner"), b.style.animationDelay = -2.35 * o + "s"), l.appendChild(b)
            }
          }
          for (var v = Math.min(5, u[3].length), o = 0; o < v; o++) {
            var b, s = u[3][o],
              f = $("rank");
            pe(b = de(s.player.avatar, !1), Ya(s.player)), f.appendChild(b), f.appendChild($("rank-place", "#" + (s.rank + 1))), f.appendChild($("rank-name", s.player.name)),
              f.setAttribute("playerid", s.player.id), /*elemanchor*/ f.appendChild($("rank-score", E("$ points", s.player.score))), d[3].appendChild(f)
          }
          0 < u[0].length ? (L = u[0].map(function(e) {
            return e.player.name
          }).join(", "), I.querySelector(".winner-name").textContent = (0 < u[0].length ? L : "<user left>") + "", I.querySelector(".winner-text").textContent = 1 == u[0].length ? E("is the winner!") : E("are the winners!")) : (I.querySelector(".winner-name").textContent = "", I.querySelector(".winner-text").textContent = E("Nobody won!"))
        } else I.querySelector(".winner-name").textContent = "", I.querySelector(".winner-text").textContent = E("Nobody won!");
        break;
      case V:
        if (e.data.words)
          if (vn(A), vn(un), ce(un), An[te.WORDMODE] == ne.COMBINATION) {
            A.textContent = E("Choose the first word");
            for (var S = e.data.words.length / 2, k = [], w = [], C = 0, o = 0; o < S; o++) {
              var q = $("word", e.data.words[o]),
                x = (q.index = o, $("word", e.data.words[o + S]));
              x.index = o, x.style.display = "none", x.style.animationDelay = .03 * o + "s", k.push(q), w.push(x), D(q, "click", function() {
                C = this.index;
                for (var e = 0; e < S; e++) k[e].style.display = "none", w[e].style.display = "";
                A.textContent = E("Choose the second word")
              }), D(x, "click", function() {
                ha([C, this.index])
              }), un.appendChild(q), un.appendChild(x)
            }
          } else {
            A.textContent = E("Choose a word");
            for (o = 0; o < e.data.words.length; o++) {
              var M = $("word", e.data.words[o]);
              M.index = o, D(M, "click", function() {
                ha(this.index)
              }), un.appendChild(M)
            }
          }
        else {
          vn(A);
          var L = (s = W(e.data.id)) ? s.name : E("User"),
            L = (A.textContent = "", A.appendChild(se("span", void 0, E("$ is choosing a word!", L))), de(s
            && (A.setAttribute("playerid", s.id) || true) /*overlayanchor*/ ? s.avatar : [0, 0, 0, 0], e.data.id == En));
          s && pe(L, Ya(s)), L.style.width = "2em", L.style.height = "2em", A.appendChild(L)
        }
    }
  }
  let Sn = 0,
    kn = 1,
    wn = 2,
    Cn = 3,
    qn = 4,
    xn = 5,
    Mn = 6;

  function Ln(e, t) {
    this.url = t, this.buffer = null, this.loaded = !1;
    var n = this,
      a = new XMLHttpRequest;
    a.open("GET", t, !0), a.responseType = "arraybuffer", a.onload = function() {
      e.context.decodeAudioData(a.response, function(e) {
        n.buffer = e, n.loaded = !0
      }, function(e) {
        console.log("Failed loading audio from url '" + t + "'")
      })
    }, a.send()
  }

  function Dn() {
    this.context = null, this.gain = null, this.sounds = new Map, h.addEventListener("load", this.load.bind(this), !1)
  }
  Dn.prototype.addSound = function(e, t) {
    this.sounds.set(e, new Ln(this, t))
  }, Dn.prototype.loadSounds = function() {
    this.addSound(Sn, "/audio/roundStart.ogg"), this.addSound(kn, "/audio/roundEndSuccess.ogg"), this.addSound(wn, "/audio/roundEndFailure.ogg"), this.addSound(Cn, "/audio/join.ogg"), this.addSound(qn, "/audio/leave.ogg"), this.addSound(xn, "/audio/playerGuessed.ogg"), this.addSound(Mn, "/audio/tick.ogg")
  }, Dn.prototype.playSound = function(e) {
    var t, n;
    null == this.context ? this.load() : "running" != this.context.state ? this.context.resume().then(function() {
      this.playSound(e)
    }) : null != this.context && 0 < l.volume && this.sounds.has(e) && (t = this.sounds.get(e)).loaded && ((n = this.context.createBufferSource()).buffer = t.buffer, n.connect(this.gain), n.start(0))
  }, Dn.prototype.setVolume = function(e) {
    g[p].querySelector("#volume .title .icon").classList.toggle("muted", e <= 0), g[p].querySelector("#volume .volume-value").textContent = e <= 0 ? "Muted" : e + "%", this.gain && (this.gain.gain.value = e / 100)
  }, Dn.prototype.load = function() {
    if (null == this.context) try {
      h.AudioContext = h.AudioContext || h.webkitAudioContext, this.context = new AudioContext, this.gain = this.context.createGain(), this.gain.connect(this.context.destination), this.setVolume(l.volume), console.log("AudioContext created."), this.loadSounds()
    } catch (e) {
      console.log("Error creating AudioContext.", e), this.context = null
    }
  };
  let k = 4,
    $n = location.origin + "/api/play";
  G;
  var w = [],
    x = 0,
    En = -1,
    M = -1,
    An = [],
    L = {
      id: -1,
      time: 0,
      data: 0
    },
    In = -1,
    Rn = 0,
    Tn = void 0,
    R = new Dn,
    T = void 0,
    Nn = !1,
    Wn = !1,
    On = c.querySelector("#game"),
    Pn = c.querySelector("#game-wrapper"),
    n = c.querySelector("#game-canvas .room"),
    Yn = c.querySelector("#game-players"),
    zn = c.querySelector("#game-players .players-list"),
    Bn = c.querySelector("#game-players-footer"),
    Un = (c.querySelector("#game-board"), c.querySelector("#game-bar"), c.querySelector("#game-round .text")),
    N = [c.querySelector("#game-word .description"), c.querySelector("#game-word .word"), c.querySelector("#game-word .hints .container")],
    Hn = (c.querySelector("#game-chat"), [c.querySelector("#game-chat form"), c.querySelector("#game-chat-input-mobile form")]),
    _n = [c.querySelector("#game-chat input"), c.querySelector("#game-chat-input-mobile input")],
    Gn = c.querySelector("#game-chat .chat-content"),
    Kn = c.querySelector("#home .container-name-lang input"),
    Fn = c.querySelector("#home .container-name-lang select"),
    Vn = c.querySelector("#home .panel .button-play"),
    jn = c.querySelector("#home .panel .button-create");
  let Zn = 11 == (Xn = new Date).getMonth() && 19 <= (Xn = Xn.getDate()) && Xn <= 26;
  var Xn = 9 == (Xn = new Date).getMonth() && 24 <= (Xn = Xn.getDate()) && Xn <= 31;

  function Jn(e) {
    Nn = e, c.querySelector("#load").style.display = e ? "block" : "none"
  }

  function Qn(e, t, n, a) {
    var o, r;
    e = e, t = t, o = function(e, t) {
      switch (e) {
        case 200:
          return void n({
            success: !0,
            data: t
          });
        case 503:
        case 0:
          a && qe(ye, E("Servers are currently undergoing maintenance!") + "\\n\\r" + E("Please try again later!") + "\\n\\rStatus: " + e);
          break;
        default:
          a && qe(ye, E("An unknown error occurred ('$')", e) + "\\n\\r" + E("Please try again later!"))
      }

      document.dispatchEvent(new CustomEvent("joinLobbyFailed")) & n({
        success: !1,
        error: e
      })
    }, (r = new XMLHttpRequest).onreadystatechange = function() {
      4 == this.readyState && o(this.status, this.response)
    }, r.open("POST", e, !0), r.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), r.send(t)
  }
  Zn;
  var ea = null;
  adplayer = null;
  try {
    aiptag.cmd.player.push(function() {
      console.log("ad player loaded"), adplayer = new aipPlayer({
        AD_WIDTH: 960,
        AD_HEIGHT: 540,
        AD_FULLSCREEN: !1,
        AD_CENTERPLAYER: !0,
        LOADING_TEXT: "loading advertisement",
        PREROLL_ELEM: function() {
          return c.getElementById("preroll")
        },
        AIP_COMPLETE: function(e) {
          ea()
        },
        AIP_REMOVE: function() {}
      })
    })
  } catch (e) {
    console.log("ad push failed: "), console.log(e)
  }

  function ta(t) {
    var e, n, a = !1;
    if (h.localStorageAvailable && (n = d.getItem("lastAd"), e = new Date, d.setItem("lastAd", e.toString()), null == n ? n = e : (n = new Date(Date.parse(n)), a = 1 <= Math.abs(n - e) / 1e3 / 60)), a) try {
      aiptag && adplayer && null != adplayer && "undefined" !== adplayer ? (ea = t, aiptag.cmd.player.push(function() {
        adplayer.startPreRoll()
      })) : t()
    } catch (e) {
      console.log(e), t()
    } else t()
  }

  function na(e, t, n) {
    R.context && R.context.resume && R.context.resume(), S && ua();
    var a, o = 0,
      r = {
        transports: ["websocket", "polling"],
        closeOnBeforeunload: !1
      };
    "URL" in h && "127.0.0.1" != (a = new URL(e)).hostname && "localhost" != a.hostname && (r.path = "/" + a.port + "/", e = a.protocol + "//" + a.hostname), (S = O(e, r)).on("connect", function() {
      /* TYPOMOD
                           desc: disconnect socket & leave lobby */
      document.addEventListener('socketEmit', event =>
        S.emit('data', { id: event.detail.id, data: event.detail.data })
      );

      typo.disconnect = () => {
        if (S) {
          S.typoDisconnect = true;
          S.on("disconnect", () => {
            typo.disconnect = undefined;
            document.dispatchEvent(new Event("leftLobby"));
          });
          S.off("data");
          S.reconnect = false;
          S.disconnect();
        } else {
          document.dispatchEvent(new Event("leftLobby"));
        }
      }
      S.on("data", data => typo.messagePort.postMessage(data));
      typo.messagePort.onmessage = data => S.emit("data", data.data);

      const originalEmit = S.emit.bind(S);
      S.emit = function(...event) {
        typo.emitPort.postMessage(event);

        const {data, id} = event[1];

        if(id === Ia){
          const events = [];
          const buffer = [];
          let sent = 0; /* to calculate correct undo offset */

          for(const command of data){
            /* DO NOT edit reference as it's used in local cmd history */
            const commandCopy = structuredClone(command);
            const sequence = typo.msiColorSwitch.ensureColorSequence(commandCopy);
            if(sequence === undefined) buffer.push(commandCopy);
            else {
              if(buffer.length > 0) events.push({id: Ia, data: buffer});
              events.push({id: Ia, data: sequence});
              events.push({id: Ta, data: dt + sent});
              buffer.push(commandCopy);
            }
          }

          if(buffer.length > 0) events.push({id: Ia, data: buffer});

          for(event of events){
            originalEmit("data", event);
          }
        }

        else {
          originalEmit(...event) /* replace recursion prevention */;
        }
      };
      /* TYPOEND */
      Jn(!1), S.on("joinerr", function(e) {
        ua(), qe(ye, (e => {

          document.dispatchEvent(new CustomEvent("joinLobbyFailed"));switch (e) {
            case 1:
              return E("Room not found!");
            case 2:
              return E("Room is full!");
            case 3:
              return E("You are on a kick cooldown!");
            case 4:
              return E("You are banned from this room!");
            case 5:
              return E("You are joining rooms too quickly!");
            case 100:
              return E("You are already connected to this room!");
            case 200:
              return E("Too many users from your IP are connected to this room!");
            case 300:
              return E("You have been kicked too many times!");
            default:
              return E("An unknown error ('$') occured!", e)
          }
        })(e))
      }), S.on("data", Pa);
      var e = Kn.value.split("#"),
        e = {
          join: t,
          create: n ? 1 : 0,
          name: e[0],
          lang: Fn.value,
          code: e[1],
          avatar: l.avatar
        };
      S.emit("login", e)
    }), S.on("reason", function(e) {
      o = e
    }), S.on("disconnect", function(e) {
      /* TYPOMOD
                       DESC: no msg if disconnect intentionally */
      document.dispatchEvent(new CustomEvent("leftLobby"));                if(!S.typoDisconnect)
        /*TYPOEND*/
        switch (console.log("socket disconnect: " + e), o) {
          case Q:
            qe(ve, E("You have been kicked!"));
            break;
          case ee:
            qe(ve, E("You have been banned!"));
            break;
          default:
            qe(ve, E("Connection lost!") + "\\n" + e)
        }
      ua()
    }), S.on("connect_error", function(e) {
      ua(), Jn(!1), qe(ye, e.message)
    })
  }

  function aa(e) {
    R.playSound(Cn), Tt(Xe, !0), At(12), Nt(1), Wt(0), Kt(!0), ce(Gn), c.querySelector("#home").style.display = "none", c.querySelector("#game").style.display = "flex", x = e.me, In = e.type, Tn = e.id, c.querySelector("#input-invite").value = "https://skribbl.io/?" + e.id, An = e.settings, oa(), ce(zn), w = [];
    for (var t = 0; t < e.users.length; t++) za(e.users[t], !1);
    Ga(), Ka(), ia(e.round), fa(e.owner), sa(e.state, !0), Wn || (setTimeout(function() {
      try {
        (adsbygoogle = h.adsbygoogle || []).push({}), (adsbygoogle = h.adsbygoogle || []).push({})
      } catch (e) {
        console.log("google ad request failed"), console.log(e)
      }
    }, 1500), Wn = !0)
  }

  function oa() {
    ia(Rn);
    for (var e, t = 0; t < ja.length; t++) {
      var n = ja[t];
      n.index && (e = An[(n = n).index], "checkbox" == n.element.type ? n.element.checked = !!e : n.element.value = e)
    }
  }

  function ra(e, t, n) {
    An[e] = t, n && S && S.emit("data", {
      id: xa,
      data: {
        id: e,
        val: t
      }
    }), oa()
  }

  function ia(e) {
    var e = (Rn = e) + 1,
      t = An[te.ROUNDS];
    Un.textContent = E("Round $ of $", [e, t])
  }

  function la() {
    for (var e = 0; e < w.length; e++) w[e].score = 0;
    for (e = 0; e < w.length; e++) Fa(w[e], !1), Va(w[e], !1);
    Ka()
  }

  function sa(e, t) {
    var n, a;
    if (n = L = e, null != fn && (h.cancelAnimationFrame(fn), fn = void 0), n.id == j ? yn({
      top: -100,
      opacity: 0
    }, 600, function() {
      cn.classList.remove("show")
    }) : cn.classList.contains("show") ? yn({
      top: -100,
      opacity: 1
    }, 600, function() {
      bn(n), yn({
        top: 0,
        opacity: 1
      }, 600)
    }) : (cn.classList.add("show"), bn(n), yn({
      top: 0,
      opacity: 1
    }, 600)), a = e.time, oo(), ro(a), no = setInterval(function() {
      ro(Math.max(0, ao - 1));
      var e = -1;
      L.id == j && (e = Qa), L.id == V && (e = eo), to.style.animationName = ao < e ? ao % 2 == 0 ? "rot_left" : "rot_right" : "none", ao < e && R.playSound(Mn), ao <= 0 && oo()
    }, 1e3), Pn.classList.add("toolbar-hidden"), yt(), da(!1), e.id == J ? (la(), Pn.classList.add("room")) : Pn.classList.remove("room"), e.id == F && (ia(e.data), 0 == e.data) && la(), e.id == Z) {
      x != M && ga(e.data.word);
      for (var o = 0; o < e.data.scores.length; o += 3) {
        var r = e.data.scores[o + 0],
          i = e.data.scores[o + 1];
        e.data.scores[o + 2];
        (c = W(r)) && (c.score = i)
      }
      Ka();
      for (var l = !0, o = 0; o < w.length; o++)
        if (w[o].guessed) {
          l = !1;
          break
        } l ? R.playSound(wn) : R.playSound(kn), y(E("The word was '$'", e.data.word), "", f($e), !0)
    } else e.id != j && (N[0].textContent = E("WAITING"), N[0].classList.add("waiting"), N[1].style.display = "none", N[2].style.display = "none");
    if (e.id == j) {
      if (M = e.data.id,
        typo.msi.reset(),
        typo.msiColorSwitch.currentCode = undefined,R.playSound(Sn), Kt(!0), e.data.drawCommands && (v = e.data.drawCommands), y(E("$ is drawing now!", W(M).name), "", f(De), !0), !t)
        for (o = 0; o < w.length; o++) Fa(w[o], !1);
      N[0].classList.remove("waiting"), M == x ? (a = e.data.word, N[0].textContent = E("DRAW THIS"), N[1].style.display = "", N[2].style.display = "none", N[1].textContent = a, Pn.classList.remove("toolbar-hidden"), yt()) : (da(!0), pa(e.data.word, !1), ma(e.data.hints))
    } else {
      M = -1;
      for (o = 0; o < w.length; o++) Fa(w[o], !1)
    }
    if (e.id == X && 0 < e.data.length) {
      for (var s = [], i = 0, o = 0; o < e.data.length; o++) {
        var c, d = e.data[o][0],
          u = e.data[o][1];
        (c = W(d)) && 0 == u && (i = c.score, s.push(c.name))
      }
      1 == s.length ? y(E("$ won with a score of $!", [s[0], i]), "", f(Ae), !0) : 1 < s.length && y(E("$ and $ won with a score of $!", [s.slice(0, -1).join(", "), s[s.length - 1], i]), "", f(Ae), !0)
    }
    for (o = 0; o < w.length; o++) Va(w[o], w[o].id == M);
    Ga()
  }

  function ca(e) {
    S && S.connected && L.id == j && (S.emit("data", {
      id: Sa,
      data: e
    }), da(!1))
  }

  function da(e) {
    c.querySelector("#game-rate").style.display = e ? "" : "none"
  }

  function ua() {
    console.log("lobby left"), S && S.close(), Kt(!(S = void 0)), oo(), w = [], An = [], L = {
      id: M = En = -1,
      time: x = 0,
      data: 0
    }, c.querySelector("#home").style.display = "", c.querySelector("#game").style.display = "none"
  }

  function ha(e) {
    S && S.connected && L.id == V && S.emit("data", {
      id: Aa,
      data: e
    })
  }

  function pa(e, t) {
    for (var n = e.length - 1, a = 0; a < e.length; a++) n += e[a];
    var o = !t && 1 == An[te.WORDMODE];
    o && (n = 3), N[0].textContent = E(o ? "WORD HIDDEN" : "GUESS THIS"), N[1].style.display = "none", N[2].style.display = "", ce(N[2]), N[2].hints = [];
    for (a = 0; a < n; a++) N[2].hints[a] = $("hint", o ? "?" : "_"), N[2].appendChild(N[2].hints[a]);
    o || N[2].appendChild($("word-length", e.join(" ")))
  }

  function ma(e) {
    for (var t = N[2].hints, n = 0; n < e.length; n++) {
      var a = e[n][0],
        o = e[n][1];
      t[a].textContent = o, t[a].classList.add("uncover")
    }
  }

  function ga(e) {
    (!N[2].hints || N[2].hints.length < e.length) && pa([e.length], !0);
    for (var t = [], n = 0; n < e.length; n++) t.push([n, e.charAt(n)]);
    ma(t)
  }

  function fa(e) {
    En = e;
    for (var t = 0; t < w.length; t++) he(w[t].element, w[t].id == En), Ha(w[t], 0, w[t].id == En);
    var n = x != En;
    c.querySelector("#button-start-game").disabled = n;
    for (var a = 0; a < ja.length; a++) ja[a].element.disabled = n;
    e = W(En);
    e && y(E("$ is now the room owner!", e.name), "", f(Ae), !0)
  }
  let ya = 1,
    va = 2,
    ba = 5,
    Sa = 8,
    ka = 9,
    wa = 90,
    Ca = 10,
    qa = 11,
    xa = 12,
    Ma = 13,
    La = 14,
    Da = 15,
    $a = 16,
    Ea = 17,
    Aa = 18,
    Ia = 19,
    Ra = 20,
    Ta = 21,
    Na = 30,
    Wa = 31,
    Oa = 32;

  function Pa(e) {
    var t = e.id,
      n = e.data;
    switch (t) {
      case Ca:
        aa(n);
        break;
      case qa:
        sa(n);
        break;
      case xa:
        ra(n.id, n.val, !1);
        break;
      case Ma:
        ma(n);
        break;
      case La:
        ro(n);
        break;
      case ya:
        var a = za(n, !0);
        Ka(), a.joinTimeout = setTimeout(() => {
          y(E("$ joined the room!", a.name), "", f($e), !0), R.playSound(Cn), a.joinTimeout = void 0
        }, 0 == In ? 1e3 : 0);
        break;
      case ka:
        (a = W(n.id)) && (a.avatar = n.avatar, ue(a.element.avatar, a.avatar));
        break;
      case wa:
        (a = W(n.id)) && (a.name = n.name, a.element.querySelector(".player-name").textContent = n.name);
        break;
      case va:
        (a = (e => {
          for (var t = 0; t < w.length; t++) {
            var n = w[t];
            if (n.id == e) return w.splice(t, 1), n.element.remove(), Ka(), Ga(), n
          }
        })(n.id)) && (null == a.joinTimeout ? (y(((e, t) => {
          switch (e) {
            default:
              return E("$ left the room!", t);
            case Q:
              return E("$ has been kicked!", t);
            case ee:
              return E("$ has been banned!", t)
          }
        })(n.reason, a.name), "", f(Ee), !0), R.playSound(qn)) : (clearTimeout(a.joinTimeout), a.joinTimeout = void 0), n.id != M || n.reason != Q && n.reason != ee || Kt(!0));
        break;
      case ba:
        var o = W(n[0]),
          r = W(n[1]),
          i = n[2],
          l = n[3];
        o && r && y(E("$ is voting to kick $ ($/$)", [o.name, r.name, i, l]), "", f(Le), !0);
        break;
      case Da:
        (a = W(n.id)) && (y(E("$ guessed the word!", a.name), "", f($e), !0).classList.add("guessed"), Fa(a, !0), R.playSound(xn), n.id == x) && ga(n.word);
        break;
      case Sa:
        (a = W(n.id)) && (o = a, r = 0 == n.vote ? "thumbsdown.gif" : "thumbsup.gif", (i = $("icon")).style.backgroundImage = "url(/img/" + r + ")", r = Ua(o, i).getBoundingClientRect(), o = .9 * (r.bottom - r.top), i.style.width = o + "px", i.style.height = o + "px", n.vote ? y(E("$ liked the drawing!", a.name), "", f($e), !0) : y(E("$ disliked the drawing!", a.name), "", f(Ee), !0));
        break;
      case Ea:
        fa(n);
        break;
      case $a:
        y(E("$ is close!", n), "", f(Le), !0);
        break;
      case Na:
        Ba(W(n.id), n.msg);
        break;
      case Oa:
        y(E("Spam detected! You're sending messages too quickly."), "", f(Ee), !0);
        break;
      case Wa:
        switch (n.id) {
          case 0:
            y(E("You need at least 2 players to start the game!"), "", f(Ee), !0);
            break;
          case 100:
            y(E("Server restarting in about $ seconds!", n.data), "", f(Ee), !0)
        }
        break;
      case Ia:
        for (var s = 0; s < n.length; s++)
          n[s] = typo.msi.processIncomingCommand(n[s]), n[s] !== undefined && Vt(n[s]);
        break;
      case Ra:
        Kt(!0);
        break;
      case Ta:
        Ut(n);
        break;
      default:
        return void console.log("Unimplemented data packed received with id " + t)
    }
  }

  function W(e) {
    for (var t = 0; t < w.length; t++) {
      var n = w[t];
      if (n.id == e) return n
    }
  }

  function Ya(e) {
    return (e.flags & k) == k ? ["glow", "hue-rotate"] : []
  }

  function za(e, t) {
    var n = {
        id: e.id,
        flags: e.flags,
        name: e.name,
        avatar: e.avatar,
        score: e.score,
        guessed: e.guessed,
        rank: 0,
        muted: !1,
        votekick: !1,
        reported: !1,
        page: 0,
        element: $("player"),
        bubble: void 0
      },
      e = (w.push(n), n.id == x ? E("$ (You)", n.name) : n.name),
      a = (n.flags & k) == k,
      o = (a && n.element.classList.add("admin"), $("player-background")),
      r = (n.element.appendChild(o), a ? 1 : -1);
    if (1 == r)
      for (var i = 0; i < 7; i++) o.appendChild($("background-bubble"));
    if (2 == r)
      for (i = 0; i < 3; i++) o.appendChild($("background-wave"));
    var r = $("player-avatar-container"),
      l = de(n.avatar),
      r = (n.element.drawing = $("drawing"), (n.element.avatar = l).appendChild(n.element.drawing), r.appendChild(l), n.element.appendChild(r), zn.appendChild(n.element), pe(l, Ya(n)), $("player-info")),
      l = $("player-name", e),
      e = (n.id == x && l.classList.add("me"), r.appendChild(l), r.appendChild($("player-rank", "#" + n.rank)), r.appendChild($("player-score", E("$ points", n.score))), a && r.appendChild($("player-tag", "ADMIN")), n.element.appendChild(r), D(n.element, "click", function() {
        T = n, qe(s, n)
      }), $("player-icons")),
      l = $("icon owner"),
      a = $("icon muted");
    /* TYPOMOD
             desc: set ID to player to identify */
    n.element.setAttribute("playerid", n.id);
    /* TYPOEND */
    return e.appendChild(l), e.appendChild(a), n.element.appendChild(e), n.element.icons = [l, a], Fa(n, n.guessed), t && Ga(), n
  }

  function Ba(e, t) {
    var n, a, o;
    !e.muted && (o = ((a = W(x)).flags & k) == k, n = e.id == M || e.guessed, x == M || a.guessed || !n || o) && (a = (e.flags & k) == k, o = Me, n && (o = Ie), a && (o = Ee), Ua(e, $("text", t)), y(e.name, t, f(o), !1)
      .setAttribute("playerid", e.id))
  }

  function Ua(e, t) {
    e.bubble && (clearTimeout(e.bubble.timeout), e.bubble.remove(), e.bubble = void 0);
    var n = $("player-bubble"),
      a = $("content");
    return a.appendChild(t), n.appendChild($("arrow")), n.appendChild(a), e.element.appendChild(n), e.bubble = n, e.bubble.timeout = setTimeout(function() {
      e.bubble.remove(), e.bubble = void 0
    }, 1500), n
  }

  function Ha(e, t, n) {
    n ? e.element.icons[t].classList.add("visible") : e.element.icons[t].classList.remove("visible")
  }
  var _a = void 0;

  function Ga() {
    L.id, J;
    for (var e = getComputedStyle(Pn).getPropertyValue("--PLAYERS_PER_PAGE"), t = (e <= 0 && (t = Math.max(48, Yn.clientHeight), e = Math.floor(t / 48)), Math.ceil(w.length / e)), n = 0; n < w.length; n++) w[n].page = Math.floor(n / e);
    null == _a ? _a = me(Bn, t, [Yn], function(e, t, n) {
      for (var a = [], o = 0; o < w.length; o++) {
        var r = (i = w[o]).page == t;
        i.element.style.display = r ? "" : "none", r && a.push(i.element)
      }
      if (0 < a.length) {
        for (var i, o = 0; o < a.length; o++)(i = a[o]).classList.remove("first"), i.classList.remove("last"), o % 2 == 0 ? i.classList.remove("odd") : i.classList.add("odd");
        a[0].classList.add("first"), a[a.length - 1].classList.add("last")
      }
    }) : ge(_a, t), _a.element.style.display = 1 < t ? "" : "none"
  }

  function Ka() {
    for (var e = [], t = 0; t < w.length; t++) e.push(w[t]);
    e.sort(function(e, t) {
      return t.score - e.score
    });
    for (var n, a, o = 1, t = 0; t < e.length; t++) {
      var r = e[t];
      a = o, (n = r).rank = a, n.element.querySelector(".player-score").textContent = E("$ points", n.score), (n = n.element.querySelector(".player-rank")).textContent = "#" + a, n.classList.remove("first"), n.classList.remove("second"), n.classList.remove("third"), 1 == a && n.classList.add("first"), 2 == a && n.classList.add("second"), 3 == a && n.classList.add("third"), t < e.length - 1 && r.score > e[t + 1].score && o++
    }
  }

  function Fa(e, t) {
    (e.guessed = t) ? e.element.classList.add("guessed"): e.element.classList.remove("guessed")
  }

  function Va(e, t) {
    e.element.drawing.style.display = t ? "block" : "none"
  }
  for (var ja = [], Za = n.querySelectorAll('*[id^="item-"]'), Xa = 0; Xa < Za.length; Xa++) {
    var Ja = {
      id: Za[Xa].id.replace("item-settings-", ""),
      element: Za[Xa],
      index: Za[Xa].dataset.setting
    };
    Za[Xa].item = Ja, ja.push(Ja), D(Za[Xa].item.element, "change", function() {
      var e = this.value;
      "checkbox" == this.type && (e = this.checked ? 1 : 0), null != this.item.index && ra(this.item.index, e, !0)
    })
  }
  let Qa = 10,
    eo = 4;
  var to = c.querySelector("#game-clock .text"),
    no = null,
    ao = 0;

  function oo() {
    no && (clearInterval(no), no = null)
  }

  function ro(e) {
    ao = e, to.textContent = ao
  }
  var io, lo = (n = c.querySelector("#tutorial")).querySelectorAll(".page"),
    so = me(n.querySelector(".navigation"), lo.length, [n.querySelector(".pages")], function(e, t, n) {
      n && clearInterval(co);
      for (var a = 0; a < lo.length; a++) lo[a].classList.remove("active");
      lo[t].classList.add("active")
    }),
    co = setInterval(function() {
      so.selected < 4 ? fe(so, so.selected + 1, !1) : fe(so, 0, !1)
    }, 3500),
    n = c.querySelector("#game-settings");

  function uo() {
    var e;
    e = h.visualViewport ? h.visualViewport.height : h.innerHeight, "virtualKeyboard" in navigator && (e -= navigator.virtualKeyboard.boundingRect.height), c.documentElement.style.setProperty("--vh", e + "px")
  }

  function ho() {
    uo(), Ga()
  }

  function po() {
    var e = "top" == l.mobileChatLayout;
    On.classList.toggle("mobile-input-top", e)
  }

  function mo(e, t) {
    e = e.querySelector(".characters");
    0 == (e.textContent = t) ? e.classList.remove("visible") : e.classList.add("visible")
  }
  c.querySelector("#audio"), c.querySelector("#lightbulb"), D(n, "click", function() {
    qe(p)
  }), "virtualKeyboard" in navigator && (navigator.virtualKeyboard.overlaysContent = !0, navigator.virtualKeyboard.addEventListener("geometrychange", e => {
    uo()
  })), h.visualViewport ? (D(h.visualViewport, "resize", ho), ae && D(h.visualViewport, "scroll", ho)) : D(h, "resize", ho), h.onunload = function() {
    S && ua()
  }, D(c, "PointerEvent" in h ? "pointerdown" : "click", function(e) {
    if (e.target == m) return xe(), e.preventDefault(), !1;
    Be.elements.main.contains(e.target) ? e.preventDefault() : ("1" == Ye.value && _n[1].blur(), c.querySelector("#game-toolbar .sizes").contains(e.target) || Pt(), e.target != c.querySelector("#game-toolbar .color-preview-mobile") && rt.classList.remove("open"))
  }), D([Kn, Fn], "change", le), D(Vn, "click",
    typo.joinLobby = function() {
      var t, e, n, a, o;
      n = h.location.href,
        typo.lastConnect = Date.now(), o = "", n = n.split("?"), t = o = 1 < n.length ? (o = "" + n[1]).substring(0, a) : o, Nn || (e = "" != t ? "id=" + t : "lang=" + Fn.value, xe(), Jn(!0), ta(function() {
        Qn($n, e, function(e) {
          Jn(!1), e.success && na(e.data, t)
        }, !0)
      }))
    }), D(jn, "click", function() {
    Nn || (xe(), Jn(!0), ta(function() {
      Qn($n, "lang=" + Fn.value, function(e) {
        e.success ? na(e.data, 0, 1) : Jn(!1)
      }, !0)
    }))
  }), D(c.querySelector("#game-rate .like"), "click", function() {
    ca(1)
  }), D(c.querySelector("#game-rate .dislike"), "click", function() {
    ca(0)
  }), D(c.querySelector("#button-start-game"), "click", function() {
    if (S) {
      var e = c.querySelector("#item-settings-customwords").value.split(","),
        t = "";
      if (5 <= e.length) {
        for (var n = 0; n < e.length; n++) e[n] = e[n].trim();
        t = e.join(",")
      }
      S.emit("data", {
        id: 22,
        data: t
      })
    }
  }), D([c.querySelector("#button-invite"), c.querySelector("#modal-player-button-invite")], "click", function() {
    y(E("Copied room link to clipboard!"), "", f(Le), !0);
    var e = "https://skribbl.io/?" + Tn;
    if (navigator.clipboard) navigator.clipboard.writeText(e).then(function() {
      console.log("Async: Copying to clipboard was successful!")
    }, function(e) {
      console.error("Async: Could not copy text: ", e)
    });
    else {
      var t = c.createElement("textarea");
      t.value = e, t.style.top = "0", t.style.left = "0", t.style.position = "fixed", c.body.appendChild(t), t.select(), t.focus();
      try {
        var n = c.execCommand("copy");
        console.log("Copying link was " + (n ? "successful" : "unsuccessful"))
      } catch (e) {
        console.log("Unable to copy link " + e)
      }
      c.body.removeChild(t)
    }
  }), D(g[s].querySelector("button.kick"), "click", function() {
    xe(), null != T && T.id != x && S && S.emit("data", {
      id: 3,
      data: T.id
    })
  }), D(g[s].querySelector("button.ban"), "click", function() {
    xe(), null != T && T.id != x && S && S.emit("data", {
      id: 4,
      data: T.id
    })
  }), D(g[s].querySelector("button.votekick"), "click", function() {
    xe(), null != T && T.id != x && S && (T.id == En ? y(E("You can not votekick the lobby owner!"), "", f(Ee), !0) : S.emit("data", {
      id: ba,
      data: T.id
    }))
  }), D(g[s].querySelector("button.mute"), "click", function() {
    null != T && T.id != x && (T.muted = !T.muted, Ha(T, 1, T.muted), T.muted ? y(E("You muted '$'!", T.name), "", f(Ee), !0) : y(E("You unmuted '$'!", T.name), "", f(Ee), !0), S && S.emit("data", {
      id: 7,
      data: T.id
    }), Ce(T.muted))
  }), D(g[s].querySelector("button.report"), "click", function() {
    g[s].querySelector(".buttons").style.display = "none", g[s].querySelector(".player").style.display = "none", g[s].querySelector(".report-menu").style.display = "";
    for (var e = g[s].querySelectorAll(".report-menu input"), t = 0; t < e.length; t++) e[t].checked = !1
  }), D(g[s].querySelector("button#report-send"), "click", function() {
    var e = 0;
    g[s].querySelector("#report-reason-toxic").checked && (e |= 1), g[s].querySelector("#report-reason-spam").checked && (e |= 2), g[s].querySelector("#report-reason-bot").checked && (e |= 4), 0 < e && (null != T && T.id != x && (T.reported = !0, S && S.emit("data", {
      id: 6,
      data: {
        id: T.id,
        reasons: e
      }
    }), y(E("Your report for '$' has been sent!", T.name), "", f(Le), !0)), xe())
  }), D(g[p].querySelector("#volume input"), "change", function(e) {
    l.volume = e.target.value, R.setVolume(l.volume), R.playSound(xn), le()
  }), D(g[p].querySelector("#select-pressure-sensitivity"), "change", function(e) {
    l.pressureSensitivity = e.target.value, le()
  }), D(g[p].querySelector("#select-mobile-chat-input"), "change", function(e) {
    l.mobileChatLayout = e.target.value, po(), le()
  }), D(g[p].querySelector("#select-chat-bubbles"), "change", function(e) {
    l.chatBubbles = e.target.value, le()
  }), D(g[p].querySelector("button.reset"), "click", function() {
    for (var e = 0; e < u.length; e++) {
      var t = u[e];
      t.key = t.def, t.listing.querySelector("input").value = t.key;
      for (var n = 0; n < t.changed.length; n++) t.changed[n](t)
    }
    ie()
  }), D(_n[1], "focus", function(e) {
    function t(e) {
      h.removeEventListener("scroll", t), h.scroll(0, 0), e.preventDefault()
    }
    uo(), On.classList.add("mobile-input-focus"), ae && (h.addEventListener("scroll", t), setTimeout(function() {
      t(e)
    }, 200), e.preventDefault())
  }), D(_n[1], "blur", function(e) {
    uo(), On.classList.remove("mobile-input-focus")
  }), D(_n, "input", function(e) {
    mo(this.parentNode, this.value.length)
  }), D(Hn, "submit", function(e) {
    const input = this.querySelector("input"); let rest = input.value.substring(100);
    input.value = input.value.substring(0,100);
    if(rest.length > 0) setTimeout(()=>{input.value = rest; this.requestSubmit();},180);
    e.preventDefault();
    var e = this.querySelector("input");
    return e.value && (e = e.value, S && S.connected ? S.emit("data", {
      id: Na,
      data: e
    }) : Ba(W(x), e)), this.reset(), mo(this, 0), !1
  }), uo(), h.localStorageAvailable ? (Kn.value = e("name", ""), Fn.value = (e => {
    for (var t = c.querySelectorAll("#home .panel .container-name-lang select option"), n = 0; n < t.length; n++)
      if (t[n].value == e) return t[n].value;
    return 0
  })(e("lang", 0)), l.displayLang = e("displaylang", "en"), l.volume = parseInt(e("volume", 100)), l.filterChat = 1 == parseInt(e("filter", 1)) ? 1 : 0, l.pressureSensitivity = 1 == parseInt(e("pressure", 1)) ? 1 : 0, l.avatar = (n = "ava", Vn = l.avatar, null == (n = d.getItem(n)) ? Vn : JSON.parse(n)), l.mobileChatLayout = e("mobileChatLayout", "bottom"), l.chatBubbles = e("chatBubbles", 0), Ye.value = e("keyboard", ae ? 1 : 0), ze.value = e("keyboardlayout", "en"), He(), g[p].querySelector("#select-chat-bubbles").value = l.chatBubbles, g[p].querySelector("#select-mobile-chat-input").value = l.mobileChatLayout, g[p].querySelector("#volume input").value = l.volume, R.setVolume(l.volume), po(), console.log("Settings loaded.")) : console.log("Settings not loaded. LocalStorage unavailable.");
  for (var go = c.querySelectorAll("[data-translate]"), fo = 0; fo < go.length; fo++) {
    var yo = go[fo];
    Ve(yo, yo.dataset.translate)
  }
  for (var vo = Ge[l.displayLang], bo = 0; bo < Ke.length; bo++) {
    var So = Ke[bo],
      ko = Fe(vo, So.key);
    "text" == So.type && (So.element.textContent = ko), "placeholder" == So.type && (So.element.placeholder = ko)
  }

  function wo(e) {
    io.parts[e].classList.remove("bounce"), io.parts[e].offsetWidth, io.parts[e].classList.add("bounce")
  }
  D(jn = c.querySelectorAll("[data-tooltip]"), "pointerenter", function(e) {
    We(e.target)
  }), D(jn, "pointerleave", function(e) {
    Oe()
  }), Vn = (Hn = c.querySelector("#home .avatar-customizer")).querySelector(".container"), n = Hn.querySelectorAll(".arrows.left .arrow"), jn = Hn.querySelectorAll(".arrows.right .arrow"), Hn = Hn.querySelectorAll(".randomize"), (io = de(l.avatar)).classList.add("fit"), Vn.appendChild(io), D(n, "click", function() {
    var e = parseInt(this.dataset.avatarIndex);
    --l.avatar[e], l.avatar[e] < 0 && (l.avatar[e] = a[e] - 1), wo(e), ue(io, l.avatar), le()
  }), D(jn, "click", function() {
    var e = parseInt(this.dataset.avatarIndex);
    l.avatar[e] += 1, l.avatar[e] >= a[e] && (l.avatar[e] = 0), wo(e), ue(io, l.avatar), le()
  }), D(Hn, "click", function() {
    l.avatar[0] = Math.floor(Math.random() * a[0]), l.avatar[1] = Math.floor(Math.random() * a[1]), l.avatar[2] = Math.floor(Math.random() * a[2]), wo(1), wo(2), ue(io, l.avatar), le()
  });
  for (var Co = Math.round(8 * Math.random()), qo = c.querySelector("#home .logo-big .avatar-container"), xo = 0; xo < 8; xo++) {
    var Mo = [0, 0, 0, -1],
      Mo = (Mo[0] = xo, Mo[1] = Math.round(100 * Math.random()) % Y, Mo[2] = Math.round(100 * Math.random()) % z, 100 * Math.random() < 1 && (Mo[3] = Math.floor(20 * Math.random())), Zn && 100 * Math.random() < 35 && (Mo[3] = 96 + Math.floor(4 * Math.random())), de(Mo, Co == xo));
    Mo.index = xo, qo.appendChild(Mo), D(Mo, "click", function() {
      var e = [this.index, 0, 0, -1];
      e[1] = Math.round(100 * Math.random()) % Y, e[2] = Math.round(100 * Math.random()) % z, 1e3 * Math.random() < 10 && (e[3] = Math.floor(20 * Math.random())), ue(this, e), this.classList.remove("clicked"), this.offsetWidth, this.classList.add("clicked")
    })
  }
  Xn && (c.documentElement.dataset.halloween = "")
  ;document.dispatchEvent(new Event("skribblInitialized")); document.body.setAttribute("typo-skribbl-loaded", "true");
})(window, document, localStorage, io);`,Pb=class Pb{constructor(){f(this,"_db");f(this,"_profileStore");this._db=gM("skribbl_typo",1,{upgrade:c(e=>{e.createObjectStore("settings"),e.createObjectStore("token"),e.createObjectStore("current_profile"),e.createObjectStore("profiles");},"upgrade")}),this._profileStore=new Cf(this._db,"profiles","current_profile","settings","token");}async getSetting(e){const t=await(await this._db).get("settings",e);return t===void 0?null:t}async writeSetting(e,t){await(await this._db).put("settings",t,e);}async getToken(){const e=await(await this._db).get("token","token");return e===void 0?null:e}async setToken(e){await(await this._db).put("token",e,"token");}getReleaseDetails(){return SM}getPatchUrl(){return URL.createObjectURL(new Blob([AM],{type:"application/javascript"}))}createAndSwitchToProfile(e){return this._profileStore.createAndActivateProfile(e)}currentProfile(){return this._profileStore.getCurrentProfile()}deleteProfile(e){return this._profileStore.deleteProfile(e)}getProfiles(){return this._profileStore.getProfiles()}switchToProfile(e){return this._profileStore.switchToProfile(e)}async resetTypo(){await(await this._db).clear("settings"),await(await this._db).clear("token"),await(await this._db).clear("current_profile"),await(await this._db).clear("profiles");}};c(Pb,"PageRuntime");let Rf=Pb;const Jt=new Rf,Ye=c((r,e=void 0)=>{const t=(e??document).querySelector(r);if(!t)throw new Error(`Required element not found for selector: ${r}`);return t},"requireElement"),kM=c((r,e=void 0)=>{const t=Array.from((e??document).querySelectorAll(r));if(t.length===0)throw new Error(`Required elements not found for selector: ${r}`);return t},"requireElements"),ad=c((r,e=void 0)=>(e??document).querySelector(r),"element$1"),ph=c((r,e=void 0)=>Array.from((e??document).querySelectorAll(r)),"elements");var Lf=c(function(r,e){return Lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n;}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);},Lf(r,e)},"extendStatics");function vr(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Lf(r,e);function t(){this.constructor=r;}c(t,"__"),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t);}c(vr,"__extends");function CM(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o);})}return c(i,"adopt"),new(t||(t=Promise))(function(o,s){function a(d){try{u(n.next(d));}catch(h){s(h);}}c(a,"fulfilled");function l(d){try{u(n.throw(d));}catch(h){s(h);}}c(l,"rejected");function u(d){d.done?o(d.value):i(d.value).then(a,l);}c(u,"step"),u((n=n.apply(r,e||[])).next());})}c(CM,"__awaiter$4");function FT(r,e){var t={label:0,sent:c(function(){if(o[0]&1)throw o[1];return o[1]},"sent"),trys:[],ops:[]},n,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t);}catch(d){u=[6,d],i=0;}finally{n=o=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}}c(FT,"__generator$4");function eo(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return {next:c(function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}},"next")};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}c(eo,"__values");function ii(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value);}catch(a){s={error:a};}finally{try{i&&!i.done&&(t=n.return)&&t.call(n);}finally{if(s)throw s.error}}return o}c(ii,"__read");function ri(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))}c(ri,"__spreadArray$3");function ts(r){return this instanceof ts?(this.v=r,this):new ts(r)}c(ts,"__await");function IM(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(m){return function(b){return Promise.resolve(b).then(m,h)}}function a(m,b){n[m]&&(i[m]=function(y){return new Promise(function(w,I){o.push([m,y,w,I])>1||l(m,y);})},b&&(i[m]=b(i[m])));}function l(m,b){try{u(n[m](b));}catch(y){p(o[0][3],y);}}function u(m){m.value instanceof ts?Promise.resolve(m.value.v).then(d,h):p(o[0][2],m);}function d(m){l("next",m);}function h(m){l("throw",m);}function p(m,b){m(b),o.shift(),o.length&&l(o[0][0],o[0][1]);}}c(IM,"__asyncGenerator");function TM(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof eo=="function"?eo(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,l){s=r[o](s),i(a,l,s.done,s.value);})};}function i(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a});},s);}}c(TM,"__asyncValues");function Ht(r){return typeof r=="function"}c(Ht,"isFunction");function mh(r){var e=c(function(n){Error.call(n),n.stack=new Error().stack;},"_super"),t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}c(mh,"createErrorClass");var pf=mh(function(r){return c(function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t;},"UnsubscriptionErrorImpl")});function gc(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1);}}c(gc,"arrRemove");var Nl=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null;}return c(r,"Subscription"),r.prototype.unsubscribe=function(){var e,t,n,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=eo(s),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this);}}catch(y){e={error:y};}finally{try{l&&!l.done&&(t=a.return)&&t.call(a);}finally{if(e)throw e.error}}else s.remove(this);var d=this.initialTeardown;if(Ht(d))try{d();}catch(y){o=y instanceof pf?y.errors:[y];}var h=this._finalizers;if(h){this._finalizers=null;try{for(var p=eo(h),m=p.next();!m.done;m=p.next()){var b=m.value;try{JS(b);}catch(y){o=o??[],y instanceof pf?o=ri(ri([],ii(o)),ii(y.errors)):o.push(y);}}}catch(y){n={error:y};}finally{try{m&&!m.done&&(i=p.return)&&i.call(p);}finally{if(n)throw n.error}}}if(o)throw new pf(o)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)JS(e);else {if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this);}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e);}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e;},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&gc(t,e);},r.prototype.remove=function(e){var t=this._finalizers;t&&gc(t,e),e instanceof r&&e._removeParent(this);},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),WT=Nl.EMPTY;function HT(r){return r instanceof Nl||r&&"closed"in r&&Ht(r.remove)&&Ht(r.add)&&Ht(r.unsubscribe)}c(HT,"isSubscription");function JS(r){Ht(r)?r():r.unsubscribe();}c(JS,"execFinalizer");var QT={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},XT={setTimeout:c(function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,ri([r,e],ii(t)))},"setTimeout"),clearTimeout:c(function(r){var e=XT.delegate;return ((e==null?void 0:e.clearTimeout)||clearTimeout)(r)},"clearTimeout"),delegate:void 0};function qT(r){XT.setTimeout(function(){throw r});}c(qT,"reportUnhandledError");function bc(){}c(bc,"noop$1");function ed(r){r();}c(ed,"errorContext");var Wg=function(r){vr(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,HT(t)&&t.add(n)):n.destination=RM,n}return c(e,"Subscriber"),e.create=function(t,n,i){return new ld(t,n,i)},e.prototype.next=function(t){this.isStopped||this._next(t);},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t));},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete());},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null);},e.prototype._next=function(t){this.destination.next(t);},e.prototype._error=function(t){try{this.destination.error(t);}finally{this.unsubscribe();}},e.prototype._complete=function(){try{this.destination.complete();}finally{this.unsubscribe();}},e}(Nl),DM=Function.prototype.bind;function mf(r,e){return DM.call(r,e)}c(mf,"bind$1");var EM=function(){function r(e){this.partialObserver=e;}return c(r,"ConsumerObserver"),r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e);}catch(n){Wu(n);}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e);}catch(n){Wu(n);}else Wu(e);},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete();}catch(t){Wu(t);}},r}(),ld=function(r){vr(e,r);function e(t,n,i){var o=r.call(this)||this,s;if(Ht(t)||!t)s={next:t??void 0,error:n??void 0,complete:i??void 0};else {var a;o&&QT.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return o.unsubscribe()},s={next:t.next&&mf(t.next,a),error:t.error&&mf(t.error,a),complete:t.complete&&mf(t.complete,a)}):s=t;}return o.destination=new EM(s),o}return c(e,"SafeSubscriber"),e}(Wg);function Wu(r){qT(r);}c(Wu,"handleUnhandledError");function MM(r){throw r}c(MM,"defaultErrorHandler");var RM={closed:!0,next:bc,error:MM,complete:bc},Hg=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ko(r){return r}c(ko,"identity");function LM(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return KT(r)}c(LM,"pipe");function KT(r){return r.length===0?ko:r.length===1?r[0]:c(function(t){return r.reduce(function(n,i){return i(n)},t)},"piped")}c(KT,"pipeFromArray");var In=function(){function r(e){e&&(this._subscribe=e);}return c(r,"Observable"),r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var i=this,o=NM(e)?e:new ld(e,t,n);return ed(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o));}),o},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t);}},r.prototype.forEach=function(e,t){var n=this;return t=FS(t),new t(function(i,o){var s=new ld({next:c(function(a){try{e(a);}catch(l){o(l),s.unsubscribe();}},"next"),error:o,complete:i});n.subscribe(s);})},r.prototype._subscribe=function(e){var t;return (t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[Hg]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return KT(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=FS(e),new e(function(n,i){var o;t.subscribe(function(s){return o=s},function(s){return i(s)},function(){return n(o)});})},r.create=function(e){return new r(e)},r}();function FS(r){var e;return (e=r??QT.Promise)!==null&&e!==void 0?e:Promise}c(FS,"getPromiseCtor");function PM(r){return r&&Ht(r.next)&&Ht(r.error)&&Ht(r.complete)}c(PM,"isObserver");function NM(r){return r&&r instanceof Wg||PM(r)&&HT(r)}c(NM,"isSubscriber");function OM(r){return Ht(r==null?void 0:r.lift)}c(OM,"hasLift");function jt(r){return function(e){if(OM(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n);}});throw new TypeError("Unable to lift unknown Observable type")}}c(jt,"operate");function kt(r,e,t,n,i){return new jM(r,e,t,n,i)}c(kt,"createOperatorSubscriber");var jM=function(r){vr(e,r);function e(t,n,i,o,s,a){var l=r.call(this,t)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=n?function(u){try{n(u);}catch(d){t.error(d);}}:r.prototype._next,l._error=o?function(u){try{o(u);}catch(d){t.error(d);}finally{this.unsubscribe();}}:r.prototype._error,l._complete=i?function(){try{i();}catch(u){t.error(u);}finally{this.unsubscribe();}}:r.prototype._complete,l}return c(e,"OperatorSubscriber"),e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this));}},e}(Wg),GM=mh(function(r){return c(function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed";},"ObjectUnsubscribedErrorImpl")}),be=function(r){vr(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return c(e,"Subject"),e.prototype.lift=function(t){var n=new WS(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new GM},e.prototype.next=function(t){var n=this;ed(function(){var i,o;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var s=eo(n.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(t);}}catch(u){i={error:u};}finally{try{a&&!a.done&&(o=s.return)&&o.call(s);}finally{if(i)throw i.error}}}});},e.prototype.error=function(t){var n=this;ed(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var i=n.observers;i.length;)i.shift().error(t);}});},e.prototype.complete=function(){var t=this;ed(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete();}});},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null;},Object.defineProperty(e.prototype,"observed",{get:c(function(){var t;return ((t=this.observers)===null||t===void 0?void 0:t.length)>0},"get"),enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?WT:(this.currentObservers=null,a.push(t),new Nl(function(){n.currentObservers=null,gc(a,t);}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,i=n.hasError,o=n.thrownError,s=n.isStopped;i?t.error(o):s&&t.complete();},e.prototype.asObservable=function(){var t=new In;return t.source=this,t},e.create=function(t,n){return new WS(t,n)},e}(In),WS=function(r){vr(e,r);function e(t,n){var i=r.call(this)||this;return i.destination=t,i.source=n,i}return c(e,"AnonymousSubject"),e.prototype.next=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,t);},e.prototype.error=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,t);},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t);},e.prototype._subscribe=function(t){var n,i;return (i=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&i!==void 0?i:WT},e}(be),Le=function(r){vr(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return c(e,"BehaviorSubject"),Object.defineProperty(e.prototype,"value",{get:c(function(){return this.getValue()},"get"),enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return !n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,i=t.thrownError,o=t._value;if(n)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t);},e}(be),$M={now:c(function(){return Date.now()},"now"),delegate:void 0},YM=function(r){vr(e,r);function e(t,n){return r.call(this)||this}return c(e,"Action"),e.prototype.schedule=function(t,n){return this},e}(Nl),HS={setInterval:c(function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setInterval.apply(void 0,ri([r,e],ii(t)))},"setInterval"),clearInterval:c(function(r){return clearInterval(r)},"clearInterval"),delegate:void 0},zM=function(r){vr(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return c(e,"AsyncAction"),e.prototype.schedule=function(t,n){var i;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var o=this.id,s=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(s,o,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(s,this.id,n),this},e.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),HS.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,n,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&HS.clearInterval(n);},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null));},e.prototype._execute=function(t,n){var i=!1,o;try{this.work(t);}catch(s){i=!0,o=s||new Error("Scheduled action threw falsy error");}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,i=t.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,gc(o,this),n!=null&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,r.prototype.unsubscribe.call(this);}},e}(YM),QS=function(){function r(e,t){t===void 0&&(t=r.now),this.schedulerActionCtor=e,this.now=t;}return c(r,"Scheduler"),r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},r.now=$M.now,r}(),UM=function(r){vr(e,r);function e(t,n){n===void 0&&(n=QS.now);var i=r.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return c(e,"AsyncScheduler"),e.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}},e}(QS),Ol=new UM(zM),BM=Ol,Qg=new In(function(r){return r.complete()});function eD(r){return r&&Ht(r.schedule)}c(eD,"isScheduler");function Xg(r){return r[r.length-1]}c(Xg,"last");function gh(r){return Ht(Xg(r))?r.pop():void 0}c(gh,"popResultSelector");function Co(r){return eD(Xg(r))?r.pop():void 0}c(Co,"popScheduler");function tD(r,e){return typeof Xg(r)=="number"?r.pop():e}c(tD,"popNumber");var nD=c(function(r){return r&&typeof r.length=="number"&&typeof r!="function"},"isArrayLike");function iD(r){return Ht(r==null?void 0:r.then)}c(iD,"isPromise$1");function rD(r){return Ht(r[Hg])}c(rD,"isInteropObservable");function oD(r){return Symbol.asyncIterator&&Ht(r==null?void 0:r[Symbol.asyncIterator])}c(oD,"isAsyncIterable");function sD(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}c(sD,"createInvalidObservableTypeError");function xM(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}c(xM,"getSymbolIterator");var aD=xM();function lD(r){return Ht(r==null?void 0:r[aD])}c(lD,"isIterable");function cD(r){return IM(this,arguments,c(function(){var t,n,i,o;return FT(this,function(s){switch(s.label){case 0:t=r.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return [4,ts(t.read())];case 3:return n=s.sent(),i=n.value,o=n.done,o?[4,ts(void 0)]:[3,5];case 4:return [2,s.sent()];case 5:return [4,ts(i)];case 6:return [4,s.sent()];case 7:return s.sent(),[3,2];case 8:return [3,10];case 9:return t.releaseLock(),[7];case 10:return [2]}})},"readableStreamLikeToAsyncGenerator_1"))}c(cD,"readableStreamLikeToAsyncGenerator");function uD(r){return Ht(r==null?void 0:r.getReader)}c(uD,"isReadableStreamLike");function kn(r){if(r instanceof In)return r;if(r!=null){if(rD(r))return ZM(r);if(nD(r))return VM(r);if(iD(r))return Ri(r);if(oD(r))return dD(r);if(lD(r))return JM(r);if(uD(r))return FM(r)}throw sD(r)}c(kn,"innerFrom");function ZM(r){return new In(function(e){var t=r[Hg]();if(Ht(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}c(ZM,"fromInteropObservable");function VM(r){return new In(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete();})}c(VM,"fromArrayLike");function Ri(r){return new In(function(e){r.then(function(t){e.closed||(e.next(t),e.complete());},function(t){return e.error(t)}).then(null,qT);})}c(Ri,"fromPromise");function JM(r){return new In(function(e){var t,n;try{for(var i=eo(r),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){t={error:a};}finally{try{o&&!o.done&&(n=i.return)&&n.call(i);}finally{if(t)throw t.error}}e.complete();})}c(JM,"fromIterable");function dD(r){return new In(function(e){WM(r,e).catch(function(t){return e.error(t)});})}c(dD,"fromAsyncIterable");function FM(r){return dD(cD(r))}c(FM,"fromReadableStreamLike");function WM(r,e){var t,n,i,o;return CM(this,void 0,void 0,function(){var s,a;return FT(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=TM(r),l.label=1;case 1:return [4,t.next()];case 2:if(n=l.sent(),!!n.done)return [3,4];if(s=n.value,e.next(s),e.closed)return [2];l.label=3;case 3:return [3,1];case 4:return [3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return [3,10];case 9:if(i)throw i.error;return [7];case 10:return [7];case 11:return e.complete(),[2]}})})}c(WM,"process$1");function fi(r,e,t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var o=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe();},n);if(r.add(o),!i)return o}c(fi,"executeSchedule");function hD(r,e){return e===void 0&&(e=0),jt(function(t,n){t.subscribe(kt(n,function(i){return fi(n,r,function(){return n.next(i)},e)},function(){return fi(n,r,function(){return n.complete()},e)},function(i){return fi(n,r,function(){return n.error(i)},e)}));})}c(hD,"observeOn");function fD(r,e){return e===void 0&&(e=0),jt(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e));})}c(fD,"subscribeOn");function HM(r,e){return kn(r).pipe(fD(e),hD(e))}c(HM,"scheduleObservable");function QM(r,e){return kn(r).pipe(fD(e),hD(e))}c(QM,"schedulePromise");function XM(r,e){return new In(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule());})})}c(XM,"scheduleArray");function qM(r,e){return new In(function(t){var n;return fi(t,e,function(){n=r[aD](),fi(t,e,function(){var i,o,s;try{i=n.next(),o=i.value,s=i.done;}catch(a){t.error(a);return}s?t.complete():t.next(o);},0,!0);}),function(){return Ht(n==null?void 0:n.return)&&n.return()}})}c(qM,"scheduleIterable");function pD(r,e){if(!r)throw new Error("Iterable cannot be null");return new In(function(t){fi(t,e,function(){var n=r[Symbol.asyncIterator]();fi(t,e,function(){n.next().then(function(i){i.done?t.complete():t.next(i.value);});},0,!0);});})}c(pD,"scheduleAsyncIterable");function KM(r,e){return pD(cD(r),e)}c(KM,"scheduleReadableStreamLike");function eR(r,e){if(r!=null){if(rD(r))return HM(r,e);if(nD(r))return XM(r,e);if(iD(r))return QM(r,e);if(oD(r))return pD(r,e);if(lD(r))return qM(r,e);if(uD(r))return KM(r,e)}throw sD(r)}c(eR,"scheduled");function ji(r,e){return e?eR(r,e):kn(r)}c(ji,"from");function Tt(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Co(r);return ji(r,t)}c(Tt,"of");var tR=mh(function(r){return c(function(){r(this),this.name="EmptyError",this.message="no elements in sequence";},"EmptyErrorImpl")});function Ee(r,e){return new Promise(function(t,n){var i=new ld({next:c(function(o){t(o),i.unsubscribe();},"next"),error:n,complete:c(function(){n(new tR);},"complete")});r.subscribe(i);})}c(Ee,"firstValueFrom");function mD(r){return r instanceof Date&&!isNaN(r)}c(mD,"isValidDate");var nR=mh(function(r){return c(function(t){t===void 0&&(t=null),r(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t;},"TimeoutErrorImpl")});function gD(r,e){var t=mD(r)?{first:r}:typeof r=="number"?{each:r}:r,n=t.first,i=t.each,o=t.with,s=o===void 0?iR:o,a=t.scheduler,l=a===void 0?Ol:a,u=t.meta,d=u===void 0?null:u;if(n==null&&i==null)throw new TypeError("No timeout provided.");return jt(function(h,p){var m,b,y=null,w=0,I=c(function(S){b=fi(p,l,function(){try{m.unsubscribe(),kn(s({meta:d,lastValue:y,seen:w})).subscribe(p);}catch(R){p.error(R);}},S);},"startTimer");m=h.subscribe(kt(p,function(S){b==null||b.unsubscribe(),w++,p.next(y=S),i>0&&I(i);},void 0,void 0,function(){b!=null&&b.closed||b==null||b.unsubscribe(),y=null;})),!w&&I(n!=null?typeof n=="number"?n:+n-l.now():i);})}c(gD,"timeout");function iR(r){throw new nR(r)}c(iR,"timeoutErrorFactory");function ce(r,e){return jt(function(t,n){var i=0;t.subscribe(kt(n,function(o){n.next(r.call(e,o,i++));}));})}c(ce,"map");var rR=Array.isArray;function oR(r,e){return rR(e)?r.apply(void 0,ri([],ii(e))):r(e)}c(oR,"callOrApply");function qg(r){return ce(function(e){return oR(r,e)})}c(qg,"mapOneOrManyArgs");var sR=Array.isArray,aR=Object.getPrototypeOf,lR=Object.prototype,cR=Object.keys;function bD(r){if(r.length===1){var e=r[0];if(sR(e))return {args:e,keys:null};if(uR(e)){var t=cR(e);return {args:t.map(function(n){return e[n]}),keys:t}}}return {args:r,keys:null}}c(bD,"argsArgArrayOrObject");function uR(r){return r&&typeof r=="object"&&aR(r)===lR}c(uR,"isPOJO");function vD(r,e){return r.reduce(function(t,n,i){return t[n]=e[i],t},{})}c(vD,"createObject");function Hr(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Co(r),n=gh(r),i=bD(r),o=i.args,s=i.keys;if(o.length===0)return ji([],t);var a=new In(_D(o,t,s?function(l){return vD(s,l)}:ko));return n?a.pipe(qg(n)):a}c(Hr,"combineLatest$1");function _D(r,e,t){return t===void 0&&(t=ko),function(n){XS(e,function(){for(var i=r.length,o=new Array(i),s=i,a=i,l=c(function(d){XS(e,function(){var h=ji(r[d],e),p=!1;h.subscribe(kt(n,function(m){o[d]=m,p||(p=!0,a--),a||n.next(t(o.slice()));},function(){--s||n.complete();}));},n);},"_loop_1"),u=0;u<i;u++)l(u);},n);}}c(_D,"combineLatestInit");function XS(r,e,t){r?fi(t,r,e):e();}c(XS,"maybeSchedule");function dR(r,e,t,n,i,o,s,a){var l=[],u=0,d=0,h=!1,p=c(function(){h&&!l.length&&!u&&e.complete();},"checkComplete"),m=c(function(y){return u<n?b(y):l.push(y)},"outerNext"),b=c(function(y){u++;var w=!1;kn(t(y,d++)).subscribe(kt(e,function(I){e.next(I);},function(){w=!0;},void 0,function(){if(w)try{u--;for(var I=c(function(){var S=l.shift();s||b(S);},"_loop_1");l.length&&u<n;)I();p();}catch(S){e.error(S);}}));},"doInnerSub");return r.subscribe(kt(e,m,function(){h=!0,p();})),function(){}}c(dR,"mergeInternals");function Ba(r,e,t){return t===void 0&&(t=1/0),Ht(e)?Ba(function(n,i){return ce(function(o,s){return e(n,o,i,s)})(kn(r(n,i)))},t):(typeof e=="number"&&(t=e),jt(function(n,i){return dR(n,i,r,t)}))}c(Ba,"mergeMap");function Kg(r){return r===void 0&&(r=1/0),Ba(ko,r)}c(Kg,"mergeAll");function hR(){return Kg(1)}c(hR,"concatAll");function qS(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return hR()(ji(r,Co(r)))}c(qS,"concat");function yD(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=gh(r),n=bD(r),i=n.args,o=n.keys,s=new In(function(a){var l=i.length;if(!l){a.complete();return}for(var u=new Array(l),d=l,h=l,p=c(function(b){var y=!1;kn(i[b]).subscribe(kt(a,function(w){y||(y=!0,h--),u[b]=w;},function(){return d--},void 0,function(){(!d||!y)&&(h||a.next(o?vD(o,u):u),a.complete());}));},"_loop_1"),m=0;m<l;m++)p(m);});return t?s.pipe(qg(t)):s}c(yD,"forkJoin");function vc(r,e,t){r===void 0&&(r=0),t===void 0&&(t=BM);var n=-1;return e!=null&&(eD(e)?t=e:n=e),new In(function(i){var o=mD(r)?+r-t.now():r;o<0&&(o=0);var s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=n?this.schedule(void 0,n):i.complete());},o)})}c(vc,"timer");function wD(r,e){return r===void 0&&(r=0),e===void 0&&(e=Ol),r<0&&(r=0),vc(r,r,e)}c(wD,"interval");function _c(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Co(r),n=tD(r,1/0),i=r;return i.length?i.length===1?kn(i[0]):Kg(n)(ji(i,t)):Qg}c(_c,"merge$1");var fR=Array.isArray;function SD(r){return r.length===1&&fR(r[0])?r[0]:r}c(SD,"argsOrArgArray");function Se(r,e){return jt(function(t,n){var i=0;t.subscribe(kt(n,function(o){return r.call(e,o,i++)&&n.next(o)}));})}c(Se,"filter");function pR(r){for(var e,t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=(e=Co(n))!==null&&e!==void 0?e:Ol,s=(t=n[0])!==null&&t!==void 0?t:null,a=n[1]||1/0;return jt(function(l,u){var d=[],h=!1,p=c(function(y){var w=y.buffer,I=y.subs;I.unsubscribe(),gc(d,y),u.next(w),h&&m();},"emit"),m=c(function(){if(d){var y=new Nl;u.add(y);var w=[],I={buffer:w,subs:y};d.push(I),fi(y,o,function(){return p(I)},r);}},"startBuffer");s!==null&&s>=0?fi(u,o,m,s,!0):h=!0,m();var b=kt(u,function(y){var w,I,S=d.slice();try{for(var R=eo(S),E=R.next();!E.done;E=R.next()){var P=E.value,L=P.buffer;L.push(y),a<=L.length&&p(P);}}catch(O){w={error:O};}finally{try{E&&!E.done&&(I=R.return)&&I.call(R);}finally{if(w)throw w.error}}},function(){for(;d!=null&&d.length;)u.next(d.shift().buffer);b==null||b.unsubscribe(),u.complete(),u.unsubscribe();},void 0,function(){return d=null});l.subscribe(b);})}c(pR,"bufferTime");function Qo(r){return jt(function(e,t){var n=null,i=!1,o;n=e.subscribe(kt(t,void 0,void 0,function(s){o=kn(r(s,Qo(r)(e))),n?(n.unsubscribe(),n=null,o.subscribe(t)):i=!0;})),i&&(n.unsubscribe(),n=null,o.subscribe(t));})}c(Qo,"catchError");function AD(r,e,t,n,i){return function(o,s){var a=t,l=e,u=0;o.subscribe(kt(s,function(d){var h=u++;l=a?r(l,d,h):(a=!0,d),n&&s.next(l);},i&&function(){a&&s.next(l),s.complete();}));}}c(AD,"scanInternals");function kD(r,e){return jt(AD(r,e,arguments.length>=2,!1,!0))}c(kD,"reduce");function CD(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=gh(r);return t?LM(CD.apply(void 0,ri([],ii(r))),qg(t)):jt(function(n,i){_D(ri([n],ii(SD(r))))(i);})}c(CD,"combineLatest");function Qe(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return CD.apply(void 0,ri([],ii(r)))}c(Qe,"combineLatestWith");function mR(r,e){return Ht(e)?Ba(r,e,1):Ba(r,1)}c(mR,"concatMap");function gf(r){return kD(function(e,t,n){return e+1},0)}c(gf,"count");function Pf(r){return jt(function(e,t){var n=!1,i=null,o=null,s=c(function(){if(o==null||o.unsubscribe(),o=null,n){n=!1;var a=i;i=null,t.next(a);}},"emit");e.subscribe(kt(t,function(a){o==null||o.unsubscribe(),n=!0,i=a,o=kt(t,s,bc),kn(r(a)).subscribe(o);},function(){s(),t.complete();},void 0,function(){i=o=null;}));})}c(Pf,"debounce");function xa(r,e){return e===void 0&&(e=Ol),jt(function(t,n){var i=null,o=null,s=null,a=c(function(){if(i){i.unsubscribe(),i=null;var u=o;o=null,n.next(u);}},"emit");function l(){var u=s+r,d=e.now();if(d<u){i=this.schedule(void 0,u-d),n.add(i);return}a();}c(l,"emitWhenIdle"),t.subscribe(kt(n,function(u){o=u,s=e.now(),i||(i=e.schedule(l,r),n.add(i));},function(){a(),n.complete();},void 0,function(){o=i=null;}));})}c(xa,"debounceTime");function vt(r){return r<=0?function(){return Qg}:jt(function(e,t){var n=0;e.subscribe(kt(t,function(i){++n<=r&&(t.next(i),r<=n&&t.complete());}));})}c(vt,"take");function gR(r){return ce(function(){return r})}c(gR,"mapTo");function bR(r,e){return Ba(function(t,n){return kn(r(t,n)).pipe(vt(1),gR(t))})}c(bR,"delayWhen");function jl(r,e){e===void 0&&(e=Ol);var t=vc(r,e);return bR(function(){return t})}c(jl,"delay");function ct(r,e){return e===void 0&&(e=ko),r=r??vR,jt(function(t,n){var i,o=!0;t.subscribe(kt(n,function(s){var a=e(s);(o||!r(i,a))&&(o=!1,i=a,n.next(s));}));})}c(ct,"distinctUntilChanged");function vR(r,e){return r===e}c(vR,"defaultCompare");function ID(r,e){return jt(function(t,n){var i=0,o=null,s=!1;t.subscribe(kt(n,function(a){o||(o=kt(n,void 0,function(){o=null,s&&n.complete();}),kn(r(a,i++)).subscribe(o));},function(){s=!0,!o&&n.complete();}));})}c(ID,"exhaustMap");function _R(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Co(r),n=tD(r,1/0);return r=SD(r),jt(function(i,o){Kg(n)(ji(ri([i],ii(r)),t)).subscribe(o);})}c(_R,"merge");function Kt(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return _R.apply(void 0,ri([],ii(r)))}c(Kt,"mergeWith");function Cr(){return jt(function(r,e){var t,n=!1;r.subscribe(kt(e,function(i){var o=t;t=i,n&&e.next([o,i]),n=!0;}));})}c(Cr,"pairwise");function yR(r){var e,t=1/0,n;return r!=null&&(typeof r=="object"?(e=r.count,t=e===void 0?1/0:e,n=r.delay):t=r),t<=0?function(){return Qg}:jt(function(i,o){var s=0,a,l=c(function(){if(a==null||a.unsubscribe(),a=null,n!=null){var d=typeof n=="number"?vc(n):kn(n(s)),h=kt(o,function(){h.unsubscribe(),u();});d.subscribe(h);}else u();},"resubscribe"),u=c(function(){var d=!1;a=i.subscribe(kt(o,void 0,function(){++s<t?a?l():d=!0:o.complete();})),d&&l();},"subscribeToSource");u();})}c(yR,"repeat");function bh(r,e){return jt(AD(r,e,arguments.length>=2,!0))}c(bh,"scan");function wR(r){return Se(function(e,t){return r<=t})}c(wR,"skip");function lr(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Co(r);return jt(function(n,i){(t?qS(r,n,t):qS(r,n)).subscribe(i);})}c(lr,"startWith");function lt(r,e){return jt(function(t,n){var i=null,o=0,s=!1,a=c(function(){return s&&!i&&n.complete()},"checkComplete");t.subscribe(kt(n,function(l){i==null||i.unsubscribe();var u=0,d=o++;kn(r(l,d)).subscribe(i=kt(n,function(h){return n.next(e?e(l,h,d,u++):h)},function(){i=null,a();}));},function(){s=!0,a();}));})}c(lt,"switchMap");function Wo(r){return jt(function(e,t){kn(r).subscribe(kt(t,function(){return t.complete()},bc)),!t.closed&&e.subscribe(t);})}c(Wo,"takeUntil");function _t(r,e,t){var n=Ht(r)||e||t?{next:r,error:e,complete:t}:r;return n?jt(function(i,o){var s;(s=n.subscribe)===null||s===void 0||s.call(n);var a=!0;i.subscribe(kt(o,function(l){var u;(u=n.next)===null||u===void 0||u.call(n,l),o.next(l);},function(){var l;a=!1,(l=n.complete)===null||l===void 0||l.call(n),o.complete();},function(l){var u;a=!1,(u=n.error)===null||u===void 0||u.call(n,l),o.error(l);},function(){var l,u;a&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(u=n.finalize)===null||u===void 0||u.call(n);}));}):ko}c(_t,"tap");function Oe(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=gh(r);return jt(function(n,i){for(var o=r.length,s=new Array(o),a=r.map(function(){return !1}),l=!1,u=c(function(h){kn(r[h]).subscribe(kt(i,function(p){s[h]=p,!l&&!a[h]&&(a[h]=!0,(l=a.every(ko))&&(a=null));},bc));},"_loop_1"),d=0;d<o;d++)u(d);n.subscribe(kt(i,function(h){if(l){var p=ri([h],ii(s));i.next(t?t.apply(void 0,ri([],ii(p))):p);}}));})}c(Oe,"withLatestFrom");const Nb=class Nb{constructor(e=!1){f(this,"_typoBodyLoaded$",new Le(!1));f(this,"_canvasFound$",new Le(!1));f(this,"_chatboxFound$",new Le(!1));f(this,"_contentScriptLoaded$",new Le(!1));f(this,"_patchLoaded$",new Le(!1));f(this,"_canvasPrioritizedEventsReady$",new Le(void 0));f(this,"_chatboxPrioritizedEventsReady$",new Le(void 0));f(this,"_canvasEventListener",new Map);f(this,"_chatboxEventListener",new Map);f(this,"_canvasPrioritizedEventsReady",Ee(this._canvasPrioritizedEventsReady$.pipe(Se(e=>e!==void 0))));f(this,"_chatboxPrioritizedEventsReady",Ee(this._chatboxPrioritizedEventsReady$.pipe(Se(e=>e!==void 0))));this._debuggingEnabled=e,this._typoBodyLoaded$.pipe(Se(t=>t),_t(()=>this.listenForCanvas()),_t(()=>this.listenForChatbox()),Qe(this._canvasFound$,this._chatboxFound$,this._contentScriptLoaded$),Se(([,t,n])=>t&&n)).subscribe(()=>{this.debug("All prerequisites executed, injecting patch and listening to events"),this.listenPrioritizedCanvasEvents(),this.listenPrioritizedChatboxEvents(),this.injectPatch();}),this.debug("Interceptor initialized, starting listeners for token and game.js"),this.waitForTypoLoadedBody(),this.patchLoaded$.subscribe(()=>{document.body.dataset.typo_loaded="true";});}debug(...e){this._debuggingEnabled&&console.log("[INTERCEPTOR DEBUG]",...e);}injectPatch(){this.debug("Injecting game patch");const e=document.createElement("script");e.src=Jt.getPatchUrl(),e.onload=async()=>{this.debug("Game patch loaded"),this._patchLoaded$.next(!0),this._patchLoaded$.complete();},document.body.appendChild(e);}waitForTypoLoadedBody(){if(this.debug("Listening for body from typo loader"),document.body.dataset.typo_loader==="true"){this.debug("Body already loaded"),this._typoBodyLoaded$.next(!0),this._typoBodyLoaded$.complete();return}const e=new MutationObserver(()=>{document.body.dataset.typo_loader==="true"&&(this.debug("Typo body loaded"),this._typoBodyLoaded$.next(!0),this._typoBodyLoaded$.complete(),e.disconnect());});e.observe(document,{childList:!0,subtree:!0});}listenForChatbox(){if(this.debug("Listening for chatbox"),ad("#game-chat .chat-form > input")){this.debug("Chatbox already present"),this._chatboxFound$.next(!0),this._chatboxFound$.complete();return}new MutationObserver(t=>{t.forEach(n=>{n.type==="childList"&&[...n.addedNodes].find(o=>{var s,a,l;return o.nodeName==="INPUT"&&((s=o.parentElement)==null?void 0:s.classList.contains("chat-form"))&&((l=(a=o.parentElement)==null?void 0:a.parentElement)==null?void 0:l.id)==="game-chat"})&&(this.debug("Chatbox found"),this._chatboxFound$.next(!0),this._chatboxFound$.complete());});}).observe(document.body,{childList:!0,subtree:!0});}listenPrioritizedChatboxEvents(){const e=Ye("#game-chat .chat-form > input"),t=c((i,o)=>{const s=this._chatboxEventListener.get(i);s===void 0?this._chatboxEventListener.set(i,new Set([o])):s.add(o);},"addListener"),n=c((i,o)=>{const s=this._chatboxEventListener.get(i);s!==void 0&&s.delete(o);},"removeListener");for(const i in e)if(/^on/.test(i)){const o=i.slice(2);e.addEventListener(o,s=>{const a=this._chatboxEventListener.get(o);if(a!==void 0){for(const l of a)if(l(s)===!1){s.stopImmediatePropagation();return}}});}this._chatboxPrioritizedEventsReady$.next({add:t,remove:n});}listenForCanvas(){if(this.debug("Listening on DOM buildup until canvas element is added"),ad("#game-canvas > canvas")){this.debug("Canvas already present"),this._canvasFound$.next(!0),this._canvasFound$.complete();return}new MutationObserver(t=>{t.forEach(n=>{n.type==="childList"&&[...n.addedNodes].find(o=>{var s;return o.nodeName==="CANVAS"&&((s=o.parentElement)==null?void 0:s.id)==="game-canvas"})&&(this.debug("Canvas found"),this._canvasFound$.next(!0),this._canvasFound$.complete());});}).observe(document.body,{childList:!0,subtree:!0});}listenPrioritizedCanvasEvents(){const e=c(i=>(o,s)=>{const a=this._canvasEventListener.get(o);if(a===void 0)this._canvasEventListener.set(o,new Map([[i,new Set([{priority:i,handler:s}])]]));else {const l=a.get(i);l===void 0?a.set(i,new Set([{priority:i,handler:s}])):l.add({priority:i,handler:s});}},"addListener"),t=c((i,o)=>{const s=this._canvasEventListener.get(i);if(s!==void 0)for(const a of s.values())for(const l of a)l.handler===o&&a.delete(l);},"removeListener"),n=Ye("#game-canvas > canvas");for(const i in n)if(/^on/.test(i)){const o=i.slice(2);n.addEventListener(o,s=>{const a=this._canvasEventListener.get(o);if(a===void 0)return;const l=[...a.get("preDraw")??[],...a.get("draw")??[],...a.get("postDraw")??[]];for(const u of l)if(u.handler(s)===!1){s.stopImmediatePropagation();return}});}this._canvasPrioritizedEventsReady$.next({add:e,remove:t});}triggerPatchInjection(){if(this._contentScriptLoaded$.closed)throw new Error("Already triggered patch injection");this.debug("Content script loaded, triggering patch injection"),this._contentScriptLoaded$.next(!0),this._contentScriptLoaded$.complete();}enableDebugging(){this._debuggingEnabled=!0;}get patchLoaded$(){return this._patchLoaded$.pipe(Se(e=>e),ce(()=>{}))}get canvasPrioritizedEventsReady(){return this._canvasPrioritizedEventsReady}get chatboxPrioritizedEventsReady(){return this._chatboxPrioritizedEventsReady}};c(Nb,"Interceptor");let to=Nb;function j(){}c(j,"noop");function St(r,e){for(const t in e)r[t]=e[t];return r}c(St,"assign");function SR(r){return !!r&&(typeof r=="object"||typeof r=="function")&&typeof r.then=="function"}c(SR,"is_promise");function TD(r){return r()}c(TD,"run");function KS(){return Object.create(null)}c(KS,"blank_object");function Je(r){r.forEach(TD);}c(Je,"run_all");function Yr(r){return typeof r=="function"}c(Yr,"is_function");function re(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}c(re,"safe_not_equal");let Hu;function ht(r,e){return r===e?!0:(Hu||(Hu=document.createElement("a")),Hu.href=e,r===Hu.href)}c(ht,"src_url_equal");function AR(r){return Object.keys(r).length===0}c(AR,"is_empty");function Io(r,...e){if(r==null){for(const n of e)n(void 0);return j}const t=r.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}c(Io,"subscribe");function De(r,e,t){r.$$.on_destroy.push(Io(e,t));}c(De,"component_subscribe");function Ut(r,e,t,n){if(r){const i=DD(r,e,t,n);return r[0](i)}}c(Ut,"create_slot");function DD(r,e,t,n){return r[1]&&n?St(t.ctx.slice(),r[1](n(e))):t.ctx}c(DD,"get_slot_context");function Bt(r,e,t,n){if(r[2]&&n){const i=r[2](n(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],s=Math.max(e.dirty.length,i.length);for(let a=0;a<s;a+=1)o[a]=e.dirty[a]|i[a];return o}return e.dirty|i}return e.dirty}c(Bt,"get_slot_changes");function xt(r,e,t,n,i,o){if(i){const s=DD(e,t,n,o);r.p(s,i);}}c(xt,"update_slot_base");function Zt(r){if(r.ctx.length>32){const e=[],t=r.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return -1}c(Zt,"get_all_dirty_from_scope");function kR(r){const e={};for(const t in r)t[0]!=="$"&&(e[t]=r[t]);return e}c(kR,"exclude_internal_props");function eA(r,e){const t={};e=new Set(e);for(const n in r)!e.has(n)&&n[0]!=="$"&&(t[n]=r[n]);return t}c(eA,"compute_rest_props");function tA(r){return r??""}c(tA,"null_to_empty");function gn(r,e,t){return r.set(t),e}c(gn,"set_store_value");function oi(r){return r&&Yr(r.destroy)?r.destroy:j}c(oi,"action_destroyer");function g(r,e){r.appendChild(e);}c(g,"append");function k(r,e,t){r.insertBefore(e,t||null);}c(k,"insert");function A(r){r.parentNode&&r.parentNode.removeChild(r);}c(A,"detach");function Ie(r,e){for(let t=0;t<r.length;t+=1)r[t]&&r[t].d(e);}c(Ie,"destroy_each");function v(r){return document.createElement(r)}c(v,"element");function CR(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}c(CR,"svg_element");function G(r){return document.createTextNode(r)}c(G,"text");function C(){return G(" ")}c(C,"space");function je(){return G("")}c(je,"empty");function F(r,e,t,n){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}c(F,"listen");function _(r,e,t){t==null?r.removeAttribute(e):r.getAttribute(e)!==t&&r.setAttribute(e,t);}c(_,"attr");function ln(r){return r===""?null:+r}c(ln,"to_number");function IR(r){return Array.from(r.childNodes)}c(IR,"children");function K(r,e){e=""+e,r.data!==e&&(r.data=e);}c(K,"set_data");function de(r,e){r.value=e??"";}c(de,"set_input_value");function H(r,e,t,n){t==null?r.style.removeProperty(e):r.style.setProperty(e,t,"");}c(H,"set_style");function Li(r,e,t){for(let n=0;n<r.options.length;n+=1){const i=r.options[n];if(i.__value===e){i.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1);}c(Li,"select_option");function yc(r){const e=r.querySelector(":checked");return e&&e.__value}c(yc,"select_value");function ue(r,e,t){r.classList.toggle(e,!!t);}c(ue,"toggle_class");function TR(r,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:n})}c(TR,"custom_event");const Ob=class Ob{constructor(e=!1){f(this,"is_svg",!1);f(this,"e");f(this,"n");f(this,"t");f(this,"a");this.is_svg=e,this.e=this.n=null;}c(e){this.h(e);}m(e,t,n=null){this.e||(this.is_svg?this.e=CR(t.nodeName):this.e=v(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(n);}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes);}i(e){for(let t=0;t<this.n.length;t+=1)k(this.t,this.n[t],e);}p(e){this.d(),this.h(e),this.i(this.a);}d(){this.n.forEach(A);}};c(Ob,"HtmlTag");let cd=Ob;function qe(r,e){return new r(e)}c(qe,"construct_svelte_component");let wc;function nr(r){wc=r;}c(nr,"set_current_component");function Gl(){if(!wc)throw new Error("Function called outside component initialization");return wc}c(Gl,"get_current_component");function li(r){Gl().$$.on_mount.push(r);}c(li,"onMount");function vh(r){Gl().$$.on_destroy.push(r);}c(vh,"onDestroy");function ED(){const r=Gl();return (e,t,{cancelable:n=!1}={})=>{const i=r.$$.callbacks[e];if(i){const o=TR(e,t,{cancelable:n});return i.slice().forEach(s=>{s.call(r,o);}),!o.defaultPrevented}return !0}}c(ED,"createEventDispatcher");function DR(r,e){return Gl().$$.context.set(r,e),e}c(DR,"setContext");function ER(r){return Gl().$$.context.get(r)}c(ER,"getContext");function _h(r,e){const t=r.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e));}c(_h,"bubble");const Ho=[],Ve=[];let ns=[];const Nf=[],MR=Promise.resolve();let Of=!1;function RR(){Of||(Of=!0,MR.then(eb));}c(RR,"schedule_update");function Ir(r){ns.push(r);}c(Ir,"add_render_callback");function gt(r){Nf.push(r);}c(gt,"add_flush_callback");const bf=new Set;let Jo=0;function eb(){if(Jo!==0)return;const r=wc;do{try{for(;Jo<Ho.length;){const e=Ho[Jo];Jo++,nr(e),LR(e.$$);}}catch(e){throw Ho.length=0,Jo=0,e}for(nr(null),Ho.length=0,Jo=0;Ve.length;)Ve.pop()();for(let e=0;e<ns.length;e+=1){const t=ns[e];bf.has(t)||(bf.add(t),t());}ns.length=0;}while(Ho.length);for(;Nf.length;)Nf.pop()();Of=!1,bf.clear(),nr(r);}c(eb,"flush");function LR(r){if(r.fragment!==null){r.update(),Je(r.before_update);const e=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,e),r.after_update.forEach(Ir);}}c(LR,"update");function PR(r){const e=[],t=[];ns.forEach(n=>r.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),ns=e;}c(PR,"flush_render_callbacks");const td=new Set;let Qr;function fe(){Qr={r:0,c:[],p:Qr};}c(fe,"group_outros");function pe(){Qr.r||Je(Qr.c),Qr=Qr.p;}c(pe,"check_outros");function T(r,e){r&&r.i&&(td.delete(r),r.i(e));}c(T,"transition_in");function M(r,e,t,n){if(r&&r.o){if(td.has(r))return;td.add(r),Qr.c.push(()=>{td.delete(r),n&&(t&&r.d(1),n());}),r.o(e);}else n&&n();}c(M,"transition_out");function $n(r,e){const t=e.token={};function n(i,o,s,a){if(e.token!==t)return;e.resolved=a;let l=e.ctx;s!==void 0&&(l=l.slice(),l[s]=a);const u=i&&(e.current=i)(l);let d=!1;e.block&&(e.blocks?e.blocks.forEach((h,p)=>{p!==o&&h&&(fe(),M(h,1,1,()=>{e.blocks[p]===h&&(e.blocks[p]=null);}),pe());}):e.block.d(1),u.c(),T(u,1),u.m(e.mount(),e.anchor),d=!0),e.block=u,e.blocks&&(e.blocks[o]=u),d&&eb();}if(c(n,"update"),SR(r)){const i=Gl();if(r.then(o=>{nr(i),n(e.then,1,e.value,o),nr(null);},o=>{if(nr(i),n(e.catch,2,e.error,o),nr(null),!e.hasCatch)throw o}),e.current!==e.pending)return n(e.pending,0),!0}else {if(e.current!==e.then)return n(e.then,1,e.value,r),!0;e.resolved=r;}}c($n,"handle_promise");function To(r,e,t){const n=e.slice(),{resolved:i}=r;r.current===r.then&&(n[r.value]=i),r.current===r.catch&&(n[r.error]=i),r.block.p(n,t);}c(To,"update_await_block_branch");function te(r){return (r==null?void 0:r.length)!==void 0?r:Array.from(r)}c(te,"ensure_array_like");function Rt(r,e){const t={},n={},i={$$scope:1};let o=r.length;for(;o--;){const s=r[o],a=e[o];if(a){for(const l in s)l in a||(n[l]=1);for(const l in a)i[l]||(t[l]=a[l],i[l]=1);r[o]=a;}else for(const l in s)i[l]=1;}for(const s in n)s in t||(t[s]=void 0);return t}c(Rt,"get_spread_update");function Lt(r){return typeof r=="object"&&r!==null?r:{}}c(Lt,"get_spread_object");function bt(r,e,t){const n=r.$$.props[e];n!==void 0&&(r.$$.bound[n]=t,t(r.$$.ctx[n]));}c(bt,"bind");function V(r){r&&r.c();}c(V,"create_component");function x(r,e,t){const{fragment:n,after_update:i}=r.$$;n&&n.m(e,t),Ir(()=>{const o=r.$$.on_mount.map(TD).filter(Yr);r.$$.on_destroy?r.$$.on_destroy.push(...o):Je(o),r.$$.on_mount=[];}),i.forEach(Ir);}c(x,"mount_component");function Z(r,e){const t=r.$$;t.fragment!==null&&(PR(t.after_update),Je(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[]);}c(Z,"destroy_component");function NR(r,e){r.$$.dirty[0]===-1&&(Ho.push(r),RR(),r.$$.dirty.fill(0)),r.$$.dirty[e/31|0]|=1<<e%31;}c(NR,"make_dirty");function le(r,e,t,n,i,o,s=null,a=[-1]){const l=wc;nr(r);const u=r.$$={fragment:null,ctx:[],props:o,update:j,not_equal:i,bound:KS(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:KS(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};s&&s(u.root);let d=!1;if(u.ctx=t?t(r,e.props||{},(h,p,...m)=>{const b=m.length?m[0]:p;return u.ctx&&i(u.ctx[h],u.ctx[h]=b)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](b),d&&NR(r,h)),p}):[],u.update(),d=!0,Je(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const h=IR(e.target);u.fragment&&u.fragment.l(h),h.forEach(A);}else u.fragment&&u.fragment.c();e.intro&&T(r.$$.fragment),x(r,e.target,e.anchor),eb();}nr(l);}c(le,"init");const jb=class jb{constructor(){f(this,"$$");f(this,"$$set");}$destroy(){Z(this,1),this.$destroy=j;}$on(e,t){if(!Yr(t))return j;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1);}}$set(e){this.$$set&&!AR(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1);}};c(jb,"SvelteComponent");let se=jb;const OR="4",Fo=[];function MD(r,e=j){let t;const n=new Set;function i(a){if(re(r,a)&&(r=a,t)){const l=!Fo.length;for(const u of n)u[1](),Fo.push(u,r);if(l){for(let u=0;u<Fo.length;u+=2)Fo[u][0](Fo[u+1]);Fo.length=0;}}}c(i,"set");function o(a){i(a(r));}c(o,"update");function s(a,l=j){const u=[a,l];return n.add(u),n.size===1&&(t=e(i,o)||j),a(r),()=>{n.delete(u),n.size===0&&t&&(t(),t=null);}}return c(s,"subscribe"),{set:i,update:o,subscribe:s}}c(MD,"writable");function it(r,e,t,n=!0){const i=MD(e);let o=n;const s=r.subscribe({next:c(a=>{i.set(a),o=!0;},"next"),error:c(a=>console.error("Error from observable:",a),"error")});return {subscribe:i.subscribe,unsubscribe:c(()=>s.unsubscribe(),"unsubscribe"),set:c(a=>{i.set(a),o&&(t==null||t(a));},"set")}}c(it,"fromObservable");typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(OR);function nA(r){let e,t;return {c(){e=v("span"),t=G(r[2]),_(e,"class","svelte-kfudwd");},m(n,i){k(n,e,i),g(e,t);},p(n,i){i&4&&K(t,n[2]);},d(n){n&&A(e);}}}c(nA,"create_if_block$R");function jR(r){let e,t,n,i,o,s,a=r[2]&&nA(r);return {c(){e=v("div"),t=v("img"),i=C(),a&&a.c(),ht(t.src,n="")||_(t,"src",n),_(t,"alt","icon"),H(t,"content","var(--"+(r[0]?"file-img-enabled-gif":"file-img-disabled-gif")+")"),_(t,"class","svelte-kfudwd"),_(e,"role","checkbox"),_(e,"tabindex","0"),_(e,"aria-checked",r[0]),_(e,"class","svelte-kfudwd"),ue(e,"disabled",r[1]);},m(l,u){k(l,e,u),g(e,t),g(e,i),a&&a.m(e,null),o||(s=[F(e,"click",r[4]),F(e,"click",r[5]),F(e,"keypress",r[6])],o=!0);},p(l,[u]){u&1&&H(t,"content","var(--"+(l[0]?"file-img-enabled-gif":"file-img-disabled-gif")+")"),l[2]?a?a.p(l,u):(a=nA(l),a.c(),a.m(e,null)):a&&(a.d(1),a=null),u&1&&_(e,"aria-checked",l[0]),u&2&&ue(e,"disabled",l[1]);},i:j,o:j,d(l){l&&A(e),a&&a.d(),o=!1,Je(s);}}}c(jR,"create_fragment$1P");function GR(r,e,t){let{checked:n=!1}=e,{disabled:i=!1}=e,{description:o=""}=e;const s=ED();function a(d){_h.call(this,r,d);}c(a,"click_handler");const l=c(()=>{t(0,n=!n),s("change",n);},"click_handler_1"),u=c(d=>{d.key==="Enter"&&t(0,n=!n),s("change",n);},"keypress_handler");return r.$$set=d=>{"checked"in d&&t(0,n=d.checked),"disabled"in d&&t(1,i=d.disabled),"description"in d&&t(2,o=d.description);},[n,i,o,s,a,l,u]}c(GR,"instance$1F");const Gb=class Gb extends se{constructor(e){super(),le(this,e,GR,jR,re,{checked:0,disabled:1,description:2});}};c(Gb,"Checkbox");let It=Gb;function iA(r){let e,t,n,i,o,s=r[0].description+"",a,l;function u(h){r[3](h);}c(u,"checkbox_checked_binding");let d={description:r[0].name};return r[2]!==void 0&&(d.checked=r[2]),t=new It({props:d}),Ve.push(()=>bt(t,"checked",u)),{c(){e=v("b"),V(t.$$.fragment),i=C(),o=v("div"),a=G(s),_(e,"class","svelte-rvotkt");},m(h,p){k(h,e,p),x(t,e,null),k(h,i,p),k(h,o,p),g(o,a),l=!0;},p(h,p){const m={};p&1&&(m.description=h[0].name),!n&&p&4&&(n=!0,m.checked=h[2],gt(()=>n=!1)),t.$set(m),(!l||p&1)&&s!==(s=h[0].description+"")&&K(a,s);},i(h){l||(T(t.$$.fragment,h),l=!0);},o(h){M(t.$$.fragment,h),l=!1;},d(h){h&&(A(e),A(i),A(o)),Z(t);}}}c(iA,"create_if_block$Q");function $R(r){let e,t,n=r[1]&&iA(r);return {c(){n&&n.c(),e=je();},m(i,o){n&&n.m(i,o),k(i,e,o),t=!0;},p(i,[o]){i[1]?n?(n.p(i,o),o&2&&T(n,1)):(n=iA(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(fe(),M(n,1,1,()=>{n=null;}),pe());},i(i){t||(T(n),t=!0);},o(i){M(n),t=!1;},d(i){i&&A(e),n&&n.d(i);}}}c($R,"create_fragment$1O");function YR(r,e,t){let n,i=j,o=c(()=>(i(),i=Io(a,u=>t(2,n=u)),a),"$$subscribe_settingStore");r.$$.on_destroy.push(()=>i());let{setting:s}=e,a;function l(u){n=u,a.set(n);}return c(l,"checkbox_checked_binding"),r.$$set=u=>{"setting"in u&&t(0,s=u.setting);},r.$$.update=()=>{r.$$.dirty&1&&o(t(1,a=s.store));},[s,a,n,l]}c(YR,"instance$1E");const $b=class $b extends se{constructor(e){super(),le(this,e,YR,$R,re,{setting:0});}};c($b,"Boolean_setting_input");let jf=$b;function rA(r){let e,t,n=r[0].name+"",i,o,s,a,l,u,d,h,p=r[0].description+"",m,b,y,w=r[2]!==void 0&&r[1]&&oA(r);return {c(){var I,S;e=v("div"),t=v("b"),i=G(n),o=C(),s=v("input"),u=C(),w&&w.c(),d=C(),h=v("div"),m=G(p),_(t,"class","svelte-i0zktq"),_(s,"type","number"),_(s,"min",a=(I=r[1])==null?void 0:I.min),_(s,"max",l=(S=r[1])==null?void 0:S.max),_(s,"class","svelte-i0zktq"),_(e,"class","typo-numeric-setting svelte-i0zktq");},m(I,S){k(I,e,S),g(e,t),g(t,i),g(e,o),g(e,s),de(s,r[4]),g(e,u),w&&w.m(e,null),g(e,d),g(e,h),g(h,m),b||(y=F(s,"input",r[5]),b=!0);},p(I,S){var R,E;S&1&&n!==(n=I[0].name+"")&&K(i,n),S&2&&a!==(a=(R=I[1])==null?void 0:R.min)&&_(s,"min",a),S&2&&l!==(l=(E=I[1])==null?void 0:E.max)&&_(s,"max",l),S&16&&ln(s.value)!==I[4]&&de(s,I[4]),I[2]!==void 0&&I[1]?w?w.p(I,S):(w=oA(I),w.c(),w.m(e,d)):w&&(w.d(1),w=null),S&1&&p!==(p=I[0].description+"")&&K(m,p);},d(I){I&&A(e),w&&w.d(),b=!1,y();}}}c(rA,"create_if_block$P");function oA(r){let e,t,n,i,o;return {c(){e=v("input"),_(e,"type","range"),_(e,"min",t=r[1].min),_(e,"max",n=r[1].max),_(e,"step",r[2]),_(e,"class","svelte-i0zktq");},m(s,a){k(s,e,a),de(e,r[4]),i||(o=[F(e,"change",r[6]),F(e,"input",r[6])],i=!0);},p(s,a){a&2&&t!==(t=s[1].min)&&_(e,"min",t),a&2&&n!==(n=s[1].max)&&_(e,"max",n),a&4&&_(e,"step",s[2]),a&16&&de(e,s[4]);},d(s){s&&A(e),i=!1,Je(o);}}}c(oA,"create_if_block_1$n");function zR(r){let e,t=r[3]&&rA(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,[i]){n[3]?t?t.p(n,i):(t=rA(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(zR,"create_fragment$1N");function UR(r,e,t){let n,i=j,o=c(()=>(i(),i=Io(u,p=>t(4,n=p)),u),"$$subscribe_settingStore");r.$$.on_destroy.push(()=>i());let{setting:s}=e,{bounds:a}=e,{withSliderAndSteps:l}=e,u;function d(){n=ln(this.value),u.set(n);}c(d,"input_input_handler");function h(){n=ln(this.value),u.set(n);}return c(h,"input_change_input_handler"),r.$$set=p=>{"setting"in p&&t(0,s=p.setting),"bounds"in p&&t(1,a=p.bounds),"withSliderAndSteps"in p&&t(2,l=p.withSliderAndSteps);},r.$$.update=()=>{r.$$.dirty&1&&o(t(3,u=s.store));},[s,a,l,u,n,d,h]}c(UR,"instance$1D");const Yb=class Yb extends se{constructor(e){super(),le(this,e,UR,zR,re,{setting:0,bounds:1,withSliderAndSteps:2});}};c(Yb,"Numeric_setting_input");let Gf=Yb;function sA(r,e,t){const n=r.slice();return n[5]=e[t].choice,n[6]=e[t].name,n}c(sA,"get_each_context$F");function aA(r){let e,t,n=r[0].name+"",i,o,s,a,l,u=r[0].description+"",d,h,p,m=te(r[1]),b=[];for(let y=0;y<m.length;y+=1)b[y]=lA(sA(r,m,y));return {c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("select");for(let y=0;y<b.length;y+=1)b[y].c();a=C(),l=v("div"),d=G(u),_(t,"class","svelte-zlhfg4"),r[3]===void 0&&Ir(()=>r[4].call(s)),_(e,"class","typo-numeric-setting svelte-zlhfg4");},m(y,w){k(y,e,w),g(e,t),g(t,i),g(e,o),g(e,s);for(let I=0;I<b.length;I+=1)b[I]&&b[I].m(s,null);Li(s,r[3],!0),g(e,a),g(e,l),g(l,d),h||(p=F(s,"change",r[4]),h=!0);},p(y,w){if(w&1&&n!==(n=y[0].name+"")&&K(i,n),w&2){m=te(y[1]);let I;for(I=0;I<m.length;I+=1){const S=sA(y,m,I);b[I]?b[I].p(S,w):(b[I]=lA(S),b[I].c(),b[I].m(s,null));}for(;I<b.length;I+=1)b[I].d(1);b.length=m.length;}w&10&&Li(s,y[3]),w&1&&u!==(u=y[0].description+"")&&K(d,u);},d(y){y&&A(e),Ie(b,y),h=!1,p();}}}c(aA,"create_if_block$O");function lA(r){let e,t=r[6]+"",n,i;return {c(){e=v("option"),n=G(t),e.__value=i=r[5],de(e,e.__value);},m(o,s){k(o,e,s),g(e,n);},p(o,s){s&2&&t!==(t=o[6]+"")&&K(n,t),s&2&&i!==(i=o[5])&&(e.__value=i,de(e,e.__value));},d(o){o&&A(e);}}}c(lA,"create_each_block$F");function BR(r){let e,t=r[2]&&aA(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,[i]){n[2]?t?t.p(n,i):(t=aA(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(BR,"create_fragment$1M");function xR(r,e,t){let n,i=j,o=c(()=>(i(),i=Io(l,d=>t(3,n=d)),l),"$$subscribe_settingStore");r.$$.on_destroy.push(()=>i());let{setting:s}=e,{choices:a}=e,l;function u(){n=yc(this),l.set(n),t(1,a);}return c(u,"select_change_handler"),r.$$set=d=>{"setting"in d&&t(0,s=d.setting),"choices"in d&&t(1,a=d.choices);},r.$$.update=()=>{r.$$.dirty&1&&o(t(2,l=s.store));},[s,a,l,n,u]}c(xR,"instance$1C");const zb=class zb extends se{constructor(e){super(),le(this,e,xR,BR,re,{setting:0,choices:1});}};c(zb,"Choice_setting_input");let $f=zb;function cA(r){let e,t,n=r[0].name+"",i,o,s,a,l,u=r[0].description+"",d,h,p;return {c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("input"),a=C(),l=v("div"),d=G(u),_(t,"class","svelte-xq58hp"),_(s,"type","text"),_(s,"class","svelte-xq58hp"),_(e,"class","typo-text-setting svelte-xq58hp");},m(m,b){k(m,e,b),g(e,t),g(t,i),g(e,o),g(e,s),de(s,r[2]),g(e,a),g(e,l),g(l,d),h||(p=F(s,"input",r[3]),h=!0);},p(m,b){b&1&&n!==(n=m[0].name+"")&&K(i,n),b&4&&s.value!==m[2]&&de(s,m[2]),b&1&&u!==(u=m[0].description+"")&&K(d,u);},d(m){m&&A(e),h=!1,p();}}}c(cA,"create_if_block$N");function ZR(r){let e,t=r[1]&&cA(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,[i]){n[1]?t?t.p(n,i):(t=cA(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(ZR,"create_fragment$1L");function VR(r,e,t){let n,i=j,o=c(()=>(i(),i=Io(a,u=>t(2,n=u)),a),"$$subscribe_settingStore");r.$$.on_destroy.push(()=>i());let{setting:s}=e,a;function l(){n=this.value,a.set(n);}return c(l,"input_input_handler"),r.$$set=u=>{"setting"in u&&t(0,s=u.setting);},r.$$.update=()=>{r.$$.dirty&1&&o(t(1,a=s.store));},[s,a,n,l]}c(VR,"instance$1B");const Ub=class Ub extends se{constructor(e){super(),le(this,e,VR,ZR,re,{setting:0});}};c(Ub,"Text_setting_input");let Yf=Ub;const an=class an{constructor(e,t,n,i){this._r=e,this._g=t,this._b=n,this._a=i,this._r=an.sanitizeRgbComponent(e),this._g=an.sanitizeRgbComponent(t),this._b=an.sanitizeRgbComponent(n),i!==void 0&&(this._a=an.sanitizeRgbComponent(i));}get r(){return this._r}get g(){return this._g}get b(){return this._b}static sanitizeRgbComponent(e){return Number.isFinite(e)?Math.min(255,Math.max(0,Math.round(e))):0}get rgbString(){return "rgb("+[this._r,this._g,this._b,this._a].filter(e=>e!==void 0).join(",")+")"}get rgbArray(){return this._a?[this._r,this._g,this._b,this._a]:[this._r,this._g,this._b]}get rgb(){return {r:this._r,g:this._g,b:this._b,a:this._a}}get hex(){return "#"+this._r.toString(16).padStart(2,"0")+this._g.toString(16).padStart(2,"0")+this._b.toString(16).padStart(2,"0")+(this._a?Math.floor(255*this._a).toString(16).padStart(2,"0"):"")}set hex(e){const t=an.fromHex(e);this._r=t._r,this._g=t._g,this._b=t._b,this._a=t._a;}get skribblCode(){const e=an.skribblColors.findIndex(t=>t[0]===this._r&&t[1]===this._g&&t[2]===this._b);return e!==-1?e:this.typoCode}get typoCode(){const e=(this._r<<16|this._g<<8|this._b).toString(16).toUpperCase();return parseInt(e,16)+1e4}get hsl(){const e=this.r/255,t=this.g/255,n=this.b/255,i=Math.max(e,t,n),o=Math.min(e,t,n);let s=0,a=0;const l=(i+o)/2;if(i==o)s=a=0;else {const u=i-o;switch(a=l>.5?u/(2-i-o):u/(i+o),i){case e:s=(t-n)/u+(t<n?6:0);break;case t:s=(n-e)/u+2;break;case n:s=(e-t)/u+4;break}s/=6;}return this._a!==void 0?[s*360,a*100,l*100,this._a]:[s*360,a*100,l*100]}get hsv(){const e=this.r/255,t=this.g/255,n=this.b/255,i=Math.max(e,t,n),o=Math.min(e,t,n),s=i-o;let a=0,l=0;const u=i;if(i!==0?l=s/i:(a=0,l=0),i!==o){switch(i){case e:a=(t-n)/s+(t<n?6:0);break;case t:a=(n-e)/s+2;break;case n:a=(e-t)/s+4;break}a/=6;}return [a*360,l*100,u*100,this._a]}static fromRgb(e,t,n,i){return new an(Math.round(e),Math.round(t),Math.round(n),i?Math.round(i*100)/100:void 0)}static fromHex(e){e[0]=="#"&&(e=e.substring(1));const t=Math.round(parseInt("0x"+e.substring(0,2))),n=Math.round(parseInt("0x"+e.substring(2,4))),i=Math.round(parseInt("0x"+e.substring(4,6))),o=e.length>6?Math.round(parseInt("0x"+e.substring(6,8))):void 0;return new an(t,n,i,o)}static fromRgbString(e){const t=e.trim().replace(" ","").split(","),n=parseInt(t[0].replace(/[^\d]/g,""),10),i=parseInt(t[1].replace(/[^\d]/g,""),10),o=parseInt(t[2].replace(/[^\d]/g,""),10),s=t.length>3?parseInt(t[4].replace(/[^\d]/g,""),10):void 0;return new an(n,i,o,s)}static fromSkribblCode(e){if(e<1e4){const n=an.skribblColors[e];return an.fromRgb(n[0],n[1],n[2])}const t=(e-1e4).toString(16).padStart(6,"0");return an.fromHex(t)}static fromHsl(e,t,n,i){t/=100,n/=100;const o=c(h=>(h+e/30)%12,"k"),s=t*Math.min(n,1-n),a=c(h=>n-s*Math.max(-1,Math.min(o(h)-3,Math.min(9-o(h),1))),"f"),l=Math.round(a(0)*255),u=Math.round(a(8)*255),d=Math.round(a(4)*255);return new an(l,u,d,i)}static fromHsv(e,t,n,i){t/=100,n/=100;const o=n*t,s=o*(1-Math.abs(e/60%2-1)),a=n-o;let l=0,u=0,d=0;return 0<=e&&e<60?(l=o,u=s,d=0):60<=e&&e<120?(l=s,u=o,d=0):120<=e&&e<180?(l=0,u=o,d=s):180<=e&&e<240?(l=0,u=s,d=o):240<=e&&e<300?(l=s,u=0,d=o):300<=e&&e<360&&(l=o,u=0,d=s),l=Math.round((l+a)*255),u=Math.round((u+a)*255),d=Math.round((d+a)*255),new an(l,u,d,i)}copy(){return new an(this._r,this._g,this._b,this._a)}withAlpha(e){return this._a=e,this}};c(an,"Color"),f(an,"skribblColors",[[255,255,255],[0,0,0],[193,193,193],[80,80,80],[239,19,11],[116,11,7],[255,113,0],[194,56,0],[255,228,0],[232,162,0],[0,204,0],[0,70,25],[0,255,145],[0,120,93],[0,178,255],[0,86,158],[35,31,211],[14,8,101],[163,0,186],[85,0,105],[223,105,167],[135,53,84],[255,172,142],[204,119,77],[160,82,45],[99,48,13]]);let tt=an;function uA(r){let e,t;return {c(){e=v("p"),t=G(r[2]);},m(n,i){k(n,e,i),g(e,t);},p(n,i){i&4&&K(t,n[2]);},d(n){n&&A(e);}}}c(uA,"create_if_block_1$m");function dA(r){let e,t,n,i;return {c(){e=v("div"),t=v("div"),_(t,"class","alpha-thumb svelte-1x2m4l5"),H(t,"top","calc(50% - .5rem)"),H(t,"left","calc("+(r[6]??1)*100+"% - .5rem)"),ue(t,"listen",r[10]),_(e,"class","alpha-rect svelte-1x2m4l5"),H(e,"background","linear-gradient(to right, "+r[0].copy().withAlpha(0).rgbString+", "+r[0].copy().withAlpha(1).rgbString+")");},m(o,s){k(o,e,s),g(e,t),n||(i=[F(e,"mousedown",r[16]),F(e,"mouseup",r[13]),F(e,"mouseleave",r[13])],n=!0);},p(o,s){s&64&&H(t,"left","calc("+(o[6]??1)*100+"% - .5rem)"),s&1024&&ue(t,"listen",o[10]),s&1&&H(e,"background","linear-gradient(to right, "+o[0].copy().withAlpha(0).rgbString+", "+o[0].copy().withAlpha(1).rgbString+")");},d(o){o&&A(e),n=!1,Je(i);}}}c(dA,"create_if_block$M");function JR(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y=r[2].length>0&&uA(r),w=r[1]&&dA(r);return {c(){e=v("div"),t=v("div"),t.innerHTML='<img src="" alt="picker icon" style="content: var(--file-img-crosshair-gif)" class="svelte-1x2m4l5"/> <h3 class="svelte-1x2m4l5">Color Picker</h3>',n=C(),y&&y.c(),i=C(),o=v("div"),s=v("div"),a=C(),l=v("div"),u=v("div"),d=C(),w&&w.c(),h=C(),p=v("input"),_(t,"class","picker-header svelte-1x2m4l5"),_(s,"class","color-thumb svelte-1x2m4l5"),H(s,"top","calc(100% - "+r[5]+"% - .5rem)"),H(s,"left","calc("+r[4]+"% - .5rem)"),ue(s,"listen",r[8]),_(o,"class","color-rect svelte-1x2m4l5"),H(o,"background","linear-gradient(to top, rgba(0, 0, 0, 1), rgba(0, 0, 0, 0)), linear-gradient(to right, hsl(0, 0%, 100%), hsl("+r[3]+", 100%, 50%))"),_(u,"class","hue-thumb svelte-1x2m4l5"),H(u,"top","calc(50% - .5rem)"),H(u,"left","calc("+r[3]/3.6+"% - .5rem)"),ue(u,"listen",r[9]),_(l,"class","hue-rect svelte-1x2m4l5"),_(p,"type","text"),_(p,"placeholder","#aabbcc"),_(e,"class","color-picker svelte-1x2m4l5");},m(I,S){k(I,e,S),g(e,t),g(e,n),y&&y.m(e,null),g(e,i),g(e,o),g(o,s),g(e,a),g(e,l),g(l,u),g(e,d),w&&w.m(e,null),g(e,h),g(e,p),de(p,r[7]),m||(b=[F(o,"mousedown",r[14]),F(o,"mouseup",r[11]),F(o,"mouseleave",r[11]),F(l,"mousedown",r[15]),F(l,"mouseup",r[12]),F(l,"mouseleave",r[12]),F(p,"input",r[17]),F(p,"change",r[18])],m=!0);},p(I,[S]){I[2].length>0?y?y.p(I,S):(y=uA(I),y.c(),y.m(e,i)):y&&(y.d(1),y=null),S&32&&H(s,"top","calc(100% - "+I[5]+"% - .5rem)"),S&16&&H(s,"left","calc("+I[4]+"% - .5rem)"),S&256&&ue(s,"listen",I[8]),S&8&&H(o,"background","linear-gradient(to top, rgba(0, 0, 0, 1), rgba(0, 0, 0, 0)), linear-gradient(to right, hsl(0, 0%, 100%), hsl("+I[3]+", 100%, 50%))"),S&8&&H(u,"left","calc("+I[3]/3.6+"% - .5rem)"),S&512&&ue(u,"listen",I[9]),I[1]?w?w.p(I,S):(w=dA(I),w.c(),w.m(e,h)):w&&(w.d(1),w=null),S&128&&p.value!==I[7]&&de(p,I[7]);},i:j,o:j,d(I){I&&A(e),y&&y.d(),w&&w.d(),m=!1,Je(b);}}}c(JR,"create_fragment$1K");function FR(r,e,t){let{color:n=tt.fromHex("#45588d")}=e,{allowAlpha:i=!1}=e,{description:o=""}=e,s=n.hex,a,l,u,d,h=!1;const p=c(L=>{if(!h)return;t(8,h=!1);const O=L.target.getBoundingClientRect(),z=L.clientX-O.left,$=L.clientY-O.top;t(4,l=Math.min(100,Math.max(0,z/O.width*100))),t(5,u=Math.min(100,Math.max(0,100-$/O.height*100))),t(0,n=tt.fromHsv(a,l,u,d)),t(7,s=n.hex);},"handleSV");let m=!1;const b=c(L=>{if(!m)return;t(9,m=!1);const O=L.target.getBoundingClientRect(),z=L.clientX-O.left;t(3,a=Math.min(359,Math.max(0,z/O.width*360))),t(0,n=tt.fromHsv(a,l,u,d)),t(7,s=n.hex);},"handleHue");let y=!1;const w=c(L=>{if(!y||!i)return;t(10,y=!1);const O=L.target.getBoundingClientRect(),z=L.clientX-O.left;t(6,d=Math.min(100,Math.max(0,z/O.width))),t(0,n=tt.fromHsv(a,l,u,d)),t(7,s=n.hex);},"handleAlpha"),I=c(()=>t(8,h=!0),"mousedown_handler"),S=c(()=>t(9,m=!0),"mousedown_handler_1"),R=c(()=>t(10,y=!0),"mousedown_handler_2");function E(){s=this.value,t(7,s);}c(E,"input_input_handler");const P=c(L=>{t(0,n=tt.fromHex(s));},"change_handler");return r.$$set=L=>{"color"in L&&t(0,n=L.color),"allowAlpha"in L&&t(1,i=L.allowAlpha),"description"in L&&t(2,o=L.description);},r.$$.update=()=>{if(r.$$.dirty&123){const L=n.hex,O=tt.fromHsv(a,l,u,d).hex;if(console.log(L,O),L!==O){const z=n.hsv;t(3,a=z[0]??0),t(4,l=z[1]??100),t(5,u=z[2]??50),t(6,d=i?z[3]:void 0);}}},[n,i,o,a,l,u,d,s,h,m,y,p,b,w,I,S,R,E,P]}c(FR,"instance$1A");const Bb=class Bb extends se{constructor(e){super(),le(this,e,FR,JR,re,{color:0,allowAlpha:1,description:2});}};c(Bb,"Color_picker");let zf=Bb;function hA(r){let e,t,n,i,o,s;function a(u){r[10](u);}c(a,"colorpicker_color_binding");let l={allowAlpha:r[1],description:r[5]};return r[0]!==void 0&&(l.color=r[0]),t=new zf({props:l}),Ve.push(()=>bt(t,"color",a)),{c(){e=v("div"),V(t.$$.fragment),_(e,"class","color-picker-popout svelte-1bdf7g"),H(e,"top",r[6].top),H(e,"left",r[6].left),H(e,"right",r[6].right),H(e,"bottom",r[6].bottom),H(e,"transform-origin",r[6].transformOrigin),ue(e,"closing",r[7]);},m(u,d){k(u,e,d),x(t,e,null),i=!0,o||(s=F(e,"click",HR),o=!0);},p(u,d){const h={};d&2&&(h.allowAlpha=u[1]),d&32&&(h.description=u[5]),!n&&d&1&&(n=!0,h.color=u[0],gt(()=>n=!1)),t.$set(h),(!i||d&64)&&H(e,"top",u[6].top),(!i||d&64)&&H(e,"left",u[6].left),(!i||d&64)&&H(e,"right",u[6].right),(!i||d&64)&&H(e,"bottom",u[6].bottom),(!i||d&64)&&H(e,"transform-origin",u[6].transformOrigin),(!i||d&128)&&ue(e,"closing",u[7]);},i(u){i||(T(t.$$.fragment,u),i=!0);},o(u){M(t.$$.fragment,u),i=!1;},d(u){u&&A(e),Z(t),o=!1,s();}}}c(hA,"create_if_block$L");function WR(r){let e,t,n,i,o,s,a,l=r[6]&&hA(r);return {c(){e=v("div"),t=v("div"),n=C(),l&&l.c(),_(t,"class","color-picker-button-content svelte-1bdf7g"),H(t,"background-color",r[2]?r[0].hex:void 0),H(t,"border-radius",r[4]),_(e,"class","typo-color-picker-button svelte-1bdf7g"),H(e,"height",r[3]),_(e,"data-rgb",i=r[0].rgbString);},m(u,d){k(u,e,d),g(e,t),g(e,n),l&&l.m(e,null),o=!0,s||(a=F(e,"click",r[8]),s=!0);},p(u,[d]){(!o||d&5)&&H(t,"background-color",u[2]?u[0].hex:void 0),(!o||d&16)&&H(t,"border-radius",u[4]),u[6]?l?(l.p(u,d),d&64&&T(l,1)):(l=hA(u),l.c(),T(l,1),l.m(e,null)):l&&(fe(),M(l,1,1,()=>{l=null;}),pe()),(!o||d&8)&&H(e,"height",u[3]),(!o||d&1&&i!==(i=u[0].rgbString))&&_(e,"data-rgb",i);},i(u){o||(T(l),o=!0);},o(u){M(l),o=!1;},d(u){u&&A(e),l&&l.d(),s=!1,a();}}}c(WR,"create_fragment$1J");const HR=c(r=>r.stopImmediatePropagation(),"click_handler");function QR(r,e,t){let{color:n=tt.fromHex("#45588d")}=e,{allowAlpha:i=!1}=e,{useBackground:o=!0}=e,{height:s="2rem"}=e,{borderRadius:a="3px"}=e,{colorChanged:l=void 0}=e,{description:u=""}=e,d,h=!1;const p=c(b=>{t(7,h=!1);const y=b.target,w=y.getBoundingClientRect(),I=c(O=>{O.target!==y&&(document.removeEventListener("click",I),l==null||l(n),t(7,h=!0),setTimeout(()=>{t(6,d=void 0);},150));},"handler");document.addEventListener("click",I);let S,R,E,P,L;w.x>window.innerWidth/2?R="0":S="0",w.y>window.innerHeight/2?(E="0",L="bottom"):(P="0",L="top"),t(6,d={top:P,left:S,right:R,bottom:E,transformOrigin:L});},"openPopup");function m(b){n=b,t(0,n);}return c(m,"colorpicker_color_binding"),r.$$set=b=>{"color"in b&&t(0,n=b.color),"allowAlpha"in b&&t(1,i=b.allowAlpha),"useBackground"in b&&t(2,o=b.useBackground),"height"in b&&t(3,s=b.height),"borderRadius"in b&&t(4,a=b.borderRadius),"colorChanged"in b&&t(9,l=b.colorChanged),"description"in b&&t(5,u=b.description);},[n,i,o,s,a,u,d,h,p,l,m]}c(QR,"instance$1z");const xb=class xb extends se{constructor(e){super(),le(this,e,QR,WR,re,{color:0,allowAlpha:1,useBackground:2,height:3,borderRadius:4,colorChanged:9,description:5});}};c(xb,"Color_picker_button");let pi=xb;function fA(r){let e,t,n=r[0].name+"",i,o,s,a=r[0].description+"",l,u,d,h,p,m;function b(w){r[3](w);}c(b,"colorpickerbutton_color_binding");let y={};return r[1]!==void 0&&(y.color=r[1]),h=new pi({props:y}),Ve.push(()=>bt(h,"color",b)),{c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("div"),l=G(a),u=C(),d=v("div"),V(h.$$.fragment),_(t,"class","svelte-1pjx4sn"),_(e,"class","typo-text-setting svelte-1pjx4sn");},m(w,I){k(w,e,I),g(e,t),g(t,i),g(e,o),g(e,s),g(s,l),g(e,u),g(e,d),x(h,d,null),m=!0;},p(w,I){(!m||I&1)&&n!==(n=w[0].name+"")&&K(i,n),(!m||I&1)&&a!==(a=w[0].description+"")&&K(l,a);const S={};!p&&I&2&&(p=!0,S.color=w[1],gt(()=>p=!1)),h.$set(S);},i(w){m||(T(h.$$.fragment,w),m=!0);},o(w){M(h.$$.fragment,w),m=!1;},d(w){w&&A(e),Z(h);}}}c(fA,"create_if_block$K");function XR(r){let e,t,n=r[2]&&fA(r);return {c(){n&&n.c(),e=je();},m(i,o){n&&n.m(i,o),k(i,e,o),t=!0;},p(i,[o]){i[2]?n?(n.p(i,o),o&4&&T(n,1)):(n=fA(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(fe(),M(n,1,1,()=>{n=null;}),pe());},i(i){t||(T(n),t=!0);},o(i){M(n),t=!1;},d(i){i&&A(e),n&&n.d(i);}}}c(XR,"create_fragment$1I");function qR(r,e,t){let n,i=j,o=c(()=>(i(),i=Io(a,d=>t(4,n=d)),a),"$$subscribe_settingStore");r.$$.on_destroy.push(()=>i());let{setting:s}=e,a,l;li(async()=>{t(1,l=tt.fromHex(await s.getValue()));});function u(d){l=d,t(1,l);}return c(u,"colorpickerbutton_color_binding"),r.$$set=d=>{"setting"in d&&t(0,s=d.setting);},r.$$.update=()=>{r.$$.dirty&1&&o(t(2,a=s.store)),r.$$.dirty&2&&l&&gn(a,n=l.hex,n);},[s,l,a,u]}c(qR,"instance$1y");const Zb=class Zb extends se{constructor(e){super(),le(this,e,qR,XR,re,{setting:0});}};c(Zb,"Color_hex_setting_input");let Uf=Zb;const Vb=class Vb{constructor(e,t,n){f(this,"_name");f(this,"_description");f(this,"_changes",new Le(null));this.key=e,this.defaultValue=t,this.feature=n,this.feature=n;}get globalKey(){const e=this.key.replace(/[^a-zA-Z0-9.]/g,"_");return this.feature?`feature_${this.feature.featureId}.${e}`:`global.${e}`}async getValue(){const e=await Jt.getSetting(this.globalKey);if(e==null)return this.defaultValue;const t=JSON.parse(e);return this._changes.next(t),t}async setValue(e){const t=JSON.stringify(e);await Jt.writeSetting(this.globalKey,t),this._changes.next(e);}get name(){return this._name}get description(){return this._description}setDefaultValue(e){this.defaultValue=e;}withName(e){return this._name=e,this}withDescription(e){return this._description=e,this}get changes$(){return this._changes.pipe(lt(e=>e===null?ji(this.getValue()):Tt(e)))}get store(){return it(this.changes$,this.defaultValue,e=>this.setValue(e),!1)}get asFrozen(){return this}};c(Vb,"ExtensionSetting");let dt=Vb;const Jb=class Jb extends dt{};c(Jb,"SettingWithInput");let no=Jb;const Fb=class Fb extends no{get componentData(){return {componentType:jf,props:{setting:this}}}};c(Fb,"BooleanExtensionSetting");let He=Fb;const Wb=class Wb extends no{get componentData(){return {componentType:Yf,props:{setting:this}}}};c(Wb,"TextExtensionSetting");let Bf=Wb;const Hb=class Hb extends no{get componentData(){return {componentType:Uf,props:{setting:this}}}};c(Hb,"HexColorExtensionSetting");let ud=Hb;const Qb=class Qb extends no{constructor(){super(...arguments);f(this,"_min");f(this,"_max");f(this,"_sliderWithSteps");}get componentData(){return {componentType:Gf,props:{setting:this,withSliderAndSteps:this._sliderWithSteps,bounds:this._min!==void 0&&this._max!==void 0?{min:this._min,max:this._max}:void 0}}}withBounds(t,n){return this._min=t,this._max=n,this}withSlider(t=1){return this._sliderWithSteps=t,this}};c(Qb,"NumericExtensionSetting");let Wt=Qb;const Xb=class Xb extends no{constructor(){super(...arguments);f(this,"_choices",[]);}get componentData(){return {componentType:$f,props:{setting:this,choices:this._choices}}}withChoices(t){return this._choices=t,this}};c(Xb,"ChoiceExtensionSetting");let cr=Xb;var ei="named",RD="name",tb="unmanaged",LD="optional",yh="inject",Sc="multi_inject",PD="inversify:tagged",ND="inversify:tagged_props",xf="inversify:paramtypes",KR="design:paramtypes",Zf="post_construct",Vf="pre_destroy";function e2(){return [yh,Sc,RD,tb,ei,LD]}c(e2,"getNonCustomTagKeys");var pA=e2(),Xt={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Mt={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Su={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},t2=0;function Au(){return t2++}c(Au,"id");var n2=function(){function r(e,t){this.id=Au(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=Mt.Invalid,this.constraint=function(n){return !0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null;}return c(r,"Binding"),r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===Xt.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}(),i2="Cannot apply @injectable decorator multiple times.",OD="Metadata key was used more than once in a parameter:",Wl="NULL argument",mA="Key Not Found",r2="Ambiguous match found for serviceIdentifier:",o2="Could not unbind serviceIdentifier:",s2="No matching bindings found for serviceIdentifier:",jD="Missing required @injectable annotation in:",a2="Missing required @inject or @multiInject annotation in:",l2=c(function(r){return "@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."},"UNDEFINED_INJECT_ANNOTATION"),c2="Circular dependency found:",u2="Invalid binding type:",d2="No snapshot available to restore.",h2="Invalid return type in middleware. Middleware must return!",f2="Value provided to function binding must be a function!",p2=c(function(r){return "You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`},"LAZY_IN_SYNC"),m2="The toSelf function can only be applied when a constructor is used as service identifier",GD="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",g2=c(function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return "The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")},"ARGUMENTS_LENGTH_MISMATCH"),b2="Invalid Container constructor argument. Container options must be an object.",v2='Invalid Container option. Default scope must be a string ("singleton" or "transient").',_2="Invalid Container option. Auto bind injectable must be a boolean",y2="Invalid Container option. Skip base check must be a boolean",w2="Cannot apply @postConstruct decorator multiple times in the same class",S2="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",A2=c(function(r,e){return "@postConstruct error in class "+r+": "+e},"POST_CONSTRUCT_ERROR"),k2=c(function(r,e){return "@preDestroy error in class "+r+": "+e},"PRE_DESTROY_ERROR"),Jf=c(function(r,e){return "onDeactivation() error in class "+r+": "+e},"ON_DEACTIVATION_ERROR"),C2=c(function(r,e){return "It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with "+("service identifier '"+e+"'.")},"CIRCULAR_DEPENDENCY_IN_FACTORY"),I2="Maximum call stack size exceeded",T2=function(){function r(){}return c(r,"MetadataReader"),r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(xf,e),n=Reflect.getMetadata(PD,e);return {compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(ND,e)||[];return t},r}(),nd={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function $D(r){return r instanceof RangeError||r.message===I2}c($D,"isStackOverflowExeption");var D2=c(function(r,e){try{return r()}catch(t){throw $D(t)&&(t=e()),t}},"tryAndThrowErrorIfStackOverflow");function Ac(r){if(typeof r=="function"){var e=r;return e.name}else {if(typeof r=="symbol")return r.toString();var e=r;return e}}c(Ac,"getServiceIdentifierAsString");function gA(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=wh(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData);})),n}c(gA,"listRegisteredBindingsForServiceIdentifier");function YD(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:YD(r.parentRequest,e)}c(YD,"alreadyDependencyChain");function E2(r){function e(n,i){i===void 0&&(i=[]);var o=Ac(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}c(e,"_createStringArr");var t=e(r);return t.reverse().join(" --> ")}c(E2,"dependencyChainToString");function zD(r){r.childRequests.forEach(function(e){if(YD(e,e.serviceIdentifier)){var t=E2(e);throw new Error(c2+" "+t)}else zD(e);});}c(zD,"circularDependencyToException");function M2(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`;})," "+r+`
 `+r+" - "+t}else return " "+r}c(M2,"listMetadataForTarget");function wh(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}c(wh,"getFunctionName");function R2(r){return r.toString().slice(7,-1)}c(R2,"getSymbolDescription");var UD=function(){function r(e){this.id=Au(),this.container=e;}return c(r,"Context"),r.prototype.addPlan=function(e){this.plan=e;},r.prototype.setCurrentRequest=function(e){this.currentRequest=e;},r}(),Tr=function(){function r(e,t){this.key=e,this.value=t;}return c(r,"Metadata"),r.prototype.toString=function(){return this.key===ei?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}(),L2=function(){function r(e,t){this.parentContext=e,this.rootRequest=t;}return c(r,"Plan"),r}(),P2=function(){function r(e){this._cb=e;}return c(r,"LazyServiceIdentifier"),r.prototype.unwrap=function(){return this._cb()},r}(),N2=function(){function r(e){this.str=e;}return c(r,"QueryableString"),r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}(),Sh=function(){function r(e,t,n,i){this.id=Au(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?R2(t):t;this.name=new N2(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new Tr(ei,i):i instanceof Tr&&(s=i),s!==null&&this.metadata.push(s);}return c(r,"Target"),r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return !0}return !1},r.prototype.isArray=function(){return this.hasTag(Sc)},r.prototype.matchesArray=function(e){return this.matchesTag(Sc)(e)},r.prototype.isNamed=function(){return this.hasTag(ei)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return pA.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(LD)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===ei})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return pA.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(ei)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return !0}return !1}},r}(),dd=function(r,e,t){for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};function O2(r,e){var t=wh(e);return BD(r,t,e,!1)}c(O2,"getDependencies");function BD(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=jD+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),u=t.length===0&&l.length>0,d=l.length>t.length,h=u||d?l.length:t.length,p=G2(n,e,o,a,h),m=xD(r,t,e),b=dd(dd([],p,!0),m);return b}c(BD,"getTargets");function j2(r,e,t,n,i){var o=i[r.toString()]||[],s=VD(o),a=s.unmanaged!==!0,l=n[r],u=s.inject||s.multiInject;if(l=u||l,l instanceof P2&&(l=l.unwrap()),a){var d=l===Object,h=l===Function,p=l===void 0,m=d||h||p;if(!e&&m){var b=a2+" argument "+r+" in class "+t+".";throw new Error(b)}var y=new Sh(Su.ConstructorArgument,s.targetName,l);return y.metadata=o,y}return null}c(j2,"getConstructorArgsAsTarget");function G2(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=j2(a,r,e,t,n);l!==null&&o.push(l);}return o}c(G2,"getConstructorArgsAsTargets");function $2(r,e,t,n){var i=r||e;if(i===void 0){var o=jD+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}c($2,"_getServiceIdentifierForProperty");function xD(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,u=a;l<u.length;l++){var d=u[l],h=n[d],p=VD(h),m=p.targetName||d,b=$2(p.inject,p.multiInject,d,t),y=new Sh(Su.ClassProperty,m,b);y.metadata=h,i.push(y);}var w=Object.getPrototypeOf(e.prototype).constructor;if(w!==Object){var I=xD(r,w,t);i=dd(dd([],i,!0),I);}return i}c(xD,"getClassPropsAsTargets");function ZD(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=wh(t),i=BD(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(u){return u.key===tb})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:ZD(r,t)}else return 0}c(ZD,"getBaseClassDependencyCount");function VD(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value;}),{inject:e[yh],multiInject:e[Sc],targetName:e[RD],unmanaged:e[tb]}}c(VD,"formatTargetMetadata");var nb=function(){function r(e,t,n,i,o){this.id=Au(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null;}return c(r,"Request"),r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();function hd(r){return r._bindingDictionary}c(hd,"getBindingDictionary");function Y2(r,e,t,n,i,o){var s=r?Sc:yh,a=new Tr(s,t),l=new Sh(e,n,t,a);if(i!==void 0){var u=new Tr(i,o);l.metadata.push(u);}return l}c(Y2,"_createTarget");function bA(r,e,t,n,i){var o=kc(t.container,i.serviceIdentifier),s=[];return o.length===nd.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=kc(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new nb(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),z2(i.serviceIdentifier,s,i,t.container),s}c(bA,"_getActiveBindings");function z2(r,e,t,n){switch(e.length){case nd.NoBindingsAvailable:if(t.isOptional())return e;var i=Ac(r),o=s2;throw o+=M2(i,t),o+=gA(n,i,kc),new Error(o);case nd.OnlyOneBindingAvailable:return e;case nd.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=Ac(r),o=r2+" "+i;throw o+=gA(n,i,kc),new Error(o)}}c(z2,"_validateActiveBindingCount");function JD(r,e,t,n,i,o){var s,a;if(i===null){s=bA(r,e,n,null,o),a=new nb(t,n,null,s,o);var l=new L2(n,a);n.addPlan(l);}else s=bA(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(u){var d=null;if(o.isArray())d=a.addChildRequest(u.serviceIdentifier,u,o);else {if(u.cache)return;d=a;}if(u.type===Mt.Instance&&u.implementationType!==null){var h=O2(r,u.implementationType);if(!n.container.options.skipBaseClassChecks){var p=ZD(r,u.implementationType);if(h.length<p){var m=g2(wh(u.implementationType));throw new Error(m)}}h.forEach(function(b){JD(r,!1,b.serviceIdentifier,n,d,b);});}});}c(JD,"_createSubRequests");function kc(r,e){var t=[],n=hd(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=kc(r.parent,e)),t}c(kc,"getBindings");function U2(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new UD(e),u=Y2(t,n,i,"",o,s);try{return JD(r,a,i,l,null,u),l}catch(d){throw $D(d)&&zD(l.plan.rootRequest),d}}c(U2,"plan");function B2(r,e,t,n){var i=new Sh(Su.Variable,"",e,new Tr(t,n)),o=new UD(r),s=new nb(e,o,null,[],i);return s}c(B2,"createMockRequest");function jn(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}c(jn,"isPromise");function FD(r){return jn(r)?!0:Array.isArray(r)&&r.some(jn)}c(FD,"isPromiseOrContainsPromise");var x2=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o);})}return c(i,"adopt"),new(t||(t=Promise))(function(o,s){function a(d){try{u(n.next(d));}catch(h){s(h);}}c(a,"fulfilled");function l(d){try{u(n.throw(d));}catch(h){s(h);}}c(l,"rejected");function u(d){d.done?o(d.value):i(d.value).then(a,l);}c(u,"step"),u((n=n.apply(r,[])).next());})},Z2=function(r,e){var t={label:0,sent:c(function(){if(o[0]&1)throw o[1];return o[1]},"sent"),trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t);}catch(d){u=[6,d],i=0;}finally{n=o=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}},V2=c(function(r,e){return e.scope===Xt.Singleton&&e.activated?e.cache:e.scope===Xt.Request&&r.has(e.id)?r.get(e.id):null},"tryGetFromScope"),J2=c(function(r,e,t){e.scope===Xt.Singleton&&W2(e,t),e.scope===Xt.Request&&F2(r,e,t);},"saveToScope"),F2=c(function(r,e,t){r.has(e.id)||r.set(e.id,t);},"_saveToRequestScope"),W2=c(function(r,e){r.cache=e,r.activated=!0,jn(e)&&H2(r,e);},"_saveToSingletonScope"),H2=c(function(r,e){return x2(void 0,void 0,void 0,function(){var t,n;return Z2(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return [2]}})})},"_saveAsyncResultToSingletonScope"),ql;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider";})(ql||(ql={}));var Q2=c(function(r){var e=null;switch(r.type){case Mt.ConstantValue:case Mt.Function:e=r.cache;break;case Mt.Constructor:case Mt.Instance:e=r.implementationType;break;case Mt.DynamicValue:e=r.dynamicValue;break;case Mt.Provider:e=r.provider;break;case Mt.Factory:e=r.factory;break}if(e===null){var t=Ac(r.serviceIdentifier);throw new Error(u2+" "+t)}},"ensureFullyBound"),X2=c(function(r){switch(r.type){case Mt.Factory:return {factory:r.factory,factoryType:ql.Factory};case Mt.Provider:return {factory:r.provider,factoryType:ql.Provider};case Mt.DynamicValue:return {factory:r.dynamicValue,factoryType:ql.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}},"getFactoryDetails"),Za=function(){return Za=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);}return r},Za.apply(this,arguments)},WD=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o);})}return c(i,"adopt"),new(t||(t=Promise))(function(o,s){function a(d){try{u(n.next(d));}catch(h){s(h);}}c(a,"fulfilled");function l(d){try{u(n.throw(d));}catch(h){s(h);}}c(l,"rejected");function u(d){d.done?o(d.value):i(d.value).then(a,l);}c(u,"step"),u((n=n.apply(r,[])).next());})},HD=function(r,e){var t={label:0,sent:c(function(){if(o[0]&1)throw o[1];return o[1]},"sent"),trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t);}catch(d){u=[6,d],i=0;}finally{n=o=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}},q2=function(r,e,t){if(arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};function K2(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===Su.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=FD(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}c(K2,"_resolveRequests");function eL(r,e,t){var n;if(e.length>0){var i=K2(e,t),o=Za(Za({},i),{constr:r});i.isAsync?n=tL(o):n=QD(o);}else n=new r;return n}c(eL,"_createInstance");function QD(r){var e,t=new((e=r.constr).bind.apply(e,q2([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];(!n.target.isOptional()||s!==void 0)&&(t[o]=s);}),t}c(QD,"createInstanceWithInjections");function tL(r){return WD(this,void 0,void 0,function(){var e,t;return HD(this,function(n){switch(n.label){case 0:return [4,vA(r.constructorInjections)];case 1:return e=n.sent(),[4,vA(r.propertyInjections)];case 2:return t=n.sent(),[2,QD(Za(Za({},r),{constructorInjections:e,propertyInjections:t}))]}})})}c(tL,"createInstanceWithInjectionsAsync");function vA(r){return WD(this,void 0,void 0,function(){var e,t,n,i;return HD(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return [2,Promise.all(e)]})})}c(vA,"possiblyWaitInjections");function _A(r,e){var t=nL(r,e);return jn(t)?t.then(function(){return e}):e}c(_A,"_getInstanceAfterPostConstruct");function nL(r,e){var t,n;if(Reflect.hasMetadata(Zf,r)){var i=Reflect.getMetadata(Zf,r);try{return (n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){if(o instanceof Error)throw new Error(A2(r.name,o.message))}}}c(nL,"_postConstruct");function iL(r,e){r.scope!==Xt.Singleton&&rL(r,e);}c(iL,"_validateInstanceResolution");function rL(r,e){var t="Class cannot be instantiated in "+(r.scope===Xt.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error(Jf(e.name,t));if(Reflect.hasMetadata(Vf,e))throw new Error(k2(e.name,t))}c(rL,"_throwIfHandlingDeactivation");function oL(r,e,t,n){iL(r,e);var i=eL(e,t,n);return jn(i)?i.then(function(o){return _A(e,o)}):_A(e,i)}c(oL,"resolveInstance");var sL=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o);})}return c(i,"adopt"),new(t||(t=Promise))(function(o,s){function a(d){try{u(n.next(d));}catch(h){s(h);}}c(a,"fulfilled");function l(d){try{u(n.throw(d));}catch(h){s(h);}}c(l,"rejected");function u(d){d.done?o(d.value):i(d.value).then(a,l);}c(u,"step"),u((n=n.apply(r,[])).next());})},aL=function(r,e){var t={label:0,sent:c(function(){if(o[0]&1)throw o[1];return o[1]},"sent"),trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t);}catch(d){u=[6,d],i=0;}finally{n=o=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}},ib=c(function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=ib(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return dL(r,e,s)}},"_resolveRequest"),lL=c(function(r,e){var t=X2(r);return D2(function(){return t.factory.bind(r)(e)},function(){return new Error(C2(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},"_resolveFactoryFromBinding"),cL=c(function(r,e,t){var n,i=e.childRequests;switch(Q2(t),t.type){case Mt.ConstantValue:case Mt.Function:n=t.cache;break;case Mt.Constructor:n=t.implementationType;break;case Mt.Instance:n=oL(t,t.implementationType,i,ib(r));break;default:n=lL(t,e.parentContext);}return n},"_getResolvedFromBinding"),uL=c(function(r,e,t){var n=V2(r,e);return n!==null||(n=t(),J2(r,e,n)),n},"_resolveInScope"),dL=c(function(r,e,t){return uL(r,t,function(){var n=cL(r,e,t);return jn(n)?n=n.then(function(i){return yA(e,t,i)}):n=yA(e,t,n),n})},"_resolveBinding");function yA(r,e,t){var n=hL(r.parentContext,e,t),i=mL(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,u=pL(o,l);jn(n)?n=XD(u,a,n):n=fL(u,a,n),s=i.next();}while(s.done!==!0&&!hd(o).hasKey(r.serviceIdentifier));return n}c(yA,"_onActivation");var hL=c(function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},"_bindingActivation"),fL=c(function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),jn(t))return XD(r,e,t);n=r.next();}return t},"_activateContainer"),XD=c(function(r,e,t){return sL(void 0,void 0,void 0,function(){var n,i;return aL(this,function(o){switch(o.label){case 0:return [4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return [2,n]}})})},"_activateContainerAsync"),pL=c(function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},"_getContainerActivationsForService"),mL=c(function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=c(function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},"getNextContainer"),i={next:n};return i},"_getContainersIterator");function gL(r){var e=ib(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}c(gL,"resolve");var Ki=c(function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:Ki(t,e):!1},"traverseAncerstors"),Xl=c(function(r){return function(e){var t=c(function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)},"constraint");return t.metaData=new Tr(r,e),t}},"taggedConstraint"),Qu=Xl(ei),vf=c(function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else {var i=e.bindings[0].implementationType;return r===i}return !1}},"typeConstraint"),fd=function(){function r(e){this._binding=e;}return c(r,"BindingWhenSyntax"),r.prototype.when=function(e){return this._binding.constraint=e,new bn(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=Qu(e),new bn(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return !1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new bn(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Xl(e)(t),new bn(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&vf(e)(t.parentRequest)},new bn(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&Qu(e)(t.parentRequest)},new bn(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&Xl(e)(t)(n.parentRequest)},new bn(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&Ki(t,vf(e))},new bn(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!Ki(t,vf(e))},new bn(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&Ki(t,Qu(e))},new bn(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!Ki(t,Qu(e))},new bn(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&Ki(n,Xl(e)(t))},new bn(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!Ki(n,Xl(e)(t))},new bn(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&Ki(t,e)},new bn(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!Ki(t,e)},new bn(this._binding)},r}(),bn=function(){function r(e){this._binding=e;}return c(r,"BindingOnSyntax"),r.prototype.onActivation=function(e){return this._binding.onActivation=e,new fd(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new fd(this._binding)},r}(),er=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new fd(this._binding),this._bindingOnSyntax=new bn(this._binding);}return c(r,"BindingWhenOnSyntax"),r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}(),bL=function(){function r(e){this._binding=e;}return c(r,"BindingInSyntax"),r.prototype.inRequestScope=function(){return this._binding.scope=Xt.Request,new er(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=Xt.Singleton,new er(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=Xt.Transient,new er(this._binding)},r}(),wA=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new fd(this._binding),this._bindingOnSyntax=new bn(this._binding),this._bindingInSyntax=new bL(e);}return c(r,"BindingInWhenOnSyntax"),r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}(),vL=function(){function r(e){this._binding=e;}return c(r,"BindingToSyntax"),r.prototype.to=function(e){return this._binding.type=Mt.Instance,this._binding.implementationType=e,new wA(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+m2);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=Mt.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Xt.Singleton,new er(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=Mt.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new wA(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=Mt.Constructor,this._binding.implementationType=e,this._binding.scope=Xt.Singleton,new er(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=Mt.Factory,this._binding.factory=e,this._binding.scope=Xt.Singleton,new er(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(f2);var t=this.toConstantValue(e);return this._binding.type=Mt.Function,this._binding.scope=Xt.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=Mt.Factory,this._binding.factory=function(t){var n=c(function(){return t.container.get(e)},"autofactory");return n},this._binding.scope=Xt.Singleton,new er(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=Mt.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new er(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=Mt.Provider,this._binding.provider=e,this._binding.scope=Xt.Singleton,new er(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)});},r}(),_L=function(){function r(){}return c(r,"ContainerSnapshot"),r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();function yL(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}c(yL,"isClonable");var Fr=function(){function r(){this._map=new Map;}return c(r,"Lookup"),r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Wl);if(t==null)throw new Error(Wl);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t]);},r.prototype.get=function(e){if(e==null)throw new Error(Wl);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(mA)},r.prototype.remove=function(e){if(e==null)throw new Error(Wl);if(!this._map.delete(e))throw new Error(mA)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return !o.some(function(l){return a===l})});t._setValue(n,s);}});},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var u=l[a],d=e(u);d?n.push(u):s.push(u);}t._setValue(o,s);}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Wl);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,yL(i)?i.clone():i)});}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t);});},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e);},r}(),wL=function(){function r(){this._map=new Map;}return c(r,"ModuleActivationStore"),r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n);},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n);},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()});}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new Fr,onDeactivations:new Fr};return e},r}(),pd=function(){return pd=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);}return r},pd.apply(this,arguments)},qn=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o);})}return c(i,"adopt"),new(t||(t=Promise))(function(o,s){function a(d){try{u(n.next(d));}catch(h){s(h);}}c(a,"fulfilled");function l(d){try{u(n.throw(d));}catch(h){s(h);}}c(l,"rejected");function u(d){d.done?o(d.value):i(d.value).then(a,l);}c(u,"step"),u((n=n.apply(r,[])).next());})},Kn=function(r,e){var t={label:0,sent:c(function(){if(o[0]&1)throw o[1];return o[1]},"sent"),trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t);}catch(d){u=[6,d],i=0;}finally{n=o=0;}if(u[0]&5)throw u[1];return {value:u[0]?u[1]:void 0,done:!0}}},SL=function(r,e,t){for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))},AL=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+b2);if(t.defaultScope===void 0)t.defaultScope=Xt.Transient;else if(t.defaultScope!==Xt.Singleton&&t.defaultScope!==Xt.Transient&&t.defaultScope!==Xt.Request)throw new Error(""+v2);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+_2);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+y2);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Au(),this._bindingDictionary=new Fr,this._snapshots=[],this._middleware=null,this._activations=new Fr,this._deactivations=new Fr,this.parent=null,this._metadataReader=new T2,this._moduleActivationStore=new wL;}return c(r,"Container"),r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=SL([e,t],n).map(function(u){return hd(u)}),a=hd(o);function l(u,d){u.traverse(function(h,p){p.forEach(function(m){d.add(m.serviceIdentifier,m.clone());});});}return c(l,"copyDictionary"),s.forEach(function(u){l(u,a);}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction);}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qn(this,void 0,void 0,function(){var n,i,o,s,a;return Kn(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return [2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id);});},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qn(this,void 0,void 0,function(){var n,i,o,s;return Kn(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return [2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||Xt.Transient,n=new n2(e,t);return this._bindingDictionary.add(e,n),new vL(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return qn(this,void 0,void 0,function(){return Kn(this,function(t){switch(t.label){case 0:return [4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t);}this._removeServiceFromDictionary(e);},r.prototype.unbindAsync=function(e){return qn(this,void 0,void 0,function(){var t;return Kn(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n);}),this._bindingDictionary=new Fr;},r.prototype.unbindAllAsync=function(){return qn(this,void 0,void 0,function(){var e,t=this;return Kn(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o));}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new Fr,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t);},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t);},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return !t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,ei,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=B2(this,e,t,n);i=o.some(function(a){return a.constraint(s)});}return !i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(_L.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()));},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(d2);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore;},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n);},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e;},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return qn(this,void 0,void 0,function(){var t;return Kn(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return qn(this,void 0,void 0,function(){var i;return Kn(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,ei,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,ei,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,ei,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,ei,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){var n,i;if(Reflect.hasMetadata(Vf,e)){var o=Reflect.getMetadata(Vf,e);return (i=(n=t)[o.value])===null||i===void 0?void 0:i.call(n)}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations);},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(jn(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if(jn(s))return this._handleDeactivationError(s,i)}catch(a){if(a instanceof Error)throw new Error(Jf(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return qn(this,void 0,void 0,function(){var n;return Kn(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:if(n=i.sent(),n instanceof Error)throw new Error(Jf(t.name,n.message));return [3,3];case 3:return [2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if(jn(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next();}},r.prototype._deactivateContainerAsync=function(e,t){return qn(this,void 0,void 0,function(){var n;return Kn(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return [2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=c(function(d,h){d._binding.moduleId=h;},"setModuleId"),n=c(function(d){return function(h){var p=e.bind(h);return t(p,d),p}},"getBindFunction"),i=c(function(){return function(d){return e.unbind(d)}},"getUnbindFunction"),o=c(function(){return function(d){return e.unbindAsync(d)}},"getUnbindAsyncFunction"),s=c(function(){return function(d){return e.isBound(d)}},"getIsboundFunction"),a=c(function(d){return function(h){var p=e.rebind(h);return t(p,d),p}},"getRebindFunction"),l=c(function(d){return function(h,p){e._moduleActivationStore.addActivation(d,h,p),e.onActivation(h,p);}},"getOnActivationFunction"),u=c(function(d){return function(h,p){e._moduleActivationStore.addDeactivation(d,h,p),e.onDeactivation(h,p);}},"getOnDeactivationFunction");return function(d){return {bindFunction:n(d),isboundFunction:s(),onActivationFunction:l(d),onDeactivationFunction:u(d),rebindFunction:a(d),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=pd(pd({},e),{contextInterceptor:c(function(i){return i},"contextInterceptor"),targetType:Su.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(h2);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(FD(t))throw new Error(p2(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=U2(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=gL(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return jn(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if(jn(o))throw new Error(S2)}},r.prototype._deactivateSingletonsAsync=function(e){return qn(this,void 0,void 0,function(){var t=this;return Kn(this,function(n){switch(n.label){case 0:return [4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return qn(this,void 0,void 0,function(){return Kn(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return [4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return [2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e);}catch{throw new Error(o2+" "+Ac(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if(jn(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return qn(this,void 0,void 0,function(){return Kn(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return [4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();function kL(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i);}}c(kL,"getFirstArrayDuplicate");function CL(r){return r.prototype!==void 0}c(CL,"targetIsConstructorFunction");function IL(r){if(r!==void 0)throw new Error(GD)}c(IL,"_throwIfMethodParameter");function TL(r,e,t,n){IL(e),qD(PD,r,t.toString(),n);}c(TL,"tagParameter");function DL(r,e,t){if(CL(r))throw new Error(GD);qD(ND,r.constructor,e,t);}c(DL,"tagProperty");function EL(r){var e=[];if(Array.isArray(r)){e=r;var t=kL(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(OD+" "+t.toString())}else e=[r];return e}c(EL,"_ensureNoMetadataKeyDuplicates");function qD(r,e,t,n){var i=EL(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=c(function(h){if(i.some(function(p){return p.key===h.key}))throw new Error(OD+" "+h.key.toString())},"_loop_1"),l=0,u=s;l<u.length;l++){var d=u[l];a(d);}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e);}c(qD,"_tagParameterOrProperty");function ML(r){return function(e,t,n){typeof n=="number"?TL(e,t,n,r):DL(e,t,r);}}c(ML,"createTaggedDecorator");function we(){return function(r){if(Reflect.hasOwnMetadata(xf,r))throw new Error(i2);var e=Reflect.getMetadata(KR,r)||[];return Reflect.defineMetadata(xf,e,r),r}}c(we,"injectable");function RL(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error(l2(o))}return ML(new Tr(r,e))(t,n,i)}}}c(RL,"injectBase");var D=RL(yh);function LL(r,e){return function(){return function(t,n){var i=new Tr(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor);}}}c(LL,"propertyEventDecorator");var zr=LL(Zf,w2),KD=Object.defineProperty,PL=Object.getOwnPropertyDescriptor,NL=c((r,e,t)=>e in r?KD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,"__defNormalProp"),OL=c((r,e,t,n)=>{for(var i=n>1?void 0:n?PL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&KD(e,t,i),i},"__decorateClass$25"),eE=c((r,e,t)=>NL(r,typeof e!="symbol"?e+"":e,t),"__publicField"),ls;let ni=(ls=class{constructor(){f(this,"_prefix","skribbltypo");f(this,"_printEnabledSetting",new He("logging.printLogEnabled",!0).withName("Print Logs").withDescription("Print extension event logs to the browser console"));f(this,"_loggers",[]);f(this,"_logLevelSettings",new Map);f(this,"_events$",new be);f(this,"_recordedEvents",[]);this._events$.subscribe(e=>{this.printEvent(e),this._recordedEvents.push(e);});}trackLoggerInstance(e){const t=new dt(`logging.logLevel.${e.boundTo}`,ni.defaultLogLevel).withName(`Log level for ${e.boundTo}`).withDescription(`The minimum log level filter for the logger bound to ${e.boundTo}`);t.changes$.subscribe(n=>e.level=n),this._logLevelSettings.set(e,t),this._loggers.push(e),e.events$.pipe(Oe(this._printEnabledSetting.changes$)).subscribe(([n,i])=>{i&&this._events$.next(n);});}getTimestamp(e){return `${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`}getLevelString(e){switch(e){case"debug":return "DEB ";case"info":return "INFO";case"warn":return "WARN";case"error":return "ERR "}}printEvent(e){console.log(`%c ${this.getTimestamp(e.date)} %c[${this._prefix}] [${this.getLevelString(e.logLevel)}]  (${e.bindingName})`,ni.styles.date,ni.styles[e.logLevel],e.message,...e.data);}get recordedEvents(){return this._recordedEvents}get loggers(){return this._loggers}get printEnabledSetting(){return this._printEnabledSetting}getLogLevelSetting(e){const t=this._logLevelSettings.get(e);if(!t)throw new Error(`Logger settings for ${e.boundTo} not found`);return t.asFrozen}},c(ls,"LoggingService"),ls);eE(ni,"defaultLogLevel","debug");eE(ni,"styles",{debug:"color: lightGray; font-weight: bold;",info:"color: lightBlue; font-weight: bold;",warn:"color: orange; font-weight: bold;",error:"color: red; font-weight: bold;",date:"color: darkGrey; font-weight: light;"});ni=OL([we()],ni);const qb=class qb{};c(qb,"ApplicationEvent");let $t=qb;const rt=Symbol("loggerFactory");var jL=Object.defineProperty,GL=Object.getOwnPropertyDescriptor,$L=c((r,e,t,n)=>{for(var i=n>1?void 0:n?GL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&jL(e,t,i),i},"__decorateClass$24"),YL=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$v"),cs;let Va=(cs=class{constructor(e){f(this,"_logger");f(this,"_events$",new be);this._logger=e(this);}get events$(){return this._events$.asObservable()}publishEvent(e){this._events$.next(e);}},c(cs,"EventsService"),cs);Va=$L([we(),YL(0,D(rt))],Va);var zL=Object.defineProperty,UL=Object.getOwnPropertyDescriptor,tE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?UL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&zL(e,t,i),i},"__decorateClass$23"),SA=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$u"),us;let Ot=(us=class{constructor(e,t){f(this,"_logger");this._eventsService=t,this._logger=e(this);}start(){this._logger.info("Starting event processor");const e=this.streamEvents();e instanceof Promise?e.then(t=>this.publishEvents(t)):this.publishEvents(e);}publishEvents(e){e.subscribe(t=>{this._eventsService.publishEvent(t);});}isProcessorEvent(e){return e instanceof this.eventType}},c(us,"EventProcessor"),us);tE([zr()],Ot.prototype,"start",1);Ot=tE([we(),SA(0,D(rt)),SA(1,D(Va))],Ot);var BL=Object.defineProperty,xL=Object.getOwnPropertyDescriptor,ZL=c((r,e,t,n)=>{for(var i=n>1?void 0:n?xL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&BL(e,t,i),i},"__decorateClass$22"),AA=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$t"),ds;let Yt=(ds=class{constructor(e,t){f(this,"_events$");f(this,"_logger");this._eventsService=e,this._logger=t(this),this._events$=e.events$.pipe(Se(n=>this._processor.isProcessorEvent(n)));}get events$(){return this._events$}},c(ds,"EventListener"),ds);Yt=ZL([we(),AA(0,D(Va)),AA(1,D(rt))],Yt);var VL=Object.defineProperty,JL=Object.getOwnPropertyDescriptor,rb=c((r,e,t,n)=>{for(var i=n>1?void 0:n?JL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&VL(e,t,i),i},"__decorateClass$21");const Kb=class Kb extends $t{constructor(e){super(),this.data=e;}};c(Kb,"CanvasClearedEvent");let md=Kb;var hs;let gd=(hs=class extends Ot{constructor(){super(...arguments);f(this,"eventType",md);}async streamEvents(){const t=new be;return document.addEventListener("logCanvasClear",n=>{const i=n.detail;t.next(new md(i));}),t}},c(hs,"CanvasClearedEventProcessor"),hs);gd=rb([we()],gd);var fs;let Cc=(fs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(fs,"CanvasClearedEventListener"),fs);rb([D(gd)],Cc.prototype,"_processor",2);Cc=rb([we()],Cc);const FL={listenerType:Cc,processorType:gd},ev=class ev extends se{constructor(e){super(),le(this,e,null,null,re,{});}};c(ev,"Chat_controls");let Ff=ev;const tv=class tv{constructor(e,t){this.interpretable=e,this.message=t;}};c(tv,"InterpretableResult");let Ic=tv;const nv=class nv extends Ic{};c(nv,"InterpretableSuccess");let vn=nv;const lh=class lh{constructor(e){f(this,"_execute");f(this,"_builtInterpretable");this._interpretableBuilder=e;}chainInterpretable(e){const t=new lh(e);return this.setExecute(async(n,i)=>({next:t.build(),result:new vn(this.interpretable)})),t}setExecute(e){return this._execute=e,this}build(){if(!this._execute||!this._interpretableBuilder)throw new Error("Cannot build interpretable without execute function");const e=this._execute;return this._builtInterpretable=this._interpretableBuilder((t,n)=>e(t,n)),this._builtInterpretable}get interpretable(){if(!this._builtInterpretable)throw new Error("Interpretable has not yet been built");return this._builtInterpretable}};c(lh,"DeferredInterpretableBuilder");let Wf=lh;const iv=class iv extends vn{constructor(e,t,n){super(e,t),this.run=n;}};c(iv,"InterpretableDeferResult");let Tc=iv;const rc=class rc{constructor(e,t=[]){this._interpretableDeferred=e,this._precedingParams=t;}static forCommand(e){const t=new Wf(n=>e.setExecute(n));return new rc(t)}addParam(e){const t=this._interpretableDeferred.chainInterpretable(n=>e.withAction(n));return new rc(t,[...this._precedingParams,e])}run(e){return this._interpretableDeferred.setExecute(async t=>{const n=this._interpretableDeferred.interpretable;return {result:new Tc(n,void 0,()=>e(t,n))}}),this._precedingParams}build(){this._interpretableDeferred.build();}};c(rc,"CommandParamsBuilder");let Hf=rc;const rv=class rv extends Ic{};c(rv,"InterpretableError");let Gn=rv;const ov=class ov extends Gn{};c(ov,"InterpretableCommandPartialMatch");let Ja=ov;const sv=class sv{constructor(e,t,n,i,o=!0){f(this,"_id");f(this,"_enabledSetting");f(this,"_execute");f(this,"_params",[]);this._defaultId=e,this._feature=t,this._name=n,this._description=i,this._defaultEnabled=o,this._id=new dt(`command.${this._defaultId}.name`,this._defaultId,this._feature),this._enabledSetting=new dt(`command.${this._defaultId}.enabled`,this._defaultEnabled,this._feature);}get name(){return this._name}get defaultId(){return this._defaultId}get description(){return this._description}get idSetting(){return this._id.asFrozen}get enabledSetting(){return this._enabledSetting.asFrozen}get params(){return this._params}async interpret(e,t,n){const i=await Ee(this._id.changes$);if(e.startsWith(i)){const o=e.substring(i.length);return {context:n,remainder:o,result:{}}}if(e.length>0&&i.startsWith(e))throw new Ja(this);return null}execute(e,t){var n;return ((n=this._execute)==null?void 0:n.call(this,e,t))??Promise.resolve({result:new vn(this)})}setExecute(e){return this._execute=e,this}run(e){return this.setExecute(async()=>({result:new Tc(this,void 0,()=>e(this))})),this}withParameters(e){const t=Hf.forCommand(this);return this._params=e(t),t.build(),this}};c(sv,"ExtensionCommand");let ti=sv;var WL=Object.defineProperty,HL=Object.getOwnPropertyDescriptor,QL=c((r,e,t,n)=>{for(var i=n>1?void 0:n?HL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&WL(e,t,i),i},"__decorateClass$20"),XL=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$s"),ps;let bd=(ps=class{constructor(e){f(this,"_logger");f(this,"_registeredCommands",[]);f(this,"_activeCommands$",new Le([]));this._logger=e(this);}registerCommand(e){this._registeredCommands.push(e),this._activeCommands$.next(this._registeredCommands);}removeCommand(e){this._registeredCommands=this._registeredCommands.filter(t=>t!==e),this._activeCommands$.next(this._registeredCommands);}get commands$(){return this._activeCommands$.pipe(lt(e=>{const t=e.map(n=>n.enabledSetting.changes$.pipe(ce(i=>({command:n,enabled:i}))));return Hr(...t)}),ce(e=>e.filter(t=>t.enabled).map(t=>t.command)))}async executeCommand(e,t){const n={parameters:e.params,command:e};return {result:await this.executeInterpretable(e,t,{},n),context:n}}async executeInterpretable(e,t,n,i){let o;try{o=await e.interpret(t,n,i);}catch(a){if(a instanceof Gn)return a;throw a}if(o===null)return null;let s;try{s=await e.execute(o.result,i);}catch(a){if(a instanceof Gn)return a;throw a}return this._logger.debug("Interpretable execution result",e,s),s.next!==void 0?await this.executeInterpretable(s.next,o.remainder,o.result,i):s.result}},c(ps,"CommandsService"),ps);bd=QL([we(),XL(0,D(rt))],bd);var qL=Object.defineProperty,KL=Object.getOwnPropertyDescriptor,eP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?KL(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&qL(e,t,i),i},"__decorateClass$1$"),tP=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$r"),ms;let vd=(ms=class{constructor(e){f(this,"_logger");f(this,"_registeredHotkeys",[]);this._logger=e(this);}registerHotkey(e){if(this._registeredHotkeys.includes(e)){this._logger.warn("Attempted to register a hotkey that was already registered",e);return}this._registeredHotkeys.push(e),this._logger.debug("Registered hotkey",e);}removeHotkey(e){const t=this._registeredHotkeys.length;this._registeredHotkeys=this._registeredHotkeys.filter(n=>n!==e),t===this._registeredHotkeys.length&&this._logger.warn("Attempted to remove a hotkey that was not registered",e),this._logger.debug("Removed hotkey",e);}get registeredHotkeys(){return [...this._registeredHotkeys]}async setHotkeyCombo(e,t){try{t.length===0&&(this._logger.debug("Saving empty hotkey combo; disabling hotkey"),await e.enabledSetting.setValue(!1)),await e.comboSetting.setValue(t);}catch(n){throw this._logger.error("Error updating hotkey combo",n),n}this._logger.info("Updated hotkey combo",e.name,t);}async resetHotkeyCombo(e){try{await e.comboSetting.setValue([...e.defaultCombo??[]]),(e.defaultCombo===void 0||e.defaultCombo.length===0)&&(this._logger.debug("Resetting hotkey combo to empty; disabling hotkey"),await e.enabledSetting.setValue(!1));}catch(t){throw this._logger.error("Error updating hotkey combo",t),t}return this._logger.info("Reset hotkey combo",e.name),[...e.defaultCombo??[]]}},c(ms,"HotkeysService"),ms);vd=eP([we(),tP(0,D(rt))],vd);var nP=Object.defineProperty,iP=Object.getOwnPropertyDescriptor,rP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?iP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&nP(e,t,i),i},"__decorateClass$1_"),oP=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$q"),gs;let _d=(gs=class{constructor(e){f(this,"_logger");f(this,"_registeredTooltips",new Map);f(this,"_changes",new be);f(this,"_tooltipClass","typo-tooltip-registered");f(this,"_observer",new MutationObserver(e=>{let t=!1;e.forEach(n=>{n.type==="childList"&&n.removedNodes.forEach(i=>{i instanceof HTMLElement&&this.getTooltipsOfElement(i).forEach(s=>{s instanceof HTMLElement&&(this._logger.debug("Removing tooltip from element",s),this._registeredTooltips.delete(s),t=!0);});});}),t&&this._changes.next();}));this._logger=e(this),this._observer.observe(document.body,{childList:!0,subtree:!0});}registerTooltip(e,t,n){this._registeredTooltips.has(e)&&this._logger.debug("Overriding tooltip for element",e,t,n);const i={target:e,...t,feature:n};this._registeredTooltips.set(e,i),e.classList.toggle(this._tooltipClass,!0),this._changes.next(),this._logger.debug("Registered tooltip",i);}get tooltips$(){return this._changes.pipe(lr(null),ce(()=>Array.from(this._registeredTooltips.values())))}getTooltipsOfElement(e){const t=e.classList.contains(this._tooltipClass),n=[...e.querySelectorAll(`.${this._tooltipClass}`)].filter(i=>i instanceof HTMLElement);return t?[e,...n]:n}getTooltipsUntilElement(e){const t=[];let n=e.closest(`.${this._tooltipClass}`);for(;n!=null&&n.parentElement instanceof HTMLElement;)t.push(n),n=n.parentElement.closest(`.${this._tooltipClass}`);return t}},c(gs,"TooltipsService"),gs);_d=rP([we(),oP(0,D(rt))],_d);var sP=Object.defineProperty,aP=Object.getOwnPropertyDescriptor,lP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?aP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&sP(e,t,i),i},"__decorateClass$1Z"),cP=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$p"),bs;let Dc=(bs=class{constructor(e){f(this,"_logger");f(this,"_completedTasks",new dt("completed_onboarding_tasks",[]));f(this,"_tasks",[]);f(this,"_taskCompleted$",new be);this._logger=e(this);}registerTask(e){var i;const t=`${((i=e.feature)==null?void 0:i.name)??"global"}_${e.key}`,n={name:e.name,description:e.description,key:t,start:e.start,priority:e.priority??Number.MAX_SAFE_INTEGER};return this._tasks.push(n),{complete:c(()=>this._completedTasks.changes$.pipe(vt(1)).subscribe(o=>{o.includes(t)||(o.push(t),this._completedTasks.setValue(o),this._taskCompleted$.next(n));}),"complete"),clear:c(()=>this._completedTasks.changes$.pipe(vt(1)).subscribe(o=>{o.includes(t)&&(o.splice(o.indexOf(t),1),this._completedTasks.setValue(o));}),"clear"),completed:c(async()=>(await this._completedTasks.getValue()).includes(t),"completed"),task:n}}async getOnboardingTasks(){const e=await this._completedTasks.getValue();return Promise.all(this._tasks.map(async t=>({...t,completed:e.includes(t.key)})))}get taskCompleted$(){return this._taskCompleted$.asObservable()}},c(bs,"OnboardingService"),bs);Dc=lP([we(),cP(0,D(rt))],Dc);var uP=Object.defineProperty,dP=Object.getOwnPropertyDescriptor,nE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?dP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&uP(e,t,i),i},"__decorateClass$1Y"),Hl=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$o"),vs;let $e=(vs=class{constructor(e,t,n,i,o){f(this,"featureEnabledDefault",!0);f(this,"_isActivated",!1);f(this,"_hotkeys",[]);f(this,"_settings",[]);f(this,"_commands",[]);f(this,"onboardingTaskFactories",[]);f(this,"toggleEnabled",!0);f(this,"developerFeature",!1);f(this,"_isActivatedSetting",new He("isActivated",this.featureEnabledDefault,this).withName("Activated").withDescription("Enable or disable the feature. Disabled features will reset and remove every functionality, mods and hotkeys."));f(this,"_logger");this._hotkeysService=t,this._tooltipsService=n,this._commandsService=i,this._onboardingService=o,this._logger=e(this);}get boundServices(){return []}useHotkey(e){return this._hotkeys.push(e),e}useOnboardingTask(e){return new Promise(t=>{const n=c(()=>{const i=c(async()=>(this._isActivated||(this._logger.debug("Activating feature for onboarding task",e.key),await this.activate()),await e.start()??!0),"startWithActivation"),o=this._onboardingService.registerTask({...e,feature:this,start:i});t(o);},"factory");this.onboardingTaskFactories.push(n);})}useCommand(e){return this._commands.push(e),e}useSetting(e){return this._settings.push(e),e}get hotkeys(){return this._hotkeys}get settings(){return this._settings}get commands(){return this._commands}get featureTags(){return this.tags}get activated(){return this._isActivated}get featureManagementComponent(){}get featureInfoComponent(){}get hasDetailComponents(){return this.hotkeys.length>0||this.commands.length>0||this.featureManagementComponent!==void 0||this.featureInfoComponent!==void 0||this._settings.length>0}postConstruct(){this._logger.debug("onConstruct not implemented");}onActivate(){this._logger.debug("onActivate not implemented");}onDestroy(){this._logger.debug("onDestroy not implemented");}init(){this._isActivatedSetting.setDefaultValue(this.featureEnabledDefault);const e=c(()=>{this._isActivatedSetting.getValue().then(n=>{this._logger.debug("Feature loaded with activation state",n),n&&this.activate();});},"loadActivation"),t=this.postConstruct();t instanceof Promise?t.then(e):e();for(const n of this.onboardingTaskFactories)n();}async activate(){if(this._isActivated)throw this._logger.warn("Attempted to activate feature while already activated"),new Error("Feature is already activated");this._logger.info("Activating feature"),await Promise.all(this.boundServices.map(t=>t.onFeatureActivate()));const e=this.onActivate();e instanceof Promise&&await e,this._isActivated=!0,await this._isActivatedSetting.setValue(!0),this._hotkeys.length!==0&&(this._logger.debug("Registering feature hotkeys",this._hotkeys),this._hotkeys.forEach(t=>this._hotkeysService.registerHotkey(t)));for(const t of this._commands)this._commandsService.registerCommand(t);}async destroy(){if(!this._isActivated)throw this._logger.warn("Attempted to destroy feature without activation"),new Error("Feature is not activated");this._logger.info("Destroying feature");const e=this.onDestroy();e instanceof Promise&&await e,this._isActivated=!1,await this._isActivatedSetting.setValue(!1),await Promise.all(this.boundServices.map(t=>t.onFeatureDestroy())),this._hotkeys.length!==0&&(this._logger.debug("Removing feature hotkeys",this._hotkeys),this._hotkeys.forEach(t=>this._hotkeysService.removeHotkey(t)));for(const t of this._commands)this._commandsService.removeCommand(t);}get activated$(){return this._isActivatedSetting.changes$}registerTooltip(e,t){this._logger.debug("Registering tooltip",e,t),this._tooltipsService.registerTooltip(e,t,this);}get createTooltip(){return (e,t)=>(this.registerTooltip(e,t),{update:c(n=>{this.registerTooltip(e,n);},"update")})}},c(vs,"TypoFeature"),vs);nE([zr()],$e.prototype,"init",1);$e=nE([we(),Hl(0,D(rt)),Hl(1,D(vd)),Hl(2,D(_d)),Hl(3,D(bd)),Hl(4,D(Dc))],$e);var hP=Object.defineProperty,fP=Object.getOwnPropertyDescriptor,pP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?fP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&hP(e,t,i),i},"__decorateClass$1X"),_s;let yd=(_s=class{constructor(){f(this,"_level","debug");f(this,"_levels",{debug:1,info:2,warn:3,error:4});f(this,"_boundTo");f(this,"_events$",new be);}set level(e){this._level=e;}get level(){return this._level}bindTo(e){return this._boundTo=e,this}get boundTo(){var e;return ((e=this._boundTo)==null?void 0:e.constructor.name)??" / "}get boundType(){return this._boundTo instanceof $e?"feature":"other"}get events$(){return this._events$.asObservable()}debug(e,...t){this._levels[this.level]>this._levels.debug||this._events$.next({logLevel:"debug",message:e,data:t,date:new Date,bindingName:this.boundTo});}info(e,...t){this._levels[this.level]>this._levels.info||this._events$.next({logLevel:"info",message:e,data:t,date:new Date,bindingName:this.boundTo});}warn(e,...t){this._levels[this.level]>this._levels.warn||this._events$.next({logLevel:"warn",message:e,data:t,date:new Date,bindingName:this.boundTo});}error(e,...t){this._levels[this.level]>this._levels.error||this._events$.next({logLevel:"error",message:e,data:t,date:new Date,bindingName:this.boundTo});}},c(_s,"LoggerService"),_s);yd=pP([we()],yd);var mP=Object.defineProperty,gP=Object.getOwnPropertyDescriptor,bP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?gP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&mP(e,t,i),i},"__decorateClass$1W"),vP=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$n"),ys;let un=(ys=class{constructor(e){f(this,"_logger");f(this,"_setupPromise");this._logger=e(this);}complete(){return this._setupPromise===void 0&&(this._logger.info("Running setup"),this._setupPromise=this.runSetup(),this._setupPromise.then(()=>{this._logger.info("Setup completed");})),this._setupPromise}},c(ys,"Setup"),ys);un=bP([we(),vP(0,D(rt))],un);const Ec=c((r,e,t)=>(t.insertAdjacentElement(e,r),r),"appendElement"),nn=c(r=>{const e=document.createElement("template");return e.innerHTML=r.trim(),e.content.firstChild},"createElement"),iE=Symbol("earlySetup");function Do(){return function(r){Reflect.defineMetadata(iE,!0,r);}}c(Do,"earlySetup");function _P(r){return Reflect.getMetadata(iE,r)}c(_P,"isEarlySetup");var yP=Object.defineProperty,wP=Object.getOwnPropertyDescriptor,rE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?wP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&yP(e,t,i),i},"__decorateClass$1V"),ws;let ur=(ws=class extends un{constructor(){super(...arguments);f(this,"_interceptor");}async runSetup(){return Ee(this._interceptor.patchLoaded$)}},c(ws,"GamePatchReadySetup"),ws);rE([D(to)],ur.prototype,"_interceptor",2);ur=rE([Do()],ur);var SP=Object.defineProperty,AP=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&SP(e,t,i),i},"__decorateClass$1U");const av=class av extends un{constructor(){super(...arguments);f(this,"_gameReadySetup");}async runSetup(){await this._gameReadySetup.complete();const t=Ec(nn("<div class='typo-chat-controls'></div>"),"afterbegin",Ye("#game-wrapper"));return new Ff({target:t}),t}};c(av,"ChatControlsSetup");let Mc=av;AP([D(ur)],Mc.prototype,"_gameReadySetup");const lv=class lv{constructor(e,t,n,i,o,s,a,l,u=!0){f(this,"_enabledSetting");f(this,"_comboSetting");f(this,"_onceListeners",[]);this._key=e,this._name=t,this._description=n,this._feature=i,this._action=o,this._defaultCombo=a,this._releaseAction=l,this._preventWhenInputActive=u,this._enabledSetting=new dt(`hotkey.${this._key}.enabled`,s===!0&&this._defaultCombo!==void 0&&this._defaultCombo.length>0,this._feature),this._comboSetting=new dt(`hotkey.${this._key}.combo`,this._defaultCombo??[],this._feature);}get disabledOnInputs(){return this._preventWhenInputActive}get name(){return this._name}get description(){return this._description}get enabledSetting(){return this._enabledSetting.asFrozen}get comboSetting(){return this._comboSetting.asFrozen}get defaultCombo(){return this._defaultCombo}once(e){this._onceListeners.push(e);}executeIfMatches(e,t){return this._enabledSetting.changes$.pipe(vt(1),lt(n=>n?this._comboSetting.changes$.pipe(vt(1),ce(i=>!(this._preventWhenInputActive&&t)&&i.length>0?i:null),ce(i=>i?i.length===e.length&&i.every(o=>e.includes(o)):!1)):Tt(!1)),lt(n=>{if(!n)return Tt(!1);const i=this._action(),o=[...this._onceListeners];this._onceListeners=[];const s=o.map(a=>a());return s.push(i),Promise.all(s)}))}releaseIfNotMatches(e){return this._comboSetting.changes$.pipe(vt(1),ce(t=>t?t.length===e.length&&t.every(n=>e.includes(n)):!1),lt(t=>{if(t)return Tt(!1);if(this._releaseAction){const n=this._releaseAction();return n instanceof Promise?Ri(n).pipe(ce(()=>!0)):Tt(!0)}return Tt(!0)}))}};c(lv,"HotkeyAction");let cn=lv;var kP=Object.defineProperty,CP=Object.getOwnPropertyDescriptor,IP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?CP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&kP(e,t,i),i},"__decorateClass$1T"),TP=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$m"),Ss;let xn=(Ss=class{constructor(e){f(this,"_globalHotkeysList",{exitModal:new cn("modal_close","Close Modal","Close open modals using a hotkey",void 0,()=>{},!0,["Escape"])});f(this,"_settings",{devMode:new He("devMode",!1).withName("Developer Mode").withDescription("Enable some developer features & settings"),controlsPosition:new cr("controlsPosition","topleft").withName("Control Icons Position").withDescription("The position where the typo controls are displayed").withChoices([{name:"Top Right",choice:"topright"},{name:"Top Left",choice:"topleft"},{name:"Bottom Right",choice:"bottomright"},{name:"Bottom Left",choice:"bottomleft"}]),controlsDirection:new cr("controlsDirection","vertical").withName("Control Icons Direction").withDescription("The direction where the typo controls are lined up").withChoices([{name:"Horizontal",choice:"horizontal"},{name:"Vertical",choice:"vertical"}]),showLandingOutfit:new He("showLandingOutfit",!0).withName("Customizer Outfit").withDescription("Show your current outfit on the avatar customizer")});f(this,"_logger");this._logger=e(this);}get globalHotkeys(){return this._globalHotkeysList}get globalHotkeysList(){return Object.values(this._globalHotkeysList)}get settings(){return this._settings}get settingsList(){return Object.values(this._settings)}},c(Ss,"GlobalSettingsService"),Ss);xn=IP([we(),TP(0,D(rt))],xn);function DP(r){let e,t,n,i,o;return {c(){e=v("div"),t=v("div"),_(t,"class","typo-controls-mobile-expand svelte-1c97t9h"),H(t,"background-image","var(--file-img-typo-gif)"),_(e,"class",n="typo-controls "+r[2]+" "+r[3]+" svelte-1c97t9h"),ue(e,"expanded",r[1]);},m(s,a){k(s,e,a),g(e,t),r[9](e),i||(o=F(t,"click",r[8]),i=!0);},p(s,[a]){a&12&&n!==(n="typo-controls "+s[2]+" "+s[3]+" svelte-1c97t9h")&&_(e,"class",n),a&14&&ue(e,"expanded",s[1]);},i:j,o:j,d(s){s&&A(e),r[9](null),i=!1,o();}}}c(DP,"create_fragment$1H");function EP(r,e,t){let n,i,o,s,{globalSettings:a}=e;const l=new Promise(b=>{s=b;});li(()=>{s(o);});const u=a.settings.controlsPosition.store;De(r,u,b=>t(2,n=b));const d=a.settings.controlsDirection.store;De(r,d,b=>t(3,i=b));let h=!1;const p=c(()=>t(1,h=!h),"click_handler");function m(b){Ve[b?"unshift":"push"](()=>{o=b,t(0,o);});}return c(m,"div1_binding"),r.$$set=b=>{"globalSettings"in b&&t(6,a=b.globalSettings);},[o,h,n,i,u,d,a,l,p,m]}c(EP,"instance$1x");const cv=class cv extends se{constructor(e){super(),le(this,e,EP,DP,re,{globalSettings:6,element:7});}get element(){return this.$$.ctx[7]}};c(cv,"Controls");let Qf=cv;var MP=Object.defineProperty,oE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&MP(e,t,i),i},"__decorateClass$1S");const uv=class uv extends un{constructor(){super(...arguments);f(this,"_gameReadySetup");f(this,"_settingsService");}async runSetup(){return await this._gameReadySetup.complete(),await new Qf({target:document.body,props:{globalSettings:this._settingsService}}).element}};c(uv,"ControlsSetup");let Fa=uv;oE([D(ur)],Fa.prototype,"_gameReadySetup");oE([D(xn)],Fa.prototype,"_settingsService");function RP(r){let e;return {c(){e=v("div"),_(e,"class","typo-customizer-actions svelte-2foe7d");},m(t,n){k(t,e,n),r[2](e);},p:j,i:j,o:j,d(t){t&&A(e),r[2](null);}}}c(RP,"create_fragment$1G");function LP(r,e,t){let n,i;const o=new Promise(a=>{i=a;});li(()=>{i(n);});function s(a){Ve[a?"unshift":"push"](()=>{n=a,t(0,n);});}return c(s,"div_binding"),[n,o,s]}c(LP,"instance$1w");const dv=class dv extends se{constructor(e){super(),le(this,e,LP,RP,re,{element:1});}get element(){return this.$$.ctx[1]}};c(dv,"Customizer_actions");let Xf=dv;const hv=class hv extends un{async runSetup(){return await new Xf({target:Ye(".avatar-customizer")}).element}};c(hv,"CustomizerActionsSetup");let wd=hv;var PP=Object.defineProperty,NP=Object.getOwnPropertyDescriptor,OP=c((r,e,t,n)=>{for(var i=n>1?void 0:n?NP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&PP(e,t,i),i},"__decorateClass$1R"),As;let Sd=(As=class extends un{async runSetup(){return new Promise(e=>{document.body.getAttribute("typo-skribbl-loaded")!==null?e():document.addEventListener("skribblInitialized",()=>e());})}},c(As,"SkribblInitializedSetup"),As);Sd=OP([Do()],Sd);const fv=class fv extends se{constructor(e){super(),le(this,e,null,null,re,{});}};c(fv,"Toast_container");let qf=fv;var jP=Object.defineProperty,GP=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&jP(e,t,i),i},"__decorateClass$1Q");const pv=class pv extends un{constructor(){super(...arguments);f(this,"_gameReadySetup");}async runSetup(){await this._gameReadySetup.complete();const t=Ec(nn("<div class='typo-toast-container'></div>"),"afterbegin",document.body);return new qf({target:t}),t}};c(pv,"ToastSetup");let Rc=pv;GP([D(ur)],Rc.prototype,"_gameReadySetup");function kA(r,e,t){const n=r.slice();return n[4]=e[t],n}c(kA,"get_each_context$E");function CA(r,e,t){const n=r.slice();return n[4]=e[t],n}c(CA,"get_each_context_1$e");function IA(r){let e,t=r[4].name+"",n,i,o;function s(){return r[2](r[4])}c(s,"keydown_handler");function a(){return r[3](r[4])}return c(a,"click_handler"),{c(){e=v("h2"),n=G(t),_(e,"tabindex","0"),_(e,"role","button"),_(e,"class","svelte-14yq9xv"),ue(e,"inactive",r[4]!==r[1]);},m(l,u){k(l,e,u),g(e,n),i||(o=[F(e,"keydown",s),F(e,"click",a)],i=!0);},p(l,u){r=l,u&1&&t!==(t=r[4].name+"")&&K(n,t),u&3&&ue(e,"inactive",r[4]!==r[1]);},d(l){l&&A(e),i=!1,Je(o);}}}c(IA,"create_each_block_1$e");function TA(r){let e,t,n;return {c(){e=v("div"),_(e,"class",t="typo-panel-tab color-scrollbar panel-tab-"+r[4].id+" svelte-14yq9xv"),e.hidden=n=r[4]!==r[1];},m(i,o){k(i,e,o);},p(i,o){o&1&&t!==(t="typo-panel-tab color-scrollbar panel-tab-"+i[4].id+" svelte-14yq9xv")&&_(e,"class",t),o&3&&n!==(n=i[4]!==i[1])&&(e.hidden=n);},d(i){i&&A(e);}}}c(TA,"create_each_block$E");function $P(r){let e,t,n,i=te(r[0]),o=[];for(let l=0;l<i.length;l+=1)o[l]=IA(CA(r,i,l));let s=te(r[0]),a=[];for(let l=0;l<s.length;l+=1)a[l]=TA(kA(r,s,l));return {c(){e=v("div");for(let l=0;l<o.length;l+=1)o[l].c();t=C();for(let l=0;l<a.length;l+=1)a[l].c();n=je(),_(e,"class","panel-header svelte-14yq9xv");},m(l,u){k(l,e,u);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(e,null);k(l,t,u);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(l,u);k(l,n,u);},p(l,[u]){if(u&3){i=te(l[0]);let d;for(d=0;d<i.length;d+=1){const h=CA(l,i,d);o[d]?o[d].p(h,u):(o[d]=IA(h),o[d].c(),o[d].m(e,null));}for(;d<o.length;d+=1)o[d].d(1);o.length=i.length;}if(u&3){s=te(l[0]);let d;for(d=0;d<s.length;d+=1){const h=kA(l,s,d);a[d]?a[d].p(h,u):(a[d]=TA(h),a[d].c(),a[d].m(n.parentNode,n));}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length;}},i:j,o:j,d(l){l&&(A(e),A(t),A(n)),Ie(o,l),Ie(a,l);}}}c($P,"create_fragment$1F");function YP(r,e,t){let{tabs:n=[]}=e,i=n[0];const o=c(a=>t(1,i=a),"keydown_handler"),s=c(a=>t(1,i=a),"click_handler");return r.$$set=a=>{"tabs"in a&&t(0,n=a.tabs);},[n,i,o,s]}c(YP,"instance$1v");const mv=class mv extends se{constructor(e){super(),le(this,e,YP,$P,re,{tabs:0});}};c(mv,"Panel_tabs");let Ad=mv;var zP=Object.defineProperty,UP=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&zP(e,t,i),i},"__decorateClass$1P");const gv=class gv extends un{constructor(){super(...arguments);f(this,"_gameReadySetup");}async runSetup(){await this._gameReadySetup.complete();const t={rightPanel:Ec(nn("<div class='panel panel-right typo-panel'></div>"),"afterend",Ye(".panel")),leftPanel:Ec(nn("<div class='panel panel-left typo-panel'></div>"),"beforebegin",Ye(".panel"))};return new Ad({target:t.leftPanel,props:{tabs:[{name:"Typo News",id:"news"},{name:"Changelog",id:"changelog"}]}}),new Ad({target:t.rightPanel,props:{tabs:[{name:"Lobbies",id:"lobbies"},{name:"Filters",id:"filter"},{name:"Outfit",id:"cabin"}]}}),t}};c(gv,"PanelSetup");let Lc=gv;UP([D(ur)],Lc.prototype,"_gameReadySetup");const bv=class bv extends se{constructor(e){super(),le(this,e,null,null,re,{});}};c(bv,"Toolbar");let Kf=bv;var BP=Object.defineProperty,xP=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&BP(e,t,i),i},"__decorateClass$1O");const vv=class vv extends un{constructor(){super(...arguments);f(this,"_gameReadySetup");}async runSetup(){await this._gameReadySetup.complete();const t=Ec(nn("<div class='typo-toolbar'></div>"),"afterbegin",Ye("#game-wrapper"));return new Kf({target:t}),t}};c(vv,"ToolbarSetup");let Pc=vv;xP([D(ur)],Pc.prototype,"_gameReadySetup");var ZP=Object.defineProperty,Eo=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&ZP(e,t,i),i},"__decorateClass$1N");function VP(r,e,t,n,i,o){return {panelContainer:Ye(".panels"),avatarPanel:Ye(".panel:not(.typo-panel)"),newsTab:Ye(".panel-tab-news"),changelogTab:Ye(".panel-tab-changelog"),lobbiesTab:Ye(".panel-tab-lobbies"),cabinTab:Ye(".panel-tab-cabin"),filterTab:Ye(".panel-tab-filter"),playButton:Ye(".panel:not(.typo-panel) .button-play"),gameBar:Ye("#game-bar"),clearButton:Ye('.tool[data-tooltip="Clear"]'),gameSettings:Ye("#game-settings"),home:Ye("#home"),game:Ye("#game"),gameWrapper:Ye("#game-wrapper"),load:Ye("#load"),chatInput:Ye("#game-chat form.chat-form input"),chatForm:Ye("#game-chat form.chat-form"),chatArea:Ye("#game-chat"),chatContent:Ye("#game-chat .chat-content"),hints:Ye("#game-word .hints"),canvasWrapper:Ye("#game-canvas"),canvas:Ye("#game-canvas canvas"),landingAvatar:Ye(".avatar-customizer .avatar"),landingCustomizeContainer:Ye(".avatar-customizer"),landingAvatarContainer:Ye(".avatar-customizer .container"),skribblTools:Ye(".toolbar-group-tools"),skribblActions:Ye(".toolbar-group-actions"),skribblToolbar:Ye("#game-toolbar"),skribblBrushTools:Ye('.toolbar-group-tools .tool[data-tooltip="Brush"]'),colorContainer:Ye("#game-toolbar .colors"),scoreboardResults:Ye("#game-canvas .overlay-content .result"),playerPopup:Ye("#modal .modal-content .modal-container-player"),skribblModal:Ye("#modal"),canvasOverlay:Ye("#game-canvas .overlay-content"),textOverlay:Ye("#game-canvas .overlay-content > .text"),gameRate:Ye("#game-rate"),inputName:Ye("input.input-name"),logoIngame:Ye("#game-logo img"),chatControls:i,...r,toolbar:e,controls:t,toastContainer:n,customizerActions:o}}c(VP,"getElements$1");const _v=class _v extends un{constructor(){super(...arguments);f(this,"_panelSetup");f(this,"_toolbarSetup");f(this,"_controlsSetup");f(this,"_chatControlsSetup");f(this,"_toastSetup");f(this,"_gameReadySetup");f(this,"_customizerIconsSetup");}async runSetup(){await this._gameReadySetup.complete();const t=await this._panelSetup.complete(),n=await this._toolbarSetup.complete(),i=await this._controlsSetup.complete(),o=await this._chatControlsSetup.complete(),s=await this._toastSetup.complete(),a=await this._customizerIconsSetup.complete();return VP(t,n,i,s,o,a)}};c(_v,"ElementsSetup");let Me=_v;Eo([D(Lc)],Me.prototype,"_panelSetup");Eo([D(Pc)],Me.prototype,"_toolbarSetup");Eo([D(Fa)],Me.prototype,"_controlsSetup");Eo([D(Mc)],Me.prototype,"_chatControlsSetup");Eo([D(Rc)],Me.prototype,"_toastSetup");Eo([D(Sd)],Me.prototype,"_gameReadySetup");Eo([D(wd)],Me.prototype,"_customizerIconsSetup");var JP=Object.defineProperty,FP=Object.getOwnPropertyDescriptor,Ah=c((r,e,t,n)=>{for(var i=n>1?void 0:n?FP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&JP(e,t,i),i},"__decorateClass$1M");const yv=class yv extends $t{constructor(e){super(),this.data=e;}};c(yv,"ChatTypedEvent");let Kl=yv;var ks;let Nc=(ks=class extends Ot{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"eventType",Kl);}async streamEvents(){const t=new be,{chatInput:n,chatForm:i}=await this._elementsSetup.complete();return n.addEventListener("input",()=>{const o=n.value;t.next(new Kl(o));}),i.addEventListener("submit",()=>{t.next(new Kl(""));}),t.pipe(ct((o,s)=>o.data===s.data),_t(o=>this._logger.debug("Chat typed event",o)))}},c(ks,"ChatTypedEventProcessor"),ks);Ah([D(Me)],Nc.prototype,"_elementsSetup",2);Nc=Ah([we()],Nc);var Cs;let Oc=(Cs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Cs,"ChatTypedEventListener"),Cs);Ah([D(Nc)],Oc.prototype,"_processor",2);Oc=Ah([we()],Oc);const WP={listenerType:Oc,processorType:Nc};var HP=Object.defineProperty,QP=Object.getOwnPropertyDescriptor,ob=c((r,e,t,n)=>{for(var i=n>1?void 0:n?QP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&HP(e,t,i),i},"__decorateClass$1L");const wv=class wv extends $t{constructor(e){super(),this.data=e;}};c(wv,"ColorChangedEvent");let ec=wv;var Is;let kd=(Is=class extends Ot{constructor(){super(...arguments);f(this,"eventType",ec);}async streamEvents(){const t=new be;return document.addEventListener("skribblColorChanged",n=>{const i=n.detail,o=tt.fromRgbString(i);t.next(new ec({color:o,target:"primary"})),this._logger.info("prim Color changed",o);}),document.addEventListener("skribblSecondaryColorChanged",n=>{const i=n.detail,o=tt.fromRgbString(i);t.next(new ec({color:o,target:"secondary"})),this._logger.info("sec Color changed",o);}),t}},c(Is,"ColorChangedEventProcessor"),Is);kd=ob([we()],kd);var Ts;let Wa=(Ts=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Ts,"ColorChangedEventListener"),Ts);ob([D(kd)],Wa.prototype,"_processor",2);Wa=ob([we()],Wa);const XP={listenerType:Wa,processorType:kd};var qP=Object.defineProperty,KP=Object.getOwnPropertyDescriptor,eN=c((r,e,t,n)=>{for(var i=n>1?void 0:n?KP(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&qP(e,t,i),i},"__decorateClass$1K"),Ds;let Ha=(Ds=class extends un{async runSetup(){return new Promise(e=>{window.addEventListener("message",t=>{if(t.data==="skribblEmitPort"){const n=t.ports;if(n.length===0)return;const i=new be;n[0].onmessage=o=>{i.next({event:o.data[0],data:o.data[1]});},e(i);}});})}},c(Ds,"SkribblEmitRelaySetup"),Ds);Ha=eN([Do()],Ha);var tN=Object.defineProperty,nN=Object.getOwnPropertyDescriptor,iN=c((r,e,t,n)=>{for(var i=n>1?void 0:n?nN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&tN(e,t,i),i},"__decorateClass$1J"),Es;let _n=(Es=class extends un{async runSetup(){return new Promise(e=>{window.addEventListener("message",t=>{if(t.data==="skribblMessagePort"){const n=t.ports;if(n.length===0)return;const i=new be;document.addEventListener("insertSkribblEmit",o=>{this._logger.debug("insertSkribblEmit",o.detail),n[0].postMessage(o.detail);}),n[0].onmessage=o=>{o.data.id!==19&&this._logger.debug("Received message",o.data),i.next(o.data);},e({serverMessages$:i,insertMessage:c(o=>n[0].postMessage(o),"insertMessage")});}});})}},c(Es,"SkribblMessageRelaySetup"),Es);_n=iN([Do()],_n);var rN=Object.defineProperty,oN=Object.getOwnPropertyDescriptor,ku=c((r,e,t,n)=>{for(var i=n>1?void 0:n?oN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&rN(e,t,i),i},"__decorateClass$1I");const Sv=class Sv extends $t{constructor(e){super(),this.data=e;}};c(Sv,"DrawEvent");let jc=Sv;var Ms;let Qa=(Ms=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"_skribblEmitRelaySetup");f(this,"eventType",jc);}async streamEvents(){const t=new be,n=await this._skribblMessageRelaySetup.complete(),i=await this._skribblEmitRelaySetup.complete();return _c(i.pipe(Se(o=>o.event==="data"),ce(o=>o.data)),n.serverMessages$).pipe(ce(o=>o.id===19?typeof o.data[0]=="number"?[o.data]:o.data:o.id===10&&o.data.state.id===4&&o.data.state.data.drawCommands?o.data.state.data.drawCommands:null),Se(o=>o!==null),pR(100),Se(o=>o.length>0)).subscribe(o=>{const s=o.flat(1);t.next(new jc(s));}),t}},c(Ms,"DrawEventProcessor"),Ms);ku([D(_n)],Qa.prototype,"_skribblMessageRelaySetup",2);ku([D(Ha)],Qa.prototype,"_skribblEmitRelaySetup",2);Qa=ku([we()],Qa);var Rs;let Gc=(Rs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Rs,"DrawEventListener"),Rs);ku([D(Qa)],Gc.prototype,"_processor",2);Gc=ku([we()],Gc);const sN={listenerType:Gc,processorType:Qa};var aN=Object.defineProperty,lN=Object.getOwnPropertyDescriptor,kh=c((r,e,t,n)=>{for(var i=n>1?void 0:n?lN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&aN(e,t,i),i},"__decorateClass$1H");const Av=class Av extends $t{constructor(e){super(),this.data=e;}};c(Av,"HintsAddedEvent");let is=Av;var Ls;let $c=(Ls=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"eventType",is);}async streamEvents(){const t=new be;return (await this._skribblMessageRelaySetup.complete()).serverMessages$.subscribe(i=>{if(i.id===10&&i.data.state.id===4&&i.data.state.data.hints){const o=i.data.state.data.hints;this._logger.info("Lobby joined",o),t.next(new is(o));}else if(i.id===13){const o=i.data??[];this._logger.info("Hints added",o),t.next(new is(o));}}),t}},c(Ls,"HintsAddedEventProcessor"),Ls);kh([D(_n)],$c.prototype,"_skribblMessageRelaySetup",2);$c=kh([we()],$c);var Ps;let Yc=(Ps=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Ps,"HintsAddedEventListener"),Ps);kh([D($c)],Yc.prototype,"_processor",2);Yc=kh([we()],Yc);const cN={listenerType:Yc,processorType:$c};var uN=Object.defineProperty,dN=Object.getOwnPropertyDescriptor,Cu=c((r,e,t,n)=>{for(var i=n>1?void 0:n?dN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&uN(e,t,i),i},"__decorateClass$1G");const kv=class kv extends $t{constructor(e){super(),this.data=e;}};c(kv,"ImageResetEvent");let rs=kv;var Ns;let Xa=(Ns=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"_skribblEmitRelaySetup");f(this,"eventType",rs);}async streamEvents(){const t=new be,n=await this._skribblMessageRelaySetup.complete(),i=await this._skribblEmitRelaySetup.complete();return _c(i.pipe(Se(o=>o.event==="data"),ce(o=>o.data)),n.serverMessages$).subscribe(o=>{o.id===20&&(this._logger.info("Image cleared"),t.next(new rs(0))),o.id===21&&(this._logger.info("Undo action",o.data),t.next(new rs(o.data)));}),t}},c(Ns,"ImageResetEventProcessor"),Ns);Cu([D(_n)],Xa.prototype,"_skribblMessageRelaySetup",2);Cu([D(Ha)],Xa.prototype,"_skribblEmitRelaySetup",2);Xa=Cu([we()],Xa);var Os;let qa=(Os=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Os,"ImageResetEventListener"),Os);Cu([D(Xa)],qa.prototype,"_processor",2);qa=Cu([we()],qa);const hN={listenerType:qa,processorType:Xa},fN=c(r=>{switch(r.id){case 8:return r.data.vote===1?{likeInteraction:{sourcePlayerId:r.data.id}}:{dislikeInteraction:{sourcePlayerId:r.data.id}};case 5:return {votekickInteraction:{targetPlayerId:r.data[1],sourcePlayerId:r.data[0],totalVotes:r.data[2],requiredVotes:r.data[3]}}}},"parseSkribblLobbyInteractedEvent");var pN=Object.defineProperty,mN=Object.getOwnPropertyDescriptor,Ch=c((r,e,t,n)=>{for(var i=n>1?void 0:n?mN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&pN(e,t,i),i},"__decorateClass$1F");const Cv=class Cv extends $t{constructor(e){super(),this.data=e;}};c(Cv,"LobbyInteractedEvent");let Cd=Cv;var js;let zc=(js=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"eventType",Cd);}async streamEvents(){return (await this._skribblMessageRelaySetup.complete()).serverMessages$.pipe(ce(n=>fN(n)),Se(n=>n!==void 0),ce(n=>new Cd(n)),_t(n=>this._logger.debug("Lobby interacted",n)))}},c(js,"LobbyInteractedEventProcessor"),js);Ch([D(_n)],zc.prototype,"_skribblMessageRelaySetup",2);zc=Ch([we()],zc);var Gs;let Ka=(Gs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Gs,"LobbyInteractedEventListener"),Gs);Ch([D(zc)],Ka.prototype,"_processor",2);Ka=Ch([we()],Ka);const gN={listenerType:Ka,processorType:zc};function bN(){return {languageSettings:new Map(kM("#home .container-name-lang > select option").map(r=>[Number(r.value),r.textContent??""]))}}c(bN,"getElements");const Iv=class Iv extends un{async runSetup(){return bN()}};c(Iv,"GameSettingsSetup");let el=Iv;var vN=Object.defineProperty,_N=Object.getOwnPropertyDescriptor,Iu=c((r,e,t,n)=>{for(var i=n>1?void 0:n?_N(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&vN(e,t,i),i},"__decorateClass$1E");const Tv=class Tv extends $t{constructor(e){super(),this.data=e;}};c(Tv,"LobbyJoinFailedEvent");let Id=Tv;var $s;let tl=($s=class extends Ot{constructor(){super(...arguments);f(this,"_gameSettingsSetup");f(this,"_skribblMessageRelaySetup");f(this,"eventType",Id);}async streamEvents(){const t=new be;return document.addEventListener("joinLobbyFailed",()=>{t.next(new Id(null));}),t}},c($s,"LobbyJoinFailedEventProcessor"),$s);Iu([D(el)],tl.prototype,"_gameSettingsSetup",2);Iu([D(_n)],tl.prototype,"_skribblMessageRelaySetup",2);tl=Iu([we()],tl);var Ys;let Uc=(Ys=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Ys,"LobbyJoinFailedListener"),Ys);Iu([D(tl)],Uc.prototype,"_processor",2);Uc=Iu([we()],Uc);const yN={listenerType:Uc,processorType:tl};var wN=Object.defineProperty,SN=Object.getOwnPropertyDescriptor,Ih=c((r,e,t,n)=>{for(var i=n>1?void 0:n?SN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&wN(e,t,i),i},"__decorateClass$1D");const Dv=class Dv extends $t{constructor(e){super(),this.data=e;}};c(Dv,"LobbyPlayerChangedEvent");let os=Dv;var zs;let Bc=(zs=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"eventType",os);}async streamEvents(){const t=new be;return (await this._skribblMessageRelaySetup.complete()).serverMessages$.subscribe(i=>{if(i.id===1){const o={joined:i.data};this._logger.info("Player joined",o),t.next(new os(o));}else if(i.id===2){const o={left:{id:i.data.id,reason:i.data.id===1?"left":"kicked"}};this._logger.info("Player left",o),t.next(new os(o));}}),t}},c(zs,"LobbyPlayerChangedEventProcessor"),zs);Ih([D(_n)],Bc.prototype,"_skribblMessageRelaySetup",2);Bc=Ih([we()],Bc);var Us;let nl=(Us=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Us,"LobbyPlayerChangedEventListener"),Us);Ih([D(Bc)],nl.prototype,"_processor",2);nl=Ih([we()],nl);const AN={listenerType:nl,processorType:Bc};function sE(r,e){return r.reduce((t,n,i)=>i%e?t:[...t,r.slice(i,i+e)],[])}c(sE,"arrayChunk");const ep=c(r=>{switch(r.id){case 2:return {roundStarted:{round:r.data,startsIn:r.time}};case 3:return {drawerChoosingWord:{maxTime:r.time,drawerId:r.data.id}};case 4:return {drawingStarted:{word:typeof r.data.word=="string"?r.data.word:void 0,characters:typeof r.data.word=="string"?r.data.word.length:r.data.word,maxTime:r.time,drawerId:r.data.id}};case 5:return {drawingRevealed:{reason:r.data.reason===1?"outOfTime":"allGuessed",word:r.data.word,time:r.time,scores:sE(r.data.scores,3).map(([e,t,n])=>({playerId:e,score:t,rewarded:n}))}};case 6:return {gameEnded:{ranking:r.data.map(([e,t])=>({playerId:e,rank:t})),displayTime:r.time}};case 7:return {timerSet:{time:r.time}};default:return}},"parseLobbyStateUpdate");var kN=Object.defineProperty,CN=Object.getOwnPropertyDescriptor,Tu=c((r,e,t,n)=>{for(var i=n>1?void 0:n?CN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&kN(e,t,i),i},"__decorateClass$1C");const Ev=class Ev extends $t{constructor(e){super(),this.data=e;}};c(Ev,"LobbyStateChangedEvent");let ir=Ev;var Bs;let il=(Bs=class extends Ot{constructor(){super(...arguments);f(this,"_gameSettingsSetup");f(this,"_skribblMessageRelaySetup");f(this,"eventType",ir);}async streamEvents(){const t=new be;return (await this._skribblMessageRelaySetup.complete()).serverMessages$.subscribe(i=>{if(i.id===11){const o=ep(i.data);if(o===void 0){this._logger.warn("Unknown event",i.data);return}this._logger.info("Lobby updated",o),t.next(new ir(o));}if(i.id===10){const o=ep(i.data.state);if(o===void 0){this._logger.warn("Unknown event",i.data.state);return}this._logger.info("Lobby joined",o),t.next(new ir(o));}i.id===14&&(this._logger.info("Lobby timer set",i.data),t.next(new ir({timerSet:{time:i.data}})));}),t}},c(Bs,"LobbyStateChangedEventProcessor"),Bs);Tu([D(el)],il.prototype,"_gameSettingsSetup",2);Tu([D(_n)],il.prototype,"_skribblMessageRelaySetup",2);il=Tu([we()],il);var xs;let Zn=(xs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(xs,"LobbyStateChangedEventListener"),xs);Tu([D(il)],Zn.prototype,"_processor",2);Zn=Tu([we()],Zn);const IN={listenerType:Zn,processorType:il};var TN=Object.defineProperty,DN=Object.getOwnPropertyDescriptor,Th=c((r,e,t,n)=>{for(var i=n>1?void 0:n?DN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&TN(e,t,i),i},"__decorateClass$1B");const Mv=class Mv extends $t{constructor(e){super(),this.data=e;}};c(Mv,"MessageReceivedEvent");let Td=Mv;var Zs;let xc=(Zs=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"eventType",Td);}async streamEvents(){return (await this._skribblMessageRelaySetup.complete()).serverMessages$.pipe(Se(n=>n.id==30),ce(n=>new Td({message:n.data.msg,senderId:n.data.id})),_t(n=>this._logger.debug("Message received",n)))}},c(Zs,"MessageReceivedEventProcessor"),Zs);Th([D(_n)],xc.prototype,"_skribblMessageRelaySetup",2);xc=Th([we()],xc);var Vs;let Zc=(Vs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Vs,"MessageReceivedEventListener"),Vs);Th([D(xc)],Zc.prototype,"_processor",2);Zc=Th([we()],Zc);const EN={listenerType:Zc,processorType:xc};var MN=Object.defineProperty,RN=Object.getOwnPropertyDescriptor,Dh=c((r,e,t,n)=>{for(var i=n>1?void 0:n?RN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&MN(e,t,i),i},"__decorateClass$1A");const Rv=class Rv extends $t{constructor(e){super(),this.data=e;}};c(Rv,"MessageSentEvent");let Dd=Rv;var Js;let Vc=(Js=class extends Ot{constructor(){super(...arguments);f(this,"_skribblEmitRelaySetup");f(this,"eventType",Dd);}async streamEvents(){return (await this._skribblEmitRelaySetup.complete()).pipe(Se(n=>n.event==="data"&&n.data.id==30),ce(n=>new Dd(n.data.data)))}},c(Js,"MessageSentEventProcessor"),Js);Dh([D(Ha)],Vc.prototype,"_skribblEmitRelaySetup",2);Vc=Dh([we()],Vc);var Fs;let rl=(Fs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Fs,"MessageSentEventListener"),Fs);Dh([D(Vc)],rl.prototype,"_processor",2);rl=Dh([we()],rl);const LN={listenerType:rl,processorType:Vc};var PN=Object.defineProperty,NN=Object.getOwnPropertyDescriptor,Eh=c((r,e,t,n)=>{for(var i=n>1?void 0:n?NN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&PN(e,t,i),i},"__decorateClass$1z");const Lv=class Lv extends $t{constructor(e){super(),this.data=e;}};c(Lv,"PlayerPopupVisibilityChangedEvent");let tc=Lv;var Ws;let Jc=(Ws=class extends Ot{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"eventType",tc);}async streamEvents(){const t=new be,n=await this._elementsSetup.complete(),i=new MutationObserver(()=>{n.skribblModal.style.display!=="none"&&n.playerPopup.style.display==="flex"?t.next(new tc(!0)):t.next(new tc(!1));});return i.observe(n.playerPopup,{attributes:!0}),i.observe(n.skribblModal,{attributes:!0}),t.pipe(ct(),xa(50))}},c(Ws,"PlayerPopupVisibilityChangedEventProcessor"),Ws);Eh([D(Me)],Jc.prototype,"_elementsSetup",2);Jc=Eh([we()],Jc);var Hs;let Fc=(Hs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Hs,"PlayerPopupVisibilityChangedEventListener"),Hs);Eh([D(Jc)],Fc.prototype,"_processor",2);Fc=Eh([we()],Fc);const ON={listenerType:Fc,processorType:Jc};var jN=Object.defineProperty,GN=Object.getOwnPropertyDescriptor,Mh=c((r,e,t,n)=>{for(var i=n>1?void 0:n?GN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&jN(e,t,i),i},"__decorateClass$1y");const Pv=class Pv extends $t{constructor(e){super(),this.data=e;}};c(Pv,"RoundStartedEvent");let Wc=Pv;var Qs;let Hc=(Qs=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"eventType",Wc);}async streamEvents(){const t=new be;return (await this._skribblMessageRelaySetup.complete()).serverMessages$.subscribe(i=>{if(i.id===11&&i.data.id==2){const o=i.data.data+1;this._logger.info("Round started",o),t.next(new Wc(o));}}),t}},c(Qs,"RoundStartedEventProcessor"),Qs);Mh([D(_n)],Hc.prototype,"_skribblMessageRelaySetup",2);Hc=Mh([we()],Hc);var Xs;let ol=(Xs=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Xs,"RoundStartedEventListener"),Xs);Mh([D(Hc)],ol.prototype,"_processor",2);ol=Mh([we()],ol);const $N={listenerType:ol,processorType:Hc};var YN=Object.defineProperty,zN=Object.getOwnPropertyDescriptor,Rh=c((r,e,t,n)=>{for(var i=n>1?void 0:n?zN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&YN(e,t,i),i},"__decorateClass$1x");const Nv=class Nv extends $t{constructor(e){super(),this.data=e;}};c(Nv,"ScoreboardVisibilityChangedEvent");let nc=Nv;var qs;let Qc=(qs=class extends Ot{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"eventType",nc);}async streamEvents(){const t=new be,n=await this._elementsSetup.complete();return new MutationObserver(()=>{n.scoreboardResults.classList.contains("show")?t.next(new nc(!0)):t.next(new nc(!1));}).observe(n.scoreboardResults,{attributes:!0}),t.pipe(ct(),xa(50))}},c(qs,"ScoreboardVisibilityChangedEventProcessor"),qs);Rh([D(Me)],Qc.prototype,"_elementsSetup",2);Qc=Rh([we()],Qc);var Ks;let Xc=(Ks=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(Ks,"ScoreboardVisibilityChangedEventListener"),Ks);Rh([D(Qc)],Xc.prototype,"_processor",2);Xc=Rh([we()],Xc);const UN={listenerType:Xc,processorType:Qc};var BN=Object.defineProperty,xN=Object.getOwnPropertyDescriptor,sb=c((r,e,t,n)=>{for(var i=n>1?void 0:n?xN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&BN(e,t,i),i},"__decorateClass$1w");const Ov=class Ov extends $t{constructor(e){super(),this.data=e;}};c(Ov,"SizeChangedEvent");let Ed=Ov;var ea;let Md=(ea=class extends Ot{constructor(){super(...arguments);f(this,"eventType",Ed);}async streamEvents(){const t=new be;return document.addEventListener("skribblSizeChanged",n=>{const i=Number(n.detail);t.next(new Ed(i)),this._logger.info("Size changed",i);}),t}},c(ea,"SizeChangedEventProcessor"),ea);Md=sb([we()],Md);var ta;let qc=(ta=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(ta,"SizeChangedEventListener"),ta);sb([D(Md)],qc.prototype,"_processor",2);qc=sb([we()],qc);const ZN={listenerType:qc,processorType:Md};var VN=Object.defineProperty,JN=Object.getOwnPropertyDescriptor,Lh=c((r,e,t,n)=>{for(var i=n>1?void 0:n?JN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&VN(e,t,i),i},"__decorateClass$1v");const jv=class jv extends $t{constructor(e){super(),this.data=e;}};c(jv,"TextOverlayVisibilityChangedEvent");let ic=jv;var na;let Kc=(na=class extends Ot{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"eventType",ic);}async streamEvents(){const t=new be,n=await this._elementsSetup.complete(),i=new MutationObserver(()=>{n.canvasOverlay.style.top.trim()!=="-100%"&&n.textOverlay.classList.contains("show")?t.next(new ic(!0)):t.next(new ic(!1));});return i.observe(n.textOverlay,{attributes:!0}),i.observe(n.canvasOverlay,{attributes:!0}),t.pipe(ct(),xa(50))}},c(na,"TextOverlayVisibilityChangedEventProcessor"),na);Lh([D(Me)],Kc.prototype,"_elementsSetup",2);Kc=Lh([we()],Kc);var ia;let eu=(ia=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(ia,"TextOverlayVisibilityChangedEventListener"),ia);Lh([D(Kc)],eu.prototype,"_processor",2);eu=Lh([we()],eu);const FN={listenerType:eu,processorType:Kc};var WN=Object.defineProperty,HN=Object.getOwnPropertyDescriptor,ab=c((r,e,t,n)=>{for(var i=n>1?void 0:n?HN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&WN(e,t,i),i},"__decorateClass$1u"),ui=(r=>(r[r.brush=0]="brush",r[r.fill=1]="fill",r[r.deselected=-1]="deselected",r[r.other=2]="other",r))(ui||{});const Gv=class Gv extends $t{constructor(e){super(),this.data=e;}};c(Gv,"ToolChangedEvent");let Rd=Gv;var ra;let Ld=(ra=class extends Ot{constructor(){super(...arguments);f(this,"eventType",Rd);}async streamEvents(){const t=new be;return document.addEventListener("skribblToolChanged",n=>{const i=n.detail,o=i>2?2:i;t.next(new Rd(o)),this._logger.info("Tool changed",o);}),t}},c(ra,"ToolChangedEventProcessor"),ra);Ld=ab([we()],Ld);var oa;let tu=(oa=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(oa,"ToolChangedEventListener"),oa);ab([D(Ld)],tu.prototype,"_processor",2);tu=ab([we()],tu);const QN={listenerType:tu,processorType:Ld};var XN=Object.defineProperty,qN=Object.getOwnPropertyDescriptor,Ph=c((r,e,t,n)=>{for(var i=n>1?void 0:n?qN(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&XN(e,t,i),i},"__decorateClass$1t");const $v=class $v extends $t{constructor(e){super(),this.data=e;}};c($v,"WordGuessedEvent");let sl=$v;var sa;let nu=(sa=class extends Ot{constructor(){super(...arguments);f(this,"_skribblMessageRelaySetup");f(this,"eventType",sl);}async streamEvents(){const t=new be;return (await this._skribblMessageRelaySetup.complete()).serverMessages$.subscribe(i=>{if(i.id===15){const o={playerId:i.data.id,word:i.data.word??void 0};this._logger.info("Word guessed",o),t.next(new sl(o));}}),t}},c(sa,"WordGuessedEventProcessor"),sa);Ph([D(_n)],nu.prototype,"_skribblMessageRelaySetup",2);nu=Ph([we()],nu);var aa;let Dr=(aa=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(aa,"WordGuessedEventListener"),aa);Ph([D(nu)],Dr.prototype,"_processor",2);Dr=Ph([we()],Dr);const KN={listenerType:Dr,processorType:nu};var ye=(r=>(r.DRAWING="drawing",r.INTERFACE="interface",r.INFORMATION="info",r.GAMEPLAY="gameplay",r.SOCIAL="social",r.PALANTIR="palantir",r.DEVELOPMENT="dev",r))(ye||{});const DA=Object.values(ye),Yv=class Yv extends se{constructor(e){super(),le(this,e,null,null,re,{});}};c(Yv,"Canvas_rate_icons");let tp=Yv;var eO=Object.defineProperty,tO=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&eO(e,t,i),i},"__decorateClass$1s");const zv=class zv extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"name","Improved Like Icons");f(this,"description","Sets new like/dislike icons which better fit the skribbl style.");f(this,"tags",[ye.INTERFACE]);f(this,"featureId",46);f(this,"_component");}async onActivate(){(await this._elementsSetup.complete()).gameRate.classList.add("typo-icons"),this._component=new tp({target:document.body});}async onDestroy(){var n;(await this._elementsSetup.complete()).gameRate.classList.remove("typo-icons"),(n=this._component)==null||n.$destroy(),this._component=void 0;}};c(zv,"CanvasRateIconsFeature");let iu=zv;tO([D(Me)],iu.prototype,"_elementsSetup");var nO=Object.defineProperty,iO=Object.getOwnPropertyDescriptor,lb=c((r,e,t,n)=>{for(var i=n>1?void 0:n?iO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&nO(e,t,i),i},"__decorateClass$1r");const Uv=class Uv extends $t{constructor(e){super(),this.data=e;}};c(Uv,"LobbyLeftEvent");let rr=Uv;var la;let Pd=(la=class extends Ot{constructor(){super(...arguments);f(this,"eventType",rr);}streamEvents(){const t=new be;return document.addEventListener("leftLobby",async()=>{this._logger.info("Lobby left"),t.next(new rr(null));}),t}},c(la,"LobbyLeftEventProcessor"),la);Pd=lb([we()],Pd);var ca;let Vn=(ca=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(ca,"LobbyLeftEventListener"),ca);lb([D(Pd)],Vn.prototype,"_processor",2);Vn=lb([we()],Vn);const rO={listenerType:Vn,processorType:Pd},EA=c((r,e)=>({id:r.id??null,private:r.type===1,meId:r.me,ownerId:r.owner==-1?null:r.owner,drawerId:null,round:r.round+1,settings:{language:e.get(r.settings[0])??"Unknown",players:r.settings[1],drawTime:r.settings[2],rounds:r.settings[3]},players:r.users}),"parseSkribblLobbyDataEvent");var oO=Object.defineProperty,sO=Object.getOwnPropertyDescriptor,Du=c((r,e,t,n)=>{for(var i=n>1?void 0:n?sO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&oO(e,t,i),i},"__decorateClass$1q");const Bv=class Bv extends $t{constructor(e){super(),this.data=e;}};c(Bv,"LobbyJoinedEvent");let Kr=Bv;var ua;let al=(ua=class extends Ot{constructor(){super(...arguments);f(this,"_gameSettingsSetup");f(this,"_skribblMessageRelaySetup");f(this,"eventType",Kr);}async streamEvents(){const t=new be,n=await this._skribblMessageRelaySetup.complete(),i=await this._gameSettingsSetup.complete();return n.serverMessages$.subscribe(o=>{var s;if(o.id===10){const a=EA(o.data,i.languageSettings),l=ep(o.data.state);a.drawerId=((s=l==null?void 0:l.drawingStarted)==null?void 0:s.drawerId)??null,this._logger.info("Lobby joined",a),t.next(new Kr(a));}}),document.addEventListener("practiceJoined",async o=>{const s=await this._gameSettingsSetup.complete(),a=EA(o.detail,s.languageSettings);this._logger.info("Practice lobby joined",a),t.next(new Kr(a));}),t}},c(ua,"LobbyJoinedEventProcessor"),ua);Du([D(el)],al.prototype,"_gameSettingsSetup",2);Du([D(_n)],al.prototype,"_skribblMessageRelaySetup",2);al=Du([we()],al);var da;let Gi=(da=class extends Yt{constructor(){super(...arguments);f(this,"_processor");}},c(da,"LobbyJoinedEventListener"),da);Du([D(al)],Gi.prototype,"_processor",2);Gi=Du([we()],Gi);const aO={listenerType:Gi,processorType:al};var lO=Object.defineProperty,cO=Object.getOwnPropertyDescriptor,uO=c((r,e,t,n)=>{for(var i=n>1?void 0:n?cO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&lO(e,t,i),i},"__decorateClass$1p"),Xi=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$l"),ha;let ut=(ha=class{constructor(e,t,n,i,o,s,a,l,u){f(this,"_logger");f(this,"_currentLobby$",new Le(null));f(this,"_currentLobbyDebounced$",new Le(null));f(this,"_discoveredLobbies$",new Le(new Map));this.lobbyJoined=t,this.lobbyLeft=n,this.lobbyPlayerChanged=i,this.lobbyStateChanged=o,this.roundStarted=s,this.wordGuessed=a,this.elementsSetup=l,this.lobbyJoinFailedListener=u,this._logger=e(this),_c(n.events$,t.events$,i.events$,o.events$,s.events$,a.events$).pipe(Oe(this._currentLobby$),ce(d=>({update:d[0],currentLobby:d[1]})),ce(({update:d,currentLobby:h})=>{if(this._logger.debug("Lobby update",d,h),h=h===null?null:structuredClone(h),d instanceof rr)h=null;else if(d instanceof Kr)h=d.data;else if(h!==null&&d instanceof Wc)h.round=d.data;else if(h!==null&&d instanceof sl){const p=d.data;h.players.forEach(m=>{m.id===p.playerId&&(m.guessed=!0);});}else if(h!==null&&d instanceof ir){const p=d.data;if(p.drawingRevealed){const m=new Map(p.drawingRevealed.scores.map(b=>[b.playerId,b.score]));h.players.forEach(b=>{b.guessed=!1,b.score=m.get(b.id)??b.score;}),h.drawerId=null;}p.drawingStarted!==void 0&&(h.drawerId=p.drawingStarted.drawerId);}else if(h!==null&&d instanceof os){const p=d.data;if(p.left){const m=p.left;h.players=h.players.filter(b=>b.id!==m.id);}else p.joined&&h.players.push(p.joined);}return this._logger.debug("Lobby update processed",h),h}),_t(d=>this._currentLobby$.next(d)),xa(100),ct((d,h)=>JSON.stringify(d)===JSON.stringify(h))).subscribe(d=>this._currentLobbyDebounced$.next(d)),this.lobby$.subscribe(d=>{this._logger.info("Lobby changed",d);const h=this._discoveredLobbies$.value;d!==null&&d.id!==null&&h.set(d.id,{...d,seenAt:Date.now()}),this._discoveredLobbies$.next(h);});}async joinLobby(e){if(this._currentLobby$.value!==null)throw this._logger.warn("Attempted to join a lobby while already in one"),new Error("Already in a lobby");const t=await this.elementsSetup.complete();t.load.style.display="block",t.home.style.display="none";const n=Ee(this.lobbyJoinFailedListener.events$.pipe(Kt(this.lobbyJoined.events$),ce(i=>i instanceof Kr)));return document.dispatchEvent(new CustomEvent("joinLobby",{detail:e})),n}leaveLobby(){if(this._currentLobby$.value===null)throw this._logger.warn("Attempted to leave a lobby while not in one"),new Error("Not in a lobby");document.dispatchEvent(new CustomEvent("leaveLobby"));}get lobby$(){return this._currentLobbyDebounced$.asObservable()}get discoveredLobbies$(){return this._discoveredLobbies$.pipe(ce(e=>Array.from(e.values())))}},c(ha,"LobbyService"),ha);ut=uO([we(),Xi(0,D(rt)),Xi(1,D(Gi)),Xi(2,D(Vn)),Xi(3,D(nl)),Xi(4,D(Zn)),Xi(5,D(ol)),Xi(6,D(Dr)),Xi(7,D(Me)),Xi(8,D(Uc))],ut);function dO(r){let e,t,n,i,o;return {c(){e=v("div"),t=v("div"),n=C(),i=v("span"),o=G(r[0]),_(t,"class","icon svelte-c1csua"),_(i,"class","svelte-c1csua"),_(e,"class","svelte-c1csua");},m(s,a){k(s,e,a),g(e,t),g(e,n),g(e,i),g(i,o);},p(s,[a]){a&1&&K(o,s[0]);},i:j,o:j,d(s){s&&A(e);}}}c(dO,"create_fragment$1E");function hO(r,e,t){let{content:n="Loading..."}=e;return r.$$set=i=>{"content"in i&&t(0,n=i.content);},[n]}c(hO,"instance$1u");const xv=class xv extends se{constructor(e){super(),le(this,e,hO,dO,re,{content:0});}};c(xv,"Bounceload");let Yn=xv;function fO(r){let e,t,n,i,o,s;return {c(){e=v("div"),t=v("img"),_(t,"class","typo-icon-button-graphic svelte-b0w31n"),ht(t.src,n="")||_(t,"src",n),H(t,"content","var(--"+r[1]+")"),H(t,"width",r[5]),_(t,"alt",r[2]),ue(t,"effect",r[3]),_(e,"class","typo-icon-button svelte-b0w31n"),H(e,"order",r[6]??"auto"),_(e,"role","button"),_(e,"data-name",r[2]),_(e,"tabindex",r[9]),ue(e,"greyscale",r[4]),ue(e,"disabled",r[0]);},m(a,l){k(a,e,l),g(e,t),o||(s=[oi(i=r[7].call(null,e,{title:r[2],lock:r[8]})),F(e,"click",r[12]),F(e,"click",r[13]),F(e,"keypress",r[14])],o=!0);},p(a,[l]){l&2&&H(t,"content","var(--"+a[1]+")"),l&32&&H(t,"width",a[5]),l&4&&_(t,"alt",a[2]),l&8&&ue(t,"effect",a[3]),l&64&&H(e,"order",a[6]??"auto"),l&4&&_(e,"data-name",a[2]),l&512&&_(e,"tabindex",a[9]),i&&Yr(i.update)&&l&260&&i.update.call(null,{title:a[2],lock:a[8]}),l&16&&ue(e,"greyscale",a[4]),l&1&&ue(e,"disabled",a[0]);},i:j,o:j,d(a){a&&A(e),o=!1,Je(s);}}}c(fO,"create_fragment$1D");function pO(r,e,t){let{disabled:n=!1}=e,{icon:i}=e,{name:o}=e,{hoverMove:s=!0}=e,{greyscaleInactive:a=!1}=e,{size:l="37px"}=e,{order:u=void 0}=e,{tooltipAction:d=c(()=>{},"tooltipAction")}=e,{lockTooltip:h=void 0}=e,{tabIndex:p=0}=e;const m=new be,b=m.asObservable();function y(S){_h.call(this,r,S);}c(y,"click_handler");const w=c(()=>m.next(void 0),"click_handler_1"),I=c(S=>S.code==="Enter"&&m.next(void 0),"keypress_handler");return r.$$set=S=>{"disabled"in S&&t(0,n=S.disabled),"icon"in S&&t(1,i=S.icon),"name"in S&&t(2,o=S.name),"hoverMove"in S&&t(3,s=S.hoverMove),"greyscaleInactive"in S&&t(4,a=S.greyscaleInactive),"size"in S&&t(5,l=S.size),"order"in S&&t(6,u=S.order),"tooltipAction"in S&&t(7,d=S.tooltipAction),"lockTooltip"in S&&t(8,h=S.lockTooltip),"tabIndex"in S&&t(9,p=S.tabIndex);},[n,i,o,s,a,l,u,d,h,p,m,b,y,w,I]}c(pO,"instance$1t");const Zv=class Zv extends se{constructor(e){super(),le(this,e,pO,fO,re,{disabled:0,icon:1,name:2,hoverMove:3,greyscaleInactive:4,size:5,order:6,tooltipAction:7,lockTooltip:8,tabIndex:9,click$:11});}get click$(){return this.$$.ctx[11]}};c(Zv,"Icon_button");let st=Zv;function MA(r){let e,t;return {c(){e=v("h3"),t=G(r[1]);},m(n,i){k(n,e,i),g(e,t);},p(n,i){i&2&&K(t,n[1]);},d(n){n&&A(e);}}}c(MA,"create_if_block_5$6");function mO(r){let e,t,n,i,o,s=r[5]&&RA(r),a=r[0]!==void 0&&r[3]===void 0&&LA(r),l=r[3]!==void 0&&PA(r),u=r[2]!==void 0&&NA(r);return {c(){s&&s.c(),e=C(),a&&a.c(),t=C(),l&&l.c(),n=C(),u&&u.c(),i=je();},m(d,h){s&&s.m(d,h),k(d,e,h),a&&a.m(d,h),k(d,t,h),l&&l.m(d,h),k(d,n,h),u&&u.m(d,h),k(d,i,h),o=!0;},p(d,h){d[5]?s?s.p(d,h):(s=RA(d),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),d[0]!==void 0&&d[3]===void 0?a?a.p(d,h):(a=LA(d),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),d[3]!==void 0?l?l.p(d,h):(l=PA(d),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),d[2]!==void 0?u?(u.p(d,h),h&4&&T(u,1)):(u=NA(d),u.c(),T(u,1),u.m(i.parentNode,i)):u&&(fe(),M(u,1,1,()=>{u=null;}),pe());},i(d){o||(T(u),o=!0);},o(d){M(u),o=!1;},d(d){d&&(A(e),A(t),A(n),A(i)),s&&s.d(d),a&&a.d(d),l&&l.d(d),u&&u.d(d);}}}c(mO,"create_else_block$q");function gO(r){let e,t;return e=new Yn({props:{content:r[0]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&1&&(o.content=n[0]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(gO,"create_if_block$J");function RA(r){let e,t,n;return {c(){e=v("span"),e.textContent="",_(e,"class","close-toast svelte-12e6hb5");},m(i,o){k(i,e,o),t||(n=F(e,"click",r[12]),t=!0);},p:j,d(i){i&&A(e),t=!1,n();}}}c(RA,"create_if_block_4$a");function LA(r){let e,t;return {c(){e=v("span"),t=G(r[0]),_(e,"class","svelte-12e6hb5");},m(n,i){k(n,e,i),g(e,t);},p(n,i){i&1&&K(t,n[0]);},d(n){n&&A(e);}}}c(LA,"create_if_block_3$a");function PA(r){let e,t,n,i,o,s;return {c(){e=v("form"),t=v("input"),n=C(),i=v("input"),_(t,"type","submit"),t.hidden=!0,_(t,"class","svelte-12e6hb5"),_(i,"name","typo-toast-input"),i.autofocus=!0,_(i,"type","text"),_(i,"placeholder",r[0]),_(e,"class","svelte-12e6hb5");},m(a,l){k(a,e,l),g(e,t),g(e,n),g(e,i),de(i,r[9]),i.focus(),o||(s=[F(i,"input",r[13]),F(i,"keydown",vO),F(e,"submit",r[14])],o=!0);},p(a,l){l&1&&_(i,"placeholder",a[0]),l&512&&i.value!==a[9]&&de(i,a[9]);},d(a){a&&A(e),o=!1,Je(s);}}}c(PA,"create_if_block_2$h");function NA(r){let e,t,n,i,o=(r[6]??"")+"",s,a,l,u,d,h=(r[7]??"")+"",p,m,b,y;return n=new st({props:{icon:"file-img-enabled-gif",name:"Confirm",hoverMove:!1,size:"1.5rem"}}),u=new st({props:{icon:"file-img-disabled-gif",name:"Abort",hoverMove:!1,size:"1.5rem"}}),{c(){e=v("div"),t=v("span"),V(n.$$.fragment),i=C(),s=G(o),a=C(),l=v("span"),V(u.$$.fragment),d=C(),p=G(h),_(t,"class","svelte-12e6hb5"),_(l,"class","svelte-12e6hb5"),_(e,"class","typo-toast-confirm svelte-12e6hb5");},m(w,I){k(w,e,I),g(e,t),x(n,t,null),g(t,i),g(t,s),g(e,a),g(e,l),x(u,l,null),g(l,d),g(l,p),m=!0,b||(y=[F(t,"click",r[15]),F(l,"click",r[16])],b=!0);},p(w,I){(!m||I&64)&&o!==(o=(w[6]??"")+"")&&K(s,o),(!m||I&128)&&h!==(h=(w[7]??"")+"")&&K(p,h);},i(w){m||(T(n.$$.fragment,w),T(u.$$.fragment,w),m=!0);},o(w){M(n.$$.fragment,w),M(u.$$.fragment,w),m=!1;},d(w){w&&A(e),Z(n),Z(u),b=!1,Je(y);}}}c(NA,"create_if_block_1$l");function bO(r){let e,t,n,i,o,s=r[1]!==void 0&&MA(r);const a=[gO,mO],l=[];function u(d,h){return d[4]?0:1}return c(u,"select_block_type"),n=u(r),i=l[n]=a[n](r),{c(){e=v("div"),s&&s.c(),t=C(),i.c(),_(e,"class","typo-toast svelte-12e6hb5"),ue(e,"closing",r[10]),ue(e,"loading",r[4]);},m(d,h){k(d,e,h),s&&s.m(e,null),g(e,t),l[n].m(e,null),o=!0;},p(d,[h]){d[1]!==void 0?s?s.p(d,h):(s=MA(d),s.c(),s.m(e,t)):s&&(s.d(1),s=null);let p=n;n=u(d),n===p?l[n].p(d,h):(fe(),M(l[p],1,1,()=>{l[p]=null;}),pe(),i=l[n],i?i.p(d,h):(i=l[n]=a[n](d),i.c()),T(i,1),i.m(e,null)),(!o||h&1024)&&ue(e,"closing",d[10]),(!o||h&16)&&ue(e,"loading",d[4]);},i(d){o||(T(i),o=!0);},o(d){M(i),o=!1;},d(d){d&&A(e),s&&s.d(),l[n].d();}}}c(bO,"create_fragment$1C");const vO=c(r=>r.stopPropagation(),"keydown_handler");function _O(r,e,t){let{content:n}=e,{title:i}=e,{closeHandler:o}=e,{confirmHandler:s=void 0}=e,{promptHandler:a=void 0}=e,{showLoading:l=!1}=e,{allowClose:u=!0}=e,{confirmNaming:d=void 0}=e,{cancelNaming:h=void 0}=e,p="",m=!1;const b=c(()=>{setTimeout(()=>o(),150),t(10,m=!0);},"close"),y=c(()=>b(),"click_handler");function w(){p=this.value,t(9,p);}c(w,"input1_input_handler");const I=c(E=>{E.preventDefault(),a(p);},"submit_handler"),S=c(()=>s(!0),"click_handler_1"),R=c(()=>s(!1),"click_handler_2");return r.$$set=E=>{"content"in E&&t(0,n=E.content),"title"in E&&t(1,i=E.title),"closeHandler"in E&&t(11,o=E.closeHandler),"confirmHandler"in E&&t(2,s=E.confirmHandler),"promptHandler"in E&&t(3,a=E.promptHandler),"showLoading"in E&&t(4,l=E.showLoading),"allowClose"in E&&t(5,u=E.allowClose),"confirmNaming"in E&&t(6,d=E.confirmNaming),"cancelNaming"in E&&t(7,h=E.cancelNaming);},[n,i,s,a,l,u,d,h,b,p,m,o,y,w,I,S,R]}c(_O,"instance$1s");const Vv=class Vv extends se{constructor(e){super(),le(this,e,_O,bO,re,{content:0,title:1,closeHandler:11,confirmHandler:2,promptHandler:3,showLoading:4,allowClose:5,confirmNaming:6,cancelNaming:7,close:8});}get close(){return this.$$.ctx[8]}};c(Vv,"Toast");let Wr=Vv;var yO=Object.defineProperty,wO=Object.getOwnPropertyDescriptor,SO=c((r,e,t,n)=>{for(var i=n>1?void 0:n?wO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&yO(e,t,i),i},"__decorateClass$1o"),OA=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$k"),fa;let ft=(fa=class{constructor(e,t){f(this,"_logger");this._elementsSetup=t,this._logger=e(this);}async showToast(e,t,n){const i=await this._elementsSetup.complete(),o=new Wr({target:i.toastContainer,props:{closeHandler:c(()=>{o.$destroy();},"closeHandler"),title:e,content:t,showLoading:!1}});setTimeout(()=>o.close(),n??3e3);}async showStickyToast(e,t,n){const i=await this._elementsSetup.complete(),o=new be,s=new Wr({target:i.toastContainer,props:{closeHandler:c(()=>{s.$destroy(),o.next();},"closeHandler"),title:e,content:t,showLoading:!1,allowClose:n===void 0?!1:n}});return {close:c(()=>s.close(),"close"),update:c((a,l)=>{s.$set({title:a,content:l});},"update"),closed$:o.asObservable(),resolve:c((a,l)=>{s.$set({showLoading:!1,title:a??"Done"}),setTimeout(()=>s.close(),l??3e3);},"resolve")}}async showLoadingToast(e){const t=await this._elementsSetup.complete(),n=new Wr({target:t.toastContainer,props:{closeHandler:c(()=>{n.$destroy();},"closeHandler"),title:void 0,content:e,showLoading:!0}});return {close:c(()=>n.close(),"close"),resolve:c((i,o)=>{n.$set({showLoading:!1,title:i??"Done"}),setTimeout(()=>n.close(),o??3e3);},"resolve"),reject:c((i,o,s)=>{n.$set({showLoading:!1,title:o??"Error"}),i!==void 0&&n.$set({content:i}),setTimeout(()=>n.close(),s??3e3);},"reject")}}async showPromptToast(e,t=void 0,n=1e4){const i=await this._elementsSetup.complete(),o=new be,s=new Wr({target:i.toastContainer,props:{closeHandler:c(()=>{s.$destroy(),o.closed||o.next(null),o.complete();},"closeHandler"),promptHandler:c(a=>{o.next(a),s.close();},"promptHandler"),title:e,content:t,showLoading:!1}});return n&&setTimeout(()=>{s.close();},n),{close:c(()=>s.close(),"close"),result:Ee(o)}}async showConfirmToast(e,t=void 0,n=3e4,i){const o=await this._elementsSetup.complete(),s=new be,a=new Wr({target:o.toastContainer,props:{closeHandler:c(()=>{a.$destroy(),s.closed||s.next(!1),s.complete();},"closeHandler"),confirmHandler:c(l=>{s.next(l),a.close();},"confirmHandler"),title:e,content:t,showLoading:!1,confirmNaming:i==null?void 0:i.confirm,cancelNaming:i==null?void 0:i.cancel}});return n&&setTimeout(()=>{a.close();},n),{close:c(()=>a.close(),"close"),result:Ee(s)}}},c(fa,"ToastService"),fa);ft=SO([we(),OA(0,D(rt)),OA(1,D(Me))],ft);var AO=Object.defineProperty,kO=Object.getOwnPropertyDescriptor,aE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?kO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&AO(e,t,i),i},"__decorateClass$1n"),pa;let Er=(pa=class extends un{constructor(){super(...arguments);f(this,"_interceptor");}async runSetup(){return this._interceptor.canvasPrioritizedEventsReady}},c(pa,"PrioritizedCanvasEventsSetup"),pa);aE([D(to)],Er.prototype,"_interceptor",2);Er=aE([Do()],Er);const Eu=c(()=>{const r=document.createElement("style");if(document.head.append(r),r.sheet===null)throw r.remove(),new Error("Unable to create stylesheet");return {sheet:r.sheet,remove:r.remove.bind(r),clear:c(()=>{r.innerText="";},"clear"),replace:c(t=>{r.innerText=t;},"replace")}},"createStylesheet");function CO(r){let e,t,n,i,o,s,a,l,u,d,h;return {c(){e=G("Canvas Zoom lets you zoom the drawing canvas, so you can work on details more easily. "),t=v("br"),n=G(`
To start zooming, press the "Zoom Toggle" hotkey.`),i=v("br"),o=G(`
The center of the zoomed area will be at your last mouse position. The mouse has to be on the canvas when you enable zoom. `),s=v("br"),a=v("br"),l=G(`
To adjust the zoom level, you can press the Zoom Level hotkeys.`),u=v("br"),d=G(`
You can exit the zoom by pressing the "Zoom Toggle" hotkey again. `),h=v("br");},m(p,m){k(p,e,m),k(p,t,m),k(p,n,m),k(p,i,m),k(p,o,m),k(p,s,m),k(p,a,m),k(p,l,m),k(p,u,m),k(p,d,m),k(p,h,m);},p:j,i:j,o:j,d(p){p&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a),A(l),A(u),A(d),A(h));}}}c(CO,"create_fragment$1B");const Jv=class Jv extends se{constructor(e){super(),le(this,e,null,CO,re,{});}};c(Jv,"Canvas_zoom_info");let np=Jv;var IO=Object.defineProperty,$l=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&IO(e,t,i),i},"__decorateClass$1m");const Fv=class Fv extends $e{constructor(){super(...arguments);f(this,"_toastService");f(this,"_prioritizedCanvasEventsSetup");f(this,"_lobbyStateChangedEventListener");f(this,"_lobbyLeftEventListener");f(this,"_imageResetEventListener");f(this,"_lobbyService");f(this,"name","Canvas Zoom");f(this,"description","Lets you zoom a section of the canvas when you're drawing");f(this,"tags",[ye.DRAWING]);f(this,"featureId",26);f(this,"_enableOnlyWhenDrawingSetting",this.useSetting(new He("trigger_require_drawing",!0,this).withName("Zoom Only When Drawing").withDescription("Only allow start zooming with the hotkey when you're currently drawing")));f(this,"_toggleZoomHotkey",this.useHotkey(new cn("toggle_zoom","Toggle Zoom","Toggles canvas zooming on or off",this,()=>{this._currentMouseoverCoordinates$.pipe(Qe(this._zoomActive$,this._enableOnlyWhenDrawingSetting.changes$,this._lobbyService.lobby$),vt(1)).subscribe(([t,n,i,o])=>{i&&(o===null||o.drawerId!==o.meId)?this._zoomActive$.next(!1):this._zoomActive$.next(n!==!1||t===null?!1:t);});},!0,["ControlLeft"])));f(this,"_zoomLevelHotkeys",[1,2,3,4,5].map(t=>this.useHotkey(new cn(`zoom_level_${t}`,`Zoom Level ${t}`,`Set the zoom level to ${t}`,this,()=>this._zoomLevel$.next(t),!0,[`Digit${t}`]))));f(this,"_currentMouseoverCoordinates$",new Le(null));f(this,"_zoomActive$",new Le(!1));f(this,"_zoomLevel$",new Le(1));f(this,"_toastHandle");f(this,"_zoomStateSubscription");f(this,"_zoomResetSubscription");f(this,"_zoomStyle");f(this,"_canvasPointermoveListener",this.onCanvasPointermove.bind(this));f(this,"_canvasPointeroutListener",this.onCanvasPointerout.bind(this));}get featureInfoComponent(){return {componentType:np,props:{}}}async onActivate(){const{add:t}=await this._prioritizedCanvasEventsSetup.complete();t("postDraw")("pointermove",this._canvasPointermoveListener),t("postDraw")("pointerout",this._canvasPointeroutListener),this._zoomStyle=Eu(),this._zoomResetSubscription=this._imageResetEventListener.events$.pipe(Kt(this._lobbyStateChangedEventListener.events$.pipe(Se(n=>n.data.drawingRevealed!==void 0||n.data.drawingStarted!==void 0)),this._lobbyLeftEventListener.events$)).subscribe(()=>{this._zoomActive$.next(!1);}),this._zoomStateSubscription=this._zoomActive$.pipe(ct(),Qe(this._zoomLevel$),Cr()).subscribe(n=>this.processZoomStateUpdate(n));}async onDestroy(){var n,i,o,s;const{remove:t}=await this._prioritizedCanvasEventsSetup.complete();t("pointermove",this._canvasPointermoveListener),t("pointerout",this._canvasPointeroutListener),(n=this._zoomStyle)==null||n.remove(),this._zoomStyle=void 0,(i=this._toastHandle)==null||i.close(),(o=this._zoomStateSubscription)==null||o.unsubscribe(),(s=this._zoomResetSubscription)==null||s.unsubscribe(),this._zoomStateSubscription=void 0,this._zoomResetSubscription=void 0,this._toastHandle=void 0,this._zoomActive$.next(!1),this._currentMouseoverCoordinates$.next(null);}async setZoom(t,n){this._logger.debug("Setting zoom level",t);const i=this._zoomStyle;if(!i){this._logger.error("Zoom style element not found");return}if(t===void 0||n===void 0){i.clear();return}i.replace(`
      #game-canvas {
        width: 800px;
        aspect-ratio: 8/6;
      }
   
      #game-canvas canvas {
        position: absolute;
        width: calc(${t*2} * 100%);
        top: calc(-100% * (${n[1]} / 600 * ${t*2-1}));
        left: calc(-100% * (${n[0]} / 800 * ${t*2-1}));
      }
    `);}onCanvasPointermove(t){this._zoomActive$.value===!1&&this._currentMouseoverCoordinates$.next([t.offsetX,t.offsetY]);}onCanvasPointerout(){this._currentMouseoverCoordinates$.next(null);}async processZoomStateUpdate([[t,n],[i,o]]){var s;this._logger.debug("Zoom state processing",{prevState:t,prevLevel:n},{state:i,level:o},this._toastHandle),await this.setZoom(i!==!1?o:void 0,i!==!1?i:void 0),i!==!1&&t===!1&&(this._toastHandle!==void 0&&(this._logger.warn("Toast handle unexpected existing when just triggered"),this._toastHandle.close()),this._toastHandle=await this._toastService.showStickyToast("Canvas zoom","Click one of the zoom level hotkeys to set the zoom level")),i===!1&&t!==!1&&(this._toastHandle===void 0&&this._logger.warn("Toast handle unexpected not existing when just stopped"),(s=this._toastHandle)==null||s.close(),this._toastHandle=void 0);}get onlyWhenDrawingStore(){return this._enableOnlyWhenDrawingSetting.store}};c(Fv,"CanvasZoomFeature");let $i=Fv;$l([D(ft)],$i.prototype,"_toastService");$l([D(Er)],$i.prototype,"_prioritizedCanvasEventsSetup");$l([D(Zn)],$i.prototype,"_lobbyStateChangedEventListener");$l([D(Vn)],$i.prototype,"_lobbyLeftEventListener");$l([D(qa)],$i.prototype,"_imageResetEventListener");$l([D(ut)],$i.prototype,"_lobbyService");var TO=Object.defineProperty,DO=Object.getOwnPropertyDescriptor,lE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?DO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&TO(e,t,i),i},"__decorateClass$1l"),ma;let ru=(ma=class extends un{constructor(){super(...arguments);f(this,"_interceptor");}async runSetup(){return this._interceptor.chatboxPrioritizedEventsReady}},c(ma,"PrioritizedChatboxEventsSetup"),ma);lE([D(to)],ru.prototype,"_interceptor",2);ru=lE([Do()],ru);function EO(r){let e,t,n,i,o,s,a,l;return {c(){e=v("p"),t=v("span"),n=v("b"),i=G(r[1]),s=C(),a=v("span"),l=G(r[0]),_(n,"class",o=tA(r[2])+" svelte-1q3466u"),_(a,"class","svelte-1q3466u"),_(t,"class","svelte-1q3466u"),_(e,"class","typo-chat-message svelte-1q3466u");},m(u,d){k(u,e,d),g(e,t),g(t,n),g(n,i),r[8](n),g(t,s),g(t,a),g(a,l),r[9](a),r[10](t),r[11](e);},p(u,[d]){d&2&&K(i,u[1]),d&4&&o!==(o=tA(u[2])+" svelte-1q3466u")&&_(n,"class",o),d&1&&K(l,u[0]);},i:j,o:j,d(u){u&&A(e),r[8](null),r[9](null),r[10](null),r[11](null);}}}c(EO,"create_fragment$1A");function MO(r,e,t){let{content:n=""}=e,{title:i=""}=e,{style:o="normal"}=e,s;const a=new Promise(w=>s=w);let l,u,d,h;li(()=>{s({element:l,title:i,content:n,contentElement:d,titleElement:u,wrapperElement:h});});function p(w){Ve[w?"unshift":"push"](()=>{u=w,t(4,u);});}c(p,"b_binding");function m(w){Ve[w?"unshift":"push"](()=>{d=w,t(5,d);});}c(m,"span0_binding");function b(w){Ve[w?"unshift":"push"](()=>{l=w,t(3,l);});}c(b,"span1_binding");function y(w){Ve[w?"unshift":"push"](()=>{h=w,t(6,h);});}return c(y,"p_binding"),r.$$set=w=>{"content"in w&&t(0,n=w.content),"title"in w&&t(1,i=w.title),"style"in w&&t(2,o=w.style);},[n,i,o,l,u,d,h,a,p,m,b,y]}c(MO,"instance$1r");const Wv=class Wv extends se{constructor(e){super(),le(this,e,MO,EO,re,{content:0,title:1,style:2,message:7});}get message(){return this.$$.ctx[7]}};c(Wv,"Message");let ip=Wv;var RO=Object.defineProperty,LO=Object.getOwnPropertyDescriptor,Mo=c((r,e,t,n)=>{for(var i=n>1?void 0:n?LO(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&RO(e,t,i),i},"__decorateClass$1k"),PO=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$j"),ga;let rn=(ga=class{constructor(e){f(this,"_elementsSetup");f(this,"_chatboxEventsSetup");f(this,"_messageReceivedEventListener");f(this,"_messageRelaySetup");f(this,"lobbyService");f(this,"_logger");f(this,"_elementDiscovered$",new be);f(this,"_messageDiscovered$",new be);f(this,"_playerMessageReceived$",new be);f(this,"_lockedChatboxFeature",null);f(this,"_cancelChatboxEventsFilter",null);this._logger=e(this);}postConstruct(){this._logger.debug("Initializing chat service"),this.setupMessageObserver(),this.setupChatboxCancelEventFilter();}async setupChatboxCancelEventFilter(){const e=await this._chatboxEventsSetup.complete(),t=c(n=>{if(this._cancelChatboxEventsFilter===null)return;const i=this._cancelChatboxEventsFilter(n);(i==="preventDefault"||i==="both")&&n.preventDefault(),(i==="stopPropagation"||i==="both")&&n.stopImmediatePropagation();},"filter2");e.add("keyup",t),e.add("keydown",t);}async setupMessageObserver(){const e=await this._elementsSetup.complete();new MutationObserver(o=>{o.forEach(s=>{if(s.addedNodes.length>0){const a=s.addedNodes[0];if(a.tagName!=="P"||a.children.length!=2)return;const l=a.children[0],u=a.children[1];if(l.tagName!=="B"||u.tagName!=="SPAN")return;this._elementDiscovered$.next({title:l.textContent??"",content:u.textContent??"",element:a,titleElement:a.children[0],contentElement:a.children[1]});}});}).observe(e.chatContent,{childList:!0,subtree:!1}),this._messageReceivedEventListener.events$.pipe(Oe(this.lobbyService.lobby$),ce(([o,s])=>{if(s===null){this._logger.warn("Message received but no lobby present",o.data);return}const a=s.players.find(l=>l.id===o.data.senderId);if(!a){this._logger.warn("Player not found for message",o.data);return}return {player:a,content:o.data.message}}),Se(o=>o!==void 0)).subscribe(o=>this._messageDiscovered$.next(o));const n=[],i=[];this._messageDiscovered$.pipe(ce(o=>n.push(o)),Kt(this._elementDiscovered$.pipe(Se(o=>o.content.length!==0),ce(o=>i.push(o))))).subscribe(()=>{const o=this.findMessageMatches(n,i);for(const s of o)this._playerMessageReceived$.next(s),this._logger.debug("Message match found",s);});}findMessageMatches(e,t){const n=[];for(const i of e)for(const o of t)if(`${i.player.name}: `===o.title&&i.content===o.content){n.push({...i,...o}),e.splice(e.indexOf(i),1),t.splice(t.indexOf(o),1);break}return n}get chatMessageAdded$(){return this._elementDiscovered$.asObservable()}get playerMessageReceived$(){return this._playerMessageReceived$.asObservable()}async sendChatMessage(e){this._logger.debug("Sending chat message",e),(await this._messageRelaySetup.complete()).insertMessage({id:30,data:{msg:e}});}async addChatMessage(e,t,n="normal"){const o=(await this._elementsSetup.complete()).chatContent,s=await this.isScrolledDown(),a=new ip({target:o,props:{title:t??"",content:e,style:n}}),l=await a.message;return s&&await this.scrollToBottom(),this._elementDiscovered$.next(l),a}async isScrolledDown(){const t=(await this._elementsSetup.complete()).chatContent;return t.scrollHeight-t.scrollTop-t.clientHeight<50}async scrollToBottom(){const t=(await this._elementsSetup.complete()).chatContent;t.scrollTo({top:t.scrollHeight,behavior:"instant"});}replaceChatboxContent(e,t){return this._lockedChatboxFeature&&this._lockedChatboxFeature!==t?(this._logger.warn("Chatbox content replacement denied - chatbox locked by other feature",this._lockedChatboxFeature.name),!1):(this._elementsSetup.complete().then(n=>n.chatInput.value=e),!0)}moveChatboxCursor(e,t){return this._lockedChatboxFeature&&this._lockedChatboxFeature!==t?(this._logger.warn("Chatbox cursor movement denied - chatbox locked by other feature",this._lockedChatboxFeature.name),!1):(this._elementsSetup.complete().then(n=>n.chatInput.setSelectionRange(e,e)),!0)}requestChatboxLock(e,t=null){return this._lockedChatboxFeature&&this._lockedChatboxFeature!==e?(this._logger.warn("Chatbox lock request denied for feature - already locked by other feature",e.name),!1):(this._lockedChatboxFeature=e,this._cancelChatboxEventsFilter=t,!0)}releaseChatboxLock(e){if(this._lockedChatboxFeature!==e){this._logger.error("Chatbox lock release denied for feature - feature does not have lock",e.name);return}this._lockedChatboxFeature=null,this._cancelChatboxEventsFilter=null;}},c(ga,"ChatService"),ga);Mo([D(Me)],rn.prototype,"_elementsSetup",2);Mo([D(ru)],rn.prototype,"_chatboxEventsSetup",2);Mo([D(Zc)],rn.prototype,"_messageReceivedEventListener",2);Mo([D(_n)],rn.prototype,"_messageRelaySetup",2);Mo([D(ut)],rn.prototype,"lobbyService",2);Mo([zr()],rn.prototype,"postConstruct",1);rn=Mo([we(),PO(0,D(rt))],rn);const zn=c((r,e,t)=>{var n,i,o,s,a,l,u,d;return e===void 0?(t!==void 0&&((n=r.sheet)!=null&&n.cssRules[t])&&((i=r.sheet)==null||i.deleteRule(t),(o=r.sheet)==null||o.insertRule(".placeholder-empty-rule:not(*) {color: unset;}",t)),t):t!==void 0?(((s=r.sheet)==null?void 0:s.cssRules[t])&&((a=r.sheet)==null||a.deleteRule(t),(l=r.sheet)==null||l.insertRule(e,t)),t):(d=r.sheet)==null?void 0:d.insertRule(e,(u=r.sheet)==null?void 0:u.cssRules.length)},"replaceOrAddCssRule"),Hv=class Hv{constructor(e,t,n){f(this,"_playerHideAvatarRuleIndex");f(this,"_playerStyle");f(this,"_containerId","typo-customize-player-display");f(this,"iconsContainer",null);this._login=e,this._customizerContainer=t,this._avatarContainer=n,this._customizerContainer.classList.add(this._containerId),this._playerStyle=document.createElement("style"),this._customizerContainer.appendChild(this._playerStyle);}destroy(){this._playerStyle.remove(),this._customizerContainer.classList.remove(this._containerId);}get typoId(){return {login:this._login}}get avatarContainer(){return this._avatarContainer}get backgroundContainer(){return this._customizerContainer}get container(){return this._customizerContainer}set useBackground(e){this._customizerContainer.style.backgroundColor=e?"":"transparent",this._customizerContainer.style.zIndex=e?"":"1";}set useSafeColor(e){}set adjustToContainSprites(e){}set viewPlayerId(e){}set hideAvatar(e){this._playerHideAvatarRuleIndex=zn(this._playerStyle,e?`
      .${this._containerId} .avatar > :is(.eyes, .mouth, .color) { display: ${e?"none":"block"}
      }`:void 0,this._playerHideAvatarRuleIndex);}};c(Hv,"SkribblLandingPlayer");let rp=Hv;const oc=class oc{constructor(e,t,n){f(this,"_elementId");f(this,"_playerContainer");f(this,"_avatarContainer");f(this,"_backgroundContainer");f(this,"_iconsContainer");f(this,"_playerStyle");f(this,"_backgroundRuleIndex");f(this,"_fontColorRuleIndex");f(this,"_fontColorGuessedRuleIndex");f(this,"_fontShadowRuleIndex");f(this,"_resizeRuleIndex");f(this,"_elevateDrawingRuleIndex");f(this,"_alignRuleIndex");f(this,"_playerIdRuleIndex");f(this,"_playerInfoRuleIndex");f(this,"_playerHideAvatarRuleIndex");f(this,"_zLayerRuleIndex");if(this._player=e,this._lobbyKey=t,this._playerLogin=n,t===void 0&&n===void 0)throw new Error("No identification provided");this._playerContainer=Ye(`#game-players .player[playerid='${this._player.id}']`),this._avatarContainer=Ye(".avatar",this._playerContainer),this._backgroundContainer=Ye(".player-background",this._playerContainer),this._iconsContainer=Ye(".player-icons",this._playerContainer),this._elementId="typo-lobby-player-"+oc.idCounter++,this._playerStyle=document.createElement("style"),this._playerContainer.classList.add(this._elementId),this._playerContainer.appendChild(this._playerStyle),zn(this._playerStyle,`.${this._elementId} { z-index: ${e.id}; }`,this._zLayerRuleIndex);}destroy(){this._playerContainer.classList.remove(this._elementId),this._playerStyle.remove();}get typoId(){if(this._playerLogin!==void 0)return {login:this._playerLogin};if(this._lobbyKey!==void 0)return {lobbyKey:this._lobbyKey,lobbyPlayerId:this._player.id};throw new Error("No identification provided")}get player(){return this._player}get lobbyPlayerId(){return this._player.id}get name(){return this._player.name}get container(){return this._playerContainer}get avatarContainer(){return this._avatarContainer}get backgroundContainer(){return this._backgroundContainer}get iconsContainer(){return this._iconsContainer}set useBackground(e){this._backgroundRuleIndex=zn(this._playerStyle,e?void 0:`.${this._elementId} .player-background { background-color: transparent !important; }`,this._backgroundRuleIndex);}set useSafeColor(e){this._fontColorRuleIndex=zn(this._playerStyle,e?`
      .${this._elementId}:not(.guessed) > :not(.player-bubble) *, .${this._elementId}:not(.guessed) .player-info:after { 
        color: White !important; 
      }`:void 0,this._fontColorRuleIndex),this._fontColorGuessedRuleIndex=zn(this._playerStyle,e?`
      .${this._elementId}:is(.guessed) > :not(.player-bubble) *, .${this._elementId}:is(.guessed) .player-info:after { 
        color: #56ce27 !important;
      }`:void 0,this._fontColorGuessedRuleIndex),this._fontShadowRuleIndex=zn(this._playerStyle,e?`
      .${this._elementId} > :not(.player-bubble) *, .${this._elementId} .player-info:after { 
        text-shadow: 0px 0px 25px black, 0px 0px 10px black, 0px 0px 5px black !important;
      }`:void 0,this._fontShadowRuleIndex);}set adjustToContainSprites(e){this._resizeRuleIndex=zn(this._playerStyle,e?`.${this._elementId} { height: 56px !important; }`:void 0,this._resizeRuleIndex),this._alignRuleIndex=zn(this._playerStyle,e?`.${this._elementId} .player-avatar-container { top: calc((100% - var(--UNIT)) / 2) !important; }`:void 0,this._alignRuleIndex),this._elevateDrawingRuleIndex=zn(this._playerStyle,e?`#game-players .${this._elementId} .player-avatar-container .avatar .drawing { z-index: 100; }`:void 0,this._elevateDrawingRuleIndex);}set viewPlayerId(e){this._playerIdRuleIndex=zn(this._playerStyle,e?`
       .${this._elementId} .player-score { 
          display: none; 
       }`:void 0,this._playerIdRuleIndex),this._playerInfoRuleIndex=zn(this._playerStyle,e?`
       .${this._elementId} .player-info:after { 
          content: "#${this._player.id}"; 
       }`:void 0,this._playerInfoRuleIndex);}set hideAvatar(e){this._playerHideAvatarRuleIndex=zn(this._playerStyle,e?`
      .${this._elementId} .avatar > :is(.eyes, .mouth, .color) { display: ${e?"none":"block"}
      }`:void 0,this._playerHideAvatarRuleIndex);}};c(oc,"SkribblLobbyPlayer"),f(oc,"idCounter",0);let Nd=oc;const Ar=class Ar{constructor(){f(this,"config",{issuer:"https://api.typo.rip/openid",redirectUri:"https://skribbl.io",clientId:"1"});}async getOidcConfig(){if(Ar._oidcConfig)return Ar._oidcConfig;const e=await fetch(this.config.issuer+"/.well-known/openid-configuration");if(!e.ok)throw new Error("Failed to fetch OIDC configuration");return Ar._oidcConfig=await e.json(),Ar._oidcConfig}async loginRedirect(){const e=await this.getOidcConfig(),t=new URL(e.authorization_endpoint);t.searchParams.append("client_id",this.config.clientId),t.searchParams.append("redirect_uri",this.config.redirectUri),t.searchParams.append("response_type","code"),window.location.href=t.toString();}hasRedirectCallback(){return new URLSearchParams(window.location.search).has("code")}async exchangeAuthCode(){const e=await this.getOidcConfig(),n=new URLSearchParams(window.location.search).get("code");if(!n)throw new Error("No code found in URL");const i=await fetch(e.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:n,redirect_uri:this.config.redirectUri,client_id:this.config.clientId})});if(!i.ok)throw new Error("Failed to exchange code for token");return this.clearUrlParams(),(await i.json()).access_token}clearUrlParams(){const e=new URL(window.location.href);e.searchParams.delete("code"),e.searchParams.delete("state"),window.history.replaceState({},document.title,e.toString());}async exchangeLegacyToken(e){const t=await this.getOidcConfig(),n=await fetch(t.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"typo-legacy-token",subject_token:e,client_id:this.config.clientId})});if(!n.ok)throw new Error("Failed to exchange code for token");return this.clearUrlParams(),(await n.json()).access_token}};c(Ar,"OidcLogin"),f(Ar,"_oidcConfig");let ou=Ar;const NO="http://localhost".replace(/\/+$/,""),Qv=class Qv{constructor(e={}){this.configuration=e;}set config(e){this.configuration=e;}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:NO}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||cE}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}};c(Qv,"Configuration");let Od=Qv;const OO=new Od,sc=class sc{constructor(e=OO){f(this,"middleware");f(this,"fetchApi",c(async(e,t)=>{let n={url:e,init:t};for(const o of this.middleware)o.pre&&(n=await o.pre({fetch:this.fetchApi,...n})||n);let i;try{i=await(this.configuration.fetchApi||fetch)(n.url,n.init);}catch(o){for(const s of this.middleware)s.onError&&(i=await s.onError({fetch:this.fetchApi,url:n.url,init:n.init,error:o,response:i?i.clone():void 0})||i);if(i===void 0)throw o instanceof Error?new sp(o,"The request failed and the interceptors did not return an alternative response"):o}for(const o of this.middleware)o.post&&(i=await o.post({fetch:this.fetchApi,url:n.url,init:n.init,response:i.clone()})||i);return i},"fetchApi"));this.configuration=e,this.middleware=e.middleware;}withMiddleware(...e){const t=this.clone();return t.middleware=t.middleware.concat(...e),t}withPreMiddleware(...e){const t=e.map(n=>({pre:n}));return this.withMiddleware(...t)}withPostMiddleware(...e){const t=e.map(n=>({post:n}));return this.withMiddleware(...t)}isJsonMime(e){return e?sc.jsonRegex.test(e):!1}async request(e,t){const{url:n,init:i}=await this.createFetchParams(e,t),o=await this.fetchApi(n,i);if(o&&o.status>=200&&o.status<300)return o;throw new op(o,"Response returned an error code")}async createFetchParams(e,t){let n=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(n+="?"+this.configuration.queryParamsStringify(e.query));const i=Object.assign({},this.configuration.headers,e.headers);Object.keys(i).forEach(d=>i[d]===void 0?delete i[d]:{});const o=typeof t=="function"?t:async()=>t,s={method:e.method,headers:i,body:e.body,credentials:this.configuration.credentials},a={...s,...await o({init:s,context:e})};let l;GO(a.body)||a.body instanceof URLSearchParams||jO(a.body)?l=a.body:this.isJsonMime(i["Content-Type"])?l=JSON.stringify(a.body):l=a.body;const u={...a,body:l};return {url:n,init:u}}clone(){const e=this.constructor,t=new e(this.configuration);return t.middleware=this.middleware.slice(),t}};c(sc,"BaseAPI"),f(sc,"jsonRegex",new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i"));let Jn=sc;function jO(r){return typeof Blob<"u"&&r instanceof Blob}c(jO,"isBlob");function GO(r){return typeof FormData<"u"&&r instanceof FormData}c(GO,"isFormData");const Xv=class Xv extends Error{constructor(t,n){super(n);f(this,"name","ResponseError");this.response=t;}};c(Xv,"ResponseError");let op=Xv;const qv=class qv extends Error{constructor(t,n){super(n);f(this,"name","FetchError");this.cause=t;}};c(qv,"FetchError");let sp=qv;const Kv=class Kv extends Error{constructor(t,n){super(n);f(this,"name","RequiredError");this.field=t;}};c(Kv,"RequiredError");let Re=Kv;function cE(r,e=""){return Object.keys(r).map(t=>uE(t,r[t],e)).filter(t=>t.length>0).join("&")}c(cE,"querystring");function uE(r,e,t=""){const n=t+(t.length?`[${r}]`:r);if(e instanceof Array){const i=e.map(o=>encodeURIComponent(String(o))).join(`&${encodeURIComponent(n)}=`);return `${encodeURIComponent(n)}=${i}`}if(e instanceof Set){const i=Array.from(e);return uE(r,i,t)}return e instanceof Date?`${encodeURIComponent(n)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?cE(e,n):`${encodeURIComponent(n)}=${encodeURIComponent(String(e))}`}c(uE,"querystringSingleKey");const e_=class e_{constructor(e,t=n=>n){this.raw=e,this.transformer=t;}async value(){return this.transformer(await this.raw.json())}};c(e_,"JSONApiResponse");let et=e_;const t_=class t_{constructor(e){this.raw=e;}async value(){}};c(t_,"VoidApiResponse");let Bn=t_;function $O(r){return YO(r)}c($O,"AccessTokenDtoFromJSON");function YO(r,e){return r==null?r:{token:r.Token}}c(YO,"AccessTokenDtoFromJSONTyped");const dE={Announcement:"Announcement",Changelog:"Changelog"};function zO(r){return UO(r)}c(zO,"AnnouncementDtoFromJSON");function UO(r,e){return r==null?r:{title:r.title,content:r.content,affectedTypoVersion:r.affectedTypoVersion==null?void 0:r.affectedTypoVersion,date:r.date,type:r.type,details:r.details==null?void 0:r.details}}c(UO,"AnnouncementDtoFromJSONTyped");function hE(r){return BO(r)}c(hE,"AwardDtoFromJSON");function BO(r,e){return r==null?r:{name:r.name,id:r.id,description:r.description,url:r.url,rarity:r.rarity}}c(BO,"AwardDtoFromJSONTyped");function xO(r){return ZO(r)}c(xO,"AwardInventoryDtoFromJSON");function ZO(r,e){return r==null?r:{award:hE(r.award),inventoryIds:r.inventoryIds}}c(ZO,"AwardInventoryDtoFromJSONTyped");function VO(r){return JO(r,!1)}c(VO,"CloudDeleteDtoToJSON");function JO(r,e=!1){return r==null?r:{ids:r.ids}}c(JO,"CloudDeleteDtoToJSONTyped");function jA(r){return FO(r)}c(jA,"CloudImageDtoFromJSON");function FO(r,e){return r==null?r:{name:r.name,author:r.author,createdAt:r.createdAt,id:r.id,metaUrl:r.metaUrl,commandsUrl:r.commandsUrl,imageUrl:r.imageUrl}}c(FO,"CloudImageDtoFromJSONTyped");function WO(r){return HO(r,!1)}c(WO,"CloudSearchDtoToJSON");function HO(r,e=!1){return r==null?r:{pageSize:r.pageSize,page:r.page,authorQuery:r.authorQuery,languageQuery:r.languageQuery,createdBeforeQuery:r.createdBeforeQuery,createdAfterQuery:r.createdAfterQuery,createdInPrivateLobbyQuery:r.createdInPrivateLobbyQuery,isOwnQuery:r.isOwnQuery,titleQuery:r.titleQuery}}c(HO,"CloudSearchDtoToJSONTyped");function QO(r){return XO(r,!1)}c(QO,"CloudUploadDtoToJSON");function XO(r,e=!1){return r==null?r:{name:r.name,author:r.author,inPrivate:r.inPrivate,isOwn:r.isOwn,language:r.language,commands:r.commands,imageBase64:r.imageBase64}}c(XO,"CloudUploadDtoToJSONTyped");function qO(r){return KO(r)}c(qO,"CloudUploadedDtoFromJSON");function KO(r,e){return r==null?r:{id:r.id}}c(KO,"CloudUploadedDtoFromJSONTyped");function ej(r){return tj(r,!1)}c(ej,"EmojiCandidateDtoToJSON");function tj(r,e=!1){return r==null?r:{name:r.name,url:r.url,animated:r.animated}}c(tj,"EmojiCandidateDtoToJSONTyped");function Ql(r){return nj(r)}c(Ql,"EmojiDtoFromJSON");function nj(r,e){return r==null?r:{name:r.name,url:r.url,animated:r.animated,nameId:r.nameId}}c(nj,"EmojiDtoFromJSONTyped");function jd(r){return ij(r)}c(jd,"EventDtoFromJSON");function ij(r,e){return r==null?r:{name:r.name,id:r.id,description:r.description,eventStart:r.eventStart,eventLength:r.eventLength}}c(ij,"EventDtoFromJSONTyped");function id(r){return rj(r)}c(id,"EventDropDtoFromJSON");function rj(r,e){return r==null?r:{id:r.id,name:r.name,url:r.url,event:jd(r.event)}}c(rj,"EventDropDtoFromJSONTyped");function fE(r){return oj(r)}c(fE,"GuildDtoFromJSON");function oj(r,e){return r==null?r:{guildID:r.GuildID,invite:r.Invite,guildName:r.GuildName}}c(oj,"GuildDtoFromJSONTyped");function sj(r){return aj(r)}c(sj,"GuildInviteDtoFromJSON");function aj(r,e){return r==null?r:{name:r.name,token:r.token,iconUrl:r.iconUrl,connectedMembers:r.connectedMembers}}c(aj,"GuildInviteDtoFromJSONTyped");function Xu(r){return lj(r)}c(Xu,"MemberDtoFromJSON");function lj(r,e){return r==null?r:{bubbles:r.bubbles,drops:r.drops,sprites:r.sprites,scenes:r.scenes,flags:r.flags,rainbowSprites:r.rainbowSprites,discordID:r.discordID,userName:r.userName,userLogin:r.userLogin,guilds:r.guilds.map(fE),rawMember:r.rawMember,memberFlags:r.memberFlags}}c(lj,"MemberDtoFromJSONTyped");function cj(r){return uj(r)}c(cj,"MemberSearchDtoFromJSON");function uj(r,e){return r==null?r:{userName:r.userName,userLogin:r.userLogin,rawMember:r.rawMember}}c(uj,"MemberSearchDtoFromJSONTyped");function dj(r){return hj(r)}c(dj,"MemberWebhookDtoFromJSON");function hj(r,e){return r==null?r:{name:r.Name,guild:fE(r.Guild)}}c(hj,"MemberWebhookDtoFromJSONTyped");function fj(r){return pj(r,!1)}c(fj,"PostImageDtoToJSON");function pj(r,e=!1){return r==null?r:{title:r.title,author:r.author,posterName:r.posterName,onlyImage:r.onlyImage,imageBase64:r.imageBase64}}c(pj,"PostImageDtoToJSONTyped");function mj(r){return gj(r)}c(mj,"SceneThemeDtoFromJSON");function gj(r,e){return r==null?r:{name:r.name,shift:r.shift}}c(gj,"SceneThemeDtoFromJSONTyped");function GA(r){return bj(r)}c(GA,"SceneDtoFromJSON");function bj(r,e){return r==null?r:{name:r.name,id:r.id,url:r.url,exclusive:r.exclusive,event:r.event==null?void 0:jd(r.event),primaryColor:r.primaryColor==null?void 0:r.primaryColor,guessedColor:r.guessedColor==null?void 0:r.guessedColor,artist:r.artist==null?void 0:r.artist,themes:r.themes.map(mj)}}c(bj,"SceneDtoFromJSONTyped");function vj(r){return _j(r)}c(vj,"SceneInventoryItemDtoFromJSON");function _j(r,e){return r==null?r:{sceneId:r.sceneId,sceneShift:r.sceneShift==null?void 0:r.sceneShift}}c(_j,"SceneInventoryItemDtoFromJSONTyped");function yj(r){return wj(r,!1)}c(yj,"SceneInventoryItemDtoToJSON");function wj(r,e=!1){return r==null?r:{sceneId:r.sceneId,sceneShift:r.sceneShift}}c(wj,"SceneInventoryItemDtoToJSONTyped");function Sj(r){return Aj(r)}c(Sj,"SceneInventoryDtoFromJSON");function Aj(r,e){return r==null?r:{activeId:r.activeId==null?void 0:r.activeId,activeShift:r.activeShift==null?void 0:r.activeShift,scenes:r.scenes.map(vj)}}c(Aj,"SceneInventoryDtoFromJSONTyped");function kj(r){return Cj(r,!1)}c(kj,"SetActiveSceneDtoToJSON");function Cj(r,e=!1){return r==null?r:{scene:yj(r.scene)}}c(Cj,"SetActiveSceneDtoToJSONTyped");function pE(r){return Ij(r,!1)}c(pE,"SpriteSlotDtoToJSON");function Ij(r,e=!1){return r==null?r:{slotId:r.slotId,spriteId:r.spriteId}}c(Ij,"SpriteSlotDtoToJSONTyped");function Tj(r){return Dj(r,!1)}c(Tj,"SpriteComboDtoToJSON");function Dj(r,e=!1){return r==null?r:{slots:r.slots.map(pE)}}c(Dj,"SpriteComboDtoToJSONTyped");function $A(r){return Ej(r)}c($A,"SpriteDtoFromJSON");function Ej(r,e){return r==null?r:{name:r.name,id:r.id,cost:r.cost,url:r.url,eventDrop:r.eventDrop==null?void 0:id(r.eventDrop),isRainbowAllowed:r.isRainbowAllowed,isSpecial:r.isSpecial,artist:r.artist==null?void 0:r.artist,requiredFlags:r.requiredFlags}}c(Ej,"SpriteDtoFromJSONTyped");function Mj(r){return Rj(r)}c(Mj,"SpriteInventoryDtoFromJSON");function Rj(r,e){return r==null?r:{slot:r.slot==null?void 0:r.slot,spriteId:r.spriteId,colorShift:r.colorShift==null?void 0:r.colorShift}}c(Rj,"SpriteInventoryDtoFromJSONTyped");function Lj(r){return Pj(r)}c(Lj,"SpriteSlotCountDtoFromJSON");function Pj(r,e){return r==null?r:{unlockedSlots:r.unlockedSlots}}c(Pj,"SpriteSlotCountDtoFromJSONTyped");function Nj(r){return Oj(r)}c(Nj,"ThemeMetaDtoFromJSON");function Oj(r,e){return r==null?r:{author:r.author,created:r.created,type:r.type,id:r.id,name:r.name}}c(Oj,"ThemeMetaDtoFromJSONTyped");function jj(r){return Gj(r,!1)}c(jj,"ThemeMetaDtoToJSON");function Gj(r,e=!1){return r==null?r:{author:r.author,created:r.created,type:r.type,id:r.id,name:r.name}}c(Gj,"ThemeMetaDtoToJSONTyped");function YA(r){return $j(r)}c(YA,"ThemeDtoFromJSON");function $j(r,e){return r==null?r:{colors:r.colors,hooks:r.hooks,images:r.images,misc:r.misc,meta:Nj(r.meta)}}c($j,"ThemeDtoFromJSONTyped");function Yj(r){return zj(r,!1)}c(Yj,"ThemeDtoToJSON");function zj(r,e=!1){return r==null?r:{colors:r.colors,hooks:r.hooks,images:r.images,misc:r.misc,meta:jj(r.meta)}}c(zj,"ThemeDtoToJSONTyped");function Uj(r){return Bj(r)}c(Uj,"ThemeListingDtoFromJSON");function Bj(r,e){return r==null?r:{id:r.id,downloads:r.downloads,version:r.version,name:r.name,author:r.author}}c(Bj,"ThemeListingDtoFromJSONTyped");function xj(r){return Zj(r,!1)}c(xj,"ThemePublishRequestDtoToJSON");function Zj(r,e=!1){return r==null?r:{owner:r.owner}}c(Zj,"ThemePublishRequestDtoToJSONTyped");function _f(r){return Vj(r)}c(_f,"ThemeShareDtoFromJSON");function Vj(r,e){return r==null?r:{id:r.id}}c(Vj,"ThemeShareDtoFromJSONTyped");function Jj(r){return Fj(r,!1)}c(Jj,"ThemeUpdateRequestDtoToJSON");function Fj(r,e=!1){return r==null?r:{newId:r.newId}}c(Fj,"ThemeUpdateRequestDtoToJSONTyped");function Wj(r){return Hj(r,!1)}c(Wj,"UpdateDiscordIDToJSON");function Hj(r,e=!1){return r==null?r:{id:r.id}}c(Hj,"UpdateDiscordIDToJSONTyped");const n_=class n_ extends Jn{async getAnnouncementsRaw(e){const t={},n={},i=await this.request({path:"/announcements",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map(zO))}async getAnnouncements(e){return await(await this.getAnnouncementsRaw(e)).value()}};c(n_,"AnnouncementsApi");let ap=n_;const i_=class i_ extends Jn{async getAllAwardsRaw(e){const t={},n={},i=await this.request({path:"/awards",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map(hE))}async getAllAwards(e){return await(await this.getAllAwardsRaw(e)).value()}};c(i_,"AwardsApi");let lp=i_;const r_=class r_ extends Jn{async bulkDeleteFromUserCloudRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling bulkDeleteFromUserCloud().');if(e.cloudDeleteDto==null)throw new Re("cloudDeleteDto",'Required parameter "cloudDeleteDto" was null or undefined when calling bulkDeleteFromUserCloud().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/cloud/{login}/delete".replace("{login}",encodeURIComponent(String(e.login))),method:"POST",headers:i,query:n,body:VO(e.cloudDeleteDto)},t);return new Bn(o)}async bulkDeleteFromUserCloud(e,t){await this.bulkDeleteFromUserCloudRaw(e,t);}async deleteImageFromUserCloudRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling deleteImageFromUserCloud().');if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling deleteImageFromUserCloud().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/cloud/{login}/{id}".replace("{login}",encodeURIComponent(String(e.login))).replace("{id}",encodeURIComponent(String(e.id))),method:"DELETE",headers:i,query:n},t);return new Bn(o)}async deleteImageFromUserCloud(e,t){await this.deleteImageFromUserCloudRaw(e,t);}async getImageFromUserCloudRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getImageFromUserCloud().');if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getImageFromUserCloud().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/cloud/{login}/{id}".replace("{login}",encodeURIComponent(String(e.login))).replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>jA(s))}async getImageFromUserCloud(e,t){return await(await this.getImageFromUserCloudRaw(e,t)).value()}async linkImageToAwardRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling linkImageToAward().');if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling linkImageToAward().');if(e.token==null)throw new Re("token",'Required parameter "token" was null or undefined when calling linkImageToAward().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/cloud/{login}/{id}/award/{token}".replace("{login}",encodeURIComponent(String(e.login))).replace("{id}",encodeURIComponent(String(e.id))).replace("{token}",encodeURIComponent(String(e.token))),method:"PATCH",headers:i,query:n},t);return new Bn(o)}async linkImageToAward(e,t){await this.linkImageToAwardRaw(e,t);}async searchUserCloudRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling searchUserCloud().');if(e.cloudSearchDto==null)throw new Re("cloudSearchDto",'Required parameter "cloudSearchDto" was null or undefined when calling searchUserCloud().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/cloud/{login}/search".replace("{login}",encodeURIComponent(String(e.login))),method:"POST",headers:i,query:n,body:WO(e.cloudSearchDto)},t);return new et(o,s=>s.map(jA))}async searchUserCloud(e,t){return await(await this.searchUserCloudRaw(e,t)).value()}async uploadToUserCloudRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling uploadToUserCloud().');if(e.cloudUploadDto==null)throw new Re("cloudUploadDto",'Required parameter "cloudUploadDto" was null or undefined when calling uploadToUserCloud().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/cloud/{login}".replace("{login}",encodeURIComponent(String(e.login))),method:"POST",headers:i,query:n,body:QO(e.cloudUploadDto)},t);return new et(o,s=>qO(s))}async uploadToUserCloud(e,t){return await(await this.uploadToUserCloudRaw(e,t)).value()}};c(r_,"CloudApi");let su=r_;const o_=class o_ extends Jn{async addEmojiRaw(e,t){if(e.emojiCandidateDto==null)throw new Re("emojiCandidateDto",'Required parameter "emojiCandidateDto" was null or undefined when calling addEmoji().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/emojis",method:"POST",headers:i,query:n,body:ej(e.emojiCandidateDto)},t);return new et(o,s=>Ql(s))}async addEmoji(e,t){return await(await this.addEmojiRaw(e,t)).value()}async deleteEmojiRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling deleteEmoji().');const n={};e.nameId!=null&&(n.nameId=e.nameId);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/emojis/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"DELETE",headers:i,query:n},t);return new Bn(o)}async deleteEmoji(e,t){await this.deleteEmojiRaw(e,t);}async getAllEmojisRaw(e,t){if(e.limit==null)throw new Re("limit",'Required parameter "limit" was null or undefined when calling getAllEmojis().');if(e.animated==null)throw new Re("animated",'Required parameter "animated" was null or undefined when calling getAllEmojis().');if(e.statics==null)throw new Re("statics",'Required parameter "statics" was null or undefined when calling getAllEmojis().');const n={};e.query!=null&&(n.query=e.query),e.limit!=null&&(n.limit=e.limit),e.animated!=null&&(n.animated=e.animated),e.statics!=null&&(n.statics=e.statics);const i={},o=await this.request({path:"/emojis",method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(Ql))}async getAllEmojis(e,t){return await(await this.getAllEmojisRaw(e,t)).value()}async getAllEmojisCachedRaw(e,t){if(e.limit==null)throw new Re("limit",'Required parameter "limit" was null or undefined when calling getAllEmojisCached().');if(e.animated==null)throw new Re("animated",'Required parameter "animated" was null or undefined when calling getAllEmojisCached().');if(e.statics==null)throw new Re("statics",'Required parameter "statics" was null or undefined when calling getAllEmojisCached().');const n={};e.query!=null&&(n.query=e.query),e.limit!=null&&(n.limit=e.limit),e.animated!=null&&(n.animated=e.animated),e.statics!=null&&(n.statics=e.statics);const i={},o=await this.request({path:"/emojis/cache",method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(Ql))}async getAllEmojisCached(e,t){return await(await this.getAllEmojisCachedRaw(e,t)).value()}async getEmojiRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getEmoji().');const n={};e.nameId!=null&&(n.nameId=e.nameId);const i={},o=await this.request({path:"/emojis/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>Ql(s))}async getEmoji(e,t){return await(await this.getEmojiRaw(e,t)).value()}async getNewEmojisRaw(e,t){if(e.limit==null)throw new Re("limit",'Required parameter "limit" was null or undefined when calling getNewEmojis().');if(e.animated==null)throw new Re("animated",'Required parameter "animated" was null or undefined when calling getNewEmojis().');if(e.statics==null)throw new Re("statics",'Required parameter "statics" was null or undefined when calling getNewEmojis().');const n={};e.query!=null&&(n.query=e.query),e.limit!=null&&(n.limit=e.limit),e.animated!=null&&(n.animated=e.animated),e.statics!=null&&(n.statics=e.statics);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/emojis/discover",method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(Ql))}async getNewEmojis(e,t){return await(await this.getNewEmojisRaw(e,t)).value()}};c(o_,"EmojisApi");let cp=o_;const s_=class s_ extends Jn{async getAllEventDropsRaw(e){const t={},n={},i=await this.request({path:"/events/drops",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map(id))}async getAllEventDrops(e){return await(await this.getAllEventDropsRaw(e)).value()}async getAllEventsRaw(e){const t={},n={},i=await this.request({path:"/events",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map(jd))}async getAllEvents(e){return await(await this.getAllEventsRaw(e)).value()}async getEventByIdRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getEventById().');const n={},i={},o=await this.request({path:"/events/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>jd(s))}async getEventById(e,t){return await(await this.getEventByIdRaw(e,t)).value()}async getEventDropRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getEventDrop().');const n={},i={},o=await this.request({path:"/events/drops/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>id(s))}async getEventDrop(e,t){return await(await this.getEventDropRaw(e,t)).value()}async getEventDropsOfEventRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getEventDropsOfEvent().');const n={},i={},o=await this.request({path:"/events/{id}/drops".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(id))}async getEventDropsOfEvent(e,t){return await(await this.getEventDropsOfEventRaw(e,t)).value()}};c(s_,"EventsApi");let up=s_;const a_=class a_ extends Jn{async getGuildInviteRaw(e,t){if(e.token==null)throw new Re("token",'Required parameter "token" was null or undefined when calling getGuildInvite().');const n={},i={},o=await this.request({path:"/guilds/{token}/invite".replace("{token}",encodeURIComponent(String(e.token))),method:"GET",headers:i,query:n},t);return new et(o,s=>sj(s))}async getGuildInvite(e,t){return await(await this.getGuildInviteRaw(e,t)).value()}async postImageToGuildRaw(e,t){if(e.token==null)throw new Re("token",'Required parameter "token" was null or undefined when calling postImageToGuild().');if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling postImageToGuild().');if(e.postImageDto==null)throw new Re("postImageDto",'Required parameter "postImageDto" was null or undefined when calling postImageToGuild().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/guilds/{token}/imagepost/{id}".replace("{token}",encodeURIComponent(String(e.token))).replace("{id}",encodeURIComponent(String(e.id))),method:"POST",headers:i,query:n,body:fj(e.postImageDto)},t);return new Bn(o)}async postImageToGuild(e,t){await this.postImageToGuildRaw(e,t);}};c(a_,"GuildsApi");let dp=a_;const l_=class l_ extends Jn{async getMemberAvailableAwardInventoryRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberAvailableAwardInventory().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/awards/available".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(xO))}async getMemberAvailableAwardInventory(e,t){return await(await this.getMemberAvailableAwardInventoryRaw(e,t)).value()}async getMemberSceneInventoryRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberSceneInventory().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/scenes".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>Sj(s))}async getMemberSceneInventory(e,t){return await(await this.getMemberSceneInventoryRaw(e,t)).value()}async getMemberSpriteInventoryRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberSpriteInventory().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/sprites".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(Mj))}async getMemberSpriteInventory(e,t){return await(await this.getMemberSpriteInventoryRaw(e,t)).value()}async getMemberSpriteSlotCountRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberSpriteSlotCount().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/sprites/slots".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>Lj(s))}async getMemberSpriteSlotCount(e,t){return await(await this.getMemberSpriteSlotCountRaw(e,t)).value()}async setMemberSceneRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling setMemberScene().');if(e.setActiveSceneDto==null)throw new Re("setActiveSceneDto",'Required parameter "setActiveSceneDto" was null or undefined when calling setMemberScene().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/scenes".replace("{login}",encodeURIComponent(String(e.login))),method:"PATCH",headers:i,query:n,body:kj(e.setActiveSceneDto)},t);return new Bn(o)}async setMemberScene(e,t){await this.setMemberSceneRaw(e,t);}async setMemberSpriteComboRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling setMemberSpriteCombo().');if(e.spriteComboDto==null)throw new Re("spriteComboDto",'Required parameter "spriteComboDto" was null or undefined when calling setMemberSpriteCombo().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/sprites/combo".replace("{login}",encodeURIComponent(String(e.login))),method:"PATCH",headers:i,query:n,body:Tj(e.spriteComboDto)},t);return new Bn(o)}async setMemberSpriteCombo(e,t){await this.setMemberSpriteComboRaw(e,t);}async setMemberSpriteSlotRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling setMemberSpriteSlot().');if(e.spriteSlotDto==null)throw new Re("spriteSlotDto",'Required parameter "spriteSlotDto" was null or undefined when calling setMemberSpriteSlot().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/member/{login}/inventory/sprites/slot".replace("{login}",encodeURIComponent(String(e.login))),method:"PATCH",headers:i,query:n,body:pE(e.spriteSlotDto)},t);return new Bn(o)}async setMemberSpriteSlot(e,t){await this.setMemberSpriteSlotRaw(e,t);}};c(l_,"InventoryApi");let di=l_;const c_=class c_ extends Jn{async clearMemberDropboostRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling clearMemberDropboost().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}/dropboost".replace("{login}",encodeURIComponent(String(e.login))),method:"DELETE",headers:i,query:n},t);return new Bn(o)}async clearMemberDropboost(e,t){await this.clearMemberDropboostRaw(e,t);}async connectMemberToGuildRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling connectMemberToGuild().');if(e.token==null)throw new Re("token",'Required parameter "token" was null or undefined when calling connectMemberToGuild().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}/guilds/{token}".replace("{login}",encodeURIComponent(String(e.login))).replace("{token}",encodeURIComponent(String(e.token))),method:"PATCH",headers:i,query:n},t);return new Bn(o)}async connectMemberToGuild(e,t){await this.connectMemberToGuildRaw(e,t);}async findMembersWildcardSearchRaw(e,t){if(e.content==null)throw new Re("content",'Required parameter "content" was null or undefined when calling findMembersWildcardSearch().');const n={};e.content!=null&&(n.content=e.content);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/search",method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(cj))}async findMembersWildcardSearch(e,t){return await(await this.findMembersWildcardSearchRaw(e,t)).value()}async getAuthenticatedMemberRaw(e){const t={},n={};if(this.configuration&&this.configuration.accessToken){const o=this.configuration.accessToken,s=await o("bearer",[]);s&&(n.Authorization=`Bearer ${s}`);}const i=await this.request({path:"/members/me",method:"GET",headers:n,query:t},e);return new et(i,o=>Xu(o))}async getAuthenticatedMember(e){return await(await this.getAuthenticatedMemberRaw(e)).value()}async getMemberAccessTokenRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberAccessToken().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}/token".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>$O(s))}async getMemberAccessToken(e,t){return await(await this.getMemberAccessTokenRaw(e,t)).value()}async getMemberByDiscordIDRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getMemberByDiscordID().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/discord/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>Xu(s))}async getMemberByDiscordID(e,t){return await(await this.getMemberByDiscordIDRaw(e,t)).value()}async getMemberByLoginRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberByLogin().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>Xu(s))}async getMemberByLogin(e,t){return await(await this.getMemberByLoginRaw(e,t)).value()}async getMemberGuildWebhooksRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling getMemberGuildWebhooks().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}/webhooks".replace("{login}",encodeURIComponent(String(e.login))),method:"GET",headers:i,query:n},t);return new et(o,s=>s.map(dj))}async getMemberGuildWebhooks(e,t){return await(await this.getMemberGuildWebhooksRaw(e,t)).value()}async removeConnectedGuildRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling removeConnectedGuild().');if(e.token==null)throw new Re("token",'Required parameter "token" was null or undefined when calling removeConnectedGuild().');const n={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}/guilds/{token}".replace("{login}",encodeURIComponent(String(e.login))).replace("{token}",encodeURIComponent(String(e.token))),method:"DELETE",headers:i,query:n},t);return new Bn(o)}async removeConnectedGuild(e,t){await this.removeConnectedGuildRaw(e,t);}async updateMemberDiscordIDRaw(e,t){if(e.login==null)throw new Re("login",'Required parameter "login" was null or undefined when calling updateMemberDiscordID().');if(e.updateDiscordID==null)throw new Re("updateDiscordID",'Required parameter "updateDiscordID" was null or undefined when calling updateMemberDiscordID().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/members/{login}/discord".replace("{login}",encodeURIComponent(String(e.login))),method:"PATCH",headers:i,query:n,body:Wj(e.updateDiscordID)},t);return new et(o,s=>Xu(s))}async updateMemberDiscordID(e,t){return await(await this.updateMemberDiscordIDRaw(e,t)).value()}};c(c_,"MembersApi");let Gd=c_;const u_=class u_ extends Jn{async getAllScenesRaw(e){const t={},n={},i=await this.request({path:"/scenes",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map(GA))}async getAllScenes(e){return await(await this.getAllScenesRaw(e)).value()}async getSceneByIdRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getSceneById().');const n={},i={},o=await this.request({path:"/scenes/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>GA(s))}async getSceneById(e,t){return await(await this.getSceneByIdRaw(e,t)).value()}};c(u_,"ScenesApi");let hp=u_;const d_=class d_ extends Jn{async getAllSpritesRaw(e){const t={},n={},i=await this.request({path:"/sprites",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map($A))}async getAllSprites(e){return await(await this.getAllSpritesRaw(e)).value()}async getSpriteByIdRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getSpriteById().');const n={},i={},o=await this.request({path:"/sprites/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>$A(s))}async getSpriteById(e,t){return await(await this.getSpriteByIdRaw(e,t)).value()}};c(d_,"SpritesApi");let fp=d_;const h_=class h_ extends Jn{async getAllThemesRaw(e){const t={},n={},i=await this.request({path:"/themes",method:"GET",headers:n,query:t},e);return new et(i,o=>o.map(Uj))}async getAllThemes(e){return await(await this.getAllThemesRaw(e)).value()}async getThemeByIdRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling getThemeById().');const n={},i={},o=await this.request({path:"/themes/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>YA(s))}async getThemeById(e,t){return await(await this.getThemeByIdRaw(e,t)).value()}async publishThemeRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling publishTheme().');if(e.themePublishRequestDto==null)throw new Re("themePublishRequestDto",'Required parameter "themePublishRequestDto" was null or undefined when calling publishTheme().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/themes/{id}/public".replace("{id}",encodeURIComponent(String(e.id))),method:"POST",headers:i,query:n,body:xj(e.themePublishRequestDto)},t);return new et(o,s=>_f(s))}async publishTheme(e,t){return await(await this.publishThemeRaw(e,t)).value()}async shareThemeRaw(e,t){if(e.themeDto==null)throw new Re("themeDto",'Required parameter "themeDto" was null or undefined when calling shareTheme().');const n={},i={};i["Content-Type"]="application/json";const o=await this.request({path:"/themes/share",method:"POST",headers:i,query:n,body:Yj(e.themeDto)},t);return new et(o,s=>_f(s))}async shareTheme(e,t){return await(await this.shareThemeRaw(e,t)).value()}async updateThemeRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling updateTheme().');if(e.themeUpdateRequestDto==null)throw new Re("themeUpdateRequestDto",'Required parameter "themeUpdateRequestDto" was null or undefined when calling updateTheme().');const n={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,a=await s("bearer",[]);a&&(i.Authorization=`Bearer ${a}`);}const o=await this.request({path:"/themes/{id}/public".replace("{id}",encodeURIComponent(String(e.id))),method:"PATCH",headers:i,query:n,body:Jj(e.themeUpdateRequestDto)},t);return new et(o,s=>_f(s))}async updateTheme(e,t){return await(await this.updateThemeRaw(e,t)).value()}async useThemeByIdRaw(e,t){if(e.id==null)throw new Re("id",'Required parameter "id" was null or undefined when calling useThemeById().');const n={},i={},o=await this.request({path:"/themes/{id}/use".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:i,query:n},t);return new et(o,s=>YA(s))}async useThemeById(e,t){return await(await this.useThemeByIdRaw(e,t)).value()}};c(h_,"ThemesApi");let ss=h_;var Qj=Object.defineProperty,Xj=Object.getOwnPropertyDescriptor,qj=c((r,e,t,n)=>{for(var i=n>1?void 0:n?Xj(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&Qj(e,t,i),i},"__decorateClass$1j"),Kj=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$i"),ba;let io=(ba=class{constructor(e){f(this,"_logger");f(this,"_token",new Le(void 0));this._logger=e(this),this.initToken();}async initToken(){let e=await Jt.getToken();if(e===null){const t=new ou;if(t.hasRedirectCallback()){this._logger.error("Handling OIDC redirect callback");try{e=await t.exchangeAuthCode(),await Jt.setToken(e);}catch{t.clearUrlParams();}}}if(e&&e.length===64){this._logger.info("Exchanging legacy token for OIDC token");try{e=await new ou().exchangeLegacyToken(e),await Jt.setToken(e);}catch{this._logger.warn("Failed to exchange legacy token, removing it");}}this._logger.info("Authenticated",e),this._token.next(e);}get token(){return this._token.asObservable()}async removeToken(){await Jt.setToken(null),this._token.next(null);}async setToken(e){await Jt.setToken(e),this._token.next(e);}},c(ba,"TokenService"),ba);io=qj([we(),Kj(0,D(rt))],io);var e3=Object.defineProperty,t3=Object.getOwnPropertyDescriptor,n3=c((r,e,t,n)=>{for(var i=n>1?void 0:n?t3(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&e3(e,t,i),i},"__decorateClass$1i"),zA=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$h"),va;let mi=(va=class{constructor(e,t){f(this,"_logger");f(this,"_baseUrl","https://api.typo.rip");f(this,"_token","");f(this,"instances",new Map);this._logger=e(this),t.token.subscribe(n=>this._token=n??"");}createApiConfig(){return new Od({basePath:this._baseUrl,accessToken:c(()=>this._token,"accessToken")})}getApi(e){let t=this.instances.get(e);return t===void 0&&(t=new e(this.createApiConfig()),this.instances.set(e,t)),t}set baseUrl(e){this._baseUrl=e;}},c(va,"ApiService"),va);mi=n3([we(),zA(0,D(rt)),zA(1,D(io))],mi);var i3=Object.defineProperty,r3=Object.getOwnPropertyDescriptor,o3=c((r,e,t,n)=>{for(var i=n>1?void 0:n?r3(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&i3(e,t,i),i},"__decorateClass$1h"),qu=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$g"),_a;let Sn=(_a=class{constructor(e,t,n,i){f(this,"_logger");f(this,"_member$",new Le(void 0));f(this,"_memberData$",new Le(void 0));this._apiService=t,this._tokenService=n,this._onboardingService=i,this._logger=e(this),this._tokenService.token.pipe(Se(s=>s!==void 0)).subscribe(s=>this.loadMember(s===null)),this._member$.pipe(lt(s=>s==null?Tt(s):yD({webhooks:Ri(t.getApi(Gd).getMemberGuildWebhooks({login:Number(s.userLogin)})),member:Tt(s),slots:Ri(t.getApi(di).getMemberSpriteSlotCount({login:Number(s.userLogin)})),spriteInventory:Ri(t.getApi(di).getMemberSpriteInventory({login:Number(s.userLogin)})),sceneInventory:Ri(t.getApi(di).getMemberSceneInventory({login:Number(s.userLogin)}))}))).subscribe(s=>{this._memberData$.next(s);});const o=i.registerTask({key:"logged_in",name:"Log in with Discord",description:"Connect your discord account to typo to connect with friends and upgrade your avatar outfit.",start:c(()=>this.login(),"start"),priority:2});this._member$.subscribe(s=>{s!==void 0&&(s!==null?o.complete():o.clear());});}async loadMember(e=!1){if(e)return this._member$.next(null),Promise.resolve(null);const t=this._apiService.getApi(Gd).getAuthenticatedMember();return t.then(n=>{this._member$.next(n);}).catch(()=>{this._member$.value!==null&&this._member$.next(null);}),t}async refreshInventory(){await Ee(this.memberData$.pipe(vt(1),lt(async e=>{if(e!=null){const t=await this._apiService.getApi(di).getMemberSpriteInventory({login:Number(e.member.userLogin)}),n=await this._apiService.getApi(di).getMemberSceneInventory({login:Number(e.member.userLogin)});e.spriteInventory=t,e.sceneInventory=n,this._memberData$.next(e);}})));}get member$(){return this._member$.asObservable()}get memberData$(){return this._memberData$.asObservable()}login(){new ou().loginRedirect();}async logout(){await this._tokenService.removeToken();}async refreshMember(){return this.loadMember()}},c(_a,"MemberService"),_a);Sn=o3([we(),qu(0,D(rt)),qu(1,D(mi)),qu(2,D(io)),qu(3,D(Dc))],Sn);const f_=class f_{constructor(e,t,n){f(this,"_avatarContainer");f(this,"_placeholderBackgroundContainer");f(this,"iconsContainer",null);this._player=e,this._lobbyKey=t,this._overlayContainer=n,this._avatarContainer=Ye(".avatar",this._overlayContainer),this._placeholderBackgroundContainer=nn('<div style="display: none;"></div>'),this._overlayContainer.appendChild(this._placeholderBackgroundContainer);}destroy(){this._placeholderBackgroundContainer.remove();}get typoId(){return {lobbyKey:this._lobbyKey,lobbyPlayerId:this._player.id}}get avatarContainer(){return this._avatarContainer}get backgroundContainer(){return this._placeholderBackgroundContainer}get container(){return this._overlayContainer}set useBackground(e){}set useSafeColor(e){}set adjustToContainSprites(e){}set viewPlayerId(e){}set hideAvatar(e){e&&ph(":is(.eyes, .mouth, .color)",this._avatarContainer).forEach(t=>t.remove());}};c(f_,"SkribblOverlayPlayer");let pp=f_;const p_=class p_{constructor(e,t,n,i){f(this,"_avatarContainer");f(this,"_placeholderBackgroundContainer");f(this,"iconsContainer",null);if(this._player=e,this._playerPopup=t,this._lobbyKey=n,this._playerLogin=i,n===void 0&&i===void 0)throw new Error("No identification provided");this._avatarContainer=Ye(".avatar",this._playerPopup),this._placeholderBackgroundContainer=nn('<div style="display: none;"></div>'),this._playerPopup.appendChild(this._placeholderBackgroundContainer);}destroy(){this._placeholderBackgroundContainer.remove();}get typoId(){if(this._playerLogin!==void 0)return {login:this._playerLogin};if(this._lobbyKey!==void 0)return {lobbyKey:this._lobbyKey,lobbyPlayerId:this._player.id};throw new Error("No identification provided")}get avatarContainer(){return this._avatarContainer}get backgroundContainer(){return this._placeholderBackgroundContainer}get container(){return this._playerPopup}set useBackground(e){}set useSafeColor(e){}set adjustToContainSprites(e){}set viewPlayerId(e){}set hideAvatar(e){e&&ph(":is(.eyes, .mouth, .color)",this._avatarContainer).forEach(t=>t.remove());}};c(p_,"SkribblPopupPlayer");let mp=p_;const m_=class m_{constructor(e,t){f(this,"_playerContainer");f(this,"_avatarContainer");f(this,"_placeholderBackgroundContainer");f(this,"iconsContainer",null);this._player=e,this._lobbyKey=t,this._playerContainer=Ye(`.overlay-content .result.show .podests > div:has(.avatar[playerid='${this._player.id}'])`),this._avatarContainer=Ye(`.avatar[playerid='${this._player.id}']`,this._playerContainer),this._placeholderBackgroundContainer=nn('<div style="display: none;"></div>'),this._playerContainer.appendChild(this._placeholderBackgroundContainer);}destroy(){this._placeholderBackgroundContainer.remove();}get typoId(){return {lobbyKey:this._lobbyKey,lobbyPlayerId:this._player.id}}get avatarContainer(){return this._avatarContainer}get backgroundContainer(){return this._placeholderBackgroundContainer}get container(){return this._playerContainer}set useBackground(e){}set useSafeColor(e){}set adjustToContainSprites(e){}set viewPlayerId(e){}set hideAvatar(e){e&&ph(":is(.eyes, .mouth, .color)",this._avatarContainer).forEach(t=>t.remove());}};c(m_,"SkribblScoreboardPodiumPlayer");let gp=m_;const g_=class g_{constructor(e,t){f(this,"_playerContainer");f(this,"_avatarContainer");f(this,"_placeholderBackgroundContainer");f(this,"iconsContainer",null);this._player=e,this._lobbyKey=t,this._playerContainer=Ye(`.overlay-content .result.show .ranks .rank[playerid='${this._player.id}']`),this._avatarContainer=Ye(".avatar",this._playerContainer),this._placeholderBackgroundContainer=nn('<div style="display: none;"></div>'),this._playerContainer.appendChild(this._placeholderBackgroundContainer);}destroy(){this._placeholderBackgroundContainer.remove();}get typoId(){return {lobbyKey:this._lobbyKey,lobbyPlayerId:this._player.id}}get avatarContainer(){return this._avatarContainer}get backgroundContainer(){return this._placeholderBackgroundContainer}get container(){return this._playerContainer}set useBackground(e){}set useSafeColor(e){}set adjustToContainSprites(e){}set viewPlayerId(e){}set hideAvatar(e){e&&ph(":is(.eyes, .mouth, .color)",this._avatarContainer).forEach(t=>t.remove());}};c(g_,"SkribblScoreboardRegularPlayer");let bp=g_;var s3=Object.defineProperty,cb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&s3(e,t,i),i},"__decorateClass$1g");const b_=class b_ extends un{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_globalSettingsService");f(this,"_memberService");}async runSetup(){const t=await this._elementsSetup.complete();return this._memberService.member$.pipe(Qe(this._globalSettingsService.settings.showLandingOutfit.changes$),ce(([n,i])=>{if(!(n==null||t===void 0||!i))return new rp(Number(n.userLogin),t.landingCustomizeContainer,t.landingAvatar)}))}};c(b_,"LandingPlayerSetup");let ro=b_;cb([D(Me)],ro.prototype,"_elementsSetup");cb([D(xn)],ro.prototype,"_globalSettingsService");cb([D(Sn)],ro.prototype,"_memberService");const tr=c(r=>{const e=[...r].reduce((i,o)=>i+o.charCodeAt(0),0);return [...r].map(i=>String.fromCharCode(i.charCodeAt(0)+e)).join("")},"calculateLobbyKey");var a3=Object.defineProperty,l3=Object.getOwnPropertyDescriptor,Wn=c((r,e,t,n)=>{for(var i=n>1?void 0:n?l3(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&a3(e,t,i),i},"__decorateClass$1f"),c3=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$f"),ya;let en=(ya=class{constructor(e){f(this,"_elementsSetup");f(this,"_lobbyJoinedEvent");f(this,"_lobbyLeftEvent");f(this,"_lobbyStateChangedEvent");f(this,"_playerChangedEvent");f(this,"_scoreboardVisibleEvent");f(this,"_textOverlayVisibleEvent");f(this,"_popupVisibleEvent");f(this,"_memberService");f(this,"_lobbyService");f(this,"_landingPlayerSetup");f(this,"_logger");f(this,"_lobbyPlayers$",new Le([]));f(this,"_landingPlayer$",new Le(void 0));f(this,"_scoreboardPlayers$",new Le([]));f(this,"_popupPlayer$",new Le(void 0));f(this,"_overlayPlayer$",new Le(void 0));f(this,"_chatPlayers$",new Le([]));f(this,"_players$",new Le([]));this._logger=e(this);}postConstruct(){this.setupLandingPlayer(),this.setupLobbyPlayers(),this.setupScoreboardPlayers(),this.setupPopupPlayer(),this.setupOverlayPlayer(),this.setupCombinedPlayers();}setupCombinedPlayers(){this._lobbyPlayers$.pipe(lr([]),Qe(this.landingPlayer$,this.scoreboardPlayers$,this.popupPlayer$,this.overlayPlayer$,this._chatPlayers$),ce(([e,t,n,i,o,s])=>[...e,t,...n,i,o,...s].filter(a=>a!==void 0))).subscribe(this._players$),this.players$.pipe(Cr()).subscribe(([e,t])=>{e.filter(n=>!t.includes(n)).forEach(n=>n.destroy());});}setupLandingPlayer(){Tt(void 0).pipe(Kt(ji(this._landingPlayerSetup.complete()).pipe(lt(e=>e)))).subscribe(e=>this._landingPlayer$.next(e));}setupLobbyPlayers(){this._lobbyJoinedEvent.events$.pipe(Qe(this._memberService.member$)).subscribe(([e,t])=>{const n=e.data.players.map(i=>{try{const o=e.data.id?tr(e.data.id):void 0;return new Nd(i,o,o===void 0&&t?Number(t.userLogin):void 0)}catch(o){return this._logger.error("Failed to create player",i,o),null}}).filter(i=>i!==null);this._lobbyPlayers$.next(n),this._logger.info("Lobby joined",n);}),this._playerChangedEvent.events$.pipe(Oe(this._lobbyJoinedEvent.events$.pipe(ce(e=>e.data.id),Kt(this._lobbyLeftEvent.events$.pipe(ce(()=>{}))))),Qe(this._memberService.member$)).subscribe(([[e,t],n])=>{if(t===void 0){this._lobbyPlayers$.next([]);return}if(t===null&&n===null||n===void 0){this._lobbyPlayers$.next([]);return}if(e.data.joined){const i=this._lobbyPlayers$.value;let o;try{const s=t?tr(t):void 0;o=new Nd(e.data.joined,s,s===void 0&&n?Number(n.userLogin):void 0);}catch(s){this._logger.error("Failed to create player",e.data.joined,s);return}i.push(o),this._lobbyPlayers$.next(i),this._logger.info("Player joined",o);}if(e.data.left){const i=e.data.left.id,o=this._lobbyPlayers$.value.find(a=>a.lobbyPlayerId===i),s=this._lobbyPlayers$.value.filter(a=>a!=o);this._lobbyPlayers$.next(s),this._logger.info("Player left",o);}}),this._lobbyLeftEvent.events$.subscribe(()=>{this._lobbyPlayers$.next([]),this._logger.info("Lobby left");});}setupScoreboardPlayers(){this._scoreboardVisibleEvent.events$.pipe(Qe(this._lobbyStateChangedEvent.events$),Oe(this._lobbyService.lobby$),ce(([[e,t],n])=>n===null||t.data.gameEnded===void 0?void 0:{visible:e.data,lobby:n,stateChange:t.data.gameEnded}),ct()).subscribe(e=>{const t=e==null?void 0:e.stateChange,n=e==null?void 0:e.lobby,i=(n==null?void 0:n.id)??null,o=(e==null?void 0:e.visible)??!1;if(t===void 0||n===void 0||i===null||!o){this._logger.info("Lobby changed, no scoreboard data"),this._scoreboardPlayers$.next([]);return}const s=t.ranking.map(a=>({player:n.players.find(l=>l.id===a.playerId),rank:a.rank})).filter(a=>a.player!==void 0).map(a=>a.rank<3?new gp(a.player,tr(i)):new bp(a.player,tr(i)));this._logger.info("Scoreboard visible, scoreboard data",s),this._scoreboardPlayers$.next(s);});}setupPopupPlayer(){this._popupVisibleEvent.events$.pipe(Oe(this._memberService.member$,this._lobbyService.lobby$,this._elementsSetup.complete())).subscribe(([e,t,n,i])=>{var u;if(!e.data||n===null){this._logger.info("Popup player hidden"),this._popupPlayer$.next(void 0);return}const o=((u=ad(".player",i.playerPopup))==null?void 0:u.getAttribute("playerid"))??void 0;if(o===void 0){this._logger.error("No player id in popup"),this._popupPlayer$.next(void 0);return}const s=n.players.find(d=>d.id===Number(o));if(s===void 0){this._logger.error("Player not found in lobby",o),this._popupPlayer$.next(void 0);return}const a=n.id?tr(n.id):void 0,l=new mp(s,i.playerPopup,a,a===void 0&&t?Number(t.userLogin):void 0);this._popupPlayer$.next(l),this._logger.info("Popup player visible",l);});}setupOverlayPlayer(){this._textOverlayVisibleEvent.events$.pipe(Oe(this._lobbyService.lobby$,this._elementsSetup.complete())).subscribe(([e,t,n])=>{if(!e.data||t===null||t.id===null){this._logger.info("Overlay player hidden"),this._overlayPlayer$.next(void 0);return}const i=n.textOverlay.getAttribute("playerid")??void 0;if(ad(".avatar",n.textOverlay)===null||i===void 0){this._logger.info("No player or playerid in overlay, probably not a choosing info"),this._overlayPlayer$.next(void 0);return}const o=t.players.find(l=>l.id===Number(i));if(o===void 0){this._logger.error("Player not found in lobby",i),this._overlayPlayer$.next(void 0);return}const s=tr(t.id),a=new pp(o,s,n.textOverlay);this._overlayPlayer$.next(a),this._logger.info("Overlay player visible",a);});}addChatPlayer(e){const t=this._chatPlayers$.value;t.push(e),this._chatPlayers$.next(t);}removeChatPlayer(e){const t=this._chatPlayers$.value.filter(n=>n!==e);this._chatPlayers$.next(t);}clearChatPlayers(){this._chatPlayers$.next([]);}get lobbyPlayers$(){return this._lobbyPlayers$.asObservable()}get landingPlayer$(){return this._landingPlayer$.asObservable()}get scoreboardPlayers$(){return this._scoreboardPlayers$.asObservable()}get popupPlayer$(){return this._popupPlayer$.asObservable()}get overlayPlayer$(){return this._overlayPlayer$.asObservable()}get players$(){return this._players$.asObservable()}},c(ya,"PlayersService"),ya);Wn([D(Me)],en.prototype,"_elementsSetup",2);Wn([D(Gi)],en.prototype,"_lobbyJoinedEvent",2);Wn([D(Vn)],en.prototype,"_lobbyLeftEvent",2);Wn([D(Zn)],en.prototype,"_lobbyStateChangedEvent",2);Wn([D(nl)],en.prototype,"_playerChangedEvent",2);Wn([D(Xc)],en.prototype,"_scoreboardVisibleEvent",2);Wn([D(eu)],en.prototype,"_textOverlayVisibleEvent",2);Wn([D(Fc)],en.prototype,"_popupVisibleEvent",2);Wn([D(Sn)],en.prototype,"_memberService",2);Wn([D(ut)],en.prototype,"_lobbyService",2);Wn([D(ro)],en.prototype,"_landingPlayerSetup",2);Wn([zr()],en.prototype,"postConstruct",1);en=Wn([we(),c3(0,D(rt))],en);const ac=class ac{constructor(e,t,n){f(this,"_elementId");f(this,"_placeholderBackgroundContainer");f(this,"_playerStyle");f(this,"_playerHideAvatarRuleIndex");f(this,"iconsContainer",null);this._player=e,this._lobbyKey=t,this._container=n,this._placeholderBackgroundContainer=document.createElement("div"),this._elementId="typo-chat-player-"+ac.idCounter++,this._playerStyle=document.createElement("style"),this._container.appendChild(this._playerStyle),this.container.classList.add(this._elementId);}destroy(){this._container.classList.remove(this._elementId),this._playerStyle.remove();}get typoId(){return {lobbyKey:this._lobbyKey,lobbyPlayerId:this._player.id}}get player(){return this._player}get lobbyPlayerId(){return this._player.id}get name(){return this._player.name}get container(){return this._container}get avatarContainer(){return this._container}get backgroundContainer(){return this._placeholderBackgroundContainer}set useBackground(e){}set useSafeColor(e){}set adjustToContainSprites(e){}set viewPlayerId(e){}set hideAvatar(e){this._playerHideAvatarRuleIndex=zn(this._playerStyle,e?`
      .${this._elementId} :is(.eyes, .mouth, .color) { 
        display: ${e?"none":"block"}
      }`:void 0,this._playerHideAvatarRuleIndex);}};c(ac,"SkribblChatPlayer"),f(ac,"idCounter",0);let vp=ac;const ub=480,db=800,$d=48,hb=80,u3=ub/$d,d3=db/hb,wr=c((r,e)=>{const t=r==="avatar"?$d:hb,i=(r==="avatar"?ub:db)/t,o=Math.floor(e/i);return {x:e%i*t,y:o*t}},"calculateAtlasOffsets"),Sr=c((r,e,t)=>{const n=(r==="avatar"?$d:hb)/$d,i=r==="avatar"?ub:db,s=`${n} * ${t} * ${r==="avatar"?u3:d3}`;return `
    background-position: 
      calc(-${e.x} / ${i} * ${s}) 
      calc(-${e.y} / ${i} * ${s}); 
    background-size: calc(${s});
  `},"wrapOffsetAsStyle");function UA(r){let e,t;return {c(){e=v("div"),_(e,"class","typo-avatar-layer special svelte-ma71bf"),_(e,"style",t=Sr("container",wr("container",r[0][3]),"var(--typo-avatar-container-size)"));},m(n,i){k(n,e,i);},p(n,i){i&1&&t!==(t=Sr("container",wr("container",n[0][3]),"var(--typo-avatar-container-size)"))&&_(e,"style",t);},d(n){n&&A(e);}}}c(UA,"create_if_block$I");function h3(r){let e,t,n,i,o,s,a,l,u,d,h=r[0][3]!==void 0&&r[0][3]>=0&&UA(r);return {c(){e=v("div"),t=v("div"),i=C(),o=v("div"),a=C(),l=v("div"),d=C(),h&&h.c(),_(t,"class","typo-avatar-layer color svelte-ma71bf"),_(t,"style",n=Sr("avatar",wr("avatar",r[0][0]),"var(--typo-avatar-container-size)")),_(o,"class","typo-avatar-layer mouth svelte-ma71bf"),_(o,"style",s=Sr("avatar",wr("avatar",r[0][2]),"var(--typo-avatar-container-size)")),_(l,"class","typo-avatar-layer eyes svelte-ma71bf"),_(l,"style",u=Sr("avatar",wr("avatar",r[0][1]),"var(--typo-avatar-container-size)")),_(e,"class","typo-avatar-container svelte-ma71bf"),H(e,"--typo-avatar-container-size",r[1]);},m(p,m){k(p,e,m),g(e,t),g(e,i),g(e,o),g(e,a),g(e,l),g(e,d),h&&h.m(e,null),r[4](e);},p(p,[m]){m&1&&n!==(n=Sr("avatar",wr("avatar",p[0][0]),"var(--typo-avatar-container-size)"))&&_(t,"style",n),m&1&&s!==(s=Sr("avatar",wr("avatar",p[0][2]),"var(--typo-avatar-container-size)"))&&_(o,"style",s),m&1&&u!==(u=Sr("avatar",wr("avatar",p[0][1]),"var(--typo-avatar-container-size)"))&&_(l,"style",u),p[0][3]!==void 0&&p[0][3]>=0?h?h.p(p,m):(h=UA(p),h.c(),h.m(e,null)):h&&(h.d(1),h=null),m&2&&H(e,"--typo-avatar-container-size",p[1]);},i:j,o:j,d(p){p&&A(e),h&&h.d(),r[4](null);}}}c(h3,"create_fragment$1z");function f3(r,e,t){let{avatar:n}=e,{size:i="80px"}=e,o,s;const a=new Promise(u=>o=u);li(()=>{o(s);});function l(u){Ve[u?"unshift":"push"](()=>{s=u,t(2,s);});}return c(l,"div3_binding"),r.$$set=u=>{"avatar"in u&&t(0,n=u.avatar),"size"in u&&t(1,i=u.size);},[n,i,s,a,l]}c(f3,"instance$1q");const v_=class v_ extends se{constructor(e){super(),le(this,e,f3,h3,re,{avatar:0,size:1,element:3});}get element(){return this.$$.ctx[3]}};c(v_,"Skribbl_avatar");let _p=v_;var p3=Object.defineProperty,Nh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&p3(e,t,i),i},"__decorateClass$1e");const __=class __ extends $e{constructor(){super(...arguments);f(this,"_chatService");f(this,"_playersService");f(this,"_lobbyService");f(this,"_elementsSetup");f(this,"name","Chat Avatars");f(this,"description","Display the avatar of a player next to their chat messages.");f(this,"tags",[ye.INTERFACE]);f(this,"featureId",50);f(this,"_avatarContainers",new Set);f(this,"featureEnabledDefault",!1);f(this,"_chatSubscription");f(this,"_chatMutationObserver");}async onActivate(){this._chatSubscription=this._chatService.playerMessageReceived$.pipe(Oe(this._lobbyService.lobby$.pipe(ce(t=>t!=null&&t.id?tr(t.id):null))),Se(([,t])=>t!==null)).subscribe(async([t,n])=>this.processNewMessage(t,n)),this.observeRemovedMessages();}async onDestroy(){var t,n;(t=this._chatSubscription)==null||t.unsubscribe(),this._chatSubscription=void 0,this._playersService.clearChatPlayers();for(const i of this._avatarContainers)i.element.remove();this._avatarContainers.clear(),(n=this._chatMutationObserver)==null||n.disconnect(),this._chatMutationObserver=void 0;}async processNewMessage(t,n){if(this._logger.info("Processing new chat message",t),n===null){this._logger.warn("No lobby key found for chat message",t);return}const i=t.player,o=nn(`<div
        style="display: inline-flex; align-items: center; height: 0; vertical-align: middle; margin-right: .5rem"
      ></div>`),s=new _p({target:o,props:{avatar:i.avatar,size:"1rem"}});t.element.insertAdjacentElement("afterbegin",o);const a=await s.element,l=new vp(i,n,a);this._avatarContainers.add({element:o,player:l}),this._playersService.addChatPlayer(l);}async observeRemovedMessages(){const t=await this._elementsSetup.complete();this._chatMutationObserver=new MutationObserver(n=>{for(const i of n)i.removedNodes.length>0&&this._avatarContainers.forEach(o=>{o.element.isConnected||(this._playersService.removeChatPlayer(o.player),this._avatarContainers.delete(o));});}),this._chatMutationObserver.observe(t.chatContent,{childList:!0,subtree:!0});}};c(__,"ChatAvatarsFeature");let oo=__;Nh([D(rn)],oo.prototype,"_chatService");Nh([D(en)],oo.prototype,"_playersService");Nh([D(ut)],oo.prototype,"_lobbyService");Nh([D(Me)],oo.prototype,"_elementsSetup");var m3=Object.defineProperty,mE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&m3(e,t,i),i},"__decorateClass$1d");const y_=class y_ extends $e{constructor(){super(...arguments);f(this,"_lobbyJoinedEventListener");f(this,"_chatService");f(this,"name","Chat Clear");f(this,"description","Clears old messages in the chat for better performance");f(this,"tags",[ye.GAMEPLAY,ye.INTERFACE]);f(this,"featureId",42);f(this,"_chatSubscription");f(this,"_chatCleared$",new be);f(this,"_clearChatCommand",this.useCommand(new ti("clear",this,"Clear Chat","Clears the chat messages")).run(async t=>(this._chatCleared$.next(void 0),new vn(t,"Chat cleared"))));f(this,"_clearChatQuotaSetting",this.useSetting(new Wt("clear_quota",200,this).withName("Message Limit").withDescription("When the chat contains more than this limit, old messages are deleted. Set to 0 to disable.")));}async onActivate(){this._chatSubscription=this._lobbyJoinedEventListener.events$.pipe(lt(()=>this._chatService.chatMessageAdded$.pipe(Oe(this._clearChatQuotaSetting.changes$),bh((t,[n,i])=>(i<=0||t.length<i||(t[0].remove(),t.splice(1)),t.push(n.element),t),[]),lt(t=>this._chatCleared$.pipe(_t(()=>{t.forEach(n=>n.remove()),t.splice(0,t.length);})))))).subscribe();}async onDestroy(){var t;(t=this._chatSubscription)==null||t.unsubscribe(),this._chatSubscription=void 0;}};c(y_,"ChatClearFeature");let so=y_;mE([D(Gi)],so.prototype,"_lobbyJoinedEventListener");mE([D(rn)],so.prototype,"_chatService");const w_=class w_ extends Gn{};c(w_,"InterpretableEmptyRemainder");let au=w_;const S_=class S_{constructor(e,t){f(this,"_execute");this._name=e,this._description=t;}get name(){return this._name}get description(){return this._description}withAction(e){return this._execute=e,this}interpret(e,t,n){let i=!1;try{const{argument:o,remainder:s}=this.readArg(e,()=>i=!0);return i||(n.currentInterpretedParameter=this),Promise.resolve({result:{...t,...o},context:n,remainder:s})}catch(o){throw o instanceof au||(n.currentInterpretedParameter=this),o}}execute(e,t){var n;return ((n=this._execute)==null?void 0:n.call(this,e,t))??Promise.resolve({result:new vn(this)})}};c(S_,"ExtensionCommandParameter");let lu=S_;const A_=class A_ extends lu{constructor(t,n,i){super(t,n);f(this,"typeName","text");f(this,"typeDescription","a single word or text wrapped in quotes");this._mapping=i;}readArg(t){const n=/^\s*(["'])(.*?)\1/;let i="",o="";const s=t.trim().match(n);if(s!==null)i=s[2],o=t.trim().slice(s[0].length).trim();else {const l=t.trim().split(" ");i=l[0].trim(),o=l.slice(1).join(" ");}if(i.length<1)throw new au(this);const a=this._mapping(i);return {remainder:o,argument:a}}};c(A_,"StringCommandParameter");let yp=A_;const k_=class k_ extends Gn{};c(k_,"InterpretableArgumentParsingError");let Yd=k_;const C_=class C_ extends Ic{constructor(e){super(e,void 0);}};c(C_,"InterpretableSilentSuccess");let Pi=C_;function BA(r){let e,t,n,i,o=r[7]&&xA(r);return {c(){e=v("h3"),o&&o.c(),t=C(),n=v("span"),i=G(r[6]),_(e,"class","svelte-1lmlzvv");},m(s,a){k(s,e,a),o&&o.m(e,null),g(e,t),g(e,n),g(n,i);},p(s,a){s[7]?o?o.p(s,a):(o=xA(s),o.c(),o.m(e,t)):o&&(o.d(1),o=null),a&64&&K(i,s[6]);},d(s){s&&A(e),o&&o.d();}}}c(BA,"create_if_block_1$k");function xA(r){let e,t;return {c(){e=v("img"),ht(e.src,t="")||_(e,"src",t),_(e,"alt","Icon"),H(e,"content","var(--"+r[7]+")"),_(e,"class","svelte-1lmlzvv");},m(n,i){k(n,e,i);},p(n,i){i&128&&H(e,"content","var(--"+n[7]+")");},d(n){n&&A(e);}}}c(xA,"create_if_block_2$g");function ZA(r){let e,t,n;return {c(){e=v("span"),e.textContent="",_(e,"class","close-explicit svelte-1lmlzvv");},m(i,o){k(i,e,o),t||(n=F(e,"click",r[17]),t=!0);},p:j,d(i){i&&A(e),t=!1,n();}}}c(ZA,"create_if_block$H");function g3(r){let e,t,n,i,o,s,a=r[6]&&BA(r);const l=[r[5].props];var u=r[5].componentType;function d(p,m){let b={};for(let y=0;y<l.length;y+=1)b=St(b,l[y]);return m!==void 0&&m&32&&(b=St(b,Rt(l,[Lt(p[5].props)]))),{props:b}}c(d,"switch_props"),u&&(i=qe(u,d(r)));let h=r[0]==="explicit"&&ZA(r);return {c(){e=v("div"),a&&a.c(),t=C(),n=v("div"),i&&V(i.$$.fragment),o=C(),h&&h.c(),_(n,"class","content svelte-1lmlzvv"),ue(n,"padding",r[8]!==!1),_(e,"class","typo-area-flyout color-scrollbar svelte-1lmlzvv"),H(e,"max-height",r[12]()),H(e,"max-width",r[13]()),H(e,"grid-area",r[4]),H(e,"margin",r[2]+" "+r[3]),ue(e,"closing",r[11]),ue(e,"align-top",r[1]==="top"),ue(e,"align-bottom",r[1]==="bottom");},m(p,m){k(p,e,m),a&&a.m(e,null),g(e,t),g(e,n),i&&x(i,n,null),g(e,o),h&&h.m(e,null),r[18](e),s=!0;},p(p,[m]){if(p[6]?a?a.p(p,m):(a=BA(p),a.c(),a.m(e,t)):a&&(a.d(1),a=null),m&32&&u!==(u=p[5].componentType)){if(i){fe();const b=i;M(b.$$.fragment,1,0,()=>{Z(b,1);}),pe();}u?(i=qe(u,d(p,m)),V(i.$$.fragment),T(i.$$.fragment,1),x(i,n,null)):i=null;}else if(u){const b=m&32?Rt(l,[Lt(p[5].props)]):{};i.$set(b);}(!s||m&256)&&ue(n,"padding",p[8]!==!1),p[0]==="explicit"?h?h.p(p,m):(h=ZA(p),h.c(),h.m(e,null)):h&&(h.d(1),h=null),(!s||m&16)&&H(e,"grid-area",p[4]),(!s||m&12)&&H(e,"margin",p[2]+" "+p[3]),(!s||m&2048)&&ue(e,"closing",p[11]),(!s||m&2)&&ue(e,"align-top",p[1]==="top"),(!s||m&2)&&ue(e,"align-bottom",p[1]==="bottom");},i(p){s||(i&&T(i.$$.fragment,p),s=!0);},o(p){i&&M(i.$$.fragment,p),s=!1;},d(p){p&&A(e),a&&a.d(),i&&Z(i),h&&h.d(),r[18](null);}}}c(g3,"create_fragment$1y");function b3(r,e,t){let{closeStrategy:n="implicit"}=e,{alignment:i="bottom"}=e,{marginY:o=".5em"}=e,{marginX:s="1em"}=e,{areaName:a}=e,{maxHeight:l=void 0}=e,{maxWidth:u=void 0}=e,{componentData:d}=e,{title:h=void 0}=e,{iconName:p=void 0}=e,{contentPadding:m=void 0}=e;const b=new be,y=b.asObservable();let w,I=!1;const S=c(z=>{if(!w||n!=="implicit")return;const $=z.target;w!==$&&!w.contains($)&&R();},"clickListener"),R=c(()=>{t(11,I=!0),setTimeout(()=>{b.next();},80);},"close");vh(()=>{document.removeEventListener("click",S),b.complete();}),li(()=>{setTimeout(()=>document.addEventListener("click",S),1);});const E=c(()=>l?`calc(${l} - (2 * ${o}))`:"auto","getMaxHeightCss"),P=c(()=>u?`calc(${u} - (2 * ${s}))`:"auto","getMaxWidthCss"),L=c(()=>R(),"click_handler");function O(z){Ve[z?"unshift":"push"](()=>{w=z,t(10,w);});}return c(O,"div1_binding"),r.$$set=z=>{"closeStrategy"in z&&t(0,n=z.closeStrategy),"alignment"in z&&t(1,i=z.alignment),"marginY"in z&&t(2,o=z.marginY),"marginX"in z&&t(3,s=z.marginX),"areaName"in z&&t(4,a=z.areaName),"maxHeight"in z&&t(14,l=z.maxHeight),"maxWidth"in z&&t(15,u=z.maxWidth),"componentData"in z&&t(5,d=z.componentData),"title"in z&&t(6,h=z.title),"iconName"in z&&t(7,p=z.iconName),"contentPadding"in z&&t(8,m=z.contentPadding);},[n,i,o,s,a,d,h,p,m,R,w,I,E,P,l,u,y,L,O]}c(b3,"instance$1p");const I_=class I_ extends se{constructor(e){super(),le(this,e,b3,g3,re,{closeStrategy:0,alignment:1,marginY:2,marginX:3,areaName:4,maxHeight:14,maxWidth:15,componentData:5,title:6,iconName:7,contentPadding:8,closed$:16,close:9});}get closed$(){return this.$$.ctx[16]}get close(){return this.$$.ctx[9]}};c(I_,"Area_flyout");let si=I_;function VA(r,e,t){const n=r.slice();return n[5]=e[t],n}c(VA,"get_each_context$D");function JA(r,e,t){const n=r.slice();return n[5]=e[t],n}c(JA,"get_each_context_1$d");function FA(r,e,t){const n=r.slice();return n[11]=e[t],n}c(FA,"get_each_context_2$6");function WA(r){let e,t,n,i,o,s,a,l,u,d,h={ctx:r,current:null,token:null,hasCatch:!1,pending:y3,then:_3,catch:v3,value:8};$n(o=Ee(r[5].context.command.idSetting.changes$),h);let p=te(r[5].context.parameters),m=[];for(let S=0;S<p.length;S+=1)m[S]=HA(FA(r,p,S));function b(S,R){if(R&3&&(u=null),S[5].context.currentInterpretedParameter===void 0)return S3;if(u==null&&(u=!S[0].otherHasExecutionTarget(S[5],S[1])),u)return w3}c(b,"select_block_type");let y=b(r,-1),w=y&&y(r),I=!(r[5].result instanceof Ja)&&QA(r);return {c(){e=v("div"),t=v("div"),n=v("div"),i=G(`/
            `),h.block.c(),s=C();for(let S=0;S<m.length;S+=1)m[S].c();a=C(),l=v("div"),w&&w.c(),d=C(),I&&I.c(),_(n,"class","typo-command-result-id svelte-19nsl5m"),ue(n,"current",r[0].isActiveTypingId(r[5])),_(t,"class","typo-command-result-synopsis svelte-19nsl5m"),_(l,"class","typo-command-result-description"),_(e,"class","typo-command-result svelte-19nsl5m");},m(S,R){k(S,e,R),g(e,t),g(t,n),g(n,i),h.block.m(n,h.anchor=null),h.mount=()=>n,h.anchor=null,g(t,s);for(let E=0;E<m.length;E+=1)m[E]&&m[E].m(t,null);g(e,a),g(e,l),w&&w.m(l,null),g(e,d),I&&I.m(e,null);},p(S,R){if(r=S,h.ctx=r,R&2&&o!==(o=Ee(r[5].context.command.idSetting.changes$))&&$n(o,h)||To(h,r,R),R&3&&ue(n,"current",r[0].isActiveTypingId(r[5])),R&3){p=te(r[5].context.parameters);let E;for(E=0;E<p.length;E+=1){const P=FA(r,p,E);m[E]?m[E].p(P,R):(m[E]=HA(P),m[E].c(),m[E].m(t,null));}for(;E<m.length;E+=1)m[E].d(1);m.length=p.length;}y===(y=b(r,R))&&w?w.p(r,R):(w&&w.d(1),w=y&&y(r),w&&(w.c(),w.m(l,null))),r[5].result instanceof Ja?I&&(I.d(1),I=null):I?I.p(r,R):(I=QA(r),I.c(),I.m(e,null));},d(S){S&&A(e),h.block.d(),h.token=null,h=null,Ie(m,S),w&&w.d(),I&&I.d();}}}c(WA,"create_if_block_1$j");function v3(r){return {c:j,m:j,p:j,d:j}}c(v3,"create_catch_block_1");function _3(r){let e=r[8]+"",t;return {c(){t=G(e);},m(n,i){k(n,t,i);},p(n,i){i&2&&e!==(e=n[8]+"")&&K(t,e);},d(n){n&&A(t);}}}c(_3,"create_then_block_1");function y3(r){return {c:j,m:j,p:j,d:j}}c(y3,"create_pending_block_1");function HA(r){let e,t=r[11].typeName+"",n,i;return {c(){e=v("div"),n=G(t),i=C(),_(e,"class","typo-command-result-arg svelte-19nsl5m"),ue(e,"current",r[0].isActiveTypingParam(r[5],r[11]));},m(o,s){k(o,e,s),g(e,n),g(e,i);},p(o,s){s&2&&t!==(t=o[11].typeName+"")&&K(n,t),s&3&&ue(e,"current",o[0].isActiveTypingParam(o[5],o[11]));},d(o){o&&A(e);}}}c(HA,"create_each_block_2$6");function w3(r){let e,t=r[5].context.currentInterpretedParameter.name+"",n,i,o,s=r[5].context.currentInterpretedParameter.description+"",a,l,u,d,h,p=r[5].context.currentInterpretedParameter.typeDescription+"",m;return {c(){e=v("b"),n=G(t),i=G(":"),o=C(),a=G(s),l=v("br"),u=C(),d=v("span"),h=v("b"),h.textContent="Content: ",m=G(p),_(d,"class","typo-command-result-param-type svelte-19nsl5m");},m(b,y){k(b,e,y),g(e,n),g(e,i),k(b,o,y),k(b,a,y),k(b,l,y),k(b,u,y),k(b,d,y),g(d,h),g(d,m);},p(b,y){y&2&&t!==(t=b[5].context.currentInterpretedParameter.name+"")&&K(n,t),y&2&&s!==(s=b[5].context.currentInterpretedParameter.description+"")&&K(a,s),y&2&&p!==(p=b[5].context.currentInterpretedParameter.typeDescription+"")&&K(m,p);},d(b){b&&(A(e),A(o),A(a),A(l),A(u),A(d));}}}c(w3,"create_if_block_5$5");function S3(r){let e=r[5].context.command.description+"",t;return {c(){t=G(e);},m(n,i){k(n,t,i);},p(n,i){i&2&&e!==(e=n[5].context.command.description+"")&&K(t,e);},d(n){n&&A(t);}}}c(S3,"create_if_block_4$9");function QA(r){let e,t;function n(s,a){return a&3&&(t=null),t==null&&(t=!!s[0].otherHasExecutionTarget(s[5],s[1])),t?k3:A3}c(n,"select_block_type_1");let i=n(r,-1),o=i(r);return {c(){e=v("div"),o.c(),_(e,"class","typo-command-result-state svelte-19nsl5m");},m(s,a){k(s,e,a),o.m(e,null);},p(s,a){i===(i=n(s,a))&&o?o.p(s,a):(o.d(1),o=i(s),o&&(o.c(),o.m(e,null)));},d(s){s&&A(e),o.d();}}}c(QA,"create_if_block_2$f");function A3(r){let e,t,n,i,o=r[0].getResultStateMessage(r[5],r[2])+"",s;return {c(){e=v("img"),n=C(),i=v("span"),s=G(o),ht(e.src,t="")||_(e,"src",t),_(e,"alt","icon"),H(e,"content","var(--"+(r[0].isValidCommand(r[5])?"file-img-enabled-gif":"file-img-disabled-gif")+")"),_(e,"class","svelte-19nsl5m");},m(a,l){k(a,e,l),k(a,n,l),k(a,i,l),g(i,s);},p(a,l){l&3&&H(e,"content","var(--"+(a[0].isValidCommand(a[5])?"file-img-enabled-gif":"file-img-disabled-gif")+")"),l&7&&o!==(o=a[0].getResultStateMessage(a[5],a[2])+"")&&K(s,o);},d(a){a&&(A(e),A(n),A(i));}}}c(A3,"create_else_block$p");function k3(r){let e;return {c(){e=v("span"),e.textContent="Another command is prioritized";},m(t,n){k(t,e,n);},p:j,d(t){t&&A(e);}}}c(k3,"create_if_block_3$9");function XA(r){let e,t=r[5].result!==null&&WA(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,i){n[5].result!==null?t?t.p(n,i):(t=WA(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},d(n){n&&A(e),t&&t.d(n);}}}c(XA,"create_each_block_1$d");function qA(r){let e,t,n,i=te(r[1]),o=[];for(let s=0;s<i.length;s+=1)o[s]=KA(VA(r,i,s));return {c(){e=v("div"),e.textContent="Type a command id..",t=C();for(let s=0;s<o.length;s+=1)o[s].c();n=je();},m(s,a){k(s,e,a),k(s,t,a);for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(s,a);k(s,n,a);},p(s,a){if(a&2){i=te(s[1]);let l;for(l=0;l<i.length;l+=1){const u=VA(s,i,l);o[l]?o[l].p(u,a):(o[l]=KA(u),o[l].c(),o[l].m(n.parentNode,n));}for(;l<o.length;l+=1)o[l].d(1);o.length=i.length;}},d(s){s&&(A(e),A(t),A(n)),Ie(o,s);}}}c(qA,"create_if_block$G");function C3(r){return {c:j,m:j,p:j,d:j}}c(C3,"create_catch_block$5");function I3(r){let e=r[8]+"",t;return {c(){t=G(e);},m(n,i){k(n,t,i);},p(n,i){i&2&&e!==(e=n[8]+"")&&K(t,e);},d(n){n&&A(t);}}}c(I3,"create_then_block$5");function T3(r){return {c:j,m:j,p:j,d:j}}c(T3,"create_pending_block$5");function KA(r){let e,t,n,i,o={ctx:r,current:null,token:null,hasCatch:!1,pending:T3,then:I3,catch:C3,value:8};return $n(n=Ee(r[5].context.command.idSetting.changes$),o),{c(){e=v("b"),t=G(`/
        `),o.block.c(),i=C();},m(s,a){k(s,e,a),g(e,t),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=i,g(e,i);},p(s,a){r=s,o.ctx=r,a&2&&n!==(n=Ee(r[5].context.command.idSetting.changes$))&&$n(n,o)||To(o,r,a);},d(s){s&&A(e),o.block.d(),o.token=null,o=null;}}}c(KA,"create_each_block$D");function D3(r){let e,t,n=r[1].every(ek),i=te(r[1]),o=[];for(let a=0;a<i.length;a+=1)o[a]=XA(JA(r,i,a));let s=n&&qA(r);return {c(){e=v("div");for(let a=0;a<o.length;a+=1)o[a].c();t=C(),s&&s.c(),_(e,"class","typo-command-preview svelte-19nsl5m");},m(a,l){k(a,e,l);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null);g(e,t),s&&s.m(e,null);},p(a,[l]){if(l&7){i=te(a[1]);let u;for(u=0;u<i.length;u+=1){const d=JA(a,i,u);o[u]?o[u].p(d,l):(o[u]=XA(d),o[u].c(),o[u].m(e,t));}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length;}l&2&&(n=a[1].every(ek)),n?s?s.p(a,l):(s=qA(a),s.c(),s.m(e,null)):s&&(s.d(1),s=null);},i:j,o:j,d(a){a&&A(e),Ie(o,a),s&&s.d();}}}c(D3,"create_fragment$1x");const ek=c(r=>r.result===null,"func$4");function E3(r,e,t){let n,i,{feature:o}=e;const s=o.commandResultStore;De(r,s,l=>t(1,n=l));const a=o.submitHotkeyStore;return De(r,a,l=>t(2,i=l)),r.$$set=l=>{"feature"in l&&t(0,o=l.feature);},[o,n,i,s,a]}c(E3,"instance$1o");const T_=class T_ extends se{constructor(e){super(),le(this,e,E3,D3,re,{feature:0});}};c(T_,"Command_preview");let wp=T_;function M3(r){let e,t,n;return {c(){e=v("input"),_(e,"id","typo-command-input"),e.autofocus=!0,_(e,"type","text"),e.value="/",_(e,"placeholder","Type your command here..");},m(i,o){k(i,e,o),e.focus(),t||(n=[F(e,"input",r[1]),F(e,"submit",R3)],t=!0);},p:j,i:j,o:j,d(i){i&&A(e),t=!1,Je(n);}}}c(M3,"create_fragment$1w");const R3=c(r=>{r.preventDefault(),r.stopImmediatePropagation();},"submit_handler");function L3(r,e,t){let{onInput:n}=e;const i=c(o=>{n(o.currentTarget.value);},"input_handler");return r.$$set=o=>{"onInput"in o&&t(0,n=o.onInput);},[n,i]}c(L3,"instance$1n");const D_=class D_ extends se{constructor(e){super(),le(this,e,L3,M3,re,{onInput:0});}};c(D_,"Command_input");let Sp=D_;var P3=Object.defineProperty,gE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&P3(e,t,i),i},"__decorateClass$1c");const E_=class E_ extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_toastService");f(this,"name","Chat Commands");f(this,"description","Execute actions of other features with chat commands");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",38);f(this,"_interpreterSubscription");f(this,"_submitSubscription");f(this,"_commandArgs$",new be);f(this,"_hotkeySubmitted$",new be);f(this,"_commandResults$",new be);f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_commandInput");f(this,"_inputChangeListener",this.handleInputEvent.bind(this));f(this,"_submitCommandHotkey",this.useHotkey(new cn("submit_command","Submit Command","When pressed, the currently typed command will be submitted",this,async()=>{if(!this._commandInput)return;const t=await this._elements.complete();t.chatInput.value="",this._hotkeySubmitted$.next(void 0);},!0,["Enter"],void 0,!1)));f(this,"_customPrefixSetting",this.useSetting(new Bf("custom_prefix","",this).withName("Custom Command Prefix").withDescription("Set a custom prefix for chat commands that will trigger the command prompt, additionally to ' / '")));f(this,"_muteResultsSetting",this.useSetting(new He("mute_results",!1,this).withName("Mute Command Results").withDescription("Don't show a toast message with the command result when a command has been executed")));f(this,"_hideFlyoutSetting",this.useSetting(new He("hide_flyout",!1,this).withName("Hide Command Preview").withDescription("Hide the command preview flyout that shows possible commands and their parameters")));f(this,"_echoCommand",this.useCommand(new ti("echo",this,"Echo","Echo a text :)")).withParameters(t=>t.addParam(new yp("text","The text to echo",n=>({text:n}))).run(async({text:n},i)=>new vn(i,n))));}async onActivate(){const t=await this._elements.complete();t.chatInput.addEventListener("input",this._inputChangeListener),this._interpreterSubscription=this._commandArgs$.pipe(Oe(this._commandsService.commands$),lt(async([n,i])=>{var o;return n.startsWith("/")?(n=n.substring(1),Promise.all(i.map(async s=>this._commandsService.executeCommand(s,n)))):((o=this._commandInput)==null||o.$destroy(),this._commandInput=void 0,t.chatInput.focus(),[])}),Oe(this._hideFlyoutSetting.changes$)).subscribe(([n,i])=>{this._logger.debug("Command results changed",n),this.setFlyoutState(!i&&n.length>0,t);const o=[...n].sort((s,a)=>{const l=s.result instanceof vn,u=a.result instanceof vn;return l===u?0:l?-1:1});this._commandResults$.next(o);}),this._submitSubscription=this._hotkeySubmitted$.pipe(Oe(this._commandResults$,this._commandArgs$,this._muteResultsSetting.changes$),Se(([,,n])=>n.startsWith("/"))).subscribe(async([,n,,i])=>this.commandSubmitted(n,i));}async onDestroy(){var n,i,o;const t=await this._elements.complete();t.chatInput.removeEventListener("input",this._inputChangeListener),(n=this._interpreterSubscription)==null||n.unsubscribe(),this._interpreterSubscription=void 0,(i=this._submitSubscription)==null||i.unsubscribe(),this._submitSubscription=void 0,(o=this._commandInput)==null||o.$destroy(),this._commandInput=void 0,this.setFlyoutState(!1,t);}get commandResultStore(){return it(this._commandResults$,[])}get submitHotkeyStore(){return this._submitCommandHotkey.comboSetting.store}async handleInputEvent(t){const n=t.currentTarget,i=await this._customPrefixSetting.getValue();n!==null&&(n.value==="/"||i!==""&&n.value===i)&&await this.switchToCommandMode();}async switchToCommandMode(){const t=await this._elements.complete();t.chatInput.value="",t.chatInput.dispatchEvent(new Event("input")),this._commandInput||(this._commandInput=new Sp({target:t.chatForm,props:{onInput:c(n=>this._commandArgs$.next(n),"onInput")}}),this._commandArgs$.next("/"));}async commandSubmitted(t,n){var o;this._logger.info("Commands submitted",t),(o=this._commandInput)==null||o.$destroy(),this._commandArgs$.next("");const i=t.find(s=>s.result instanceof vn);if(i!==void 0&&i.result instanceof vn)if(i.result instanceof Tc){const s=n?void 0:await this._toastService.showLoadingToast(`Command: ${i.context.command.name}`),a=await i.result.run();a instanceof Pi?s==null||s.close():s==null||s.resolve(a.message);}else i.result.message&&!n?await this._toastService.showToast(`${i.result.message}`):!(i.result instanceof Pi)&&!n&&await this._toastService.showToast(`${i.context.command.name}`);else await this._toastService.showToast("No valid command entered");}setFlyoutState(t,n){if(t&&this._flyoutComponent===void 0){const i={componentType:wp,props:{feature:this}};this._flyoutComponent=new si({target:n.gameWrapper,props:{componentData:i,areaName:"chat",maxHeight:"600px",maxWidth:"300px",marginY:"2.5rem",title:"Command Preview",closeStrategy:"implicit"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var o,s;this._logger.info("Destroyed flyout"),(o=this._flyoutComponent)==null||o.$destroy(),(s=this._flyoutSubscription)==null||s.unsubscribe(),this._flyoutComponent=void 0;});}else this._flyoutComponent!==void 0&&!t&&this._flyoutComponent.close();}isActiveTypingParam(t,n){return this._logger.debug("Checking if param is active",t,n),t.context.currentInterpretedParameter===n}isActiveTypingId(t){return t.result===void 0}isValidCommand(t){return t.result instanceof vn}otherHasExecutionTarget(t,n){const i=n.filter(o=>o.result instanceof vn);return i.length==0||i[0]!==t}getResultStateMessage(t,n){if(t.result instanceof vn)return `Press ${n.join(" + ")} to submit`;if(t.result instanceof Yd)return "The current argument is invalid";if(t.result instanceof Ja)return "The command id is incomplete";if(t.result instanceof au)return "Some arguments are missing";if(t.result instanceof Gn)return t.result.message}};c(E_,"ChatCommandsFeature");let ll=E_;gE([D(Me)],ll.prototype,"_elements");gE([D(ft)],ll.prototype,"_toastService");var N3=Object.defineProperty,bE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&N3(e,t,i),i},"__decorateClass$1b");const M_=class M_ extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_toastService");f(this,"_iconElement");f(this,"name","Copy Chat Formatted");f(this,"description","Enables to copy selected chat messages formatted for discord messages");f(this,"tags",[ye.INTERFACE]);f(this,"featureId",36);f(this,"selectedText$",new Le(null));f(this,"_selectionChangeListener",this.onSelectionChange.bind(this));f(this,"_selectedTextSubscription");f(this,"_iconClickSubscription");}async onActivate(){document.addEventListener("selectionchange",this._selectionChangeListener),this._selectedTextSubscription=this.selectedText$.pipe(ct()).subscribe(t=>{this.processChangedChatSelection(t);});}onDestroy(){var t,n,i;document.removeEventListener("selectionchange",this._selectionChangeListener),(t=this._selectedTextSubscription)==null||t.unsubscribe(),(n=this._iconClickSubscription)==null||n.unsubscribe(),this._iconClickSubscription=void 0,(i=this._iconElement)==null||i.$destroy(),this._iconElement=void 0;}async onSelectionChange(){this._logger.debug("Selection changed");const t=await this._elementsSetup.complete(),n=document.getSelection();if(!n||n.rangeCount===0){this.selectedText$.next(null);return}const i=n.getRangeAt(0);if(i.commonAncestorContainer instanceof HTMLElement&&i.commonAncestorContainer===t.chatContent){let o=i.startContainer.nodeName==="#text"?i.startContainer.parentElement:i.startContainer,s=i.endContainer.nodeName==="#text"?i.endContainer.parentElement:i.endContainer;if(!(s instanceof HTMLElement&&o instanceof HTMLElement)){this._logger.warn("Could not find start or end element",o,s),this.selectedText$.next(null);return}if(o=o.closest("p"),s=s.closest("p"),!(o instanceof HTMLElement&&s instanceof HTMLElement)){this._logger.warn("Could not find start or end paragraph",o,s),this.selectedText$.next(null);return}const a=[...document.querySelectorAll(".chat-content p")],l=a.slice(a.indexOf(o),a.indexOf(s)+1);console.log(l.length);const u=l.map(d=>d.textContent).join(`
`);this.selectedText$.next(u);}else this.selectedText$.next(null);}async processChangedChatSelection(t){var i,o;this._logger.info("Selected text changed",t);const n=await this._elementsSetup.complete();this._iconElement&&t===null&&((i=this._iconElement)==null||i.$destroy(),this._iconElement=void 0,(o=this._iconClickSubscription)==null||o.unsubscribe(),this._iconClickSubscription=void 0),t!==null&&!this._iconElement&&(this._iconElement=new st({target:n.chatControls,props:{icon:"file-img-discord-gif",name:"Copy Chat for Discord",order:3,size:"2rem",hoverMove:!1,greyscaleInactive:!0,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconElement.click$.subscribe(async()=>{var l;const s=this.selectedText$.value;if(s===null){this._logger.warn("No text selected, but copy button clicked - illegal state");return}const a=this.formatChatForDiscord(s);this._logger.info("Copy button clicked for selection",a),await navigator.clipboard.writeText(a),await this._toastService.showToast("Chat copied to clipboard"),(l=document.getSelection())==null||l.removeAllRanges();}));}formatChatForDiscord(t){return "```diff\n"+t.replace(/(\n)(?=.*? guessed the word!)/g,`
+ `).replace(/(\n)(?=.*? joined.)/g,`
+ `).replace(/(\n)(?=The word was)/g,`
+ `).replace(/(\n)(?=.*? is drawing now!)/g,`
+ `).replace(/(\n)(?=.*? is now the room owner!)/g,`
+ `).replace(/(\n)(?=.*? left.)/g,`
- `).replace(/(\n)(?=.*? is voting to kick.)/g,`
- `).replace(/(\n)(?=.*? was kicked.)/g,`
- `).replace(/(\n)(?=Whoops.*? caught the drop before you.)/g,`
--- `).replace(/(\n)(?=Yeee.*? and caught the drop!)/g,`
--- `)+"\n```"}};c(M_,"ChatCopyFormattedFeature");let cl=M_;bE([D(Me)],cl.prototype,"_elementsSetup");bE([D(ft)],cl.prototype,"_toastService");function O3(r){return Promise.all(Object.entries(r).map(async([e,t])=>[e,await t])).then(Object.fromEntries)}c(O3,"promiseAllObject");var j3=Object.defineProperty,fb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&j3(e,t,i),i},"__decorateClass$1a");function G3(r,e,t,n,i,o,s){return {sprites:r.getAllSprites(),scenes:e.getAllScenes(),emojis:n.getAllEmojisCached({limit:1e5,animated:!0,statics:!0}),announcements:i.getAnnouncements(),themes:o.getAllThemes(),drops:t.getAllEventDrops(),awards:s.getAllAwards()}}c(G3,"getData");const R_=class R_ extends un{constructor(){super(...arguments);f(this,"_apiService");f(this,"_toastService");f(this,"_loggerFactory");}async runSetup(){const t=this._loggerFactory(this),n=O3(G3(this._apiService.getApi(fp),this._apiService.getApi(hp),this._apiService.getApi(up),this._apiService.getApi(cp),this._apiService.getApi(ap),this._apiService.getApi(ss),this._apiService.getApi(lp)));return n.catch(i=>{this._toastService.showToast("Fatal error",`Failed to fetch data from the typo servers. 
Please ask for support on the typo discord server.`),t.error("Failed to fetch data from the typo servers",i);}),n}};c(R_,"ApiDataSetup");let Tn=R_;fb([D(mi)],Tn.prototype,"_apiService");fb([D(ft)],Tn.prototype,"_toastService");fb([D(rt)],Tn.prototype,"_loggerFactory");function $3(r){let e;return {c(){e=v("div"),_(e,"class","typo-emojis-enabled");},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c($3,"create_fragment$1v");function Y3(r){return []}c(Y3,"instance$1m");const L_=class L_ extends se{constructor(e){super(),le(this,e,Y3,$3,re,{});}};c(L_,"Chat_emojis");let Ap=L_;function tk(r,e,t){const n=r.slice();return n[8]=e[t],n}c(tk,"get_each_context$C");function z3(r){let e;return {c(){e=G("Hover emojis & click to pick");},m(t,n){k(t,e,n);},p:j,d(t){t&&A(e);}}}c(z3,"create_else_block$o");function U3(r){let e,t=r[1].name+"",n,i;return {c(){e=G(":"),n=G(t),i=G(":");},m(o,s){k(o,e,s),k(o,n,s),k(o,i,s);},p(o,s){s&2&&t!==(t=o[1].name+"")&&K(n,t);},d(o){o&&(A(e),A(n),A(i));}}}c(U3,"create_if_block_1$i");function B3(r){let e,t,n;return {c(){e=G("No matching emojis."),t=v("br"),n=G("Type something else to search again!");},m(i,o){k(i,e,o),k(i,t,o),k(i,n,o);},p:j,d(i){i&&(A(e),A(t),A(n));}}}c(B3,"create_if_block$F");function nk(r){let e,t,n,i,o;function s(){return r[5](r[8])}c(s,"mouseenter_handler");function a(...l){return r[6](r[8],...l)}return c(a,"click_handler"),{c(){e=v("img"),_(e,"class","emoji-picker-candidate svelte-198xt5o"),ht(e.src,t=r[8].url)||_(e,"src",t),_(e,"alt",n=r[8].name);},m(l,u){k(l,e,u),i||(o=[F(e,"mouseenter",s),F(e,"click",a)],i=!0);},p(l,u){r=l,u&4&&!ht(e.src,t=r[8].url)&&_(e,"src",t),u&4&&n!==(n=r[8].name)&&_(e,"alt",n);},d(l){l&&A(e),i=!1,Je(o);}}}c(nk,"create_each_block$C");function x3(r){let e,t,n,i,o;function s(h,p){return h[2].length===0?B3:h[1]!==void 0?U3:z3}c(s,"select_block_type");let a=s(r),l=a(r),u=te(r[2]),d=[];for(let h=0;h<u.length;h+=1)d[h]=nk(tk(r,u,h));return {c(){e=v("div"),l.c(),t=C(),n=v("div");for(let h=0;h<d.length;h+=1)d[h].c();_(e,"class","typo-emoji-picker-hint svelte-198xt5o"),_(n,"class","typo-command-preview svelte-198xt5o");},m(h,p){k(h,e,p),l.m(e,null),k(h,t,p),k(h,n,p);for(let m=0;m<d.length;m+=1)d[m]&&d[m].m(n,null);i||(o=F(n,"mouseleave",r[7]),i=!0);},p(h,[p]){if(a===(a=s(h))&&l?l.p(h,p):(l.d(1),l=a(h),l&&(l.c(),l.m(e,null))),p&7){u=te(h[2]);let m;for(m=0;m<u.length;m+=1){const b=tk(h,u,m);d[m]?d[m].p(b,p):(d[m]=nk(b),d[m].c(),d[m].m(n,null));}for(;m<d.length;m+=1)d[m].d(1);d.length=u.length;}},i:j,o:j,d(h){h&&(A(e),A(t),A(n)),l.d(),Ie(d,h),i=!1,o();}}}c(x3,"create_fragment$1u");function Z3(r,e,t){let n,{feature:i}=e,{onSelected:o=void 0}=e,s;const a=i.emojiCandidatesStore;De(r,a,h=>t(2,n=h));const l=c(h=>t(1,s=h),"mouseenter_handler"),u=c((h,p)=>o==null?void 0:o(h,p.shiftKey),"click_handler"),d=c(()=>t(1,s=void 0),"mouseleave_handler");return r.$$set=h=>{"feature"in h&&t(4,i=h.feature),"onSelected"in h&&t(0,o=h.onSelected);},[o,s,n,a,i,l,u,d]}c(Z3,"instance$1l");const P_=class P_ extends se{constructor(e){super(),le(this,e,Z3,x3,re,{feature:4,onSelected:0});}};c(P_,"Emoji_picker");let kp=P_;var V3=Object.defineProperty,Oh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&V3(e,t,i),i},"__decorateClass$19");const N_=class N_ extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_apiDataSetup");f(this,"_chatService");f(this,"_lobbyService");f(this,"name","Chat Emojis");f(this,"description","Adds support for emojis using ':emoji-name:' format in the chat.");f(this,"tags",[ye.SOCIAL]);f(this,"featureId",22);f(this,"decayRate",.99);f(this,"boostAmount",1);f(this,"_inputListener",this.handleInputEvent.bind(this));f(this,"_emojiScoresSetting",new dt("emojiScores",{},this));f(this,"_subscription");f(this,"_component");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_emojiCandidates$",new Le([]));f(this,"_emojiScores",{});}async onActivate(){const t=await this._elements.complete();t.chatInput.addEventListener("keyup",this._inputListener);const n=(await this._apiDataSetup.complete()).emojis;this._subscription=this._chatService.playerMessageReceived$.pipe(Oe(this._lobbyService.lobby$)).subscribe(([{contentElement:i,player:o},s])=>{const a=o.id===(s==null?void 0:s.meId);this.processAddedMessage(i,n,a);}),this._component=new Ap({target:t.chatArea}),this._emojiScores=await this._emojiScoresSetting.getValue();}async onDestroy(){var n,i,o,s;(await this._elements.complete()).chatInput.removeEventListener("keyup",this._inputListener),(n=this._subscription)==null||n.unsubscribe(),(i=this._component)==null||i.$destroy(),this._component=void 0,this._subscription=void 0,(o=this._flyoutSubscription)==null||o.unsubscribe(),(s=this._flyoutComponent)==null||s.$destroy(),this._flyoutComponent=void 0,this._flyoutSubscription=void 0;}updateScores(t){for(const n in this._emojiScores)this._emojiScores[n]*=this.decayRate,this._emojiScores[n]=parseFloat(this._emojiScores[n].toFixed(4));this._emojiScores[t]||(this._emojiScores[t]=0),this._emojiScores[t]+=this.boostAmount,this._emojiScoresSetting.setValue(this._emojiScores);}async handleInputEvent(t){const n=(await this._apiDataSetup.complete()).emojis,i=await this._elements.complete();this._logger.debug("Finding emoji candidates for: ",i.chatInput.value);const o=this.parseUnfinishedEmoji(i.chatInput.value),s=o!==void 0?n.filter(a=>a.name.toLowerCase().includes(o.toLowerCase())).sort((a,l)=>{const u=this._emojiScores[this.getEmojiId(a)]??0;return (this._emojiScores[this.getEmojiId(l)]??0)-u}):[];if(this._emojiCandidates$.next(s),o!==void 0&&s.length>0&&t.key==="Tab"&&this.insertEmoji(s[0],i.chatInput),o!==void 0&&this._flyoutComponent===void 0){const a={componentType:kp,props:{feature:this,onSelected:c((l,u)=>{this.insertEmoji(l,i.chatInput,u);},"onSelected")}};this._flyoutComponent=new si({target:i.gameWrapper,props:{componentData:a,areaName:"chat",maxHeight:"600px",maxWidth:"300px",marginY:"2.5rem",title:"Emoji Picker",closeStrategy:"explicit"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var l,u;this._logger.info("Destroyed flyout"),(l=this._flyoutComponent)==null||l.$destroy(),(u=this._flyoutSubscription)==null||u.unsubscribe(),this._flyoutComponent=void 0;});}else this._flyoutComponent!==void 0&&o===void 0&&this._flyoutComponent.close();}insertEmoji(t,n,i=!1){var s;const o=n.value;n.value=o.slice(0,o.lastIndexOf(":"))+`:${this.getEmojiId(t)}:`,i?n.value=n.value+o.slice(o.lastIndexOf(":")):(s=this._flyoutComponent)==null||s.close(),n.focus();}processAddedMessage(t,n,i){Array.from(t.childNodes).filter(s=>s.nodeType===Node.TEXT_NODE).forEach(s=>{const a=this.parseTextWithEmojis(s.textContent??"");if(a.filter(u=>u.emoji!==void 0).length===0)return;const l=document.createElement("span");l.classList.add("typo-emoji-container"),a.forEach(({emoji:u,plain:d})=>{if(d&&l.appendChild(document.createTextNode(d)),u){const h=n.find(p=>`:${this.getEmojiId(p)}:`===u);if(h){const p=document.createElement("span");p.textContent=u,p.style.setProperty("--typo-emoji-url",`url(${h.url})`),p.style.setProperty("--typo-emoji-name",h.name),p.classList.add("typo-emoji"),l.appendChild(p);const m=document.createElement("div"),b=document.createElement("img");b.src=h.url,b.alt=h.name,b.className="typo-emoji-tooltip-img";const y=document.createElement("br"),w=document.createElement("span");w.textContent=`:${h.name}:`,m.append(b,y,w),this.createTooltip(p,{title:"",htmlTitle:m.innerHTML,lock:"Y"}),i&&this.updateScores(this.getEmojiId(h));}else l.appendChild(document.createTextNode(u));}}),s.replaceWith(l);});}parseTextWithEmojis(t){const n=/:([a-zA-Z0-9_-]+):/g,i=[];let o=0,s;for(;(s=n.exec(t))!==null;)s.index>o&&i.push({plain:t.slice(o,s.index)}),i.push({emoji:s[0]}),o=s.index+s[0].length;return o<t.length&&i.push({plain:t.slice(o)}),i}parseUnfinishedEmoji(t){const n=/:([a-zA-Z0-9_-]+):/g;t=t.replace(n,"");const o=/:([a-zA-Z0-9_-]*)$/.exec(t);return o==null?void 0:o[1]}getEmojiId(t){return t.nameId>0?`${t.name}-${t.nameId}`:t.name}get emojiCandidatesStore(){return it(this._emojiCandidates$,this._emojiCandidates$.value)}};c(N_,"ChatEmojisFeature");let dr=N_;Oh([D(Me)],dr.prototype,"_elements");Oh([D(Tn)],dr.prototype,"_apiDataSetup");Oh([D(rn)],dr.prototype,"_chatService");Oh([D(ut)],dr.prototype,"_lobbyService");function J3(r){let e,t,n,i;return {c(){e=G("Add a hotkey to quickly focus the chat input, so you can start guessing right away. "),t=v("br"),n=G(`
If the auto-focus setting is enabled, the chat input will be focused automatically when someone else starts drawing. `),i=v("br");},m(o,s){k(o,e,s),k(o,t,s),k(o,n,s),k(o,i,s);},p:j,i:j,o:j,d(o){o&&(A(e),A(t),A(n),A(i));}}}c(J3,"create_fragment$1t");const O_=class O_ extends se{constructor(e){super(),le(this,e,null,J3,re,{});}};c(O_,"Chat_focus_info");let Cp=O_;var F3=Object.defineProperty,vE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&F3(e,t,i),i},"__decorateClass$18");const j_=class j_ extends $e{constructor(){super(...arguments);f(this,"elementsSetup");f(this,"_lobbyStateChangedEventListener");f(this,"name","Chat Focus");f(this,"description","Quickly focus the chat input with a hotkey or when someone starts drawing");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",28);f(this,"_chatFocusHotkey",this.useHotkey(new cn("chat_focus","Chat Focus","Focus the chat input",this,async()=>(await this.elementsSetup.complete()).chatInput.focus(),!0,["Tab"],void 0,!1)));f(this,"_autoFocusChatInputSetting",this.useSetting(new He("auto_focus_chat_input",!0,this).withName("Auto Focus Chat Input").withDescription("Automatically focus the chat input when someone else starts drawing")));f(this,"_autoFocusSubscription");}get featureInfoComponent(){return {componentType:Cp,props:{}}}async onActivate(){this._autoFocusSubscription=this._lobbyStateChangedEventListener.events$.pipe(Se(t=>t.data.drawingStarted!==void 0&&t.data.drawingStarted.word===void 0),Oe(this._autoFocusChatInputSetting.changes$,this.elementsSetup.complete()),Se(([,t])=>t)).subscribe(([,,t])=>t.chatInput.focus());}async onDestroy(){var t;(t=this._autoFocusSubscription)==null||t.unsubscribe(),this._autoFocusSubscription=void 0;}get chatAutoFocusStore(){return this._autoFocusChatInputSetting.store}};c(j_,"ChatFocusFeature");let ul=j_;vE([D(Me)],ul.prototype,"elementsSetup");vE([D(Zn)],ul.prototype,"_lobbyStateChangedEventListener");const G_=class G_ extends se{constructor(e){super(),le(this,e,null,null,re,{});}};c(G_,"Chat_message_splits");let Ip=G_;var W3=Object.defineProperty,H3=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&W3(e,t,i),i},"__decorateClass$17");const $_=class $_ extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"name","Longer Chat Messages");f(this,"description","Allows typing longer chat messages and splits them");f(this,"tags",[ye.INTERFACE,ye.GAMEPLAY]);f(this,"featureId",43);f(this,"_component");}async onActivate(){const t=await this._elementsSetup.complete();this._component=new Ip({target:t.chatForm}),t.chatForm.classList.add("typo-extended"),t.chatInput.maxLength=300;}async onDestroy(){var n;const t=await this._elementsSetup.complete();t.chatForm.classList.remove("typo-extended"),t.chatInput.maxLength=100,(n=this._component)==null||n.$destroy(),this._component=void 0;}};c($_,"ChatMessageSplitsFeature");let cu=$_;H3([D(Me)],cu.prototype,"_elementsSetup");function ik(r){let e,t,n;return {c(){e=v("div"),t=G(r[0]),n=G("ms"),_(e,"class","typo-ping-info svelte-1bj7vfk");},m(i,o){k(i,e,o),g(e,t),g(e,n);},p(i,o){o&1&&K(t,i[0]);},d(i){i&&A(e);}}}c(ik,"create_if_block$E");function Q3(r){let e,t=r[0]!==void 0&&ik(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,[i]){n[0]!==void 0?t?t.p(n,i):(t=ik(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(Q3,"create_fragment$1s");function X3(r,e,t){let n,{feature:i}=e;const o=i.pingStore;return De(r,o,s=>t(0,n=s)),r.$$set=s=>{"feature"in s&&t(2,i=s.feature);},[n,o,i]}c(X3,"instance$1k");const Y_=class Y_ extends se{constructor(e){super(),le(this,e,X3,Q3,re,{feature:2});}};c(Y_,"Chat_ping");let Tp=Y_;var q3=Object.defineProperty,_E=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&q3(e,t,i),i},"__decorateClass$16");const z_=class z_ extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_lobbyService");f(this,"name","Ping Display");f(this,"description","Shows a small box with the current skribbl game ping above the chat input");f(this,"tags",[ye.INFORMATION]);f(this,"featureId",52);f(this,"featureEnabledDefault",!1);f(this,"_currentPing$",new be);f(this,"_pingSubscription");f(this,"_pingElement");}async onActivate(){const t=await this._elements.complete();this._pingElement=new Tp({target:t.chatForm,props:{feature:this}}),this._pingSubscription=this._lobbyService.lobby$.pipe(ce(n=>n!=null),ct(),lt(n=>n?wD(5e3).pipe(ID(()=>this.measurePing()),bh((i,o)=>[o,...i.slice(0,5)],[])):Tt([])),ce(n=>n.length===0?void 0:Math.round(n.reduce((i,o)=>i+o,0)/n.length))).subscribe(n=>this._currentPing$.next(n));}async onDestroy(){var t,n;(t=this._pingSubscription)==null||t.unsubscribe(),this._pingSubscription=void 0,(n=this._pingElement)==null||n.$destroy(),this._pingElement=void 0;}get pingStore(){return it(this._currentPing$,0)}async measurePing(){this._logger.info("Measuring ping");const t=performance.now();return await fetch("./credits?this_is_for_ping_measure&now="+t,{cache:"no-store"}),performance.now()-t}};c(z_,"ChatPingFeature");let dl=z_;_E([D(Me)],dl.prototype,"_elements");_E([D(ut)],dl.prototype,"_lobbyService");const U_=class U_ extends se{constructor(e){super(),le(this,e,null,null,re,{});}};c(U_,"Chat_profile_link");let Dp=U_;var K3=Object.defineProperty,jh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&K3(e,t,i),i},"__decorateClass$15");const B_=class B_ extends $e{constructor(){super(...arguments);f(this,"_chatService");f(this,"_toastService");f(this,"_elementsSetup");f(this,"_playersService");f(this,"name","Chat Profile Link");f(this,"description","Open player profiles by clicking their name in the chat.");f(this,"tags",[ye.GAMEPLAY,ye.INTERFACE]);f(this,"featureId",23);f(this,"_subscription");f(this,"_addedElements",[]);f(this,"_component");f(this,"_clickHandler",this.chatClicked.bind(this));}async onActivate(){const t=await this._elementsSetup.complete();this._component=new Dp({target:t.chatContent}),this._subscription=this._chatService.playerMessageReceived$.pipe(Oe(this._playersService.lobbyPlayers$)).subscribe(([{titleElement:n,player:i},o])=>{const s=o.find(a=>a.lobbyPlayerId===i.id);if(s===void 0){this._logger.warn("Player for chat message not found",i,o);return}n.classList.add("typo-chat-profile-link"),this._addedElements.push({titleElement:n,player:s});}),t.chatContent.addEventListener("click",this._clickHandler);}async onDestroy(){var n,i;(await this._elementsSetup.complete()).chatContent.removeEventListener("click",this._clickHandler),(n=this._subscription)==null||n.unsubscribe(),this._addedElements.forEach(({titleElement:o})=>o.classList.remove("typo-chat-profile-link")),this._addedElements=[],(i=this._component)==null||i.$destroy();}async chatClicked(t){if(t.target instanceof HTMLElement&&t.target.classList.contains("typo-chat-profile-link")){const n=this._addedElements.find(i=>i.titleElement===t.target);n?n.player.container.click():await this._toastService.showToast("Player Profile not found");}}};c(B_,"ChatProfileLinkFeature");let hr=B_;jh([D(rn)],hr.prototype,"_chatService");jh([D(ft)],hr.prototype,"_toastService");jh([D(Me)],hr.prototype,"_elementsSetup");jh([D(en)],hr.prototype,"_playersService");const x_=class x_ extends lu{constructor(t,n,i){super(t,n);f(this,"typeName","number?");f(this,"typeDescription","empty or any number");this._mapping=i;}readArg(t,n){const i=t.trim().split(" "),o=i[0].trim();if(o.length<1)return n(),{remainder:"",argument:this._mapping(void 0)};const s=Number(o);if(isNaN(s))throw new Yd(this,"Failed to parse number from args: "+t);const a=this._mapping(s);return {remainder:i.slice(1).join(" "),argument:a}}};c(x_,"NumericOptionalCommandParameter");let Ep=x_;const Z_=class Z_ extends lu{constructor(t,n,i){super(t,n);f(this,"typeName","text?");f(this,"typeDescription","empty, a single word or text wrapped in quotes");this._mapping=i;}readArg(t,n){const i=/^\s*(["'])(.*?)\1/;let o="",s="";const a=t.trim().match(i);if(a!==null)o=a[2],s=t.trim().slice(a[0].length).trim();else {const u=t.trim().split(" ");o=u[0].trim(),s=u.slice(1).join(" ");}if(o.length<1)return n(),{remainder:"",argument:this._mapping(void 0)};const l=this._mapping(o);return {remainder:s,argument:l}}};c(Z_,"StringOptionalCommandParameter");let zd=Z_;var e4=Object.defineProperty,t4=Object.getOwnPropertyDescriptor,Yl=c((r,e,t,n)=>{for(var i=n>1?void 0:n?t4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&e4(e,t,i),i},"__decorateClass$14"),n4=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$e"),wa;let fr=(wa=class{constructor(e){f(this,"_lobbyService");f(this,"_lobbyInteractedEvent");f(this,"_lobbyStateChangedEvent");f(this,"_skribblMessageRelaySetup");f(this,"_availableInteractions$",new Le(void 0));f(this,"_logger");this._logger=e(this);}postConstruct(){this._logger.debug("Initializing lobby interactions service"),this.setupAvailableInteractions();}setupAvailableInteractions(){this._lobbyService.lobby$.pipe(ct(),Cr(),ce(([e,t])=>{if(!(e===null&&t===null||e!==null&&t===null))return e===null&&t!==null?{rateAvailable:!0,votekickAvailable:!0,interactionTarget:t.players.find(n=>n.id===t.drawerId&&n.id!==t.meId)}:null})).subscribe(e=>{e!==null&&(this._logger.info("Interactions reset on lobby join",e),this._availableInteractions$.next(e));}),this._lobbyStateChangedEvent.events$.pipe(ce(e=>e.data.drawingStarted),Se(e=>e!==void 0),Oe(this._availableInteractions$,this._lobbyService.lobby$),Se(([,e,t])=>e!==void 0&&t!==null)).subscribe(([e,t,n])=>{n===null||t===void 0||(t.rateAvailable=!0,t.votekickAvailable=!0,t.interactionTarget=n.players.find(i=>i.id===e.drawerId&&i.id!==n.meId),this._logger.info("Interactions update on lobby change",t),this._availableInteractions$.next(t));}),this._lobbyInteractedEvent.events$.pipe(Oe(this._availableInteractions$,this._lobbyService.lobby$),Se(([,e,t])=>e!==void 0&&t!==null)).subscribe(([e,t,n])=>{if(n===null||t===void 0)return;const{likeInteraction:i,dislikeInteraction:o,votekickInteraction:s}=e.data;((i==null?void 0:i.sourcePlayerId)===n.meId||n.drawerId===null)&&(t.rateAvailable=!1),((o==null?void 0:o.sourcePlayerId)===n.meId||n.drawerId===null)&&(t.rateAvailable=!1),(s==null?void 0:s.sourcePlayerId)===n.meId&&(t.votekickAvailable=!1),this._logger.info("Interactions update on interaction",t),this._availableInteractions$.next(t);}),this._availableInteractions$.subscribe(e=>this._logger.info("Available interactions",e));}get availableInteractions$(){return this._availableInteractions$.asObservable()}async likePlayer(){(await this._skribblMessageRelaySetup.complete()).insertMessage({data:1,id:8});}async dislikePlayer(){(await this._skribblMessageRelaySetup.complete()).insertMessage({data:0,id:8});}async votekickPlayer(e){(await this._skribblMessageRelaySetup.complete()).insertMessage({data:e,id:5});}},c(wa,"LobbyInteractionsService"),wa);Yl([D(ut)],fr.prototype,"_lobbyService",2);Yl([D(Ka)],fr.prototype,"_lobbyInteractedEvent",2);Yl([D(Zn)],fr.prototype,"_lobbyStateChangedEvent",2);Yl([D(_n)],fr.prototype,"_skribblMessageRelaySetup",2);Yl([zr()],fr.prototype,"postConstruct",1);fr=Yl([we(),n4(0,D(rt))],fr);function i4(r){let e,t,n,i,o,s;return {c(){e=v("button"),t=v("span"),n=G(r[0]),_(t,"class","svelte-1nuwppq"),_(e,"class",i="typo-flat-button flatUI "+r[1]+" svelte-1nuwppq"),ue(e,"disabled",r[2]);},m(a,l){k(a,e,l),g(e,t),g(t,n),o||(s=[F(e,"click",r[6]),F(e,"click",r[5])],o=!0);},p(a,[l]){l&1&&K(n,a[0]),l&2&&i!==(i="typo-flat-button flatUI "+a[1]+" svelte-1nuwppq")&&_(e,"class",i),l&6&&ue(e,"disabled",a[2]);},i:j,o:j,d(a){a&&A(e),o=!1,Je(s);}}}c(i4,"create_fragment$1r");function r4(r,e,t){let{content:n}=e,{color:i}=e,{disabled:o=!1}=e;const s=new be,a=s.asObservable();function l(d){_h.call(this,r,d);}c(l,"click_handler");const u=c(()=>s.next(void 0),"click_handler_1");return r.$$set=d=>{"content"in d&&t(0,n=d.content),"color"in d&&t(1,i=d.color),"disabled"in d&&t(2,o=d.disabled);},[n,i,o,s,a,l,u]}c(r4,"instance$1j");const V_=class V_ extends se{constructor(e){super(),le(this,e,r4,i4,re,{content:0,color:1,disabled:2,click$:4});}get click$(){return this.$$.ctx[4]}};c(V_,"Flat_button");let ke=V_;function o4(r){let e;return {c(){e=v("div"),e.innerHTML='<b class="svelte-yvtrmi">No interactions available</b>',_(e,"class","typo-quickreact-keys svelte-yvtrmi");},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(o4,"create_else_block$n");function s4(r){let e,t,n,i=r[2].interactionTarget.name+"",o,s,a,l,u,d,h,p,m,b;return a=new ke({props:{content:" Kick",disabled:!r[2].votekickAvailable,color:"blue"}}),a.$on("click",r[5]),u=new ke({props:{content:" Close",color:"blue"}}),h=new ke({props:{content:" Like",disabled:!r[2].rateAvailable,color:"blue"}}),h.$on("click",r[6]),m=new ke({props:{content:" Dislike",disabled:!r[2].rateAvailable,color:"blue"}}),m.$on("click",r[7]),{c(){e=v("div"),t=v("b"),n=G("Press an arrow key to react to "),o=G(i),s=C(),V(a.$$.fragment),l=C(),V(u.$$.fragment),d=C(),V(h.$$.fragment),p=C(),V(m.$$.fragment),_(t,"class","svelte-yvtrmi"),_(e,"class","typo-quickreact-keys svelte-yvtrmi");},m(y,w){k(y,e,w),g(e,t),g(t,n),g(t,o),g(e,s),x(a,e,null),g(e,l),x(u,e,null),g(e,d),x(h,e,null),g(e,p),x(m,e,null),b=!0;},p(y,w){(!b||w&4)&&i!==(i=y[2].interactionTarget.name+"")&&K(o,i);const I={};w&4&&(I.disabled=!y[2].votekickAvailable),a.$set(I);const S={};w&4&&(S.disabled=!y[2].rateAvailable),h.$set(S);const R={};w&4&&(R.disabled=!y[2].rateAvailable),m.$set(R);},i(y){b||(T(a.$$.fragment,y),T(u.$$.fragment,y),T(h.$$.fragment,y),T(m.$$.fragment,y),b=!0);},o(y){M(a.$$.fragment,y),M(u.$$.fragment,y),M(h.$$.fragment,y),M(m.$$.fragment,y),b=!1;},d(y){y&&A(e),Z(a),Z(u),Z(h),Z(m);}}}c(s4,"create_if_block$D");function a4(r){let e,t,n,i,o,s;const a=[s4,o4],l=[];function u(d,h){return d[2]!==void 0&&d[2].interactionTarget!==void 0?0:1}return c(u,"select_block_type"),t=u(r),n=l[t]=a[t](r),{c(){e=v("div"),n.c(),_(e,"class","typo-quickreact-focus svelte-yvtrmi"),_(e,"tabindex","0");},m(d,h){k(d,e,h),l[t].m(e,null),r[8](e),i=!0,o||(s=F(e,"keydown",r[9]),o=!0);},p(d,[h]){let p=t;t=u(d),t===p?l[t].p(d,h):(fe(),M(l[p],1,1,()=>{l[p]=null;}),pe(),n=l[t],n?n.p(d,h):(n=l[t]=a[t](d),n.c()),T(n,1),n.m(e,null));},i(d){i||(T(n),i=!0);},o(d){M(n),i=!1;},d(d){d&&A(e),l[t].d(),r[8](null),o=!1,s();}}}c(a4,"create_fragment$1q");function l4(r,e,t){let n,{feature:i}=e,o;const s=i.availableInteractionsStore;De(r,s,m=>t(2,n=m));const a=c(m=>{if(n!==void 0&&n.interactionTarget!==void 0)switch(m.key){case"ArrowLeft":i.votekickPlayer(n.interactionTarget),i.toggleQuickReactMenu();break;case"ArrowRight":i.toggleQuickReactMenu();break;case"ArrowUp":i.likeCurrentPlayer(),i.toggleQuickReactMenu();break;case"ArrowDown":i.dislikeCurrentPlayer(),i.toggleQuickReactMenu();break}},"onKeyPress");li(()=>{o.focus();});const l=c(()=>i.votekickPlayer(n.interactionTarget),"click_handler"),u=c(()=>i.likeCurrentPlayer(),"click_handler_1"),d=c(()=>i.dislikeCurrentPlayer(),"click_handler_2");function h(m){Ve[m?"unshift":"push"](()=>{o=m,t(1,o);});}c(h,"div_binding");const p=c(m=>a(m),"keydown_handler");return r.$$set=m=>{"feature"in m&&t(0,i=m.feature);},[i,o,n,s,a,l,u,d,h,p]}c(l4,"instance$1i");const J_=class J_ extends se{constructor(e){super(),le(this,e,l4,a4,re,{feature:0});}};c(J_,"Quick_react");let Mp=J_;var c4=Object.defineProperty,Mu=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&c4(e,t,i),i},"__decorateClass$13");const F_=class F_ extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_lobbyInteractionsService");f(this,"_toastService");f(this,"_lobbyService");f(this,"_wordGuessedListener");f(this,"name","Quick React");f(this,"description","Adds accessibility to kick, like, and dislike via keyboard by pressing CTRL in the chat box.");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",33);f(this,"_likeCommand",this.useCommand(new ti("like",this,"Like","Like the current drawing")).run(async t=>(await this.likeCurrentPlayer(),new Pi(t))));f(this,"_dislikeCommand",this.useCommand(new ti("dislike",this,"Dislike","Dislike the current drawing")).run(async t=>(await this.dislikeCurrentPlayer(),new Pi(t))));f(this,"_kickCommand",this.useCommand(new ti("kick",this,"Votekick by ID","Kick the current (default) or another player by ID")).withParameters(t=>t.addParam(new Ep("Player ID","The ID of the player to votekick, leave empty for current drawer",n=>({id:n}))).run(async(n,i)=>{const o=await Ee(this._lobbyService.lobby$);if(n.id===void 0&&(n.id=(o==null?void 0:o.drawerId)??void 0),n.id!==void 0&&n.id===(o==null?void 0:o.meId))return new Gn(i,"You can't votekick yourself :(");const s=o==null?void 0:o.players.find(a=>a.id===n.id);return s===void 0&&n.id!==void 0?new Gn(i,"Selected player not found"):s===void 0?new Gn(i,"No default player to votekick"):(await this.votekickPlayer(s),new Pi(i))})));f(this,"_kickByNameCommand",this.useCommand(new ti("kick",this,"Votekick by name","Kick the current (default) or another player by name")).withParameters(t=>t.addParam(new zd("Player Name","The name of the player to votekick",n=>({name:n}))).run(async(n,i)=>{const o=await Ee(this._lobbyService.lobby$),s=n.name===void 0?o==null?void 0:o.players.find(a=>a.id===(o==null?void 0:o.drawerId)):o==null?void 0:o.players.find(a=>{var l;return a.name.toLowerCase()===((l=n.name)==null?void 0:l.toLowerCase())});return s===void 0&&n.name!==void 0?new Gn(i,"Selected player not found"):s===void 0?new Gn(i,"No default player to votekick"):s.id===(o==null?void 0:o.meId)?new Gn(i,"You can't votekick yourself :("):(await this.votekickPlayer(s),new Pi(i))})));f(this,"_openQuickReactHotkey",this.useHotkey(new cn("open_quickreact","Quick React","Open the quick react menu",this,()=>{},!0,["ControlRight"],()=>{this.toggleQuickReactMenu();},!1)));f(this,"_instantLikeHotkey",this.useHotkey(new cn("instant_like","Like Current Drawing","Instantly likes the current drawing, without quick react menu access",this,()=>this.likeCurrentPlayer(),!1,["ControlRight","ArrowUp"])));f(this,"_instantDislikeHotkey",this.useHotkey(new cn("instant_dislike","Dislike Current Drawing","Dislikes the current drawing, without quick react menu access",this,()=>this.dislikeCurrentPlayer(),!1,["ControlRight","ArrowDown"])));f(this,"_instantVotekickHotkey",this.useHotkey(new cn("instant_votekick","Votekick Current Drawer","Votes to kick the current drawer, without quick react menu access",this,()=>this.votekickPlayer(void 0),!1,["ControlRight","ArrowLeft"])));f(this,"_muteActionToastsSetting",this.useSetting(new He("mute_action_toasts",!1,this).withName("Mute Info Toasts").withDescription("Mute the info toasts when liking/disliking/votekicking a player")));f(this,"_likeAfterGuessSetting",this.useSetting(new He("like_after_guess",!1,this).withName("Like Drawing After Guess").withDescription("Automatically likes the drawing after you have guessed the word")));f(this,"_subscription");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_rateInteractionsStyle",nn("<style>.typo-hide-rate-interactions { display: none !important }</style>"));f(this,"_interactionUpdateSubscription");f(this,"_autoLikeSubscription");f(this,"_guessedSubscription");}async onActivate(){document.body.appendChild(this._rateInteractionsStyle);const t=await this._elements.complete();this._interactionUpdateSubscription=this._lobbyInteractionsService.availableInteractions$.subscribe(n=>{t.gameRate.classList.toggle("typo-hide-rate-interactions",(n==null?void 0:n.rateAvailable)!==!0);}),this._autoLikeSubscription=this._wordGuessedListener.events$.pipe(Se(n=>n.data.word!==void 0),Oe(this._likeAfterGuessSetting.changes$),Se(([,n])=>n===!0),Oe(this._lobbyInteractionsService.availableInteractions$),Se(([[,],n])=>(n==null?void 0:n.rateAvailable)===!0)).subscribe(()=>{this._lobbyInteractionsService.likePlayer(),this.hideGameRate();});}async onDestroy(){var t,n,i,o,s,a;(t=this._subscription)==null||t.unsubscribe(),this._subscription=void 0,(n=this._flyoutSubscription)==null||n.unsubscribe(),(i=this._flyoutComponent)==null||i.$destroy(),this._flyoutComponent=void 0,this._flyoutSubscription=void 0,(o=this._interactionUpdateSubscription)==null||o.unsubscribe(),this._interactionUpdateSubscription=void 0,this._rateInteractionsStyle.remove(),(s=this._guessedSubscription)==null||s.unsubscribe(),this._guessedSubscription=void 0,(a=this._autoLikeSubscription)==null||a.unsubscribe(),this._autoLikeSubscription=void 0;}async hideGameRate(){const t=await this._elements.complete();t.gameRate.style.display="none";}async toggleQuickReactMenu(){if(this._flyoutComponent)this._flyoutComponent.close();else {const t=await this._elements.complete(),n={componentType:Mp,props:{feature:this}};this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",marginY:"2.5rem",title:"Quick React",closeStrategy:"implicit"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(async()=>{var i,o;this._logger.debug("Destroyed menu"),(i=this._flyoutComponent)==null||i.$destroy(),this._flyoutComponent=void 0,(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutSubscription=void 0,t.chatInput.focus();});}}get availableInteractionsStore(){return it(this._lobbyInteractionsService.availableInteractions$,void 0)}async getCurrentInteractionPlayer(t){return Ee(this._lobbyInteractionsService.availableInteractions$.pipe(ce(n=>{if(n===void 0||t&&!t(n))throw new Error("Interaction is not available");return n.interactionTarget})))}async likeCurrentPlayer(){const n=await this._muteActionToastsSetting.getValue()?void 0:await this._toastService.showLoadingToast("Liking current player");let i;try{const o=await this.getCurrentInteractionPlayer(s=>s.rateAvailable);if(o===void 0)throw new Error("No player available to rate");i=o;}catch(o){n==null||n.reject(o.message);return}await this._lobbyInteractionsService.likePlayer(),await this.hideGameRate(),n==null||n.resolve(`Liked the drawing of ${i.name}`);}async dislikeCurrentPlayer(){const n=await this._muteActionToastsSetting.getValue()?void 0:await this._toastService.showLoadingToast("Disliking current player");let i;try{const o=await this.getCurrentInteractionPlayer(s=>s.rateAvailable);if(o===void 0)throw new Error("No player available to rate");i=o;}catch(o){n==null||n.reject(o.message);return}await this._lobbyInteractionsService.dislikePlayer(),await this.hideGameRate(),n==null||n.resolve(`Disliked the drawing of ${i.name}`);}async votekickPlayer(t){const i=await this._muteActionToastsSetting.getValue()?void 0:await this._toastService.showLoadingToast(`Voting to kick ${t===void 0?"current player":t.name}`);try{const o=await this.getCurrentInteractionPlayer(s=>s.votekickAvailable);if(t===void 0){if(o===void 0)throw new Error("No default player available to votekick");t=o;}}catch(o){i==null||i.reject(o.message);return}await this._lobbyInteractionsService.votekickPlayer(t.id),i==null||i.resolve(`Voted to kick ${t.name}`);}};c(F_,"ChatQuickReactFeature");let pr=F_;Mu([D(Me)],pr.prototype,"_elements");Mu([D(fr)],pr.prototype,"_lobbyInteractionsService");Mu([D(ft)],pr.prototype,"_toastService");Mu([D(ut)],pr.prototype,"_lobbyService");Mu([D(Dr)],pr.prototype,"_wordGuessedListener");var u4=Object.defineProperty,pb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&u4(e,t,i),i},"__decorateClass$12");const W_=class W_ extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_messageSent");f(this,"_chatService");f(this,"name","Chat Recall");f(this,"description","Remembers your last messages so you can quickly recall them with arrow up/down in the chat box");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",15);f(this,"_history",[]);f(this,"_historyIndex");f(this,"listener",this.handleInputEvent.bind(this));}async handleInputEvent(t){if(t.key==="ArrowUp"||t.key==="ArrowDown"){t.preventDefault();const n=t.target;this._historyIndex===void 0?t.key==="ArrowUp"&&this._chatService.replaceChatboxContent(this._history[this._history.length-1]??"")&&(this._historyIndex=this._history.length-1):t.key==="ArrowDown"?this._historyIndex<this._history.length-1?this._chatService.replaceChatboxContent(this._history[this._historyIndex+1])&&this._historyIndex++:(this._historyIndex=void 0,n.value=""):t.key==="ArrowUp"&&this._historyIndex>0&&this._chatService.replaceChatboxContent(this._history[this._historyIndex-1])&&this._historyIndex--;}}async onActivate(){(await this._elements.complete()).chatInput.addEventListener("keydown",this.listener),this._messageSent.events$.subscribe(n=>{this._history.push(n.data),this._historyIndex=void 0;});}async onDestroy(){(await this._elements.complete()).chatInput.removeEventListener("keydown",this.listener),this._history=[],this._historyIndex=0;}};c(W_,"ChatRecallFeature");let ao=W_;pb([D(Me)],ao.prototype,"_elements");pb([D(rl)],ao.prototype,"_messageSent");pb([D(rn)],ao.prototype,"_chatService");function d4(r,e){if(typeof cloneInto<"u"&&cloneInto!==void 0&&document.defaultView!==null){const t=cloneInto(e,document.defaultView);return new document.defaultView.CustomEvent(r,t)}return new CustomEvent(r,e)}c(d4,"createCrossCustomEvent");async function h4(r){const e=new Image;return e.crossOrigin="anonymous",e.src=r,await new Promise(t=>e.onload=t),e}c(h4,"crossImage");const qo=class qo{constructor(e,t){this._base64Full=e,this._blob=t;}static async fromImageUrl(e){const t=await(await fetch(e)).blob();return qo.fromBlob(t)}static async fromBlob(e){const t=new FileReader;return t.readAsDataURL(e),new Promise((n,i)=>{t.onloadend=()=>{const o=t.result;n(new qo(o,e));},t.onerror=()=>i();})}static async fromBase64(e){const t=await(await fetch(e)).blob();return new qo(e,t)}get base64Full(){return this._base64Full}get blob(){return this._blob}get base64ApiTruncated(){return this._base64Full.split(",")[1].replace("==","")}getBase64(){return this._base64Full}};c(qo,"ImageData");let hl=qo;var f4=Object.defineProperty,p4=Object.getOwnPropertyDescriptor,m4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?p4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&f4(e,t,i),i},"__decorateClass$11"),qi=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$d"),Sa;let zt=(Sa=class{constructor(e,t,n,i,o,s,a,l,u){f(this,"_logger");f(this,"_currentImageState$",new Le(null));f(this,"_currentCommands$",new Le([]));f(this,"_drawingState$",new Le("idle"));f(this,"_lockManualClear",new Le(!1));f(this,"_pasteInProgress$",new Le(!1));f(this,"_abortCommands$",new Le(Number.MAX_VALUE));f(this,"_incomingDrawCommands$",new be);this.lobbyLeft=t,this.lobbyChanged=n,this.hintsAdded=i,this.draw=o,this.wordGuessed=s,this.imageReset=a,this.elementsSetup=l,this.skribblMessages=u,this._logger=e(this),this.listenDrawCommands(),this.listenCurrentImageState(),this._lockManualClear.subscribe(d=>{this._logger.info("Lock manual clear set to",d),document.dispatchEvent(new CustomEvent("lockManualClear",{detail:d}));}),this.imageState$.subscribe(d=>{this._logger.debug("Image state updated",d);}),this.commands$.pipe(xa(1e3)).subscribe(d=>{this._logger.debug("Commands updated",d);}),t.events$.subscribe(()=>this.cancelPendingDrawCommands()),this._incomingDrawCommands$.pipe(mR(([d,h])=>{if(!h)return Tt(d);const p=Date.now(),m=this._abortCommands$.value;return p<m?Tt(d).pipe(jl(2)):Tt(null)}),Se(d=>d!==null),_t(d=>this.onDrawCommand(d)),Kt(this._pasteInProgress$.pipe(ct())),bh((d,h)=>h===!1?0:h===!0?d:d+1,0),Kt(this._abortCommands$.pipe(ct(),ce(()=>0))),xa(50)).subscribe(d=>{this._logger.debug("finished pasting",d),d>0&&document.dispatchEvent(new CustomEvent("collapseUndoActions",{detail:d})),this._pasteInProgress$.next(!1),this._abortCommands$.next(Number.MAX_VALUE);});}onDrawCommand(e){this._logger.debug("Incoming draw command",e),document.dispatchEvent(d4("performDrawCommand",{detail:e}));}listenDrawCommands(){_c(this.lobbyLeft.events$,this.lobbyChanged.events$,this.draw.events$,this.imageReset.events$).pipe(Oe(this._currentCommands$),ce(e=>({update:e[0],currentCommands:e[1]}))).subscribe(({update:e,currentCommands:t})=>{if(t=structuredClone(t),e instanceof rr)t=[];else if(e instanceof ir)e.data.drawingStarted!==void 0&&(t=[]);else if(e instanceof rr)t=[];else if(e instanceof jc){const n=e.data.map(i=>i.length>7?sE(i,7):[i]).flat(1);t.push(...n);}else e instanceof rs&&(t=e.data===0?[]:t.slice(0,e.data));this._currentCommands$.next(t);});}listenCurrentImageState(){_c(this.lobbyLeft.events$,this.lobbyChanged.events$,this.hintsAdded.events$,this.wordGuessed.events$).pipe(Oe(this._currentImageState$),ce(e=>({update:e[0],currentImageState:e[1]}))).subscribe(({update:e,currentImageState:t})=>{if(t=t===null?null:structuredClone(t),e instanceof rr)t=null,this._drawingState$.next("idle");else if(e instanceof ir)t=t??{drawerId:void 0,word:{length:[0],hints:"",solution:void 0}},e.data.drawingStarted!==void 0&&(this._drawingState$.next("drawing"),t.drawerId=e.data.drawingStarted.drawerId,t.word.length=e.data.drawingStarted.characters,t.word.solution=e.data.drawingStarted.word,t.word.hints=e.data.drawingStarted.word??e.data.drawingStarted.characters.map(n=>"_".repeat(n)).join(" ")),e.data.drawingRevealed!==void 0&&(this._drawingState$.next("idle"),t.word.solution=e.data.drawingRevealed.word,t.word.hints=e.data.drawingRevealed.word);else if(t!==null&&e instanceof is){const n=[...t.word.hints];e.data.forEach(i=>{n[i[0]]=i[1];}),t.word.hints=n.join("");}else t!==null&&e instanceof sl?e.data.word!==void 0&&(t.word.solution=e.data.word,t.word.hints=e.data.word):t!==null&&e instanceof rr&&(this._drawingState$.next("idle"),t=null);this._currentImageState$.next(t);});}get imageState$(){return this._currentImageState$.asObservable()}get commands$(){return this._currentCommands$.asObservable()}get drawingState$(){return this._drawingState$.asObservable()}async getCurrentImageBase64(){return (await this.elementsSetup.complete()).canvas.toDataURL()}async getCurrentImageData(){const e=await this.getCurrentImageBase64();return await hl.fromBase64(e)}async pasteDrawCommands(e,t=!0){this._logger.debug("Pasting draw commands",e),e.length!==0&&(this._pasteInProgress$.next(!0),e.forEach(n=>this._incomingDrawCommands$.next([n,t])));}cancelPendingDrawCommands(){this._abortCommands$.next(Date.now());}get pasteInProgress$(){return this._pasteInProgress$.pipe(ct())}setColor(e,t=!1){this._logger.debug("Setting color",e),document.dispatchEvent(new CustomEvent("setColor",{detail:{code:e,secondary:t}}));}disableCursorUpdates(e){document.dispatchEvent(new CustomEvent("disableCursorUpdates",{detail:e}));}setSize(e){this._logger.debug("Setting size",e),document.dispatchEvent(new CustomEvent("selectSkribblSize",{detail:e}));}clearImage(){this._logger.debug("Clearing image"),document.dispatchEvent(new CustomEvent("clearDrawing"));}async drawImage(e,t,n,i,o){this._logger.debug("Drawing image",e,t,n,i,o);const s=await h4(e),l=(await this.elementsSetup.complete()).canvas.getContext("2d");l==null||l.drawImage(s,t??0,n??0,i??s.width,o??s.height);}createLineCommand(e,t=void 0,n=void 0,i=!0){var s;const o=i?(s=this.clipLine([e[0],e[1]],[e[2],e[3]]))==null?void 0:s.flat():[Math.floor(e[0]),Math.floor(e[1]),Math.floor(e[2]),Math.floor(e[3])];if(o!==void 0)return [0,t??1,n??4,...o]}createFillCommand(e,t=void 0){return [1,t??1,...e]}async drawLine(e,t=void 0,n=void 0){var o;this._logger.debug("Drawing line",e,t,n);const i=(o=this.clipLine([e[0],e[1]],[e[2],e[3]]))==null?void 0:o.flat();i!==void 0&&await this.pasteDrawCommands([[0,t??1,n??4,...i]]);}clipLine(e,t){if(!(e[0]<0&&t[0]<0||e[0]>=800&&t[0]>=800||e[1]<0&&t[1]<0||e[1]>=600&&t[1]>=600)){if(t[0]<0||t[0]>=800){const s=(t[1]-e[1])/(t[0]-e[0])*((t[0]<0?0:799)-e[0])+e[1];t=[t[0]<0?0:799,s];}if((t[1]<0||t[1]>=600)&&(t=[(t[0]-e[0])/(t[1]-e[1])*((t[1]<0?0:599)-e[1])+e[0],t[1]<0?0:599]),(e[1]<0||e[1]>=600)&&(e=[(t[0]-e[0])/(t[1]-e[1])*((e[1]<0?0:599)-e[1])+e[0],e[1]<0?0:599]),e[0]<0||e[0]>=800){const s=(t[1]-e[1])/(t[0]-e[0])*((e[0]<0?0:799)-e[0])+e[1];e=[e[0]<0?0:799,s];}return e=[Math.floor(e[0]),Math.floor(e[1])],t=[Math.floor(t[0]),Math.floor(t[1])],[e,t]}}lockManualClear(e){this._lockManualClear.next(e);}get manualClearLocked$(){return this._lockManualClear.asObservable()}},c(Sa,"DrawingService"),Sa);zt=m4([we(),qi(0,D(rt)),qi(1,D(Vn)),qi(2,D(Zn)),qi(3,D(Yc)),qi(4,D(Gc)),qi(5,D(Dr)),qi(6,D(qa)),qi(7,D(Me)),qi(8,D(_n))],zt);var g4=Object.defineProperty,b4=Object.getOwnPropertyDescriptor,v4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?b4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&g4(e,t,i),i},"__decorateClass$10"),yf=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$c"),Aa;let lo=(Aa=class{constructor(e,t,n){f(this,"_logger");f(this,"_imageFinished$");this._drawingService=t,this._lobbyService=n,this._logger=e(this),this._imageFinished$=this.listenImageFinished();}listenImageFinished(){return this.mapToImageState(this._drawingService.drawingState$.pipe(jl(100),Se(e=>e==="idle"))).pipe(Se(e=>e!==null),_t(()=>this._logger.debug("Image finished")))}mapToImageState(e){return e===void 0&&(e=Tt(1)),e.pipe(Oe(this._drawingService.imageState$,this._lobbyService.lobby$,this._drawingService.commands$),lt(t=>Ri(this._drawingService.getCurrentImageData()).pipe(ce(n=>({image:structuredClone(t[1]),lobby:structuredClone(t[2]),commands:structuredClone(t[3]),imageData:n})))),ce(t=>{var a,l;if(t.image===null||t.lobby===null)return null;const{lobby:n,image:i,imageData:o,commands:s}=t;return {name:i.word.solution??`${i.word.hints} (${i.word.length.join(", ")})`,image:o,commands:s,private:n.private,artist:((a=n.players.find(u=>u.id===i.drawerId))==null?void 0:a.name)??"Unknown Artist",date:new Date,player:((l=n.players.find(u=>u.id===n.meId))==null?void 0:l.name)??"Unknown Poster",isOwn:n.meId===i.drawerId,language:n.settings.language}}))}get imageFinished$(){return this._imageFinished$}get imageHistory$(){return this._imageFinished$.pipe(bh((e,t)=>t===null?e:[...e,t],[]),ct((e,t)=>e.length===t.length))}},c(Aa,"ImageFinishedService"),Aa);lo=v4([we(),yf(0,D(rt)),yf(1,D(zt)),yf(2,D(ut))],lo);var _4=Object.defineProperty,y4=Object.getOwnPropertyDescriptor,yE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?y4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&_4(e,t,i),i},"__decorateClass$$"),w4=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$b"),ka;let co=(ka=class{constructor(e){f(this,"_apiService");f(this,"_logger");f(this,"_pendingAwardInventoryIds",new Set);this._logger=e(this);}async uploadToCloud(e,t,n=!1){const i=this._apiService.getApi(su),o=await i.uploadToUserCloud({login:Number(t.userLogin),cloudUploadDto:{name:e.name,author:e.artist,inPrivate:e.private,isOwn:e.isOwn,language:e.language,commands:e.commands,imageBase64:e.image.base64ApiTruncated}});if(this._logger.debug("Image saved to cloud"),n&&this._pendingAwardInventoryIds.size>0){const s=Array.from(this._pendingAwardInventoryIds);this._pendingAwardInventoryIds.clear();const a=await Promise.all(s.map(l=>i.linkImageToAward({login:Number(t.userLogin),token:l,id:o.id})));this._logger.info("Linked image to pending awards",a.length);}}addPendingAwardInventoryId(e){this._logger.debug("Adding pending award inventory id",e),this._pendingAwardInventoryIds.add(e);}clearPendingAwardInventoryIds(){this._logger.debug("Clearing pending award inventory ids"),this._pendingAwardInventoryIds.clear();}},c(ka,"CloudService"),ka);yE([D(mi)],co.prototype,"_apiService",2);co=yE([we(),w4(0,D(rt))],co);const S4=c(r=>{const e=r.flat();return e.forEach(t=>{switch(t[0]){case 2:t[0]=1;case 0:t[1]>11&&(t[1]+=2),t[1]>21&&(t[1]+=2);break;case 1:t=[t[0],0,t[1],t[2],t[3],t[4],t[5]];break}}),e},"convertOldSkd");var A4=Object.defineProperty,k4=Object.getOwnPropertyDescriptor,C4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?k4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&A4(e,t,i),i},"__decorateClass$_"),I4=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$a"),Ca;let uu=(Ca=class{constructor(e){f(this,"_logger");f(this,"_savedDrawCommands$");this._logger=e(this);}async onFeatureDestroy(){this._savedDrawCommands$=void 0;}async onFeatureActivate(){this._savedDrawCommands$=new Le([]);}get savedDrawCommands$(){if(!this._savedDrawCommands$)throw this._logger.error("Tried to access saved draw commands without initializing the service first. Imagelab feature enabled?"),new Error("illegal state");return this._savedDrawCommands$}saveDrawCommands(e,t){if(!this._savedDrawCommands$)throw this._logger.warn("Tried to save draw commands without initializing the service first. Imagelab feature enabled?"),new Error("illegal state");t[0]&&Array.isArray(t[0])&&Array.isArray(t[0][0])?t=S4(t):t=t,this._savedDrawCommands$.next([...this.savedDrawCommands$.value,{name:e,commands:t}]);}removeSavedDrawCommands(e){if(!this._savedDrawCommands$)throw this._logger.warn("Tried to save draw commands without initializing the service first. Imagelab feature enabled?"),new Error("illegal state");this._savedDrawCommands$.next(this._savedDrawCommands$.value.filter((t,n)=>n!==e));}},c(Ca,"ImagelabService"),Ca);uu=C4([we(),I4(0,D(rt))],uu);var T4=Object.defineProperty,D4=Object.getOwnPropertyDescriptor,E4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?D4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&T4(e,t,i),i},"__decorateClass$Z"),rk=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$9"),Ia;let du=(Ia=class{constructor(e,t){f(this,"_logger");f(this,"_history$");f(this,"_historySubscription");this._imageFinishedService=t,this._logger=e(this);}async onFeatureActivate(){this._history$=new Le([]),this._historySubscription=this._imageFinishedService.imageHistory$.subscribe(e=>{var t;return (t=this._history$)==null?void 0:t.next(e)});}async onFeatureDestroy(){var e;this._history$=void 0,(e=this._historySubscription)==null||e.unsubscribe();}get history$(){if(!this._history$)throw this._logger.error("Tried to access history without initializing the service first. Imagelab feature enabled?"),new Error("illegal state");return this._history$.asObservable()}addToHistory(e){if(!this._history$)throw this._logger.error("Tried to access history without initializing the service first. Imagelab feature enabled?"),new Error("illegal state");this._history$.next([...this._history$.value,e]);}},c(Ia,"ImagePostService"),Ia);du=E4([we(),rk(0,D(rt)),rk(1,D(lo))],du);function M4(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S;const R=[r[0].props];var E=r[0].componentType;function P(L,O){let z={};for(let $=0;$<R.length;$+=1)z=St(z,R[$]);return O!==void 0&&O&1&&(z=St(z,Rt(R,[Lt(L[0].props)]))),{props:z}}return c(P,"switch_props"),E&&(y=qe(E,P(r))),{c(){e=v("div"),t=C(),n=v("div"),i=C(),o=v("div"),s=v("div"),a=v("div"),l=C(),u=v("h1"),d=G(r[1]),h=C(),p=v("div"),p.textContent="",m=C(),b=v("div"),y&&V(y.$$.fragment),_(e,"class","backdrop svelte-lwvpkp"),_(e,"role","presentation"),ue(e,"closing",r[2]),_(n,"class","content-top svelte-lwvpkp"),_(n,"role","presentation"),ue(n,"closing",r[2]),_(a,"class","svelte-lwvpkp"),_(p,"role","button"),_(p,"tabindex","0"),_(p,"class","svelte-lwvpkp"),ue(p,"closing",r[2]),_(s,"class","content-title svelte-lwvpkp"),_(b,"class","content-wrapper color-scrollbar svelte-lwvpkp"),_(o,"class","content typo-modal svelte-lwvpkp"),ue(o,"closing",r[2]);},m(L,O){k(L,e,O),k(L,t,O),k(L,n,O),k(L,i,O),k(L,o,O),g(o,s),g(s,a),g(s,l),g(s,u),g(u,d),g(s,h),g(s,p),g(o,m),g(o,b),y&&x(y,b,null),w=!0,I||(S=[F(e,"click",r[5]),F(n,"click",r[6]),F(p,"keypress",r[7]),F(p,"click",r[8])],I=!0);},p(L,[O]){if((!w||O&4)&&ue(e,"closing",L[2]),(!w||O&4)&&ue(n,"closing",L[2]),(!w||O&2)&&K(d,L[1]),(!w||O&4)&&ue(p,"closing",L[2]),O&1&&E!==(E=L[0].componentType)){if(y){fe();const z=y;M(z.$$.fragment,1,0,()=>{Z(z,1);}),pe();}E?(y=qe(E,P(L,O)),V(y.$$.fragment),T(y.$$.fragment,1),x(y,b,null)):y=null;}else if(E){const z=O&1?Rt(R,[Lt(L[0].props)]):{};y.$set(z);}(!w||O&4)&&ue(o,"closing",L[2]);},i(L){w||(y&&T(y.$$.fragment,L),w=!0);},o(L){y&&M(y.$$.fragment,L),w=!1;},d(L){L&&(A(e),A(t),A(n),A(i),A(o)),y&&Z(y),I=!1,Je(S);}}}c(M4,"create_fragment$1p");function R4(r,e,t){let{componentData:n}=e,{closeHandler:i}=e,{title:o}=e,s=!1;const a=c(()=>{t(2,s=!0),setTimeout(()=>i(),150);},"close"),l=c(()=>a(),"click_handler"),u=c(()=>a(),"click_handler_1"),d=c(p=>p.key==="Alt"&&a(),"keypress_handler"),h=c(()=>a(),"click_handler_2");return r.$$set=p=>{"componentData"in p&&t(0,n=p.componentData),"closeHandler"in p&&t(4,i=p.closeHandler),"title"in p&&t(1,o=p.title);},[n,o,s,a,i,l,u,d,h]}c(R4,"instance$1h");const H_=class H_ extends se{constructor(e){super(),le(this,e,R4,M4,re,{componentData:0,closeHandler:4,title:1});}};c(H_,"Modal_document");let Ud=H_;function L4(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y;const w=[r[0].props];var I=r[0].componentType;function S(R,E){let P={};for(let L=0;L<w.length;L+=1)P=St(P,w[L]);return E!==void 0&&E&1&&(P=St(P,Rt(w,[Lt(R[0].props)]))),{props:P}}return c(S,"switch_props"),I&&(p=qe(I,S(r))),{c(){e=v("div"),t=v("div"),n=v("div"),i=v("div"),o=C(),s=v("h1"),a=G(r[1]),l=C(),u=v("div"),u.textContent="",d=C(),h=v("div"),p&&V(p.$$.fragment),_(i,"class","svelte-1n76u56"),_(u,"role","button"),_(u,"tabindex","0"),_(u,"class","svelte-1n76u56"),ue(u,"closing",r[2]),_(n,"class","content-title svelte-1n76u56"),_(h,"class","content-wrapper color-scrollbar svelte-1n76u56"),_(t,"class","content typo-modal svelte-1n76u56"),ue(t,"closing",r[2]),_(e,"class","backdrop svelte-1n76u56"),_(e,"role","presentation"),ue(e,"closing",r[2]);},m(R,E){k(R,e,E),g(e,t),g(t,n),g(n,i),g(n,o),g(n,s),g(s,a),g(n,l),g(n,u),g(t,d),g(t,h),p&&x(p,h,null),m=!0,b||(y=[F(u,"keypress",r[5]),F(u,"click",r[6]),F(e,"click",r[7])],b=!0);},p(R,[E]){if((!m||E&2)&&K(a,R[1]),(!m||E&4)&&ue(u,"closing",R[2]),E&1&&I!==(I=R[0].componentType)){if(p){fe();const P=p;M(P.$$.fragment,1,0,()=>{Z(P,1);}),pe();}I?(p=qe(I,S(R,E)),V(p.$$.fragment),T(p.$$.fragment,1),x(p,h,null)):p=null;}else if(I){const P=E&1?Rt(w,[Lt(R[0].props)]):{};p.$set(P);}(!m||E&4)&&ue(t,"closing",R[2]),(!m||E&4)&&ue(e,"closing",R[2]);},i(R){m||(p&&T(p.$$.fragment,R),m=!0);},o(R){p&&M(p.$$.fragment,R),m=!1;},d(R){R&&A(e),p&&Z(p),b=!1,Je(y);}}}c(L4,"create_fragment$1o");function P4(r,e,t){let{componentData:n}=e,{closeHandler:i}=e,{title:o}=e,s=!1;const a=c(()=>{t(2,s=!0),setTimeout(()=>i(),150);},"close"),l=c(h=>h.key==="Alt"&&a(),"keypress_handler"),u=c(()=>a(),"click_handler"),d=c(h=>{h.currentTarget===h.target&&a();},"click_handler_1");return r.$$set=h=>{"componentData"in h&&t(0,n=h.componentData),"closeHandler"in h&&t(4,i=h.closeHandler),"title"in h&&t(1,o=h.title);},[n,o,s,a,i,l,u,d]}c(P4,"instance$1g");const Q_=class Q_ extends se{constructor(e){super(),le(this,e,P4,L4,re,{componentData:0,closeHandler:4,title:1});}};c(Q_,"Modal_card");let Bd=Q_;var N4=Object.defineProperty,O4=Object.getOwnPropertyDescriptor,j4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?O4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&N4(e,t,i),i},"__decorateClass$Y"),ok=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$8"),Ta;let Dn=(Ta=class{constructor(e,t){f(this,"_logger");f(this,"_modalClosed$",new be);f(this,"_closeHotkey",new cn("modal_close","Close Modal","Close open modals using a hotkey",void 0,()=>{this._modalClosed$.next();},!0,["KeyA"]));this._globalSettingsService=t,this._logger=e(this);}showModal(e,t,n,i="document"){const o={componentType:e,props:t},s=i==="document"?new Ud({target:document.body,props:{componentData:o,closeHandler:c(()=>{s.$destroy();},"closeHandler"),title:n}}):new Bd({target:document.body,props:{componentData:o,closeHandler:c(()=>{s.$destroy();},"closeHandler"),title:n}});return this._globalSettingsService.globalHotkeys.exitModal.once(()=>{s.$destroy();}),{close:c(()=>{s.$destroy();},"close")}}async showPrompt(e,t,n,i="card",o){const s=new be,l=t(c(async p=>{let m=o===void 0?!0:o(p);m instanceof Promise&&(m=await m),m&&s.next(p);},"submit")),u={componentType:e,props:l},d=i==="card"?new Bd({target:document.body,props:{componentData:u,closeHandler:c(()=>{d.$destroy(),s.next(void 0);},"closeHandler"),title:n}}):new Ud({target:document.body,props:{componentData:u,closeHandler:c(()=>{d.$destroy(),s.next(void 0);},"closeHandler"),title:n}});this._globalSettingsService.globalHotkeys.exitModal.once(()=>{d.$destroy(),s.next(void 0);});const h=await Ee(s);return d.$destroy(),h}},c(Ta,"ModalService"),Ta);Dn=j4([we(),ok(0,D(rt)),ok(1,D(xn))],Dn);const fl=c((r,e)=>{const t=URL.createObjectURL(r),n=document.createElement("a");n.href=t,n.download=e,n.click();},"downloadBlob"),mb=c((r,e)=>{const t=new Blob([r],{type:"text/plain"});fl(t,e);},"downloadText"),wf=c(async r=>await(await fetch(r)).json(),"getCloudCommands"),G4=c(async r=>await(await fetch(r)).json(),"getCloudMeta"),X_=class X_{constructor(e,t){f(this,"_worker");this._parent=t,this._worker=new Worker(e,{type:"module"}),this._worker.addEventListener("message",n=>{const{type:i,methodName:o,args:s}=n.data;i==="notification"&&this._parent[o](...s);});}async run(e,...t){return new Promise(n=>{const i=Math.random().toString(36).slice(10);this._worker.addEventListener("message",o=>{o.data.messageId===i&&o.data.type==="result"?n(o.data.result):o.data.messageId===i&&o.data.type==="error"&&n(new Error(o.data.error));}),this._worker.postMessage({methodName:e,args:t,messageId:i});})}};c(X_,"TypedWorkerExecutor");let xd=X_;const wE='"use strict";(()=>{var hr=Object.create;var ir=Object.defineProperty;var dr=Object.getOwnPropertyDescriptor;var cr=Object.getOwnPropertyNames;var fr=Object.getPrototypeOf,gr=Object.prototype.hasOwnProperty;var mr=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var vr=(e,r,n,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of cr(r))!gr.call(e,t)&&t!==n&&ir(e,t,{get:()=>r[t],enumerable:!(o=dr(r,t))||o.enumerable});return e};var pr=(e,r,n)=>(n=e!=null?hr(fr(e)):{},vr(r||!e||!e.__esModule?ir(n,"default",{value:e,enumerable:!0}):n,e));var or=mr(nr=>{"use strict";function ur(e,r,n,i){var t=0,i=i===void 0?{}:i,s=i.loop===void 0?null:i.loop,l=i.palette===void 0?null:i.palette;if(r<=0||n<=0||r>65535||n>65535)throw new Error("Width/Height invalid.");function a(u){var m=u.length;if(m<2||m>256||m&m-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return m}e[t++]=71,e[t++]=73,e[t++]=70,e[t++]=56,e[t++]=57,e[t++]=97;var h=0,d=0;if(l!==null){for(var c=a(l);c>>=1;)++h;if(c=1<<h,--h,i.background!==void 0){if(d=i.background,d>=c)throw new Error("Background index out of range.");if(d===0)throw new Error("Background index explicitly passed as 0.")}}if(e[t++]=r&255,e[t++]=r>>8&255,e[t++]=n&255,e[t++]=n>>8&255,e[t++]=(l!==null?128:0)|h,e[t++]=d,e[t++]=0,l!==null)for(var f=0,g=l.length;f<g;++f){var v=l[f];e[t++]=v>>16&255,e[t++]=v>>8&255,e[t++]=v&255}if(s!==null){if(s<0||s>65535)throw new Error("Loop count invalid.");e[t++]=33,e[t++]=255,e[t++]=11,e[t++]=78,e[t++]=69,e[t++]=84,e[t++]=83,e[t++]=67,e[t++]=65,e[t++]=80,e[t++]=69,e[t++]=50,e[t++]=46,e[t++]=48,e[t++]=3,e[t++]=1,e[t++]=s&255,e[t++]=s>>8&255,e[t++]=0}var p=!1;this.addFrame=function(u,m,b,x,y,w){if(p===!0&&(--t,p=!1),w=w===void 0?{}:w,u<0||m<0||u>65535||m>65535)throw new Error("x/y invalid.");if(b<=0||x<=0||b>65535||x>65535)throw new Error("Width/Height invalid.");if(y.length<b*x)throw new Error("Not enough pixels for the frame size.");var C=!0,k=w.palette;if(k==null&&(C=!1,k=l),k==null)throw new Error("Must supply either a local or global palette.");for(var I=a(k),W=0;I>>=1;)++W;I=1<<W;var N=w.delay===void 0?0:w.delay,G=w.disposal===void 0?0:w.disposal;if(G<0||G>3)throw new Error("Disposal out of range.");var X=!1,D=0;if(w.transparent!==void 0&&w.transparent!==null&&(X=!0,D=w.transparent,D<0||D>=I))throw new Error("Transparent color index.");if((G!==0||X||N!==0)&&(e[t++]=33,e[t++]=249,e[t++]=4,e[t++]=G<<2|(X===!0?1:0),e[t++]=N&255,e[t++]=N>>8&255,e[t++]=D,e[t++]=0),e[t++]=44,e[t++]=u&255,e[t++]=u>>8&255,e[t++]=m&255,e[t++]=m>>8&255,e[t++]=b&255,e[t++]=b>>8&255,e[t++]=x&255,e[t++]=x>>8&255,e[t++]=C===!0?128|W-1:0,C===!0)for(var Y=0,Z=k.length;Y<Z;++Y){var S=k[Y];e[t++]=S>>16&255,e[t++]=S>>8&255,e[t++]=S&255}return t=xr(e,t,W<2?2:W,y),t},this.end=function(){return p===!1&&(e[t++]=59,p=!0),t},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(u){e=u},this.getOutputBufferPosition=function(){return t},this.setOutputBufferPosition=function(u){t=u}}function xr(e,r,n,o){e[r++]=n;var t=r++,i=1<<n,s=i-1,l=i+1,a=l+1,h=n+1,d=0,c=0;function f(w){for(;d>=w;)e[r++]=c&255,c>>=8,d-=8,r===t+256&&(e[t]=255,t=r++)}function g(w){c|=w<<d,d+=h,f(8)}var v=o[0]&s,p={};g(i);for(var u=1,m=o.length;u<m;++u){var b=o[u]&s,x=v<<8|b,y=p[x];if(y===void 0){for(c|=v<<d,d+=h;d>=8;)e[r++]=c&255,c>>=8,d-=8,r===t+256&&(e[t]=255,t=r++);a===4096?(g(i),a=l+1,h=n+1,p={}):(a>=1<<h&&++h,p[x]=a++),v=b}else v=y}return g(v),g(l),f(1),t+1===r?e[t]=0:(e[t]=r-t-1,e[r++]=0),r}function wr(e){var r=0;if(e[r++]!==71||e[r++]!==73||e[r++]!==70||e[r++]!==56||(e[r++]+1&253)!==56||e[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[r++]|e[r++]<<8,o=e[r++]|e[r++]<<8,t=e[r++],i=t>>7,s=t&7,l=1<<s+1,a=e[r++];e[r++];var h=null,d=null;i&&(h=r,d=l,r+=l*3);var c=!0,f=[],g=0,v=null,p=0,u=null;for(this.width=n,this.height=o;c&&r<e.length;)switch(e[r++]){case 33:switch(e[r++]){case 255:if(e[r]!==11||e[r+1]==78&&e[r+2]==69&&e[r+3]==84&&e[r+4]==83&&e[r+5]==67&&e[r+6]==65&&e[r+7]==80&&e[r+8]==69&&e[r+9]==50&&e[r+10]==46&&e[r+11]==48&&e[r+12]==3&&e[r+13]==1&&e[r+16]==0)r+=14,u=e[r++]|e[r++]<<8,r++;else for(r+=12;;){var m=e[r++];if(!(m>=0))throw Error("Invalid block size");if(m===0)break;r+=m}break;case 249:if(e[r++]!==4||e[r+4]!==0)throw new Error("Invalid graphics extension block.");var b=e[r++];g=e[r++]|e[r++]<<8,v=e[r++],(b&1)===0&&(v=null),p=b>>2&7,r++;break;case 254:for(;;){var m=e[r++];if(!(m>=0))throw Error("Invalid block size");if(m===0)break;r+=m}break;default:throw new Error("Unknown graphic control label: 0x"+e[r-1].toString(16))}break;case 44:var x=e[r++]|e[r++]<<8,y=e[r++]|e[r++]<<8,w=e[r++]|e[r++]<<8,C=e[r++]|e[r++]<<8,k=e[r++],I=k>>7,W=k>>6&1,N=k&7,G=1<<N+1,X=h,D=d,Y=!1;if(I){var Y=!0;X=r,D=G,r+=G*3}var Z=r;for(r++;;){var m=e[r++];if(!(m>=0))throw Error("Invalid block size");if(m===0)break;r+=m}f.push({x,y,width:w,height:C,has_local_palette:Y,palette_offset:X,palette_size:D,data_offset:Z,data_length:r-Z,transparent_index:v,interlaced:!!W,delay:g,disposal:p});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[r-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return u},this.frameInfo=function(S){if(S<0||S>=f.length)throw new Error("Frame index out of range.");return f[S]},this.decodeAndBlitFrameBGRA=function(S,E){var _=this.frameInfo(S),q=_.width*_.height,F=new Uint8Array(q);ar(e,_.data_offset,F,q);var z=_.palette_offset,A=_.transparent_index;A===null&&(A=256);var T=_.width,B=n-T,O=T,j=(_.y*n+_.x)*4,Q=((_.y+_.height)*n+_.x)*4,M=j,L=B*4;_.interlaced===!0&&(L+=n*4*7);for(var U=8,H=0,V=F.length;H<V;++H){var R=F[H];if(O===0&&(M+=L,O=T,M>=Q&&(L=B*4+n*4*(U-1),M=j+(T+B)*(U<<1),U>>=1)),R===A)M+=4;else{var rr=e[z+R*3],er=e[z+R*3+1],tr=e[z+R*3+2];E[M++]=tr,E[M++]=er,E[M++]=rr,E[M++]=255}--O}},this.decodeAndBlitFrameRGBA=function(S,E){var _=this.frameInfo(S),q=_.width*_.height,F=new Uint8Array(q);ar(e,_.data_offset,F,q);var z=_.palette_offset,A=_.transparent_index;A===null&&(A=256);var T=_.width,B=n-T,O=T,j=(_.y*n+_.x)*4,Q=((_.y+_.height)*n+_.x)*4,M=j,L=B*4;_.interlaced===!0&&(L+=n*4*7);for(var U=8,H=0,V=F.length;H<V;++H){var R=F[H];if(O===0&&(M+=L,O=T,M>=Q&&(L=B*4+n*4*(U-1),M=j+(T+B)*(U<<1),U>>=1)),R===A)M+=4;else{var rr=e[z+R*3],er=e[z+R*3+1],tr=e[z+R*3+2];E[M++]=rr,E[M++]=er,E[M++]=tr,E[M++]=255}--O}}}function ar(e,r,n,o){for(var t=e[r++],i=1<<t,s=i+1,l=s+1,a=t+1,h=(1<<a)-1,d=0,c=0,f=0,g=e[r++],v=new Int32Array(4096),p=null;;){for(;d<16&&g!==0;)c|=e[r++]<<d,d+=8,g===1?g=e[r++]:--g;if(d<a)break;var u=c&h;if(c>>=a,d-=a,u===i){l=s+1,a=t+1,h=(1<<a)-1,p=null;continue}else if(u===s)break;for(var m=u<l?u:p,b=0,x=m;x>i;)x=v[x]>>8,++b;var y=x,w=f+b+(m!==u?1:0);if(w>o){console.log("Warning, gif stream longer than expected.");return}n[f++]=y,f+=b;var C=f;for(m!==u&&(n[f++]=y),x=m;b--;)x=v[x],n[--C]=x&255,x>>=8;p!==null&&l<4096&&(v[l++]=p<<8|y,l>=h+1&&a<12&&(++a,h=h<<1|1)),p=u}return f!==o&&console.log("Warning, gif stream shorter than expected."),n}try{nr.GifWriter=ur,nr.GifReader=wr}catch{}});var P=class e{constructor(r,n,o,t){this._r=r;this._g=n;this._b=o;this._a=t;this._r=e.sanitizeRgbComponent(r),this._g=e.sanitizeRgbComponent(n),this._b=e.sanitizeRgbComponent(o),t!==void 0&&(this._a=e.sanitizeRgbComponent(t))}static skribblColors=[[255,255,255],[0,0,0],[193,193,193],[80,80,80],[239,19,11],[116,11,7],[255,113,0],[194,56,0],[255,228,0],[232,162,0],[0,204,0],[0,70,25],[0,255,145],[0,120,93],[0,178,255],[0,86,158],[35,31,211],[14,8,101],[163,0,186],[85,0,105],[223,105,167],[135,53,84],[255,172,142],[204,119,77],[160,82,45],[99,48,13]];get r(){return this._r}get g(){return this._g}get b(){return this._b}static sanitizeRgbComponent(r){return Number.isFinite(r)?Math.min(255,Math.max(0,Math.round(r))):0}get rgbString(){return"rgb("+[this._r,this._g,this._b,this._a].filter(r=>r!==void 0).join(",")+")"}get rgbArray(){return this._a?[this._r,this._g,this._b,this._a]:[this._r,this._g,this._b]}get rgb(){return{r:this._r,g:this._g,b:this._b,a:this._a}}get hex(){return"#"+this._r.toString(16).padStart(2,"0")+this._g.toString(16).padStart(2,"0")+this._b.toString(16).padStart(2,"0")+(this._a?Math.floor(255*this._a).toString(16).padStart(2,"0"):"")}set hex(r){let n=e.fromHex(r);this._r=n._r,this._g=n._g,this._b=n._b,this._a=n._a}get skribblCode(){let r=e.skribblColors.findIndex(n=>n[0]===this._r&&n[1]===this._g&&n[2]===this._b);return r!==-1?r:this.typoCode}get typoCode(){let r=(this._r<<16|this._g<<8|this._b).toString(16).toUpperCase();return parseInt(r,16)+1e4}get hsl(){let r=this.r/255,n=this.g/255,o=this.b/255,t=Math.max(r,n,o),i=Math.min(r,n,o),s=0,l=0,a=(t+i)/2;if(t==i)s=l=0;else{let h=t-i;switch(l=a>.5?h/(2-t-i):h/(t+i),t){case r:s=(n-o)/h+(n<o?6:0);break;case n:s=(o-r)/h+2;break;case o:s=(r-n)/h+4;break}s/=6}return this._a!==void 0?[s*360,l*100,a*100,this._a]:[s*360,l*100,a*100]}get hsv(){let r=this.r/255,n=this.g/255,o=this.b/255,t=Math.max(r,n,o),i=Math.min(r,n,o),s=t-i,l=0,a=0,h=t;if(t!==0?a=s/t:(l=0,a=0),t!==i){switch(t){case r:l=(n-o)/s+(n<o?6:0);break;case n:l=(o-r)/s+2;break;case o:l=(r-n)/s+4;break}l/=6}return[l*360,a*100,h*100,this._a]}static fromRgb(r,n,o,t){return new e(Math.round(r),Math.round(n),Math.round(o),t?Math.round(t*100)/100:void 0)}static fromHex(r){r[0]=="#"&&(r=r.substring(1));let n=Math.round(parseInt("0x"+r.substring(0,2))),o=Math.round(parseInt("0x"+r.substring(2,4))),t=Math.round(parseInt("0x"+r.substring(4,6))),i=r.length>6?Math.round(parseInt("0x"+r.substring(6,8))):void 0;return new e(n,o,t,i)}static fromRgbString(r){let n=r.trim().replace(" ","").split(","),o=parseInt(n[0].replace(/[^\\d]/g,""),10),t=parseInt(n[1].replace(/[^\\d]/g,""),10),i=parseInt(n[2].replace(/[^\\d]/g,""),10),s=n.length>3?parseInt(n[4].replace(/[^\\d]/g,""),10):void 0;return new e(o,t,i,s)}static fromSkribblCode(r){if(r<1e4){let o=e.skribblColors[r];return e.fromRgb(o[0],o[1],o[2])}let n=(r-1e4).toString(16).padStart(6,"0");return e.fromHex(n)}static fromHsl(r,n,o,t){n/=100,o/=100;let i=c=>(c+r/30)%12,s=n*Math.min(o,1-o),l=c=>o-s*Math.max(-1,Math.min(i(c)-3,Math.min(9-i(c),1))),a=Math.round(l(0)*255),h=Math.round(l(8)*255),d=Math.round(l(4)*255);return new e(a,h,d,t)}static fromHsv(r,n,o,t){n/=100,o/=100;let i=o*n,s=i*(1-Math.abs(r/60%2-1)),l=o-i,a=0,h=0,d=0;return 0<=r&&r<60?(a=i,h=s,d=0):60<=r&&r<120?(a=s,h=i,d=0):120<=r&&r<180?(a=0,h=i,d=s):180<=r&&r<240?(a=0,h=s,d=i):240<=r&&r<300?(a=s,h=0,d=i):300<=r&&r<360&&(a=i,h=0,d=s),a=Math.round((a+l)*255),h=Math.round((h+l)*255),d=Math.round((d+l)*255),new e(a,h,d,t)}copy(){return new e(this._r,this._g,this._b,this._a)}withAlpha(r){return this._a=r,this}};var K=class{constructor(r){this._canvasContext=r;this._width=r.canvas.width,this._height=r.canvas.height,this._canvasContext.fillStyle="white",this._canvasContext.fillRect(0,0,this._width,this._height)}_width;_height;_thicknessMin=4;_thicknessMax=40;processDrawCommand(r){if(r.length<2)throw new Error("Invalid command length smaller than 2");switch(r[0]){case 0:if(r.length<7)throw new Error("Invalid brush command length smaller than 7");this.drawLine(r[3],r[4],r[5],r[6],r[1],r[2]);break;case 1:if(r.length<4)throw new Error("Invalid fill command length smaller than 4");this.floodFill(r[2],r[3],r[1]);break}}clear(){this._canvasContext.clearRect(0,0,this._width,this._height)}exportImage(){return this._canvasContext.getImageData(0,0,this._width,this._height).data}drawLine(r,n,o,t,i,s){s=s<this._thicknessMin?this._thicknessMin:s>this._thicknessMax?this._thicknessMax:Math.floor(s);let l=P.fromSkribblCode(i).rgb,a=Math.ceil(s/2),h=a*a,d=this.clamp(Math.floor(r),-a,this._width+a),c=this.clamp(Math.floor(n),-a,this._height+a),f=this.clamp(Math.floor(o),-a,this._width+a),g=this.clamp(Math.floor(t),-a,this._height+a),v=Math.min(d,f)-a,p=Math.min(c,g)-a,u=Math.max(d,f)+a,m=Math.max(c,g)+a;d-=v,c-=p,f-=v,g-=p;let b=this._canvasContext.getImageData(v,p,u-v,m-p),x=(y,w)=>{for(let C=-a;C<=a;C++)for(let k=-a;k<=a;k++)if(C*C+k*k<h){let I=4*((w+k)*b.width+y+C);this.setPixel(b,I,l.r,l.g,l.b)}};if(d===f&&c===g)x(d,c);else{x(d,c),x(f,g);let y=Math.abs(f-d),w=Math.abs(g-c),C=d<f?1:-1,k=c<g?1:-1,I=y-w;for(;d!==f||c!==g;){let W=I*2;W>-w&&(I-=w,d+=C),W<y&&(I+=y,c+=k),x(d,c)}}this._canvasContext.putImageData(b,v,p)}floodFill(r,n,o){let t=this._canvasContext.getImageData(0,0,this._width,this._height);r=this.clamp(Math.floor(r),0,this._width),n=this.clamp(Math.floor(n),0,this._height);let i=P.fromSkribblCode(o).rgb,s=[[r,n]],l=this.getPixel(t,r,n);if(i.r!==l[0]||i.g!==l[1]||i.b!==l[2]){let a=c=>{let f=t.data[c],g=t.data[c+1],v=t.data[c+2];return f===l[0]&&g===l[1]&&v===l[2]},h=t.width,d=t.height;for(;s.length>0;){let[c,f]=s.pop()??[-1,-1],g=4*(f*h+c);for(;f>=0&&a(g);)g-=4*h,f--;g+=4*h,f++;let v=!1,p=!1;for(;f<d&&a(g);)this.setPixel(t,g,i.r,i.g,i.b),c>0&&a(g-4)?v||(s.push([c-1,f]),v=!0):v&&(v=!1),c<h-1&&a(g+4)?p||(s.push([c+1,f]),p=!0):p&&(p=!1),g+=4*h,f++}this._canvasContext.putImageData(t,0,0)}}getPixel(r,n,o){let t=4*(o*r.width+n);return t<0||t>=r.data.length?[0,0,0]:[r.data[t],r.data[t+1],r.data[t+2]]}setPixel(r,n,o,t,i){n<0||n>=r.data.length||(r.data[n]=o,r.data[n+1]=t,r.data[n+2]=i,r.data[n+3]=255)}clamp(r,n,o){return Math.min(Math.max(r,n),o)}};var sr=pr(or(),1),$=class{width=800;height=600;buffer;gifWriter;frameCount=0;colors;constructor(r,n){this.buffer=new Uint8Array(this.width*this.height*5*n),this.gifWriter=new sr.GifWriter(this.buffer,this.width,this.height,{loop:1});let o=l=>l.rgbArray.slice(0,3).join(","),t=P.fromRgb(255,255,255);this.colors=new Map(r.values().map((l,a)=>[l.rgbArray.slice(0,3).toString(),{color:l,index:a}])),this.colors.has(o(t))||this.colors.set(o(t),{color:t,index:this.colors.size});let s=(l=>Math.pow(2,Math.ceil(Math.log2(l))))(this.colors.size);this.colors.size<s&&new Array(s-this.colors.size).fill(t).forEach((a,h)=>{this.colors.set(`fill-${h}`,{color:a,index:this.colors.size})})}get palette(){return[...this.colors.values()].map(r=>{let n=r.color.rgbArray;return n[2]|n[1]<<8|n[0]<<16})}mapToPaletteIndex(r){return this.colors.get(r.toString())?.index??0}addFrame(r,n){let o=this.palette,t=[];for(let i=0;i<r.length;i+=4){let s=[r[i],r[i+1],r[i+2]];t.push(this.mapToPaletteIndex(s))}this.gifWriter.addFrame(0,0,this.width,this.height,t,{delay:n/10,palette:o,disposal:2}),this.frameCount++}finalize(){if(this.frameCount===0)throw new Error("No frames added to the GIF.");let r=this.buffer.subarray(0,this.gifWriter.end());return new Blob([r],{type:"image/gif"})}};function lr(e,r,n,o,t,i){let s=new Set(r.map(h=>h[1]));if(s.size>256)throw new Error("Too many colors in the skribbl commands to render gif");let l=new Set(s.values().map(h=>P.fromSkribblCode(h))),a=new $(l,t);for(let h=0;h<r.length;h++)if(e.processDrawCommand(r[h]),h%n===0){let d=e.exportImage();a.addFrame(d,o),i?.(h,r.length)}return a.addFrame(e.exportImage(),2e3),a.finalize()}var J=class{constructor(r){this.worker=r;addEventListener("message",async n=>{let{methodName:o,args:t,messageId:i}=n.data;try{let s=await this.worker[o](...t);postMessage({type:"result",messageId:i,result:s})}catch(s){postMessage({type:"error",messageId:i,error:s instanceof Error?s.message:String(s)})}})}send(r,...n){postMessage({type:"notification",methodName:r,args:n})}};var _r={renderGif(e,r){let o=new OffscreenCanvas(800,600).getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("Failed to get 2d context");let t=new K(o),i=50,s=Math.ceil(r/i),l=Math.max(1,Math.floor(e.length/s));return lr(t,e,l,i,s,(h,d)=>br.send("frameRendered",h,d))}},br=new J(_r);})();\n';function sk(r,e,t){const n=r.slice();return n[33]=e[t],n}c(sk,"get_each_context$B");function ak(r){let e,t;return e=new ke({props:{content:"Search Cloud",color:"green"}}),e.$on("click",r[20]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(ak,"create_if_block_2$e");function lk(r){let e,t,n,i={ctx:r,current:null,token:null,hasCatch:!1,pending:z4,then:Y4,catch:$4,value:11,blocks:[,,,]};return $n(t=r[11],i),{c(){e=je(),i.block.c();},m(o,s){k(o,e,s),i.block.m(o,i.anchor=s),i.mount=()=>e.parentNode,i.anchor=e,n=!0;},p(o,s){r=o,i.ctx=r,s[0]&2048&&t!==(t=r[11])&&$n(t,i)||To(i,r,s);},i(o){n||(T(i.block),n=!0);},o(o){for(let s=0;s<3;s+=1){const a=i.blocks[s];M(a);}n=!1;},d(o){o&&A(e),i.block.d(o),i.token=null,i=null;}}}c(lk,"create_if_block_1$h");function $4(r){return {c:j,m:j,p:j,i:j,o:j,d:j}}c($4,"create_catch_block$4");function Y4(r){let e,t=te(r[11]),n=[];for(let i=0;i<t.length;i+=1)n[i]=ck(sk(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,o){if(o[0]&3584){t=te(i[11]);let s;for(s=0;s<t.length;s+=1){const a=sk(i,t,s);n[s]?n[s].p(a,o):(n[s]=ck(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},i:j,o:j,d(i){i&&A(e),Ie(n,i);}}}c(Y4,"create_then_block$4");function ck(r){let e,t,n,i,o;function s(){return r[23](r[33])}return c(s,"click_handler_4"),{c(){e=v("img"),ht(e.src,t=r[33].imageUrl)||_(e,"src",t),_(e,"alt",n=r[33].name),H(e,"display",r[9].includes(r[33].id)?"none":""),_(e,"class","svelte-skb05m");},m(a,l){k(a,e,l),i||(o=F(e,"click",s),i=!0);},p(a,l){r=a,l[0]&2048&&!ht(e.src,t=r[33].imageUrl)&&_(e,"src",t),l[0]&2048&&n!==(n=r[33].name)&&_(e,"alt",n),l[0]&2560&&H(e,"display",r[9].includes(r[33].id)?"none":"");},d(a){a&&A(e),i=!1,o();}}}c(ck,"create_each_block$B");function z4(r){let e,t,n;return t=new Yn({props:{content:"Loading Images..."}}),{c(){e=v("div"),V(t.$$.fragment),_(e,"class","loading svelte-skb05m");},m(i,o){k(i,e,o),x(t,e,null),n=!0;},p:j,i(i){n||(T(t.$$.fragment,i),n=!0);},o(i){M(t.$$.fragment,i),n=!1;},d(i){i&&A(e),Z(t);}}}c(z4,"create_pending_block$4");function uk(r){let e,t,n,i,o,s,a,l=r[10].name+"",u,d,h,p,m=r[10].author+"",b,y,w,I,S=new Date(Number(r[10].createdAt)).toLocaleString()+"",R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne,W,he,Pe,me,Ae,Dt,xe,Te,Ze;return O=new ke({props:{content:"Download PNG",color:"green"}}),O.$on("click",r[25]),$=new ke({props:{content:"Download GIF",color:"green"}}),$.$on("click",r[26]),N=new ke({props:{content:"Copy Link",color:"green"}}),N.$on("click",r[27]),J=new ke({props:{content:"Add to Image Post",color:"blue"}}),J.$on("click",r[28]),Q=new ke({props:{content:"Add to Image Lab",color:"blue"}}),Q.$on("click",r[29]),he=new ke({props:{content:"Delete Image",color:"orange"}}),he.$on("click",r[30]),Ae=new st({props:{icon:"file-img-arrow-left-gif",hoverMove:!1,name:"Exit"}}),Ae.$on("click",r[31]),{c(){e=v("div"),t=v("img"),o=C(),s=v("div"),a=v("h3"),u=G(l),d=C(),h=v("span"),p=G("Drawn by "),b=G(m),y=C(),w=v("span"),I=G("Created on "),R=G(S),E=C(),P=v("br"),L=C(),V(O.$$.fragment),z=C(),V($.$$.fragment),U=C(),V(N.$$.fragment),Y=C(),ee=v("br"),B=C(),V(J.$$.fragment),q=C(),V(Q.$$.fragment),X=C(),ne=v("br"),W=C(),V(he.$$.fragment),Pe=C(),me=v("div"),V(Ae.$$.fragment),Dt=G(`
        Back to Gallery`),ht(t.src,n=r[10].imageUrl)||_(t,"src",n),_(t,"alt",i=r[10].name),_(t,"class","svelte-skb05m"),_(e,"class","present-image svelte-skb05m"),_(a,"class","svelte-skb05m"),_(h,"class","svelte-skb05m"),_(w,"class","svelte-skb05m"),_(me,"class","exit-present svelte-skb05m"),_(s,"class","present-sidebar svelte-skb05m");},m(Ne,ot){k(Ne,e,ot),g(e,t),k(Ne,o,ot),k(Ne,s,ot),g(s,a),g(a,u),g(s,d),g(s,h),g(h,p),g(h,b),g(s,y),g(s,w),g(w,I),g(w,R),g(s,E),g(s,P),g(s,L),x(O,s,null),g(s,z),x($,s,null),g(s,U),x(N,s,null),g(s,Y),g(s,ee),g(s,B),x(J,s,null),g(s,q),x(Q,s,null),g(s,X),g(s,ne),g(s,W),x(he,s,null),g(s,Pe),g(s,me),x(Ae,me,null),g(me,Dt),xe=!0,Te||(Ze=[F(t,"click",x4),F(e,"click",r[24]),F(me,"click",r[32])],Te=!0);},p(Ne,ot){(!xe||ot[0]&1024&&!ht(t.src,n=Ne[10].imageUrl))&&_(t,"src",n),(!xe||ot[0]&1024&&i!==(i=Ne[10].name))&&_(t,"alt",i),(!xe||ot[0]&1024)&&l!==(l=Ne[10].name+"")&&K(u,l),(!xe||ot[0]&1024)&&m!==(m=Ne[10].author+"")&&K(b,m),(!xe||ot[0]&1024)&&S!==(S=new Date(Number(Ne[10].createdAt)).toLocaleString()+"")&&K(R,S);},i(Ne){xe||(T(O.$$.fragment,Ne),T($.$$.fragment,Ne),T(N.$$.fragment,Ne),T(J.$$.fragment,Ne),T(Q.$$.fragment,Ne),T(he.$$.fragment,Ne),T(Ae.$$.fragment,Ne),xe=!0);},o(Ne){M(O.$$.fragment,Ne),M($.$$.fragment,Ne),M(N.$$.fragment,Ne),M(J.$$.fragment,Ne),M(Q.$$.fragment,Ne),M(he.$$.fragment,Ne),M(Ae.$$.fragment,Ne),xe=!1;},d(Ne){Ne&&(A(e),A(o),A(s)),Z(O),Z($),Z(N),Z(J),Z(Q),Z(he),Z(Ae),Te=!1,Je(Ze);}}}c(uk,"create_if_block$C");function U4(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne=r[1]+1+"",W,he,Pe,me,Ae,Dt,xe,Te,Ze;function Ne(Ge){r[18](Ge);}c(Ne,"checkbox0_checked_binding");let ot={description:"Only private lobbies"};r[5]!==void 0&&(ot.checked=r[5]),P=new It({props:ot}),Ve.push(()=>bt(P,"checked",Ne));function Pt(Ge){r[19](Ge);}c(Pt,"checkbox1_checked_binding");let Ue={description:"Only own drawings"};r[6]!==void 0&&(Ue.checked=r[6]),z=new It({props:Ue}),Ve.push(()=>bt(z,"checked",Pt));let Xe=r[2]!==null&&ak(r);J=new st({props:{icon:"file-img-arrow-left-gif",name:"Previous",size:"2rem",hoverMove:!1,disabled:r[1]<=0}}),J.$on("click",r[21]),Pe=new st({props:{icon:"file-img-arrow-right-gif",name:"Next",size:"2rem",hoverMove:!1}}),Pe.$on("click",r[22]);let nt=r[2]!==null&&r[11]!==null&&lk(r),Fe=r[10]!==null&&uk(r);return {c(){e=v("div"),t=v("div"),n=v("h3"),n.textContent="Filter Cloud",i=C(),o=v("span"),o.textContent="Artist Name",s=C(),a=v("input"),l=C(),u=v("span"),u.textContent="Image Name",d=C(),h=v("input"),p=C(),m=v("span"),m.textContent="Created Before",b=C(),y=v("input"),w=C(),I=v("span"),I.textContent="Created After",S=C(),R=v("input"),E=C(),V(P.$$.fragment),O=C(),V(z.$$.fragment),U=C(),N=v("br"),Y=C(),Xe&&Xe.c(),ee=C(),B=v("div"),V(J.$$.fragment),q=C(),Q=v("span"),X=G("Page "),W=G(ne),he=C(),V(Pe.$$.fragment),me=C(),Ae=v("div"),nt&&nt.c(),Dt=C(),Fe&&Fe.c(),_(n,"class","svelte-skb05m"),_(o,"class","svelte-skb05m"),_(a,"type","text"),_(a,"placeholder","Filter exact artist name"),_(a,"class","svelte-skb05m"),_(u,"class","svelte-skb05m"),_(h,"type","text"),_(h,"placeholder","Filter exact image title"),_(h,"class","svelte-skb05m"),_(m,"class","svelte-skb05m"),_(y,"type","datetime-local"),_(y,"class","svelte-skb05m"),_(I,"class","svelte-skb05m"),_(R,"type","datetime-local"),_(R,"class","svelte-skb05m"),_(N,"class","svelte-skb05m"),_(Q,"class","svelte-skb05m"),_(B,"class","navigate-page svelte-skb05m"),_(t,"class","gallery-sidebar svelte-skb05m"),ue(t,"present",r[10]!==null),_(Ae,"class","gallery-results svelte-skb05m"),ue(Ae,"present",r[10]!==null),_(e,"class","typo-gallery-grid color-scrollbar svelte-skb05m");},m(Ge,at){k(Ge,e,at),g(e,t),g(t,n),g(t,i),g(t,o),g(t,s),g(t,a),de(a,r[3]),g(t,l),g(t,u),g(t,d),g(t,h),de(h,r[4]),g(t,p),g(t,m),g(t,b),g(t,y),de(y,r[7]),g(t,w),g(t,I),g(t,S),g(t,R),de(R,r[8]),g(t,E),x(P,t,null),g(t,O),x(z,t,null),g(t,U),g(t,N),g(t,Y),Xe&&Xe.m(t,null),g(t,ee),g(t,B),x(J,B,null),g(B,q),g(B,Q),g(Q,X),g(Q,W),g(B,he),x(Pe,B,null),g(e,me),g(e,Ae),nt&&nt.m(Ae,null),g(e,Dt),Fe&&Fe.m(e,null),xe=!0,Te||(Ze=[F(a,"input",r[14]),F(h,"input",r[15]),F(y,"input",r[16]),F(R,"input",r[17])],Te=!0);},p(Ge,at){at[0]&8&&a.value!==Ge[3]&&de(a,Ge[3]),at[0]&16&&h.value!==Ge[4]&&de(h,Ge[4]),at[0]&128&&de(y,Ge[7]),at[0]&256&&de(R,Ge[8]);const Mn={};!L&&at[0]&32&&(L=!0,Mn.checked=Ge[5],gt(()=>L=!1)),P.$set(Mn);const Ct={};!$&&at[0]&64&&($=!0,Ct.checked=Ge[6],gt(()=>$=!1)),z.$set(Ct),Ge[2]!==null?Xe?(Xe.p(Ge,at),at[0]&4&&T(Xe,1)):(Xe=ak(Ge),Xe.c(),T(Xe,1),Xe.m(t,ee)):Xe&&(fe(),M(Xe,1,1,()=>{Xe=null;}),pe());const Qt={};at[0]&2&&(Qt.disabled=Ge[1]<=0),J.$set(Qt),(!xe||at[0]&2)&&ne!==(ne=Ge[1]+1+"")&&K(W,ne),(!xe||at[0]&1024)&&ue(t,"present",Ge[10]!==null),Ge[2]!==null&&Ge[11]!==null?nt?(nt.p(Ge,at),at[0]&2052&&T(nt,1)):(nt=lk(Ge),nt.c(),T(nt,1),nt.m(Ae,null)):nt&&(fe(),M(nt,1,1,()=>{nt=null;}),pe()),(!xe||at[0]&1024)&&ue(Ae,"present",Ge[10]!==null),Ge[10]!==null?Fe?(Fe.p(Ge,at),at[0]&1024&&T(Fe,1)):(Fe=uk(Ge),Fe.c(),T(Fe,1),Fe.m(e,null)):Fe&&(fe(),M(Fe,1,1,()=>{Fe=null;}),pe());},i(Ge){xe||(T(P.$$.fragment,Ge),T(z.$$.fragment,Ge),T(Xe),T(J.$$.fragment,Ge),T(Pe.$$.fragment,Ge),T(nt),T(Fe),xe=!0);},o(Ge){M(P.$$.fragment,Ge),M(z.$$.fragment,Ge),M(Xe),M(J.$$.fragment,Ge),M(Pe.$$.fragment,Ge),M(nt),M(Fe),xe=!1;},d(Ge){Ge&&A(e),Z(P),Z(z),Xe&&Xe.d(),Z(J),Z(Pe),nt&&nt.d(),Fe&&Fe.d(),Te=!1,Je(Ze);}}}c(U4,"create_fragment$1n");const B4=200,x4=c(r=>r.stopImmediatePropagation(),"click_handler_5");function Z4(r,e,t){let n,{feature:i}=e;const o=i.memberStore;De(r,o,W=>t(2,n=W));let s=0,a="",l="",u=!1,d=!1,h=new Date,p=new Date(new Date().setFullYear(2020,9,1)),m=[];const b=c((W,he=!1)=>(he&&t(1,s=0),i.getImages({page:s,pageSize:B4,authorQuery:a,titleQuery:l,isOwnQuery:d,createdInPrivateLobbyQuery:u,createdAfterQuery:p!==""?new Date(p).getTime().toString():void 0,createdBeforeQuery:h!==""?new Date(h).getTime().toString():void 0},W)),"search");let y=null,w=n?b(Number(n.userLogin)):null;function I(){a=this.value,t(3,a);}c(I,"input0_input_handler");function S(){l=this.value,t(4,l);}c(S,"input1_input_handler");function R(){h=this.value,t(7,h);}c(R,"input2_input_handler");function E(){p=this.value,t(8,p);}c(E,"input3_input_handler");function P(W){u=W,t(5,u);}c(P,"checkbox0_checked_binding");function L(W){d=W,t(6,d);}c(L,"checkbox1_checked_binding");const O=c(()=>t(11,w=b(Number(n==null?void 0:n.userLogin),!0)),"click_handler_1"),z=c(()=>t(1,s--,s),"click_handler_2"),$=c(()=>t(1,s++,s),"click_handler_3"),U=c(W=>t(10,y=W),"click_handler_4"),N=c(()=>t(10,y=null),"click_handler_6"),Y=c(async()=>{if(n==null||y===null)throw new Error("illegal state");await i.saveAsPng(y);},"click_handler_7"),ee=c(async()=>{if(n==null||y===null)throw new Error("illegal state");await i.saveAsGif(y);},"click_handler_8"),B=c(async()=>{if(n==null||y===null)throw new Error("illegal state");await i.copyToClipboard(y);},"click_handler_9"),J=c(async()=>{if(n==null||y===null)throw new Error("illegal state");await i.addToImagePost(y,n);},"click_handler_10"),q=c(async()=>{if(n==null||y===null)throw new Error("illegal state");await i.addToImageLab(y);},"click_handler_11"),Q=c(async()=>{if(n==null||y===null)throw new Error("illegal state");await i.deleteImage(y.id,Number(n.userLogin)),t(9,m=[...m,y.id]),t(10,y=null);},"click_handler_12");function X(W){_h.call(this,r,W);}c(X,"click_handler");const ne=c(()=>t(10,y=null),"click_handler_13");return r.$$set=W=>{"feature"in W&&t(0,i=W.feature);},r.$$.update=()=>{r.$$.dirty[0]&6&&t(11,w=n?b(Number(n.userLogin)):null);},[i,s,n,a,l,u,d,h,p,m,y,w,o,b,I,S,R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne]}c(Z4,"instance$1f");const q_=class q_ extends se{constructor(e){super(),le(this,e,Z4,U4,re,{feature:0},null,[-1,-1]);}};c(q_,"Controls_cloud");let Rp=q_;var V4=Object.defineProperty,_r=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&V4(e,t,i),i},"__decorateClass$X");const K_=class K_ extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_modalService");f(this,"_memberService");f(this,"_cloudService");f(this,"_imagePostService");f(this,"_imageLabService");f(this,"_toastService");f(this,"_apiService");f(this,"_imageFinishedService");f(this,"name","Typo Cloud");f(this,"description","Saves all images from your lobbies in a cloud and adds a gallery to browse them");f(this,"tags",[ye.PALANTIR]);f(this,"featureId",17);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_cloudSavedSubscription");}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.controls,props:{hoverMove:!1,size:"48px",icon:"file-img-cloud-gif",name:"Typo Cloud",order:2,tooltipAction:this.createTooltip}}),this._cloudSavedSubscription=this._imageFinishedService.imageFinished$.pipe(Oe(this._memberService.member$)).subscribe(async([n,i])=>{if(n===null||i===null||i===void 0){this._logger.debug("Did not save image because either member or image not defined");return}await this._cloudService.uploadToCloud(n,i,!0);}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{const n={componentType:Rp,props:{feature:this}};this._modalService.showModal(n.componentType,n.props,"Typo Cloud");});}onDestroy(){var t,n,i;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy(),(i=this._cloudSavedSubscription)==null||i.unsubscribe();}get memberStore(){return it(this._memberService.member$,void 0)}async getImages(t,n){return t.authorQuery===""&&(t.authorQuery=void 0),t.titleQuery===""&&(t.titleQuery=void 0),t.createdInPrivateLobbyQuery===!1&&(t.createdInPrivateLobbyQuery=void 0),t.isOwnQuery===!1&&(t.isOwnQuery=void 0),this._apiService.getApi(su).searchUserCloud({login:n,cloudSearchDto:t})}async deleteImage(t,n){const i=await this._toastService.showLoadingToast("Removing image from cloud");try{const o=await this._apiService.getApi(su).deleteImageFromUserCloud({login:n,id:t});return i.resolve(),o}catch{i.reject();}}async addToImagePost(t,n){const i=await this._toastService.showLoadingToast("Adding image to history");try{const o=await G4(t.metaUrl),s=await wf(t.commandsUrl),a=await hl.fromImageUrl(t.imageUrl),l={name:t.name,artist:t.author,private:o.private,isOwn:o.own,language:o.language,player:n.userName,date:new Date(o.date),commands:s,image:a};this._imagePostService.addToHistory(l),i.resolve();}catch{i.reject();}}async saveAsPng(t){const n=await this._toastService.showLoadingToast("Downloading image");try{const i=await hl.fromImageUrl(t.imageUrl);fl(i.blob,`skribbl-${t.name}-by-${t.author}.png`),n.resolve();}catch(i){throw this._logger.error("Failed to download image",i),n.reject(),i}}async saveAsGif(t){const n=await this._toastService.showStickyToast("Saving as GIF"),o=await(await this._toastService.showPromptToast("Enter GIF duration","Enter the preferred duration in seconds")).result,s=parseFloat(o??"")*1e3;if(o===null){n.close();return}if(Number.isNaN(s)){n.resolve("Invalid duration entered");return}try{const a=await wf(t.commandsUrl),l=c(m=>{const b="",y="",I=Math.floor(m*10),S=10-I;return `${b.repeat(I)}${y.repeat(S)}`},"progressBar"),u=new Blob([wE],{type:"application/javascript"}),d=new xd(URL.createObjectURL(u),{frameRendered:c((m,b)=>{n.update(`Rendering GIF..   ${l(m/b)} (${Math.floor(m*100/b).toString().padStart(2," ")}%)`);},"frameRendered")}),h=`${t.name}-by-${t.author}`,p=await d.run("renderGif",a,s);if(p instanceof Error){this._logger.error("Failed to render gif",p),n.resolve("Failed to render GIF: "+p.message);return}fl(p,`${h}.gif`.replaceAll(" ","_")),n.resolve(`${h} saved as GIF`);}catch(a){throw this._logger.error("Failed to download image",a),n.resolve("An error occurred"),a}}async copyToClipboard(t){const n=await this._toastService.showLoadingToast("Copying image link");try{await navigator.clipboard.writeText(t.imageUrl),n.resolve();}catch(i){throw this._logger.error("Failed to copy image link to clipboard",i),n.reject(),i}}async addToImageLab(t){const n=await this._toastService.showLoadingToast("Adding image to image lab");try{const i=await wf(t.commandsUrl);this._imageLabService.saveDrawCommands(`${t.name}-by-${t.author}`,i),n.resolve();}catch{n.reject("Is the image lab feature enabled?");}}};c(K_,"ControlsCloudFeature");let Fn=K_;_r([D(Me)],Fn.prototype,"_elementsSetup");_r([D(Dn)],Fn.prototype,"_modalService");_r([D(Sn)],Fn.prototype,"_memberService");_r([D(co)],Fn.prototype,"_cloudService");_r([D(du)],Fn.prototype,"_imagePostService");_r([D(uu)],Fn.prototype,"_imageLabService");_r([D(ft)],Fn.prototype,"_toastService");_r([D(mi)],Fn.prototype,"_apiService");_r([D(lo)],Fn.prototype,"_imageFinishedService");var J4=Object.defineProperty,F4=Object.getOwnPropertyDescriptor,W4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?F4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&J4(e,t,i),i},"__decorateClass$W"),H4=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$7"),Da;let uo=(Da=class{constructor(e){f(this,"_logger");f(this,"_features",[]);f(this,"_featureStates",new be);this._logger=e(this);}async registerFeature(e){if(this.features.some(t=>t.featureId===e.featureId))throw this._logger.error("Attempted to register a feature with a duplicate ID",e.name),new Error("Duplicate feature ID");this._features.push(e),e.activated$.subscribe(t=>this._featureStates.next({feature:e,running:t}));}get features(){return [...this._features]}async activateFeature(e){const t=this._features.find(n=>n instanceof e);if(!t)throw this._logger.error("Attempted to activate a feature that is not registered",t),new Error("Feature not registered");return t.activate()}},c(Da,"FeaturesService"),Da);uo=W4([we(),H4(0,D(rt))],uo);const gb=Object.freeze({"--COLOR_PANEL_BG":[226,85,32,.75],"--COLOR_PANEL_LO":[226,90,27,.75],"--COLOR_PANEL_BUTTON":[226,67,49],"--COLOR_PANEL_BUTTON_HOVER":[226,73,43],"--COLOR_PANEL_BUTTON_ACTIVE":[226,72,41],"--COLOR_PANEL_HI":[226,80,44],"--COLOR_PANEL_FOCUS":[32,85,56],"--COLOR_PANEL_BORDER":[232,85,11],"--COLOR_PANEL_BORDER_FOCUS":[207,98,66],"--COLOR_PANEL_TEXT":[0,0,94],"--COLOR_PANEL_TEXT_FOCUS":[0,0,100],"--COLOR_PANEL_TEXT_PLACEHOLDER":[0,0,61],"--COLOR_TOOL_BASE":[0,0,100],"--COLOR_TOOL_HOVER":[0,0,77],"--COLOR_TOOL_TEXT":[0,0,0],"--COLOR_TOOL_SIZE_BASE":[0,0,100],"--COLOR_TOOL_SIZE_HOVER":[0,0,77],"--COLOR_TOOL_ACTIVE":[271,77,66],"--COLOR_TOOL_SIZE_ACTIVE":[271,77,66],"--COLOR_INPUT_BG":[0,0,100],"--COLOR_INPUT_HOVER":[0,0,100],"--COLOR_INPUT_TEXT":[0,0,17],"--COLOR_INPUT_BORDER":[0,0,44],"--COLOR_INPUT_BORDER_FOCUS":[207,98,66],"--COLOR_PLAYER_TEXT_BASE":[0,0,0],"--COLOR_PLAYER_ME":[214,100,64],"--COLOR_PLAYER_ME_GUESSED":[216,100,35],"--COLOR_PLAYER_BG_BASE":[0,0,100],"--COLOR_PLAYER_BG_ALT":[0,0,93],"--COLOR_PLAYER_BG_GUESSED_BASE":[113,68,58],"--COLOR_PLAYER_BG_GUESSED_ALT":[113,57,50],"--COLOR_TOOL_TIP_BG":[226,100,64],"--COLOR_GAMEBAR_TEXT":[0,0,0],"--COLOR_GAMEBAR_ROUND_TEXT":[0,0,0],"--COLOR_GAMEBAR_WORD_DESCRIPTION":[0,0,21],"--COLOR_TEXT_CANVAS_TRANSPARENT":[0,0,25],"--COLOR_CHAT_TEXT_BASE":[0,0,0],"--COLOR_CHAT_TEXT_GUESSED":[103,68,48],"--COLOR_CHAT_TEXT_CLOSE":[54,100,44],"--COLOR_CHAT_TEXT_DRAWING":[216,60,52],"--COLOR_CHAT_TEXT_JOIN":[103,68,48],"--COLOR_CHAT_TEXT_LEAVE":[21,91,42],"--COLOR_CHAT_TEXT_OWNER":[32,100,63],"--COLOR_CHAT_TEXT_GUESSCHAT":[86,47,46],"--COLOR_CHAT_BG_BASE":[0,0,100],"--COLOR_CHAT_BG_ALT":[0,0,93],"--COLOR_CHAT_SCROLLBAR":[0,0,49],"--COLOR_CHAT_SCROLLBAR_THUMB":[0,0,78],"--COLOR_CHAT_BG_GUESSED_BASE":[105,100,94],"--COLOR_CHAT_BG_GUESSED_ALT":[104,100,87],"--COLOR_CHAT_INPUT_COUNT":[0,0,0],"--COLOR_BUTTON_DANGER_BG":[44,81,51],"--COLOR_BUTTON_SUBMIT_BG":[110,75,55],"--COLOR_BUTTON_NORMAL_BG":[208,80,54],"--COLOR_BUTTON_DANGER_TEXT":[0,0,100],"--COLOR_BUTTON_SUBMIT_TEXT":[0,0,100],"--COLOR_BUTTON_NORMAL_TEXT":[0,0,100]}),Sf=c((r,e,t)=>{const n=new Date;return {meta:{author:r,created:n.getTime(),id:t===void 0?n.getTime():t,name:e??`Untitled Theme ${n.getTime()}`,type:"theme"},colors:structuredClone(gb),hooks:{},images:{},misc:{}}},"createEmptyTheme");function Q4(r,e){e.images.urlLogo=r.urlLogo,e.images.urlBackground=r.urlBackground,e.images.urlBackgroundGame=r.urlBackgroundGame,e.misc.fontStyle=r.fontStyle,e.misc.htmlText=r.injection;let t="";if(r.containerBackgroundsCheck==!0){const s=r.containerBackgrounds?r.containerBackgrounds.trim():"";t+=":root {--COLOR_PANEL_BUTTON: "+(s!=""?s:"transparent")+" !important}",t+="#setting-bar .content, #emojiPrev, #imageAgent, #home .news ::-webkit-scrollbar, #home .news ::-webkit-scrollbar-thumb, .modalContainer, .toast, #modal .box, #home .panel, #home .bottom .footer {background-color: "+(s!=""?s:"transparent")+" !important}",t+="#home .bottom svg {fill: "+(s!=""?s:"transparent")+" !important}";}if(r.containerBackgroundsCheck==!0&&r.ingameContainerBackgroundsCheck!==!1&&(r.ingameContainerBackgrounds=r.containerBackgrounds,r.ingameContainerBackgroundsCheck=!0),r.ingameContainerBackgroundsCheck==!0){const s=r.ingameContainerBackgrounds?r.ingameContainerBackgrounds.trim():"";t+="#game-bar, .clickable,  #game-room .settings, #game-room .players,   .tooltip .tooltip-content, #imageAgent, #gamemodePopup, #optionsPopup, #downloadPopup, #sharePopup, #typoUserInfo, #imageOptions, div#game-toolbar.typomod div.tools-container div.tools div.tool, #game-toolbar divdiv.preview div.graphic-container, #game-room .container-settings, #game-chat .container, #game-players .players-list .player, #game-players .players-list .player.odd {background-color: "+(s!=""?s:"transparent")+" !important}",t+="#game-players .players-list .player.odd{background-image: linear-gradient(0, "+(s!=""?s:"transparent")+", "+(s!=""?s:"transparent")+");}",t+="#game-chat .chat-content {background:none}",t+=":root{ --COLOR_TOOL_TIP_BG: "+s+" !important; --COLOR_CHAT_BG_BASE: "+s+" !important; } ",t+="#game-players div.list div.player div.bubble div.arrow{border-right-color:"+s+"} #game-players div.list div.player div.bubble div.content{background-color:"+s+"}",t+="#game-chat .chat-content p:nth-child(even), #game-chat .chat-content p.guessed:nth-child(even) {background-color: #ffffff20;} #game-chat .chat-content p.guessed:nth-child(odd){background-color:transparent}";}if(r.containerOutlinesCheck==!0){const s=r.containerOutlines?r.containerOutlines.trim():"";t+="#game-bar,  #game-room .settings, #game-room .players,   #imageAgent, #modal .box, #home .panel, .modalContainer, #game-chat, #game-players .players-list .player, #imageOptions {border-radius: 4px; border: 2px solid "+(s!=""?s:"transparent")+" !important}";}r.containerImages&&r.containerImages.trim()!=""&&(t+="#game-bar, #game-room .settings, #game-room .players,  #imageAgent, #gamemodePopup, #optionsPopup, #downloadPopup, #sharePopup, #typoUserInfo, #imageOptions, #game-room .container-settings, #game-chat, #game-players .players-list  {background-image: url("+r.containerImages.trim()+") !important}",t+="#game-players .players-list {background:none !important}");const n=r.fontColor?r.fontColor:"";n&&n!=""&&(t+="#home .bottom .footer .notice, *:not(.chat-content *), .characters {color:"+n.trim()+" !important}",t+="input[type=checkbox].flatUI, #game-chat form input, input[type=text].flatUI, #home .bottom .footer .section-container .section{color:unset}"),!r.ingameFontColor&&r.fontColor&&(r.ingameFontColor=r.fontColor);const i=r.ingameFontColor?r.ingameFontColor:"";i&&i!=""&&(t+=":root{ --COLOR_CHAT_TEXT_BASE:"+i.trim()+" !important}",t+="#game *:not(.chat-content *) {color:"+i.trim()+"}",t+="div#game-toolbar.typomod div.tools-container div.tools div.tool div.key, #game-word .description, #game-round .round-max, #game-round span, #game-players .player-amount b:nth-child(4), #game-players .player-amount span {color:"+i.trim()+"; filter: brightness(0.8);}");const o=r.fontColorButtons?r.fontColorButtons:"";if(o&&o!=""&&(t+="select, input, button, textarea {color:"+o.trim()+"}"),(i||n||o)&&(t+="#game-clock{color:black !important}"),r.inputBackgroundsCheck==!0){const s=r.inputBackgrounds?r.inputBackgrounds.trim():"";t+="input[type=checkbox], input[type=checkbox].flatUI,#modal .container .box .content .container-rooms .room, button.flatUI.green,button.flatUI.orange, button.flatUI.blue, button.flatUI, input[type=text].flatUI, .link .input-container .link-overlay, input, textarea, button, select, #quickreact > span {background: "+(s!=""?s:"transparent")+" !important; box-shadow:none !important;} ",t+="button:is(.flatUI, .flatUI.green, .flatUI.orange, .flatUI.blue):is(:hover, :active, :focus), input:is(:hover, :active, :focus), textarea:is(:hover, :active, :focus), button:is(:hover, :active, :focus), select:is(:hover, :active, :focus) {background: "+(s!=""?s:"transparent")+" !important; opacity: 0.75}",t+=":is(#game-room .container-settings .group.customwords .checkbox, .report-menu) input[type=checkbox]:checked:after { content: ''; height:100%; width: 100%; display: grid; place-content: center;}";}if(r.inputOutlinesCheck==!0){const s=r.inputOutlines?r.inputOutlines.trim():"";t+=".link .input-container .link-overlay {display:none !important} input[type=checkbox]{border:none !important;} input, textarea, button, select {border: 2px solid "+(s!=""?s:"transparent")+" !important; }";}r.hideFooter==!0&&(t+=".tos, .notice {display:none}"),r.hideTypoInfo==!0&&(t+="#typoUserInfo {display:none !important}"),r.hideDiscord==!0&&(t+="#home .socials {opacity:0}"),r.hideInGameLogo==!0&&(t+="#game #game-logo{display:none} #game{margin-top:2em}"),r.hideAvatarLogo==!0&&(t+="#home .logo-big .avatar-container {display:none }"),r.hideTypoPanels==!0&&(t+="#panelgrid .panel:is(:first-child, :last-child) {display:none } #panelgrid{grid-template-columns: 100% !important}"),r.hideAvatarSprites==!0&&(t+=".avatar-customizer .spriteSlot{display:none }",t+=".avatar-customizer {background-image: unset !important }",t+=".avatar-customizer .color, .avatar-customizer .mouth, .avatar-customizer .eyes {opacity: 1 !important}"),e.misc.cssText=t;}c(Q4,"convertOldTheme");var X4=Object.defineProperty,q4=Object.getOwnPropertyDescriptor,K4=c((r,e,t,n)=>{for(var i=n>1?void 0:n?q4(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&X4(e,t,i),i},"__decorateClass$V"),Af=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$6"),Ea;let Zd=(Ea=class{constructor(e,t,n){f(this,"_logger");f(this,"_originalTheme",Sf("Mel","Original Skribbl",0));f(this,"_activeThemeSetting",new dt("active_theme_local_id",void 0));f(this,"_savedThemesSetting",new dt("saved_themes",[{theme:this._originalTheme,savedAt:Date.now(),enableManage:!1}]));f(this,"_loadedEditorTheme$",new Le(void 0));this._elementsSetup=t,this._apiService=n,this._logger=e(this);}get activeThemeSetting(){return this._activeThemeSetting.asFrozen}get savedThemesSetting(){return this._savedThemesSetting.asFrozen}get loadedEditorTheme$(){return this._loadedEditorTheme$.asObservable()}get loadedEditorThemeStore(){return it(this._loadedEditorTheme$,this._loadedEditorTheme$.value)}async loadThemeToEditor(e){if(this._logger.info("Loading theme to editor",e),(await this._savedThemesSetting.getValue()).find(i=>i.theme.meta.id===e.theme.meta.id)===void 0)throw this._logger.error("Theme not found",e),new Error("Theme not found");this._loadedEditorTheme$.next(structuredClone(e));}updateLoadedEditorTheme(e){var t;if(this._logger.debug("Updating loaded theme",e),((t=this._loadedEditorTheme$.value)==null?void 0:t.theme.meta.id)!==e.theme.meta.id)throw this._logger.error("Theme not loaded or different theme loaded",e),new Error("Theme not loaded or different theme loaded");this._loadedEditorTheme$.next(structuredClone(e));}async unloadThemeFromEditor(){this._logger.info("Unloading theme from editor"),this._loadedEditorTheme$.next(void 0);}async createLocalTheme(){this._logger.info("Creating new theme");const e=await this._elementsSetup.complete(),t=e.inputName.value.length>0?e.inputName.value:"User",n=Sf(t,"Untitled Theme"),i=await this._savedThemesSetting.getValue(),o={theme:n,savedAt:Date.now(),enableManage:!0};return await this._savedThemesSetting.setValue([o,...i]),o}async saveLoadedEditorTheme(){this._logger.info("Updating local theme and unloading from editor");const e=this._loadedEditorTheme$.value,t=await this._savedThemesSetting.getValue(),n=t.find(i=>i.theme.meta.id===(e==null?void 0:e.theme.meta.id));if(e===void 0||n===void 0)throw this._logger.error("Theme to update not found",e),new Error("Theme to update not found");return n.theme=e.theme,n.savedAt=Date.now(),await this._savedThemesSetting.setValue([n,...t.filter(i=>i.theme.meta.id!==n.theme.meta.id)]),this._loadedEditorTheme$.next(void 0),await this._activeThemeSetting.setValue(n.theme.meta.id),n}async importOldTheme(e,t){this._logger.info("Importing old theme",e);const n=Sf("Unknown",t);Q4(e,n);const i=await this._savedThemesSetting.getValue();i.find(a=>a.theme.meta.id===n.meta.id)!==void 0&&(this._logger.warn("Theme already exists, assigning new ID",n),n.meta.id=Date.now());const s={theme:n,savedAt:Date.now(),publicTheme:void 0,enableManage:!0};return await this._savedThemesSetting.setValue([s,...i]),s}async importThemeFromString(e){const t=JSON.parse(e);if(typeof t!="object"||t===null)throw new Error("Invalid theme data");const n={theme:t,savedAt:Date.now(),publicTheme:void 0,enableManage:!0},i=await this._savedThemesSetting.getValue();return i.find(s=>s.theme.meta.id===t.meta.id)!==void 0&&(this._logger.warn("Theme already exists, assigning new ID",t),t.meta.id=Date.now()),await this._savedThemesSetting.setValue([n,...i]),n}async savePublicTheme(e){this._logger.info("Saving public theme",e);const t=await this._apiService.getApi(ss).useThemeById({id:e.id}),n={theme:t,savedAt:Date.now(),publicTheme:{publicId:e.id,localVersion:e.version},enableManage:!1};let i=await this._savedThemesSetting.getValue();const o=i.find(s=>s.theme.meta.id===t.meta.id);return o!==void 0?(this._logger.warn("Theme already saved",e),o):(i=[n,...i],await this._savedThemesSetting.setValue(i),n)}async activateLocalTheme(e){this._logger.info("Activating local theme",e);const n=(await this._savedThemesSetting.getValue()).find(i=>i.theme.meta.id===e);if(n===void 0)throw this._logger.warn("Local Theme not found",e),new Error("Local Theme not found");return this._loadedEditorTheme$.next(void 0),await this._activeThemeSetting.setValue(n.theme.meta.id),n}async activatePublicTheme(e){this._logger.debug("Getting saved theme of public listing",e);const n=(await this._savedThemesSetting.getValue()).find(i=>{var o;return ((o=i.publicTheme)==null?void 0:o.publicId)===e.id});if(n===void 0)throw this._logger.error("Theme not found",e),new Error("Theme not found");return this._loadedEditorTheme$.next(void 0),await this._activeThemeSetting.setValue(n.theme.meta.id),n}async removeSavedTheme(e){var o;this._logger.info("Removing saved theme",e);const t=await this._savedThemesSetting.getValue(),n=t.find(s=>s.theme.meta.id===e);if(n===void 0)throw this._logger.error("Theme not found",e),new Error("Theme not found");const i=t.filter(s=>s.theme.meta.id!==e);return await this._savedThemesSetting.setValue(i),((o=this._loadedEditorTheme$.value)==null?void 0:o.theme.meta.id)===e&&this._loadedEditorTheme$.next(void 0),n}async shareTheme(e){this._logger.debug("Sharing theme",e);const t=await this._apiService.getApi(ss).shareTheme({themeDto:e}),n=t.id;return this._logger.info("created theme share id:",t.id),n}async importTheme(e){this._logger.debug("Importing theme",e);const t=await this._apiService.getApi(ss).getThemeById({id:e});this._logger.info("Loaded theme",t);const n=await this._savedThemesSetting.getValue();n.find(s=>s.theme.meta.id===t.meta.id)!==void 0&&(this._logger.warn("Theme already exists, assigning new ID",t),t.meta.id=Date.now());const o={theme:t,savedAt:Date.now(),publicTheme:void 0,enableManage:!0};return await this._savedThemesSetting.setValue([o,...n]),o}},c(Ea,"ThemesService"),Ea);Zd=K4([we(),Af(0,D(rt)),Af(1,D(Me)),Af(2,D(mi))],Zd);const eG=c((r,e)=>{var s;const n=new DOMParser().parseFromString(`<style>${r}</style>`,"text/html").querySelector("style"),i=(s=n==null?void 0:n.sheet)==null?void 0:s.cssRules;if(i==null)throw new Error("Failed to parse css rules");const o={};e.forEach(a=>{o[a]=[];});for(const a of i)if(a instanceof CSSStyleRule)for(const l in a.style){const u=a.style.getPropertyValue(l);e.forEach(d=>{u.includes(`var(${d}`)&&o[d].push(a.selectorText);});}return o},"getCssVariableSelectorHooks");var tG=Object.defineProperty,nG=Object.getOwnPropertyDescriptor,iG=c((r,e,t,n)=>{for(var i=n>1?void 0:n?nG(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&tG(e,t,i),i},"__decorateClass$U"),Ma;let Vd=(Ma=class extends un{async runSetup(){const e=await(await fetch("/css/style.css")).text();return eG(e,Object.keys(gb))}},c(Ma,"CssColorVarSelectorsSetup"),Ma);Vd=iG([Do()],Vd);const rG=c((r,e,t,n,i)=>{const o=structuredClone(gb),s=226,a=85,l=32,u=.75;if(r){const d=r.hsl,h=d[0],p=d[1],m=d[2],b=["--COLOR_PANEL_BG","--COLOR_PANEL_LO","--COLOR_PANEL_BUTTON","--COLOR_PANEL_BUTTON_HOVER","--COLOR_PANEL_BUTTON_ACTIVE","--COLOR_PANEL_HI","--COLOR_PANEL_FOCUS","--COLOR_PANEL_BORDER","--COLOR_TOOL_TIP_BG"];if(b.forEach(y=>o[y][0]=(o[y][0]-s+h)%360),b.forEach(y=>o[y][1]=o[y][1]*(p/100)),b.forEach(y=>o[y][2]=o[y][2]*(m/100)),o["--COLOR_CHAT_SCROLLBAR"]=[...o["--COLOR_PANEL_LO"]],o["--COLOR_CHAT_SCROLLBAR_THUMB"]=[...o["--COLOR_PANEL_HI"]],t){const y=a*(p/100),w=l*(m/100);o["--COLOR_CHAT_BG_BASE"]=[h,y,w,u],o["--COLOR_CHAT_BG_ALT"]=[h,y,w-7,u],o["--COLOR_PLAYER_BG_BASE"]=[h,y,w,u],o["--COLOR_PLAYER_BG_ALT"]=[h,y,w-7,u];}n&&(o["--COLOR_INPUT_BORDER"]=[h,a,75*(l/100),.4],o["--COLOR_INPUT_BORDER_FOCUS"]=[h,a,85*(l/100),.4],o["--COLOR_INPUT_BG"]=[h,a,80*(l/100),.3],o["--COLOR_INPUT_HOVER"]=[h,a,90*(l/100),.3]);}if(e){const d=e.hsl;[...t?["--COLOR_GAMEBAR_TEXT","--COLOR_GAMEBAR_ROUND_TEXT","--COLOR_PLAYER_TEXT_BASE","--COLOR_CHAT_TEXT_BASE"]:[],...n?["--COLOR_INPUT_TEXT"]:[],"--COLOR_PANEL_TEXT"].forEach(p=>o[p]=[d[0],d[1],d[2],...d[3]?[d[3]]:[]]),n&&(o["--COLOR_PANEL_TEXT_PLACEHOLDER"]=[d[0],d[1],d[2]-50]),t&&(o["--COLOR_GAMEBAR_WORD_DESCRIPTION"]=[d[0],d[1],d[2],.7]),i&&(o["--COLOR_INPUT_TEXT"][2]=100-o["--COLOR_INPUT_TEXT"][2]);}return o},"generateColorScheme"),oG=c(r=>nn(`<div id='typo-theme-background-${r.meta.id}' class="typo-theme-background"></div>`),"generateThemeBackgroundElement"),Mi=c(r=>r!==void 0&&r.trim().length>0,"stringHasContent"),sG=c((r,e)=>{const t=Object.entries(r.colors).map(i=>{const o=i[1],s=o.length==3?`hsl(${o[0]}, ${o[1]}%, ${o[2]}%)`:`hsla(${o[0]}, ${o[1]}%, ${o[2]}%, ${o[3]})`;return `${i[0]}: ${s};`}).join(`
`),n=document.createElement("STYLE");return n.id=`typo-theme-style-${r.meta.id}`,n.innerHTML=`
        :root {${t}}
        body {
            background: none;
        }
        .typo-theme-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: ${r.images.backgroundTint??""};
            z-index: -10;
            pointer-events: none;
            filter: brightness(${!Mi(r.images.urlBackground)&&(r.images.backgroundTint??"transparent")!=="transparent"?4:1});
        }
        .typo-theme-background::after {
            image-rendering: unset;
            content: "";
            position: absolute;
            inset: 0;
            background-position: center;
            background-image: url(${Mi(r.images.urlBackground)?r.images.urlBackground:"/img/background.png"});
            background-repeat: ${!Mi(r.images.urlBackground)||r.images.backgroundRepeat?"repeat":"no-repeat"};
            background-size: ${Mi(r.images.urlBackground)?r.images.backgroundRepeat?"auto":"cover":"350px"};
            mix-blend-mode: ${r.images.backgroundTint=="transparent"||!Mi(r.images.backgroundTint)?"none":"multiply"};
            filter: ${r.images.backgroundTint=="transparent"||!Mi(r.images.backgroundTint)?"none":"saturate(0%)"};
        }
        body:has(#game[style*="display: flex"]) .typo-theme-background${Mi(r.images.urlBackgroundGame)?"":".disabled"}::after {
            background-image: url(${r.images.urlBackgroundGame});
        }

        ${r.misc.hideFooter?".tos, .notice {display:none}":""}
        
        ${r.misc.hideInGameLogo?"#game #game-logo{display:none} #game{margin-top:2em}":""}

        ${r.misc.hideAvatarLogo?"#home .logo-big .avatar-container {display:none }":""}

        ${r.misc.hideSkribblPanels?".bottom .footer .section-container { display: none !important }":""}

        ${Mi(r.images.containerImages)?`
        #game-bar, #game-room .settings, #game-room .players,  #imageAgent, #gamemodePopup, #optionsPopup, #downloadPopup, 
        #sharePopup, #typoUserInfo, #imageOptions, #game-room .container-settings, #game-chat 
        .chat-content, #game-players .players-list  {background-image: url(${r.images.containerImages}) !important}
        #game-players .players-list .player {background:none !important}
        `:""}

        .flatUi.orange, .button-orange {
            background-color: var(--COLOR_BUTTON_DANGER_BG) !important;
            color: var(--COLOR_BUTTON_DANGER_TEXT) !important;
        }
        .flatUI.green, .button-play, #start-game {
            color: var(--COLOR_BUTTON_SUBMIT_TEXT) !important;
            background-color: var(--COLOR_BUTTON_SUBMIT_BG) !important;
        }
        .flatUI.blue, .button-create, .button-blue, #copy-invite {
            background-color: var(--COLOR_BUTTON_NORMAL_BG) !important;
            color: var(--COLOR_BUTTON_NORMAL_TEXT) !important;
        }

        :is(.flatUi.orange, .button-orange):is(:hover, :active, :focus) {
            background-color: var(--COLOR_BUTTON_DANGER_BG) !important;
            color: var(--COLOR_BUTTON_DANGER_TEXT) !important;
            opacity: 0.8;
        }
        :is(.flatUI.green, .button-play, #start-game):is(:hover, :active, :focus) {
            color: var(--COLOR_BUTTON_SUBMIT_TEXT) !important;
            background-color: var(--COLOR_BUTTON_SUBMIT_BG) !important;
            opacity: 0.8;
        }
        :is(.flatUI.blue, .button-create, .button-blue, #copy-invite):is(:hover, :active, :focus) {
            background-color: var(--COLOR_BUTTON_NORMAL_BG) !important;
            color: var(--COLOR_BUTTON_NORMAL_TEXT) !important;
            opacity: 0.8;
        }

        ${Mi(r.misc.fontStyle)?`*{font-family:'${r.misc.fontStyle.trim().split(":")[0].replaceAll("+"," ")}', sans-serif !important}`:""}

        ${Mi(r.images.urlLogo)?`
          div.logo-big a {display: flex; justify-content: center }
          div.logo-big img, div#game-logo img {max-height:20vh; content: url(${r.images.urlLogo}) }
        `:""}

        ${Object.entries(r.hooks?r.hooks:{}).filter(i=>i[1]!=="").map(i=>`${e[i[0]].join(",")}{${i[1]}}`).join(`
`)}

        ::-webkit-scrollbar {
            width: 14px;
            border-radius: 7px;
            background-color: var(--COLOR_PANEL_LO); 
        }
        
        ::-webkit-scrollbar-thumb {
            border-radius: 7px;
            background-color: var(--COLOR_PANEL_HI)
        }

        #game-chat ::-webkit-scrollbar {
            width: 14px;
            border-radius: 7px;
            background-color: var(--COLOR_CHAT_SCROLLBAR); 
        }
        
        #game-chat ::-webkit-scrollbar-thumb {
            border-radius: 7px;
            background-color: var(--COLOR_CHAT_SCROLLBAR_THUMB); 
        }

        ${r.misc.cssText??""}
    
        `,n},"generateStyleElementForTheme"),aG=c(r=>r.misc.themeCssUrl&&r.misc.themeCssUrl.length>0?[nn(`<link id='typo-theme-external-css-${r.meta.id}' rel="stylesheet" href="${r.misc.themeCssUrl}">`)]:[],"generateThemeExternalCssElement"),lG=c(r=>{var e;return r.misc.fontStyle&&r.misc.fontStyle.length>0?[nn(`<link id='typo-theme-font-preconnect-${r.meta.id}' rel="preconnect" href="https://fonts.gstatic.com">`),nn(`<link id='typo-theme-font-style-${r.meta.id}' href="https://fonts.googleapis.com/css2?family=${(e=r.misc.fontStyle)==null?void 0:e.trim()}&display=swap" rel="stylesheet">`)]:[]},"generateThemeFontElements"),cG=c(r=>r.misc.htmlText&&r.misc.htmlText.length>0?[nn(`<div id='typo-theme-html-${r.meta.id}'>${r.misc.htmlText}</div>`)]:[],"generateThemeCustomHtmlElement");function dk(r,e,t){const n=r.slice();return n[14]=e[t],n}c(dk,"get_each_context$A");function uG(r){return {c:j,m:j,p:j,i:j,o:j,d:j}}c(uG,"create_catch_block$3");function dG(r){let e,t,n=te(r[13]),i=[];for(let s=0;s<n.length;s+=1)i[s]=fk(dk(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();_(e,"class","typo-themes-browser-list svelte-17gbclg");},m(s,a){k(s,e,a);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);t=!0;},p(s,a){if(a&15){n=te(s[13]);let l;for(l=0;l<n.length;l+=1){const u=dk(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=fk(u),i[l].c(),T(i[l],1),i[l].m(e,null));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(dG,"create_then_block$3");function hk(r){let e,t,n,i,o,s=r[14].version+"",a,l,u,d,h=r[14].id+"",p;return {c(){e=v("div"),t=C(),n=v("div"),i=v("span"),o=G("v"),a=G(s),l=C(),u=v("span"),d=G("#"),p=G(h),_(e,"class","svelte-17gbclg"),_(i,"class","svelte-17gbclg"),_(u,"class","svelte-17gbclg"),_(n,"class","svelte-17gbclg");},m(m,b){k(m,e,b),k(m,t,b),k(m,n,b),g(n,i),g(i,o),g(i,a),g(n,l),g(n,u),g(u,d),g(u,p);},p(m,b){b&1&&s!==(s=m[14].version+"")&&K(a,s),b&1&&h!==(h=m[14].id+"")&&K(p,h);},d(m){m&&(A(e),A(t),A(n));}}}c(hk,"create_if_block_1$g");function hG(r){let e,t;function n(){return r[12](r[14])}return c(n,"click_handler_1"),e=new ke({props:{content:"Download",color:"blue"}}),e.$on("click",n),{c(){V(e.$$.fragment);},m(i,o){x(e,i,o),t=!0;},p(i,o){r=i;},i(i){t||(T(e.$$.fragment,i),t=!0);},o(i){M(e.$$.fragment,i),t=!1;},d(i){Z(e,i);}}}c(hG,"create_else_block$m");function fG(r){var i,o,s,a;let e,t;function n(){return r[11](r[14])}return c(n,"click_handler"),e=new ke({props:{content:((o=(i=r[2])==null?void 0:i.publicTheme)==null?void 0:o.publicId)===r[14].id?"Active":"Activate",disabled:((a=(s=r[2])==null?void 0:s.publicTheme)==null?void 0:a.publicId)===r[14].id,color:"green"}}),e.$on("click",n),{c(){V(e.$$.fragment);},m(l,u){x(e,l,u),t=!0;},p(l,u){var h,p,m,b;r=l;const d={};u&5&&(d.content=((p=(h=r[2])==null?void 0:h.publicTheme)==null?void 0:p.publicId)===r[14].id?"Active":"Activate"),u&5&&(d.disabled=((b=(m=r[2])==null?void 0:m.publicTheme)==null?void 0:b.publicId)===r[14].id),e.$set(d);},i(l){t||(T(e.$$.fragment,l),t=!0);},o(l){M(e.$$.fragment,l),t=!1;},d(l){Z(e,l);}}}c(fG,"create_if_block$B");function fk(r){let e,t,n=r[14].name+"",i,o,s,a,l=r[14].author+"",u,d,h,p,m,b,y,w,I=r[14].downloads+"",S,R,E,P;function L(...N){return r[10](r[14],...N)}c(L,"func");let O=r[3]&&hk(r);const z=[fG,hG],$=[];function U(N,Y){return Y&3&&(p=null),p==null&&(p=!!N[1].some(L)),p?0:1}return c(U,"select_block_type"),m=U(r,-1),b=$[m]=z[m](r),{c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("div"),a=G("by "),u=G(l),d=C(),O&&O.c(),h=C(),b.c(),y=C(),w=v("div"),S=G(I),R=G(" downloads"),E=C(),_(s,"class","svelte-17gbclg"),_(w,"class","svelte-17gbclg"),_(e,"class","typo-themes-browser-item svelte-17gbclg");},m(N,Y){k(N,e,Y),g(e,t),g(t,i),g(e,o),g(e,s),g(s,a),g(s,u),g(e,d),O&&O.m(e,null),g(e,h),$[m].m(e,null),g(e,y),g(e,w),g(w,S),g(w,R),g(e,E),P=!0;},p(N,Y){r=N,(!P||Y&1)&&n!==(n=r[14].name+"")&&K(i,n),(!P||Y&1)&&l!==(l=r[14].author+"")&&K(u,l),r[3]?O?O.p(r,Y):(O=hk(r),O.c(),O.m(e,h)):O&&(O.d(1),O=null);let ee=m;m=U(r,Y),m===ee?$[m].p(r,Y):(fe(),M($[ee],1,1,()=>{$[ee]=null;}),pe(),b=$[m],b?b.p(r,Y):(b=$[m]=z[m](r),b.c()),T(b,1),b.m(e,y)),(!P||Y&1)&&I!==(I=r[14].downloads+"")&&K(S,I);},i(N){P||(T(b),P=!0);},o(N){M(b),P=!1;},d(N){N&&A(e),O&&O.d(),$[m].d();}}}c(fk,"create_each_block$A");function pG(r){return {c:j,m:j,p:j,i:j,o:j,d:j}}c(pG,"create_pending_block$3");function mG(r){let e,t,n,i,o,s={ctx:r,current:null,token:null,hasCatch:!1,pending:pG,then:dG,catch:uG,value:13,blocks:[,,,]};return $n(i=r[0].getOnlineThemes(),s),{c(){e=v("div"),e.innerHTML=`Here you can discover themes made by other typo users. When you download a theme, it will be activated and saved to your local themes.<br/>
  When a theme receives an update, it will be automatically downloaded.`,t=C(),n=je(),s.block.c(),_(e,"class","typo-themes-browser-header svelte-17gbclg");},m(a,l){k(a,e,l),k(a,t,l),k(a,n,l),s.block.m(a,s.anchor=l),s.mount=()=>n.parentNode,s.anchor=n,o=!0;},p(a,[l]){r=a,s.ctx=r,l&1&&i!==(i=r[0].getOnlineThemes())&&$n(i,s)||To(s,r,l);},i(a){o||(T(s.block),o=!0);},o(a){for(let l=0;l<3;l+=1){const u=s.blocks[l];M(u);}o=!1;},d(a){a&&(A(e),A(t),A(n)),s.block.d(a),s.token=null,s=null;}}}c(mG,"create_fragment$1m");function gG(r,e,t){let n,i,o,s,{feature:a}=e;const l=a.devmodeStore;De(r,l,w=>t(3,s=w));const u=a.savedThemesStore;De(r,u,w=>t(1,i=w));const d=a.activeThemeStore;De(r,d,w=>t(8,n=w));const h=a.loadedEditorThemeStore;De(r,h,w=>t(9,o=w));let p;const m=c((w,I)=>{var S;return ((S=I.publicTheme)==null?void 0:S.publicId)===w.id},"func"),b=c(w=>a.activatePublicTheme(w),"click_handler"),y=c(async w=>{await a.savePublicTheme(w),await a.activatePublicTheme(w);},"click_handler_1");return r.$$set=w=>{"feature"in w&&t(0,a=w.feature);},r.$$.update=()=>{r.$$.dirty&770&&t(2,p=o===void 0?i.find(w=>w.theme.meta.id===n):void 0);},[a,i,p,s,l,u,d,h,n,o,m,b,y]}c(gG,"instance$1e");const ey=class ey extends se{constructor(e){super(),le(this,e,gG,mG,re,{feature:0});}};c(ey,"Themes_browser");let Lp=ey;function pk(r,e,t){const n=r.slice();return n[61]=e[t],n[62]=e,n[63]=t,n}c(pk,"get_each_context$z");function mk(r,e,t){const n=r.slice();return n[61]=e[t],n}c(mk,"get_each_context_1$c");function bG(r){let e,t,n,i=r[2].theme.meta.name+"",o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne,W,he,Pe,me,Ae,Dt,xe,Te,Ze,Ne,ot,Pt,Ue,Xe,nt,Fe,Ge,at,Mn,Ct,Qt,Qn,on,Rn,ci,Zi,Ln,Be,ve,Et,Gt,At,Gu,hn,mt,xl,ie,ge,_e,fn,Vh,I1,Si,T1,jo,Jh,D1,Ai,E1,Go,Fh,M1,ki,R1,L1,P1,$u,$o,Vi,Wh,N1,Zr,O1,j1,G1,Yu,Ji,Hh,$1,Pn,zu,Y1,Qh,z1,Xh,U1,qh,B1,x1,Z1,Uu,Bu,Zl,V1,Nn,xu,J1,Yo,zo,Kh,F1,Ci,W1,Uo,ef,H1,Ii,Q1,X1,q1,Bo,xo,tf,K1,Ti,eS,Zo,nf,tS,Di,nS,iS,rS,Ei,Fi,rf,oS,Wi,of,sS,Hi,sf,aS,Qi,af,lS,On,Zu,cS,lf,uS,cf,dS,uf,hS,fS,pS,Vu,Ju,Vl,Jl,df,mS;u=new ke({props:{content:"Discard & Delete",color:"orange"}}),u.$on("click",r[18]),h=new ke({props:{content:"Discard Changes",color:"blue"}}),h.$on("click",r[19]),m=new ke({props:{content:"Save Theme",color:"green"}}),m.$on("click",r[20]);function YE(ae){r[23](ae);}c(YE,"colorpickerbutton0_color_binding");let gS={};r[3]!==void 0&&(gS.color=r[3]),Ae=new pi({props:gS}),Ve.push(()=>bt(Ae,"color",YE));function zE(ae){r[24](ae);}c(zE,"colorpickerbutton1_color_binding");let bS={};r[4]!==void 0&&(bS.color=r[4]),ot=new pi({props:bS}),Ve.push(()=>bt(ot,"color",zE));function UE(ae){r[25](ae);}c(UE,"checkbox0_checked_binding");let vS={description:"Generate colors for input fields"};r[6]!==void 0&&(vS.checked=r[6]),Ge=new It({props:vS}),Ve.push(()=>bt(Ge,"checked",UE));function BE(ae){r[26](ae);}c(BE,"checkbox1_checked_binding");let _S={description:"Invert text brightness on input fields"};r[7]!==void 0&&(_S.checked=r[7]),Ct=new It({props:_S}),Ve.push(()=>bt(Ct,"checked",BE));function xE(ae){r[27](ae);}c(xE,"checkbox2_checked_binding");let yS={description:"Use theme colors in-game"};r[9]!==void 0&&(yS.checked=r[9]),on=new It({props:yS}),Ve.push(()=>bt(on,"checked",xE)),ve=new ke({props:{content:"Generate Color Scheme",color:"green"}}),ve.$on("click",r[28]);function ZE(ae){r[37](ae);}c(ZE,"checkbox3_checked_binding");let wS={description:"Tint the skribbl background with a color"};r[8]!==void 0&&(wS.checked=r[8]),Vi=new It({props:wS}),Ve.push(()=>bt(Vi,"checked",ZE)),Vi.$on("change",r[38]),Zr=new pi({props:{allowAlpha:!0,colorChanged:r[39]}});function VE(ae){r[40](ae);}c(VE,"checkbox4_checked_binding");let SS={description:"Repeat custom background image"};r[2].theme.images.backgroundRepeat!==void 0&&(SS.checked=r[2].theme.images.backgroundRepeat),Ji=new It({props:SS}),Ve.push(()=>bt(Ji,"checked",VE)),Ji.$on("change",r[41]);let Vr=te(r[11]),Vt=[];for(let ae=0;ae<Vr.length;ae+=1)Vt[ae]=gk(mk(r,Vr,ae));const JE=c(ae=>M(Vt[ae],1,1,()=>{Vt[ae]=null;}),"out");function FE(ae){r[51](ae);}c(FE,"checkbox5_checked_binding");let AS={description:"Hide skribbl footer"};r[2].theme.misc.hideFooter!==void 0&&(AS.checked=r[2].theme.misc.hideFooter),Fi=new It({props:AS}),Ve.push(()=>bt(Fi,"checked",FE)),Fi.$on("change",r[52]);function WE(ae){r[53](ae);}c(WE,"checkbox6_checked_binding");let kS={description:"Hide About, News & How-To Panels"};r[2].theme.misc.hideSkribblPanels!==void 0&&(kS.checked=r[2].theme.misc.hideSkribblPanels),Wi=new It({props:kS}),Ve.push(()=>bt(Wi,"checked",WE)),Wi.$on("change",r[54]);function HE(ae){r[55](ae);}c(HE,"checkbox7_checked_binding");let CS={description:"Hide avatars below skribbl logo"};r[2].theme.misc.hideAvatarLogo!==void 0&&(CS.checked=r[2].theme.misc.hideAvatarLogo),Hi=new It({props:CS}),Ve.push(()=>bt(Hi,"checked",HE)),Hi.$on("change",r[56]);function QE(ae){r[57](ae);}c(QE,"checkbox8_checked_binding");let IS={description:"Hide in-game skribbl logo"};r[2].theme.misc.hideInGameLogo!==void 0&&(IS.checked=r[2].theme.misc.hideInGameLogo),Qi=new It({props:IS}),Ve.push(()=>bt(Qi,"checked",QE)),Qi.$on("change",r[58]);let Vo=te(Object.entries(r[1])),Cn=[];for(let ae=0;ae<Vo.length;ae+=1)Cn[ae]=bk(pk(r,Vo,ae));return {c(){e=v("div"),t=v("h3"),n=G("Editing Theme: "),o=G(i),s=C(),a=v("br"),l=C(),V(u.$$.fragment),d=C(),V(h.$$.fragment),p=C(),V(m.$$.fragment),b=C(),y=v("div"),w=v("div"),I=v("div"),S=v("div"),S.textContent="Theme Name:",R=C(),E=v("input"),P=C(),L=v("div"),O=v("div"),O.textContent="Creator Name:",z=C(),$=v("input"),U=C(),N=v("details"),Y=v("summary"),Y.textContent="Color Scheme",ee=G(`

        Using the color scheme generator, you can easily create a unique color theme for skribbl.`),B=v("br"),J=G(`
        This overwrites all existing color customizations in "Advanced Color Settings".`),q=v("br"),Q=C(),X=v("br"),ne=C(),W=v("div"),he=v("div"),Pe=v("div"),Pe.textContent="Primary Color:",me=C(),V(Ae.$$.fragment),xe=C(),Te=v("div"),Ze=v("div"),Ze.textContent="Text Color:",Ne=C(),V(ot.$$.fragment),Ue=C(),Xe=v("br"),nt=C(),Fe=v("div"),V(Ge.$$.fragment),Mn=C(),V(Ct.$$.fragment),Qn=C(),V(on.$$.fragment),ci=C(),Zi=v("br"),Ln=C(),Be=v("div"),V(ve.$$.fragment),Et=C(),Gt=v("details"),At=v("summary"),At.textContent="Image Settings",Gu=C(),hn=v("div"),mt=v("div"),xl=v("div"),xl.textContent="Replace Skribbl Logo:",ie=C(),ge=v("input"),_e=C(),fn=v("div"),Vh=v("div"),Vh.textContent="Replace Background:",I1=C(),Si=v("input"),T1=C(),jo=v("div"),Jh=v("div"),Jh.textContent="In-Game Background:",D1=C(),Ai=v("input"),E1=C(),Go=v("div"),Fh=v("div"),Fh.textContent="Container Background:",M1=C(),ki=v("input"),R1=C(),L1=v("br"),P1=C(),$u=v("div"),$o=v("div"),V(Vi.$$.fragment),N1=C(),V(Zr.$$.fragment),O1=C(),j1=v("br"),G1=C(),Yu=v("div"),V(Ji.$$.fragment),$1=C(),Pn=v("details"),zu=v("summary"),zu.textContent="Advanced Color Settings",Y1=C(),Qh=v("p"),Qh.textContent="Advanced color settings allow you to customize the appearance of skribbl in more detail.",z1=C(),Xh=v("p"),Xh.textContent="These settings are overwritten when the color scheme generator is used.",U1=C(),qh=v("p"),qh.textContent="The color names are taken from the skribbl code.",B1=C(),x1=v("br"),Z1=C(),Uu=v("div"),Bu=v("div"),Zl=v("div");for(let ae=0;ae<Vt.length;ae+=1)Vt[ae].c();V1=C(),Nn=v("details"),xu=v("summary"),xu.textContent="Miscellaneous",J1=C(),Yo=v("div"),zo=v("div"),Kh=v("div"),Kh.textContent="Use Google Font:",F1=C(),Ci=v("input"),W1=C(),Uo=v("div"),ef=v("div"),ef.textContent="External CSS URL:",H1=C(),Ii=v("input"),Q1=C(),X1=v("br"),q1=C(),Bo=v("div"),xo=v("div"),tf=v("div"),tf.textContent="Custom CSS:",K1=C(),Ti=v("input"),eS=C(),Zo=v("div"),nf=v("div"),nf.textContent="HTML Element Injection:",tS=C(),Di=v("input"),nS=C(),iS=v("br"),rS=C(),Ei=v("div"),V(Fi.$$.fragment),oS=C(),V(Wi.$$.fragment),sS=C(),V(Hi.$$.fragment),aS=C(),V(Qi.$$.fragment),lS=C(),On=v("details"),Zu=v("summary"),Zu.textContent="Skribbl Style Hooks",cS=C(),lf=v("p"),lf.textContent="Skribbl style hooks allow more advanced CSS styling without having to dig through the skribbl css classes.",uS=C(),cf=v("p"),cf.textContent="The CSS you write will be applied wherever the skribbl color variable is used.",dS=C(),uf=v("p"),uf.textContent="Hover over the  icon to display the linked CSS classes.",hS=C(),fS=v("br"),pS=C(),Vu=v("div"),Ju=v("div"),Vl=v("div");for(let ae=0;ae<Cn.length;ae+=1)Cn[ae].c();H(t,"flex-grow","1"),_(e,"class","typo-themes-editor-header svelte-1gh1qig"),_(E,"type","text"),_(E,"class","svelte-1gh1qig"),_(I,"class","group svelte-1gh1qig"),_($,"type","text"),_($,"class","svelte-1gh1qig"),_(L,"class","group svelte-1gh1qig"),_(w,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Y,"class","svelte-1gh1qig"),_(he,"class","group svelte-1gh1qig"),_(Te,"class","group svelte-1gh1qig"),_(W,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Fe,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Be,"class","typo-themes-editor-content-section svelte-1gh1qig"),N.open=!0,_(N,"class","svelte-1gh1qig"),_(At,"class","svelte-1gh1qig"),_(ge,"type","text"),_(ge,"placeholder","https://link.here/image.gif"),_(ge,"class","svelte-1gh1qig"),_(mt,"class","group svelte-1gh1qig"),_(Si,"type","text"),_(Si,"placeholder","https://link.here/image.gif"),_(Si,"class","svelte-1gh1qig"),_(fn,"class","group svelte-1gh1qig"),_(Ai,"type","text"),_(Ai,"placeholder","https://link.here/image.gif"),_(Ai,"class","svelte-1gh1qig"),_(jo,"class","group svelte-1gh1qig"),_(ki,"type","text"),_(ki,"placeholder","https://link.here/image.gif"),_(ki,"class","svelte-1gh1qig"),_(Go,"class","group svelte-1gh1qig"),_(hn,"class","typo-themes-editor-content-section svelte-1gh1qig"),_($o,"class","group svelte-1gh1qig"),_($u,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Yu,"class","typo-themes-editor-content-section svelte-1gh1qig"),Gt.open=!0,_(Gt,"class","svelte-1gh1qig"),_(zu,"class","svelte-1gh1qig"),_(Zl,"class","color-pickers svelte-1gh1qig"),_(Bu,"class","group svelte-1gh1qig"),_(Uu,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Pn,"class","svelte-1gh1qig"),_(xu,"class","svelte-1gh1qig"),_(Ci,"type","text"),_(Ci,"placeholder","Google Fonts import URL"),_(Ci,"class","svelte-1gh1qig"),_(zo,"class","group svelte-1gh1qig"),_(Ii,"type","text"),_(Ii,"placeholder","https://some.website/link-to-style.css"),_(Ii,"class","svelte-1gh1qig"),_(Uo,"class","group svelte-1gh1qig"),_(Yo,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Ti,"type","text"),_(Ti,"placeholder",".logo-big { display: none !important; }"),_(Ti,"class","svelte-1gh1qig"),_(xo,"class","group svelte-1gh1qig"),_(Di,"type","text"),_(Di,"placeholder","<div>hello there</div>"),_(Di,"class","svelte-1gh1qig"),_(Zo,"class","group svelte-1gh1qig"),_(Bo,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Ei,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(Nn,"class","svelte-1gh1qig"),_(Zu,"class","svelte-1gh1qig"),_(Vl,"class","style-hooks svelte-1gh1qig"),_(Ju,"class","group svelte-1gh1qig"),_(Vu,"class","typo-themes-editor-content-section svelte-1gh1qig"),_(On,"class","svelte-1gh1qig"),_(y,"class","typo-themes-editor-content svelte-1gh1qig");},m(ae,Ke){k(ae,e,Ke),g(e,t),g(t,n),g(t,o),g(e,s),g(e,a),g(e,l),x(u,e,null),g(e,d),x(h,e,null),g(e,p),x(m,e,null),k(ae,b,Ke),k(ae,y,Ke),g(y,w),g(w,I),g(I,S),g(I,R),g(I,E),de(E,r[2].theme.meta.name),g(w,P),g(w,L),g(L,O),g(L,z),g(L,$),de($,r[2].theme.meta.author),g(y,U),g(y,N),g(N,Y),g(N,ee),g(N,B),g(N,J),g(N,q),g(N,Q),g(N,X),g(N,ne),g(N,W),g(W,he),g(he,Pe),g(he,me),x(Ae,he,null),g(W,xe),g(W,Te),g(Te,Ze),g(Te,Ne),x(ot,Te,null),g(N,Ue),g(N,Xe),g(N,nt),g(N,Fe),x(Ge,Fe,null),g(Fe,Mn),x(Ct,Fe,null),g(Fe,Qn),x(on,Fe,null),g(N,ci),g(N,Zi),g(N,Ln),g(N,Be),x(ve,Be,null),g(y,Et),g(y,Gt),g(Gt,At),g(Gt,Gu),g(Gt,hn),g(hn,mt),g(mt,xl),g(mt,ie),g(mt,ge),de(ge,r[2].theme.images.urlLogo),g(hn,_e),g(hn,fn),g(fn,Vh),g(fn,I1),g(fn,Si),de(Si,r[2].theme.images.urlBackground),g(hn,T1),g(hn,jo),g(jo,Jh),g(jo,D1),g(jo,Ai),de(Ai,r[2].theme.images.urlBackgroundGame),g(hn,E1),g(hn,Go),g(Go,Fh),g(Go,M1),g(Go,ki),de(ki,r[2].theme.images.containerImages),g(Gt,R1),g(Gt,L1),g(Gt,P1),g(Gt,$u),g($u,$o),x(Vi,$o,null),g($o,N1),x(Zr,$o,null),g(Gt,O1),g(Gt,j1),g(Gt,G1),g(Gt,Yu),x(Ji,Yu,null),g(y,$1),g(y,Pn),g(Pn,zu),g(Pn,Y1),g(Pn,Qh),g(Pn,z1),g(Pn,Xh),g(Pn,U1),g(Pn,qh),g(Pn,B1),g(Pn,x1),g(Pn,Z1),g(Pn,Uu),g(Uu,Bu),g(Bu,Zl);for(let Xn=0;Xn<Vt.length;Xn+=1)Vt[Xn]&&Vt[Xn].m(Zl,null);g(y,V1),g(y,Nn),g(Nn,xu),g(Nn,J1),g(Nn,Yo),g(Yo,zo),g(zo,Kh),g(zo,F1),g(zo,Ci),de(Ci,r[2].theme.misc.fontStyle),g(Yo,W1),g(Yo,Uo),g(Uo,ef),g(Uo,H1),g(Uo,Ii),de(Ii,r[2].theme.misc.themeCssUrl),g(Nn,Q1),g(Nn,X1),g(Nn,q1),g(Nn,Bo),g(Bo,xo),g(xo,tf),g(xo,K1),g(xo,Ti),de(Ti,r[2].theme.misc.cssText),g(Bo,eS),g(Bo,Zo),g(Zo,nf),g(Zo,tS),g(Zo,Di),de(Di,r[2].theme.misc.htmlText),g(Nn,nS),g(Nn,iS),g(Nn,rS),g(Nn,Ei),x(Fi,Ei,null),g(Ei,oS),x(Wi,Ei,null),g(Ei,sS),x(Hi,Ei,null),g(Ei,aS),x(Qi,Ei,null),g(y,lS),g(y,On),g(On,Zu),g(On,cS),g(On,lf),g(On,uS),g(On,cf),g(On,dS),g(On,uf),g(On,hS),g(On,fS),g(On,pS),g(On,Vu),g(Vu,Ju),g(Ju,Vl);for(let Xn=0;Xn<Cn.length;Xn+=1)Cn[Xn]&&Cn[Xn].m(Vl,null);Jl=!0,df||(mS=[F(E,"input",r[21]),F($,"input",r[22]),F(ge,"input",r[29]),F(ge,"change",r[30]),F(Si,"input",r[31]),F(Si,"change",r[32]),F(Ai,"input",r[33]),F(Ai,"change",r[34]),F(ki,"input",r[35]),F(ki,"change",r[36]),F(Ci,"input",r[43]),F(Ci,"change",r[44]),F(Ii,"input",r[45]),F(Ii,"change",r[46]),F(Ti,"input",r[47]),F(Ti,"change",r[48]),F(Di,"input",r[49]),F(Di,"change",r[50])],df=!0);},p(ae,Ke){(!Jl||Ke[0]&4)&&i!==(i=ae[2].theme.meta.name+"")&&K(o,i),Ke[0]&4&&E.value!==ae[2].theme.meta.name&&de(E,ae[2].theme.meta.name),Ke[0]&4&&$.value!==ae[2].theme.meta.author&&de($,ae[2].theme.meta.author);const Xn={};!Dt&&Ke[0]&8&&(Dt=!0,Xn.color=ae[3],gt(()=>Dt=!1)),Ae.$set(Xn);const TS={};!Pt&&Ke[0]&16&&(Pt=!0,TS.color=ae[4],gt(()=>Pt=!1)),ot.$set(TS);const DS={};!at&&Ke[0]&64&&(at=!0,DS.checked=ae[6],gt(()=>at=!1)),Ge.$set(DS);const ES={};!Qt&&Ke[0]&128&&(Qt=!0,ES.checked=ae[7],gt(()=>Qt=!1)),Ct.$set(ES);const MS={};!Rn&&Ke[0]&512&&(Rn=!0,MS.checked=ae[9],gt(()=>Rn=!1)),on.$set(MS),Ke[0]&4&&ge.value!==ae[2].theme.images.urlLogo&&de(ge,ae[2].theme.images.urlLogo),Ke[0]&4&&Si.value!==ae[2].theme.images.urlBackground&&de(Si,ae[2].theme.images.urlBackground),Ke[0]&4&&Ai.value!==ae[2].theme.images.urlBackgroundGame&&de(Ai,ae[2].theme.images.urlBackgroundGame),Ke[0]&4&&ki.value!==ae[2].theme.images.containerImages&&de(ki,ae[2].theme.images.containerImages);const RS={};!Wh&&Ke[0]&256&&(Wh=!0,RS.checked=ae[8],gt(()=>Wh=!1)),Vi.$set(RS);const LS={};Ke[0]&293&&(LS.colorChanged=ae[39]),Zr.$set(LS);const PS={};if(!Hh&&Ke[0]&4&&(Hh=!0,PS.checked=ae[2].theme.images.backgroundRepeat,gt(()=>Hh=!1)),Ji.$set(PS),Ke[0]&2053){Vr=te(ae[11]);let wt;for(wt=0;wt<Vr.length;wt+=1){const Fl=mk(ae,Vr,wt);Vt[wt]?(Vt[wt].p(Fl,Ke),T(Vt[wt],1)):(Vt[wt]=gk(Fl),Vt[wt].c(),T(Vt[wt],1),Vt[wt].m(Zl,null));}for(fe(),wt=Vr.length;wt<Vt.length;wt+=1)JE(wt);pe();}Ke[0]&4&&Ci.value!==ae[2].theme.misc.fontStyle&&de(Ci,ae[2].theme.misc.fontStyle),Ke[0]&4&&Ii.value!==ae[2].theme.misc.themeCssUrl&&de(Ii,ae[2].theme.misc.themeCssUrl),Ke[0]&4&&Ti.value!==ae[2].theme.misc.cssText&&de(Ti,ae[2].theme.misc.cssText),Ke[0]&4&&Di.value!==ae[2].theme.misc.htmlText&&de(Di,ae[2].theme.misc.htmlText);const NS={};!rf&&Ke[0]&4&&(rf=!0,NS.checked=ae[2].theme.misc.hideFooter,gt(()=>rf=!1)),Fi.$set(NS);const OS={};!of&&Ke[0]&4&&(of=!0,OS.checked=ae[2].theme.misc.hideSkribblPanels,gt(()=>of=!1)),Wi.$set(OS);const jS={};!sf&&Ke[0]&4&&(sf=!0,jS.checked=ae[2].theme.misc.hideAvatarLogo,gt(()=>sf=!1)),Hi.$set(jS);const GS={};if(!af&&Ke[0]&4&&(af=!0,GS.checked=ae[2].theme.misc.hideInGameLogo,gt(()=>af=!1)),Qi.$set(GS),Ke[0]&7){Vo=te(Object.entries(ae[1]));let wt;for(wt=0;wt<Vo.length;wt+=1){const Fl=pk(ae,Vo,wt);Cn[wt]?Cn[wt].p(Fl,Ke):(Cn[wt]=bk(Fl),Cn[wt].c(),Cn[wt].m(Vl,null));}for(;wt<Cn.length;wt+=1)Cn[wt].d(1);Cn.length=Vo.length;}},i(ae){if(!Jl){T(u.$$.fragment,ae),T(h.$$.fragment,ae),T(m.$$.fragment,ae),T(Ae.$$.fragment,ae),T(ot.$$.fragment,ae),T(Ge.$$.fragment,ae),T(Ct.$$.fragment,ae),T(on.$$.fragment,ae),T(ve.$$.fragment,ae),T(Vi.$$.fragment,ae),T(Zr.$$.fragment,ae),T(Ji.$$.fragment,ae);for(let Ke=0;Ke<Vr.length;Ke+=1)T(Vt[Ke]);T(Fi.$$.fragment,ae),T(Wi.$$.fragment,ae),T(Hi.$$.fragment,ae),T(Qi.$$.fragment,ae),Jl=!0;}},o(ae){M(u.$$.fragment,ae),M(h.$$.fragment,ae),M(m.$$.fragment,ae),M(Ae.$$.fragment,ae),M(ot.$$.fragment,ae),M(Ge.$$.fragment,ae),M(Ct.$$.fragment,ae),M(on.$$.fragment,ae),M(ve.$$.fragment,ae),M(Vi.$$.fragment,ae),M(Zr.$$.fragment,ae),M(Ji.$$.fragment,ae),Vt=Vt.filter(Boolean);for(let Ke=0;Ke<Vt.length;Ke+=1)M(Vt[Ke]);M(Fi.$$.fragment,ae),M(Wi.$$.fragment,ae),M(Hi.$$.fragment,ae),M(Qi.$$.fragment,ae),Jl=!1;},d(ae){ae&&(A(e),A(b),A(y)),Z(u),Z(h),Z(m),Z(Ae),Z(ot),Z(Ge),Z(Ct),Z(on),Z(ve),Z(Vi),Z(Zr),Z(Ji),Ie(Vt,ae),Z(Fi),Z(Wi),Z(Hi),Z(Qi),Ie(Cn,ae),df=!1,Je(mS);}}}c(bG,"create_else_block$l");function vG(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O;return a=new ke({props:{content:"Create new Theme",color:"green"}}),a.$on("click",r[15]),E=new ke({props:{content:"Import Theme",color:"blue"}}),E.$on("click",r[17]),{c(){e=v("div"),t=G('No theme loaded for editing. Select one of your themes in the "Saved Themes" tab or create a new one!'),n=v("br"),i=C(),o=v("br"),s=C(),V(a.$$.fragment),l=C(),u=v("br"),d=C(),h=v("br"),p=C(),m=v("div"),b=v("div"),b.textContent="If you have received a theme share ID, you can import it here:",y=C(),w=v("br"),I=C(),S=v("input"),R=C(),V(E.$$.fragment),_(e,"class","typo-themes-editor-header svelte-1gh1qig"),_(S,"type","text"),H(S,"width","auto"),H(S,"margin-right","1rem"),_(S,"placeholder","Share ID"),_(m,"class","typo-themes-editor-header svelte-1gh1qig");},m(z,$){k(z,e,$),g(e,t),g(e,n),g(e,i),g(e,o),g(e,s),x(a,e,null),k(z,l,$),k(z,u,$),k(z,d,$),k(z,h,$),k(z,p,$),k(z,m,$),g(m,b),g(m,y),g(m,w),g(m,I),g(m,S),de(S,r[10]),g(m,R),x(E,m,null),P=!0,L||(O=F(S,"input",r[16]),L=!0);},p(z,$){$[0]&1024&&S.value!==z[10]&&de(S,z[10]);},i(z){P||(T(a.$$.fragment,z),T(E.$$.fragment,z),P=!0);},o(z){M(a.$$.fragment,z),M(E.$$.fragment,z),P=!1;},d(z){z&&(A(e),A(l),A(u),A(d),A(h),A(p),A(m)),Z(a),Z(E),L=!1,O();}}}c(vG,"create_if_block$A");function gk(r){let e,t=r[61][0].replace("--","")+"",n,i,o,s,a;function l(...u){return r[42](r[61],...u)}return c(l,"func_1"),s=new pi({props:{color:r[61][1],allowAlpha:!0,colorChanged:l}}),{c(){e=v("div"),n=G(t),i=G(":"),o=C(),V(s.$$.fragment);},m(u,d){k(u,e,d),g(e,n),g(e,i),k(u,o,d),x(s,u,d),a=!0;},p(u,d){r=u,(!a||d[0]&2048)&&t!==(t=r[61][0].replace("--","")+"")&&K(n,t);const h={};d[0]&2048&&(h.color=r[61][1]),d[0]&2053&&(h.colorChanged=l),s.$set(h);},i(u){a||(T(s.$$.fragment,u),a=!0);},o(u){M(s.$$.fragment,u),a=!1;},d(u){u&&(A(e),A(o)),Z(s,u);}}}c(gk,"create_each_block_1$c");function bk(r){let e,t,n,i,o,s=r[61][0].replace("--","")+"",a,l,u,d,h,p;function m(){r[59].call(d,r[61]);}return c(m,"input_input_handler_1"),{c(){e=v("div"),t=v("abbr"),n=G(""),o=C(),a=G(s),l=G(":"),u=C(),d=v("input"),_(t,"title",i=r[61][1].join(", ")),_(d,"type","text"),_(d,"placeholder","color: red; border: 1px solid green;"),_(d,"class","svelte-1gh1qig");},m(b,y){k(b,e,y),g(e,t),g(t,n),g(e,o),g(e,a),g(e,l),k(b,u,y),k(b,d,y),de(d,r[2].theme.hooks[r[61][0]]),h||(p=[F(d,"input",m),F(d,"change",r[60])],h=!0);},p(b,y){r=b,y[0]&2&&i!==(i=r[61][1].join(", "))&&_(t,"title",i),y[0]&2&&s!==(s=r[61][0].replace("--","")+"")&&K(a,s),y[0]&6&&d.value!==r[2].theme.hooks[r[61][0]]&&de(d,r[2].theme.hooks[r[61][0]]);},d(b){b&&(A(e),A(u),A(d)),h=!1,Je(p);}}}c(bk,"create_each_block$z");function _G(r){let e,t,n,i;const o=[vG,bG],s=[];function a(l,u){return l[2]===void 0?0:1}return c(a,"select_block_type"),t=a(r),n=s[t]=o[t](r),{c(){e=v("div"),n.c(),_(e,"class","typo-themes-editor svelte-1gh1qig");},m(l,u){k(l,e,u),s[t].m(e,null),i=!0;},p(l,u){let d=t;t=a(l),t===d?s[t].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),n=s[t],n?n.p(l,u):(n=s[t]=o[t](l),n.c()),T(n,1),n.m(e,null));},i(l){i||(T(n),i=!0);},o(l){M(n),i=!1;},d(l){l&&A(e),s[t].d();}}}c(_G,"create_fragment$1l");function yG(r,e,t){let n,i,o=tt.fromHex("#4197c5"),s=tt.fromHex("#FFFFFF"),a=tt.fromHex("#2f61eb"),l=!0,u=!1,d=!0,h=!1,p="",{feature:m}=e,{variableHooks:b}=e;const y=m.loadedEditorThemeStore;De(r,y,ve=>t(2,n=ve));const w=m.activeThemeTabStore;De(r,w,ve=>t(12,i=ve));let I=[];const S=c(async()=>{const ve=await m.createLocalTheme();await m.loadThemeToEditor(ve);},"click_handler");function R(){p=this.value,t(10,p);}c(R,"input_input_handler");const E=c(async()=>{const ve=await m.importTheme(p);await m.activateLocalTheme(ve.theme.meta.id),gn(w,i="list",i);},"click_handler_1"),P=c(async()=>{const ve=n.theme.meta.id;await m.discardLoadedEditorTheme(ve);},"click_handler_2"),L=c(()=>m.discardLoadedEditorTheme(),"click_handler_3"),O=c(()=>{m.saveLoadedEditorTheme(),m.activeThemeTabStore.set("list");},"click_handler_4");function z(){n.theme.meta.name=this.value,y.set(n);}c(z,"input0_input_handler");function $(){n.theme.meta.author=this.value,y.set(n);}c($,"input1_input_handler");function U(ve){o=ve,t(3,o);}c(U,"colorpickerbutton0_color_binding");function N(ve){s=ve,t(4,s);}c(N,"colorpickerbutton1_color_binding");function Y(ve){l=ve,t(6,l);}c(Y,"checkbox0_checked_binding");function ee(ve){u=ve,t(7,u);}c(ee,"checkbox1_checked_binding");function B(ve){h=ve,t(9,h);}c(B,"checkbox2_checked_binding");const J=c(async()=>{await m.setColorScheme(n.theme,o,s,l,u,h),m.updateLoadedEditorTheme(n);},"click_handler_5");function q(){n.theme.images.urlLogo=this.value,y.set(n);}c(q,"input2_input_handler");const Q=c(()=>m.updateLoadedEditorTheme(n),"change_handler");function X(){n.theme.images.urlBackground=this.value,y.set(n);}c(X,"input3_input_handler");const ne=c(()=>m.updateLoadedEditorTheme(n),"change_handler_1");function W(){n.theme.images.urlBackgroundGame=this.value,y.set(n);}c(W,"input4_input_handler");const he=c(()=>m.updateLoadedEditorTheme(n),"change_handler_2");function Pe(){n.theme.images.containerImages=this.value,y.set(n);}c(Pe,"input5_input_handler");const me=c(()=>m.updateLoadedEditorTheme(n),"change_handler_3");function Ae(ve){d=ve,t(8,d),t(2,n);}c(Ae,"checkbox3_checked_binding");const Dt=c(()=>{d?gn(y,n.theme.images.backgroundTint=a.hex,n):gn(y,n.theme.images.backgroundTint=void 0,n),m.updateLoadedEditorTheme(n);},"change_handler_4"),xe=c(ve=>{t(5,a=ve),t(8,d=!0),gn(y,n.theme.images.backgroundTint=ve.hex,n),m.updateLoadedEditorTheme(n);},"func");function Te(ve){r.$$.not_equal(n.theme.images.backgroundRepeat,ve)&&(n.theme.images.backgroundRepeat=ve,y.set(n));}c(Te,"checkbox4_checked_binding");const Ze=c(()=>m.updateLoadedEditorTheme(n),"change_handler_5"),Ne=c((ve,Et)=>{gn(y,n.theme.colors[ve[0]]=Et.hsl,n),m.updateLoadedEditorTheme(n);},"func_1");function ot(){n.theme.misc.fontStyle=this.value,y.set(n);}c(ot,"input6_input_handler");const Pt=c(()=>m.updateLoadedEditorTheme(n),"change_handler_6");function Ue(){n.theme.misc.themeCssUrl=this.value,y.set(n);}c(Ue,"input7_input_handler");const Xe=c(()=>m.updateLoadedEditorTheme(n),"change_handler_7");function nt(){n.theme.misc.cssText=this.value,y.set(n);}c(nt,"input8_input_handler");const Fe=c(()=>m.updateLoadedEditorTheme(n),"change_handler_8");function Ge(){n.theme.misc.htmlText=this.value,y.set(n);}c(Ge,"input9_input_handler");const at=c(()=>m.updateLoadedEditorTheme(n),"change_handler_9");function Mn(ve){r.$$.not_equal(n.theme.misc.hideFooter,ve)&&(n.theme.misc.hideFooter=ve,y.set(n));}c(Mn,"checkbox5_checked_binding");const Ct=c(()=>m.updateLoadedEditorTheme(n),"change_handler_10");function Qt(ve){r.$$.not_equal(n.theme.misc.hideSkribblPanels,ve)&&(n.theme.misc.hideSkribblPanels=ve,y.set(n));}c(Qt,"checkbox6_checked_binding");const Qn=c(()=>m.updateLoadedEditorTheme(n),"change_handler_11");function on(ve){r.$$.not_equal(n.theme.misc.hideAvatarLogo,ve)&&(n.theme.misc.hideAvatarLogo=ve,y.set(n));}c(on,"checkbox7_checked_binding");const Rn=c(()=>m.updateLoadedEditorTheme(n),"change_handler_12");function ci(ve){r.$$.not_equal(n.theme.misc.hideInGameLogo,ve)&&(n.theme.misc.hideInGameLogo=ve,y.set(n));}c(ci,"checkbox8_checked_binding");const Zi=c(()=>m.updateLoadedEditorTheme(n),"change_handler_13");function Ln(ve){n.theme.hooks[ve[0]]=this.value,y.set(n);}c(Ln,"input_input_handler_1");const Be=c(()=>{m.updateLoadedEditorTheme(n);},"change_handler_14");return r.$$set=ve=>{"feature"in ve&&t(0,m=ve.feature),"variableHooks"in ve&&t(1,b=ve.variableHooks);},r.$$.update=()=>{r.$$.dirty[0]&4&&(t(11,I=n?Object.entries(n.theme.colors).map(ve=>{const Et=tt.fromHsl(ve[1][0],ve[1][1],ve[1][2],ve[1][3]);return [ve[0],Et]}):[]),n!=null&&n.theme.images.backgroundTint&&(n==null?void 0:n.theme.images.backgroundTint)!=="transparent"?(t(5,a=tt.fromHex(n.theme.images.backgroundTint)),t(8,d=!0)):t(8,d=!1));},[m,b,n,o,s,a,l,u,d,h,p,I,i,y,w,S,R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne,W,he,Pe,me,Ae,Dt,xe,Te,Ze,Ne,ot,Pt,Ue,Xe,nt,Fe,Ge,at,Mn,Ct,Qt,Qn,on,Rn,ci,Zi,Ln,Be]}c(yG,"instance$1d");const ty=class ty extends se{constructor(e){super(),le(this,e,yG,_G,re,{feature:0,variableHooks:1},null,[-1,-1,-1]);}};c(ty,"Themes_editor");let Pp=ty;function vk(r,e,t){const n=r.slice();return n[15]=e[t],n}c(vk,"get_each_context$y");function wG(r){let e;return {c(){e=v("div"),e.innerHTML='<img src="" alt="disabled" style="content: var(--file-img-disabled-gif)" class="svelte-wdh6rb"/> <div>Inactive</div>',_(e,"class","active-marker svelte-wdh6rb");},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(wG,"create_else_block$k");function SG(r){let e;return {c(){e=v("div"),e.innerHTML='<img src="" alt="enabled" style="content: var(--file-img-enabled-gif)" class="svelte-wdh6rb"/> <div>Editing</div>',_(e,"class","active-marker svelte-wdh6rb");},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(SG,"create_if_block_5$4");function AG(r){let e;return {c(){e=v("div"),e.innerHTML='<img src="" alt="enabled" style="content: var(--file-img-enabled-gif)" class="svelte-wdh6rb"/> <div>Selected</div>',_(e,"class","active-marker svelte-wdh6rb");},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(AG,"create_if_block_4$8");function _k(r){let e,t,n=r[15].publicTheme.localVersion+"",i,o,s,a,l=r[15].publicTheme.publicId+"",u;return {c(){e=v("span"),t=G("v"),i=G(n),o=C(),s=v("span"),a=G("#"),u=G(l),_(e,"class","svelte-wdh6rb"),_(s,"class","svelte-wdh6rb");},m(d,h){k(d,e,h),g(e,t),g(e,i),k(d,o,h),k(d,s,h),g(s,a),g(s,u);},p(d,h){h&2&&n!==(n=d[15].publicTheme.localVersion+"")&&K(i,n),h&2&&l!==(l=d[15].publicTheme.publicId+"")&&K(u,l);},d(d){d&&(A(e),A(o),A(s));}}}c(_k,"create_if_block_3$8");function yk(r){let e,t;function n(){return r[12](r[15])}return c(n,"click_handler_1"),e=new ke({props:{content:"Remove",color:"orange"}}),e.$on("click",n),{c(){V(e.$$.fragment);},m(i,o){x(e,i,o),t=!0;},p(i,o){r=i;},i(i){t||(T(e.$$.fragment,i),t=!0);},o(i){M(e.$$.fragment,i),t=!1;},d(i){Z(e,i);}}}c(yk,"create_if_block_2$d");function wk(r){var i,o;let e,t;function n(){return r[13](r[15])}return c(n,"click_handler_2"),e=new ke({props:{content:((i=r[3])==null?void 0:i.theme.meta.id)===r[15].theme.meta.id?"Editing":"Edit",color:"blue",disabled:((o=r[3])==null?void 0:o.theme.meta.id)===r[15].theme.meta.id}}),e.$on("click",n),{c(){V(e.$$.fragment);},m(s,a){x(e,s,a),t=!0;},p(s,a){var u,d;r=s;const l={};a&10&&(l.content=((u=r[3])==null?void 0:u.theme.meta.id)===r[15].theme.meta.id?"Editing":"Edit"),a&10&&(l.disabled=((d=r[3])==null?void 0:d.theme.meta.id)===r[15].theme.meta.id),e.$set(l);},i(s){t||(T(e.$$.fragment,s),t=!0);},o(s){M(e.$$.fragment,s),t=!1;},d(s){Z(e,s);}}}c(wk,"create_if_block_1$f");function Sk(r){var i;let e,t;function n(){return r[14](r[15])}return c(n,"click_handler_3"),e=new ke({props:{content:"Share",color:"blue",disabled:((i=r[3])==null?void 0:i.theme.meta.id)===r[15].theme.meta.id}}),e.$on("click",n),{c(){V(e.$$.fragment);},m(o,s){x(e,o,s),t=!0;},p(o,s){var l;r=o;const a={};s&10&&(a.disabled=((l=r[3])==null?void 0:l.theme.meta.id)===r[15].theme.meta.id),e.$set(a);},i(o){t||(T(e.$$.fragment,o),t=!0);},o(o){M(e.$$.fragment,o),t=!1;},d(o){Z(e,o);}}}c(Sk,"create_if_block$z");function Ak(r){let e,t,n,i=r[15].theme.meta.name+"",o,s,a,l=r[15].publicTheme?"Featured Theme":"Local Theme",u,d,h,p,m,b,y=r[15].theme.meta.author+"",w,I,S,R,E,P,L,O,z,$,U;function N(ne,W){var he;return ne[2]===ne[15].theme.meta.id&&ne[3]===void 0?AG:((he=ne[3])==null?void 0:he.theme.meta.id)===ne[15].theme.meta.id?SG:wG}c(N,"select_block_type");let Y=N(r),ee=Y(r),B=r[4]&&r[15].publicTheme&&_k(r);function J(){return r[11](r[15])}c(J,"click_handler"),E=new ke({props:{content:r[2]===r[15].theme.meta.id&&r[3]===void 0?"Active":"Activate",disabled:r[2]===r[15].theme.meta.id&&r[3]===void 0,color:"green"}}),E.$on("click",J);let q=(r[15].publicTheme||r[15].enableManage===!0)&&yk(r),Q=r[15].enableManage===!0&&wk(r),X=r[15].enableManage===!0&&Sk(r);return {c(){e=v("div"),t=v("div"),n=v("b"),o=G(i),s=C(),a=v("span"),u=G(l),d=C(),h=v("div"),ee.c(),p=C(),m=v("div"),b=G("by "),w=G(y),I=C(),B&&B.c(),S=C(),R=v("div"),V(E.$$.fragment),P=C(),q&&q.c(),L=C(),O=v("div"),Q&&Q.c(),z=C(),X&&X.c(),$=C(),_(n,"class","svelte-wdh6rb"),_(a,"class","svelte-wdh6rb"),_(t,"class","svelte-wdh6rb"),_(m,"class","svelte-wdh6rb"),_(h,"class","svelte-wdh6rb"),_(R,"class","svelte-wdh6rb"),_(O,"class","svelte-wdh6rb"),_(e,"class","typo-themes-list-item svelte-wdh6rb");},m(ne,W){k(ne,e,W),g(e,t),g(t,n),g(n,o),g(t,s),g(t,a),g(a,u),g(e,d),g(e,h),ee.m(h,null),g(h,p),g(h,m),g(m,b),g(m,w),g(h,I),B&&B.m(h,null),g(e,S),g(e,R),x(E,R,null),g(R,P),q&&q.m(R,null),g(e,L),g(e,O),Q&&Q.m(O,null),g(O,z),X&&X.m(O,null),g(e,$),U=!0;},p(ne,W){r=ne,(!U||W&2)&&i!==(i=r[15].theme.meta.name+"")&&K(o,i),(!U||W&2)&&l!==(l=r[15].publicTheme?"Featured Theme":"Local Theme")&&K(u,l),Y!==(Y=N(r))&&(ee.d(1),ee=Y(r),ee&&(ee.c(),ee.m(h,p))),(!U||W&2)&&y!==(y=r[15].theme.meta.author+"")&&K(w,y),r[4]&&r[15].publicTheme?B?B.p(r,W):(B=_k(r),B.c(),B.m(h,null)):B&&(B.d(1),B=null);const he={};W&14&&(he.content=r[2]===r[15].theme.meta.id&&r[3]===void 0?"Active":"Activate"),W&14&&(he.disabled=r[2]===r[15].theme.meta.id&&r[3]===void 0),E.$set(he),r[15].publicTheme||r[15].enableManage===!0?q?(q.p(r,W),W&2&&T(q,1)):(q=yk(r),q.c(),T(q,1),q.m(R,null)):q&&(fe(),M(q,1,1,()=>{q=null;}),pe()),r[15].enableManage===!0?Q?(Q.p(r,W),W&2&&T(Q,1)):(Q=wk(r),Q.c(),T(Q,1),Q.m(O,z)):Q&&(fe(),M(Q,1,1,()=>{Q=null;}),pe()),r[15].enableManage===!0?X?(X.p(r,W),W&2&&T(X,1)):(X=Sk(r),X.c(),T(X,1),X.m(O,null)):X&&(fe(),M(X,1,1,()=>{X=null;}),pe());},i(ne){U||(T(E.$$.fragment,ne),T(q),T(Q),T(X),U=!0);},o(ne){M(E.$$.fragment,ne),M(q),M(Q),M(X),U=!1;},d(ne){ne&&A(e),ee.d(),B&&B.d(),Z(E),q&&q.d(),Q&&Q.d(),X&&X.d();}}}c(Ak,"create_each_block$y");function kG(r){let e,t,n,i,o=te(r[1]),s=[];for(let l=0;l<o.length;l+=1)s[l]=Ak(vk(r,o,l));const a=c(l=>M(s[l],1,1,()=>{s[l]=null;}),"out");return {c(){e=v("div"),e.textContent="Downloaded and created themes will appear here. Select a theme to change the appearance of skribbl!",t=C(),n=v("div");for(let l=0;l<s.length;l+=1)s[l].c();_(e,"class","typo-themes-list-header svelte-wdh6rb"),_(n,"class","typo-themes-list-list svelte-wdh6rb");},m(l,u){k(l,e,u),k(l,t,u),k(l,n,u);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(n,null);i=!0;},p(l,[u]){if(u&63){o=te(l[1]);let d;for(d=0;d<o.length;d+=1){const h=vk(l,o,d);s[d]?(s[d].p(h,u),T(s[d],1)):(s[d]=Ak(h),s[d].c(),T(s[d],1),s[d].m(n,null));}for(fe(),d=o.length;d<s.length;d+=1)a(d);pe();}},i(l){if(!i){for(let u=0;u<o.length;u+=1)T(s[u]);i=!0;}},o(l){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)M(s[u]);i=!1;},d(l){l&&(A(e),A(t),A(n)),Ie(s,l);}}}c(kG,"create_fragment$1k");function CG(r,e,t){let n,i,o,s,a,{feature:l}=e;const u=l.devmodeStore;De(r,u,S=>t(4,s=S));const d=l.savedThemesStore;De(r,d,S=>t(1,n=S));const h=l.activeThemeStore;De(r,h,S=>t(2,i=S));const p=l.loadedEditorThemeStore;De(r,p,S=>t(3,o=S));const m=l.activeThemeTabStore;De(r,m,S=>t(5,a=S));const b=c(S=>l.activateLocalTheme(S.theme.meta.id),"click_handler"),y=c(S=>l.removeSavedTheme(S.theme.meta.id),"click_handler_1"),w=c(S=>{l.loadThemeToEditor(S),gn(m,a="editor",a);},"click_handler_2"),I=c(S=>{l.shareTheme(S.theme);},"click_handler_3");return r.$$set=S=>{"feature"in S&&t(0,l=S.feature);},[l,n,i,o,s,a,u,d,h,p,m,b,y,w,I]}c(CG,"instance$1c");const ny=class ny extends se{constructor(e){super(),le(this,e,CG,kG,re,{feature:0});}};c(ny,"Themes_list");let Np=ny;function IG(r){let e,t;return e=new Lp({props:{feature:r[0]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&1&&(o.feature=n[0]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(IG,"create_if_block_2$c");function TG(r){let e,t;return e=new Pp({props:{feature:r[0],variableHooks:r[1]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&1&&(o.feature=n[0]),i&2&&(o.variableHooks=n[1]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(TG,"create_if_block_1$e");function DG(r){let e,t;return e=new Np({props:{feature:r[0]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&1&&(o.feature=n[0]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(DG,"create_if_block$y");function EG(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b;const y=[DG,TG,IG],w=[];function I(S,R){return S[2]==="list"?0:S[2]==="editor"?1:S[2]==="browser"?2:-1}return c(I,"select_block_type"),~(d=I(r))&&(h=w[d]=y[d](r)),{c(){e=v("div"),t=v("div"),n=v("h3"),n.textContent="Saved Themes",i=C(),o=v("h3"),o.textContent="Theme Editor",s=C(),a=v("h3"),a.textContent="Discover Themes",l=C(),u=v("div"),h&&h.c(),_(n,"class","svelte-1ikbg14"),ue(n,"selected",r[2]==="list"),_(o,"class","svelte-1ikbg14"),ue(o,"selected",r[2]==="editor"),_(a,"class","svelte-1ikbg14"),ue(a,"selected",r[2]==="browser"),_(t,"class","typo-themes-navigation svelte-1ikbg14"),_(u,"class","typo-themes-tab color-scrollbar svelte-1ikbg14"),_(e,"class","typo-themes-content svelte-1ikbg14");},m(S,R){k(S,e,R),g(e,t),g(t,n),g(t,i),g(t,o),g(t,s),g(t,a),g(e,l),g(e,u),~d&&w[d].m(u,null),p=!0,m||(b=[F(n,"click",r[4]),F(o,"click",r[5]),F(a,"click",r[6])],m=!0);},p(S,[R]){(!p||R&4)&&ue(n,"selected",S[2]==="list"),(!p||R&4)&&ue(o,"selected",S[2]==="editor"),(!p||R&4)&&ue(a,"selected",S[2]==="browser");let E=d;d=I(S),d===E?~d&&w[d].p(S,R):(h&&(fe(),M(w[E],1,1,()=>{w[E]=null;}),pe()),~d?(h=w[d],h?h.p(S,R):(h=w[d]=y[d](S),h.c()),T(h,1),h.m(u,null)):h=null);},i(S){p||(T(h),p=!0);},o(S){M(h),p=!1;},d(S){S&&A(e),~d&&w[d].d(),m=!1,Je(b);}}}c(EG,"create_fragment$1j");function MG(r,e,t){let n,{feature:i}=e,{variableHooks:o}=e;const s=i.activeThemeTabStore;De(r,s,d=>t(2,n=d));const a=c(()=>gn(s,n="list",n),"click_handler"),l=c(()=>gn(s,n="editor",n),"click_handler_1"),u=c(()=>gn(s,n="browser",n),"click_handler_2");return r.$$set=d=>{"feature"in d&&t(0,i=d.feature),"variableHooks"in d&&t(1,o=d.variableHooks);},[i,o,n,s,a,l,u]}c(MG,"instance$1b");const iy=class iy extends se{constructor(e){super(),le(this,e,MG,EG,re,{feature:0,variableHooks:1});}};c(iy,"Controls_themes");let Op=iy;var RG=Object.defineProperty,Ro=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&RG(e,t,i),i},"__decorateClass$T");const ry=class ry extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_cssColorVarSelectorsSetup");f(this,"_apiDataSetup");f(this,"_modalService");f(this,"_toastService");f(this,"_themesService");f(this,"_globalSettingsService");f(this,"name","Themes");f(this,"description","Customize the skribbl.io appearance with pre-made themes or your own style");f(this,"tags",[ye.INTERFACE]);f(this,"featureId",34);f(this,"_onboardingTask",this.useOnboardingTask({key:"theme_activated",name:"Activate a theme",description:"Select a theme to customize the style of skribbl.",start:c(()=>this.openThemesPopup(),"start")}));f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_themeResetSubscription");f(this,"_currentThemeSubscription");f(this,"_activeThemeTab$",new Le("list"));f(this,"_themeElements",[]);f(this,"_variableHooks");f(this,"_importedOldThemes",new dt("imported_old_themes",!1,this));f(this,"_importedOldThemes2",new dt("imported_old_themes2",!1,this));}async onActivate(){const t=await this._elementsSetup.complete();this._variableHooks=await this._cssColorVarSelectorsSetup.complete(),this._iconComponent=new st({target:t.controls,props:{hoverMove:!1,size:"48px",icon:"file-img-themes-gif",name:"Themes",order:3,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{this.openThemesPopup();}),this._themeResetSubscription=this._themesService.savedThemesSetting.changes$.pipe(Qe(this._themesService.activeThemeSetting.changes$)).subscribe(([n,i])=>{n.some(o=>o.theme.meta.id===i)||this._themesService.activeThemeSetting.setValue(0);}),this._currentThemeSubscription=this._themesService.activeThemeSetting.changes$.pipe(Oe(this._themesService.savedThemesSetting.changes$),ce(([n,i])=>{var o;return n===0||(o=i.find(s=>s.theme.meta.id===n))==null?void 0:o.theme}),Qe(this._themesService.loadedEditorTheme$),ce(([n,i])=>(i==null?void 0:i.theme)??n)).subscribe(n=>{this._logger.debug("Active theme changed",n),this.setThemeElements(n);}),await this.importOldTypoThemes();}async onDestroy(){var t,n,i,o;(t=this._iconComponent)==null||t.$destroy(),(n=this._iconClickSubscription)==null||n.unsubscribe(),this._iconClickSubscription=void 0,(i=this._themeResetSubscription)==null||i.unsubscribe(),this._themeResetSubscription=void 0,(o=this._currentThemeSubscription)==null||o.unsubscribe(),this._currentThemeSubscription=void 0,await this.setThemeElements(void 0),this._variableHooks=void 0;}openThemesPopup(){if(!this._variableHooks)throw new Error("Themes feature not activated?");const t={componentType:Op,props:{feature:this,variableHooks:this._variableHooks}};this._modalService.showModal(t.componentType,t.props,"Typo Themes");}get savedThemesStore(){return this._themesService.savedThemesSetting.store}get activeThemeStore(){return this._themesService.activeThemeSetting.store}get loadedEditorThemeStore(){return this._themesService.loadedEditorThemeStore}get activeThemeTabStore(){return it(this._activeThemeTab$,this._activeThemeTab$.value,t=>this._activeThemeTab$.next(t))}get devmodeStore(){return this._globalSettingsService.settings.devMode.store}async getOnlineThemes(){return (await this._apiDataSetup.complete()).themes}async loadThemeToEditor(t){const n=await this._toastService.showLoadingToast("Loading theme to editor");try{await this._themesService.loadThemeToEditor(t),n.resolve(`Theme ${t.theme.meta.name} loaded`);}catch{n.reject("Failed to load theme");}}updateLoadedEditorTheme(t){this._themesService.updateLoadedEditorTheme(t);}async discardLoadedEditorTheme(t){if(t!==void 0){if(!await(await this._toastService.showConfirmToast("Do you want to discard & remove the theme?",void 0,1e4,{confirm:"Remove theme",cancel:"Keep editing"})).result){this._logger.info("User canceled theme removal");return}}else if(!await(await this._toastService.showConfirmToast("Do you want to discard the changes?",void 0,1e4,{confirm:"Discard changes",cancel:"Keep editing"})).result){this._logger.info("User canceled theme discarding");return}if(await this._themesService.unloadThemeFromEditor(),t!==void 0){const n=await this._toastService.showLoadingToast("Removing theme");try{const i=await this._themesService.removeSavedTheme(t);n.resolve(`Theme ${i.theme.meta.name} removed`);}catch{n.reject("Failed to remove theme");}}else await this._toastService.showToast("Theme unloaded from editor");}async createLocalTheme(){const t=await this._toastService.showLoadingToast("Creating new theme");try{const n=await this._themesService.createLocalTheme();return t.resolve("New theme created"),n}catch(n){throw t.reject("Failed to create theme"),n}}async importOldTypoThemes(){try{const t=localStorage.getItem("themes");if(!await this._importedOldThemes.getValue()&&t!==null){const i=JSON.parse(t);if(!Array.isArray(i))throw new Error("invalid themes data");for(const o of i)try{await this.importOldTheme(o);}catch(s){this._logger.error("Failed to import old typo theme",s);}await this._importedOldThemes.setValue(!0);}const n=localStorage.getItem("themesv2");if(!await this._importedOldThemes2.getValue()&&n!==null){const i=JSON.parse(n);if(!Array.isArray(i))throw new Error("invalid themes data");for(const o of i)try{await this._themesService.importThemeFromString(JSON.stringify(o));}catch(s){this._logger.error("Failed to import old typo theme",s);}await this._importedOldThemes2.setValue(!0);}}catch(t){throw this._logger.error("Failed to import old typo themes",t),t}}async importOldTheme(t){try{if(typeof t!="object")throw new Error("Invalid theme data");const n=new Map(Object.entries(t)),i=n.get("options"),o=n.get("name");if(typeof i!="object")throw new Error("Invalid theme options");if(typeof o!="string")throw new Error("Invalid theme name");if(o==="Original"){this._logger.info("Skipping original theme");return}await this._themesService.importOldTheme(i,o);}catch(n){throw n}}async saveLoadedEditorTheme(){const t=await this._toastService.showLoadingToast("Saving theme changes");try{const n=await this._themesService.saveLoadedEditorTheme();return t.resolve(`Theme ${n.theme.meta.name} updated`),n}catch(n){throw t.reject("Failed to create theme"),n}}async savePublicTheme(t){const n=await this._toastService.showLoadingToast("Saving theme");try{const i=await this._themesService.savePublicTheme(t);n.resolve(`Theme ${i.theme.meta.name} saved`);}catch{n.reject("Failed to save theme");}}async activateLocalTheme(t){const n=await this._toastService.showLoadingToast("Activating theme");try{const i=await this._themesService.activateLocalTheme(t);(await this._onboardingTask).complete(),n.resolve(`Theme ${i.theme.meta.name} activated`);}catch{n.reject("Failed to activate theme");}}async activatePublicTheme(t){const n=await this._toastService.showLoadingToast("Activating theme");try{const i=await this._themesService.activatePublicTheme(t);(await this._onboardingTask).complete(),n.resolve(`Theme ${i.theme.meta.name} activated`);}catch{n.reject("Failed to activate theme");}}async removeSavedTheme(t){if(!await(await this._toastService.showConfirmToast("Do you want to delete the theme?",void 0,1e4,{confirm:"Delete theme",cancel:"Cancel deletion"})).result){this._logger.info("User canceled theme removal");return}const n=await this._toastService.showLoadingToast("Removing theme");try{const i=await this._themesService.removeSavedTheme(t);n.resolve(`Theme ${i.theme.meta.name} removed`);}catch{n.reject("Failed to remove theme");}}async shareTheme(t){const n=await this._toastService.showLoadingToast("Sharing theme");try{const i=await this._themesService.shareTheme(t);await navigator.clipboard.writeText(i),n.resolve(`Share id (${i}) for theme ${t.meta.name} copied`);}catch{n.reject("Failed to share theme");}}async importTheme(t){const n=await this._toastService.showLoadingToast("Importing theme");try{const i=await this._themesService.importTheme(t);return n.resolve(`Theme ${i.theme.meta.name} imported`),i}catch(i){throw n.reject("Failed to import theme"),i}}async setThemeElements(t){this._logger.info("Setting theme elements",t),this._themeElements.forEach(n=>n.remove()),this._themeElements=t?await this.createThemeElements(t):[],this._themeElements.forEach(n=>document.body.appendChild(n)),document.documentElement.hasAttribute("data-halloween")&&t!==void 0?(document.documentElement.setAttribute("data-halloween-disabled","true"),document.documentElement.removeAttribute("data-halloween")):document.documentElement.hasAttribute("data-halloween-disabled")&&t===void 0&&(document.documentElement.setAttribute("data-halloween",""),document.documentElement.removeAttribute("data-halloween-disabled"));}async createThemeElements(t){const n=await this._cssColorVarSelectorsSetup.complete(),i=sG(t,n),o=lG(t),s=cG(t),a=aG(t),l=oG(t);return [i,...o,...s,...a,l]}async setColorScheme(t,n,i,o,s,a){this._logger.debug("Setting color scheme",t,n,i,o,s,a);const l=rG(n,i,a,o,s);t.colors=l,await this._toastService.showToast("Color scheme updated");}};c(ry,"ControlsThemesFeature");let gi=ry;Ro([D(Me)],gi.prototype,"_elementsSetup");Ro([D(Vd)],gi.prototype,"_cssColorVarSelectorsSetup");Ro([D(Tn)],gi.prototype,"_apiDataSetup");Ro([D(Dn)],gi.prototype,"_modalService");Ro([D(ft)],gi.prototype,"_toastService");Ro([D(Zd)],gi.prototype,"_themesService");Ro([D(xn)],gi.prototype,"_globalSettingsService");var LG=Object.defineProperty,bb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&LG(e,t,i),i},"__decorateClass$S");const oy=class oy extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_globalSettingsService");f(this,"_memberService");f(this,"name","Outfit Toggle");f(this,"description","Add a toggle to the customizer to show or hide your typo outfit");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",45);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_memberSubscription");}async onActivate(){this._memberSubscription=this._memberService.member$.subscribe(async t=>{await this.setIconEnabled(t!=null);});}async onDestroy(){var t;await this.setIconEnabled(!1),(t=this._memberSubscription)==null||t.unsubscribe(),this._memberSubscription=void 0;}async setIconEnabled(t){var n,i;if((n=this._iconClickSubscription)==null||n.unsubscribe(),(i=this._iconComponent)==null||i.$destroy(),this._iconComponent=void 0,this._iconClickSubscription=void 0,t){const o=await this._elementsSetup.complete();this._iconComponent=new st({target:o.customizerActions,props:{hoverMove:!1,greyscaleInactive:!0,size:"30px",icon:"file-img-mask-gif",name:"Toggle Outfit View",order:2,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(async()=>{const s=await this._globalSettingsService.settings.showLandingOutfit.getValue();await this._globalSettingsService.settings.showLandingOutfit.setValue(!s);});}}};c(oy,"CustomizerOutfitToggleFeature");let Mr=oy;bb([D(Me)],Mr.prototype,"_elementsSetup");bb([D(xn)],Mr.prototype,"_globalSettingsService");bb([D(Sn)],Mr.prototype,"_memberService");var PG=Object.defineProperty,NG=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&PG(e,t,i),i},"__decorateClass$R");const sy=class sy extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"name","Practice Lobby");f(this,"description","Add an option to draw on your own without time limit");f(this,"tags",[ye.DRAWING]);f(this,"featureId",44);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_onboardingTask",this.useOnboardingTask({key:"practice_joined",name:"Enter the practice mode",description:"Click the palette icon next to the avatar customizer to join a free draw practice mode.",start:c(()=>{},"start")}));}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.customizerActions,props:{hoverMove:!1,greyscaleInactive:!0,size:"30px",icon:"file-img-palette-gif",name:`Enter
Practice Lobby`,order:1,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(async()=>{document.dispatchEvent(new CustomEvent("joinPractice")),(await this._onboardingTask).complete();});}async onDestroy(){var t,n;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy(),this._iconComponent=void 0,this._iconClickSubscription=void 0;}};c(sy,"CustomizerPracticeJoinFeature");let pl=sy;NG([D(Me)],pl.prototype,"_elementsSetup");const ml={skribblPalette:{name:"Skribbl.io Original",columns:13,colorHexCodes:["#ffffff","#c1c1c1","#ef130b","#ff7100","#ffe400","#00cc00","#00ff91","#00b2ff","#231fd3","#a300ba","#df69a7","#ffac8e","#a0522d","#000000","#505050","#740b07","#c23800","#e8a200","#004619","#00785d","#00569e","#0e0865","#550069","#873554","#cc774d","#63300d"]},largerSkribbl:{name:"Skribbl XL",columns:13,colorHexCodes:["#ffffff","#e3e3e3","#ff4942","#fea941","#fefe43","#43fe43","#70ffc1","#39e6fd","#423ffe","#ca00e2","#ff83cf","#ffc6ae","#bc5b2d","#c6c6c6","#aaaaaa","#ef130b","#ff7100","#ffe400","#00cc00","#00ff91","#00b2ff","#231fd3","#a300ba","#df69a7","#ffac8e","#a0522d","#8e8e8e","#717171","#b20f09","#e15500","#f4c300","#00890d","#00bc77","#0084cf","#19149c","#7c0092","#b34f7e","#e6926e","#82411d","#555555","#393939","#740b07","#c23800","#e8a200","#004619","#00785d","#00569e","#0e0865","#550069","#873554","#cc774d","#63300d","#1c1c1c","#000000","#370705","#7e2200","#cb7701","#00240e","#004f3e","#00286e","#060043","#2e0041","#702135","#b35d2d","#451f00"]},sketchful:{name:"Sketchful",columns:13,colorHexCodes:["#ffffff","#d3d1d2","#f70f0f","#ff7200","#fce700","#02cb00","#01fe94","#05b0ff","#221ecd","#a300bd","#cc7fad","#fdad88","#9e5425","#514f54","#a9a7a8","#ae0b00","#c84706","#ec9e06","#007612","#049d6f","#00579d","#0f0b96","#6e0083","#a65673","#e38a5e","#5e320d","#000000","#827c80","#57060c","#8b2500","#9e6600","#003f00","#00766a","#003b75","#0e0151","#3c0350","#73314d","#d1754e","#421e06"]}};var OG=Object.defineProperty,jG=Object.getOwnPropertyDescriptor,vb=c((r,e,t,n)=>{for(var i=n>1?void 0:n?jG(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&OG(e,t,i),i},"__decorateClass$Q"),GG=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$5"),Ra;let Rr=(Ra=class{constructor(e){f(this,"_toastService");f(this,"_featuresService");f(this,"_logger");f(this,"_savedPalettesSetting",new dt("colors_saved_palettes",[]));f(this,"_activePaletteSetting",new dt("colors_active_palette",void 0));f(this,"_selectedPalette$",new Le(void 0));f(this,"_pickerColors$",new Le(void 0));f(this,"_colorSelector$",new Le(void 0));f(this,"featureActive",!1);this._logger=e(this),this._activePaletteSetting.changes$.pipe(Qe(this._savedPalettesSetting.changes$),_t(([t,n])=>{t!==void 0&&![...n,...Object.values(ml)].some(i=>i.name===t)&&this._activePaletteSetting.setValue(void 0);}),ce(([t,n])=>t!==void 0?[...n,...Object.values(ml)].find(i=>i.name===t):void 0),ct()).subscribe(t=>this._selectedPalette$.next(t)),this._selectedPalette$.pipe(Qe(this._colorSelector$),ce(([t,n])=>n?n(t):t)).subscribe(t=>this._pickerColors$.next(t));}get selectedPalette$(){return this._selectedPalette$.asObservable()}get pickerColors$(){return this._pickerColors$.asObservable()}get activePaletteSetting(){return this._activePaletteSetting.asFrozen}get savedPalettesSetting(){return this._savedPalettesSetting.asFrozen}async removePalette(e){this._logger.debug(`Removing palette ${e}`);const t=await this._savedPalettesSetting.getValue(),n=t.findIndex(i=>i.name===e);if(n===-1)throw this._logger.error(`Palette with name ${e} does not exist`),new Error(`Palette with name ${e} does not exist`);t.splice(n,1),await this._savedPalettesSetting.setValue(t);}async savePalette(e,t=void 0){this._logger.debug(`Saving palette ${e.name}`,e);let n=await this._savedPalettesSetting.getValue();if(n.some(i=>i.name===e.name&&i.name!==t))throw this._logger.error(`Palette with name ${e.name} already exists`),new Error(`Palette with name ${e.name} already exists`);n=n.filter(i=>i.name!==t),n.push(e),await this._savedPalettesSetting.setValue(n);}async setColorSelector(e){this.featureActive||(this._logger.error("Attempted to save palette while feature is not active"),await(await this._toastService.showConfirmToast("Attempted to modify color palette, feature disabled.","Do you want to enable the palettes feature?",5e3,{confirm:"Enable",cancel:"Cancel"})).result&&await this._featuresService.activateFeature(bi)),this._colorSelector$.next(e);}resetColorSelector(){this._colorSelector$.next(void 0);}get colorSelectorActive(){return this._colorSelector$.value===void 0}async onFeatureActivate(){this.featureActive=!0;}async onFeatureDestroy(){this.featureActive=!1;}},c(Ra,"ColorsService"),Ra);vb([D(ft)],Rr.prototype,"_toastService",2);vb([D(uo)],Rr.prototype,"_featuresService",2);Rr=vb([we(),GG(0,D(rt))],Rr);function $G(r){let e,t,n,i,o,s,a,l,u,d,h;return {c(){e=G("Using custom palettes, you can customize the colors available in the typo toolbar."),t=v("br"),n=C(),i=v("br"),o=C(),s=v("h3"),s.textContent=" Warning:",a=G(`
Only `),l=v("b"),l.textContent="typo users can see custom colors",u=G(", other players will not see anything until the next time you clear the canvas."),d=v("br"),h=G(`
Use custom colors and custom palettes only when you're in free draw mode, or when everyone in the lobby has typo installed.`);},m(p,m){k(p,e,m),k(p,t,m),k(p,n,m),k(p,i,m),k(p,o,m),k(p,s,m),k(p,a,m),k(p,l,m),k(p,u,m),k(p,d,m),k(p,h,m);},p:j,i:j,o:j,d(p){p&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a),A(l),A(u),A(d),A(h));}}}c($G,"create_fragment$1i");const ay=class ay extends se{constructor(e){super(),le(this,e,null,$G,re,{});}};c(ay,"Drawing_color_palettes_info");let jp=ay;function kk(r,e,t){const n=r.slice();return n[16]=e[t],n[17]=e,n[18]=t,n}c(kk,"get_each_context$x");function Ck(r){let e,t,n,i,o;function s(l){r[9](l,r[16],r[17],r[18]);}c(s,"colorpickerbutton_color_binding");let a={height:"auto"};return r[16]!==void 0&&(a.color=r[16]),t=new pi({props:a}),Ve.push(()=>bt(t,"color",s)),{c(){e=v("div"),V(t.$$.fragment),i=C(),_(e,"class","typo-palette-builder-color");},m(l,u){k(l,e,u),x(t,e,null),g(e,i),o=!0;},p(l,u){r=l;const d={};!n&&u&16&&(n=!0,d.color=r[16],gt(()=>n=!1)),t.$set(d);},i(l){o||(T(t.$$.fragment,l),o=!0);},o(l){M(t.$$.fragment,l),o=!1;},d(l){l&&A(e),Z(t);}}}c(Ck,"create_each_block$x");function Ik(r){let e,t;return e=new ke({props:{color:"green",content:"Save Palette"}}),e.$on("click",r[10]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Ik,"create_if_block_4$7");function Tk(r){let e,t;return e=new ke({props:{color:"orange",content:"Delete Palette"}}),e.$on("click",r[11]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Tk,"create_if_block_3$7");function Dk(r){let e,t;return e=new ke({props:{color:"blue",content:"Export to clipboard"}}),e.$on("click",r[12]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Dk,"create_if_block_2$b");function Ek(r){let e,t;return e=new ke({props:{content:"Add Color",color:"green"}}),e.$on("click",r[13]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Ek,"create_if_block_1$d");function Mk(r){let e,t;return e=new ke({props:{content:"Remove Color",color:"orange"}}),e.$on("click",r[14]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Mk,"create_if_block$x");function YG(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N=te(r[4]),Y=[];for(let ne=0;ne<N.length;ne+=1)Y[ne]=Ck(kk(r,N,ne));const ee=c(ne=>M(Y[ne],1,1,()=>{Y[ne]=null;}),"out");let B=r[0]&&Ik(r),J=r[2]&&Tk(r),q=r[1]&&Dk(r),Q=r[0]&&Ek(r),X=r[0]&&Mk(r);return {c(){e=v("div"),t=v("div"),n=v("b"),n.textContent="Palette Name",i=C(),o=v("input"),a=C(),l=v("b"),l.textContent="Columns per row",u=C(),d=v("input"),p=C(),m=v("b"),m.textContent="Palette colors",b=C(),y=v("div");for(let ne=0;ne<Y.length;ne+=1)Y[ne].c();w=C(),I=v("div"),B&&B.c(),S=C(),J&&J.c(),R=C(),q&&q.c(),E=C(),P=v("br"),L=C(),Q&&Q.c(),O=C(),X&&X.c(),_(n,"class","svelte-nspiqx"),_(o,"type","text"),o.disabled=s=r[0]===void 0,_(l,"class","svelte-nspiqx"),_(d,"type","number"),_(d,"min","0"),d.disabled=h=r[0]===void 0,_(m,"class","svelte-nspiqx"),_(y,"class","typo-palette-builder-colors svelte-nspiqx"),H(y,"pointer-events",r[0]===void 0?"none":"all"),H(y,"grid-template-columns","repeat("+r[5]+", 2rem)"),H(y,"width","calc("+r[5]+" * 2rem + "+(r[5]-1)+" * .2rem)"),_(t,"class","typo-palette-builder-inputs svelte-nspiqx"),_(I,"class","typo-palette-builder-actions svelte-nspiqx"),_(e,"class","typo-palette-builder-container svelte-nspiqx");},m(ne,W){k(ne,e,W),g(e,t),g(t,n),g(t,i),g(t,o),de(o,r[3]),g(t,a),g(t,l),g(t,u),g(t,d),de(d,r[5]),g(t,p),g(t,m),g(t,b),g(t,y);for(let he=0;he<Y.length;he+=1)Y[he]&&Y[he].m(y,null);g(e,w),g(e,I),B&&B.m(I,null),g(I,S),J&&J.m(I,null),g(I,R),q&&q.m(I,null),g(I,E),g(I,P),g(I,L),Q&&Q.m(I,null),g(I,O),X&&X.m(I,null),z=!0,$||(U=[F(o,"input",r[7]),F(d,"input",r[8])],$=!0);},p(ne,[W]){if((!z||W&1&&s!==(s=ne[0]===void 0))&&(o.disabled=s),W&8&&o.value!==ne[3]&&de(o,ne[3]),(!z||W&1&&h!==(h=ne[0]===void 0))&&(d.disabled=h),W&32&&ln(d.value)!==ne[5]&&de(d,ne[5]),W&16){N=te(ne[4]);let he;for(he=0;he<N.length;he+=1){const Pe=kk(ne,N,he);Y[he]?(Y[he].p(Pe,W),T(Y[he],1)):(Y[he]=Ck(Pe),Y[he].c(),T(Y[he],1),Y[he].m(y,null));}for(fe(),he=N.length;he<Y.length;he+=1)ee(he);pe();}(!z||W&1)&&H(y,"pointer-events",ne[0]===void 0?"none":"all"),(!z||W&32)&&H(y,"grid-template-columns","repeat("+ne[5]+", 2rem)"),(!z||W&32)&&H(y,"width","calc("+ne[5]+" * 2rem + "+(ne[5]-1)+" * .2rem)"),ne[0]?B?(B.p(ne,W),W&1&&T(B,1)):(B=Ik(ne),B.c(),T(B,1),B.m(I,S)):B&&(fe(),M(B,1,1,()=>{B=null;}),pe()),ne[2]?J?(J.p(ne,W),W&4&&T(J,1)):(J=Tk(ne),J.c(),T(J,1),J.m(I,R)):J&&(fe(),M(J,1,1,()=>{J=null;}),pe()),ne[1]?q?(q.p(ne,W),W&2&&T(q,1)):(q=Dk(ne),q.c(),T(q,1),q.m(I,E)):q&&(fe(),M(q,1,1,()=>{q=null;}),pe()),ne[0]?Q?(Q.p(ne,W),W&1&&T(Q,1)):(Q=Ek(ne),Q.c(),T(Q,1),Q.m(I,O)):Q&&(fe(),M(Q,1,1,()=>{Q=null;}),pe()),ne[0]?X?(X.p(ne,W),W&1&&T(X,1)):(X=Mk(ne),X.c(),T(X,1),X.m(I,null)):X&&(fe(),M(X,1,1,()=>{X=null;}),pe());},i(ne){if(!z){for(let W=0;W<N.length;W+=1)T(Y[W]);T(B),T(J),T(q),T(Q),T(X),z=!0;}},o(ne){Y=Y.filter(Boolean);for(let W=0;W<Y.length;W+=1)M(Y[W]);M(B),M(J),M(q),M(Q),M(X),z=!1;},d(ne){ne&&A(e),Ie(Y,ne),B&&B.d(),J&&J.d(),q&&q.d(),Q&&Q.d(),X&&X.d(),$=!1,Je(U);}}}c(YG,"create_fragment$1h");function zG(r,e,t){let n="new-palette",i=[],o=10;const s=c(R=>{t(3,n=R.name),t(4,i=R.colorHexCodes.map(E=>tt.fromHex(E))),t(5,o=R.columns);},"loadPalette");let{onPaletteSave:a=void 0}=e,{onPaletteExport:l=void 0}=e,{onPaletteDelete:u=void 0}=e,{initialPalette:d=void 0}=e;li(()=>{d&&s(d);});function h(){n=this.value,t(3,n);}c(h,"input0_input_handler");function p(){o=ln(this.value),t(5,o);}c(p,"input1_input_handler");function m(R,E,P,L){P[L]=R,t(4,i);}c(m,"colorpickerbutton_color_binding");const b=c(()=>a({name:n,columns:o,colorHexCodes:i.map(R=>R.hex)}),"click_handler"),y=c(()=>u(),"click_handler_1"),w=c(()=>l({name:n,columns:o,colorHexCodes:i.map(R=>R.hex)}),"click_handler_2"),I=c(()=>t(4,i=[...i,tt.fromHex("#77c5fa")]),"click_handler_3"),S=c(()=>t(4,i=[...i.slice(0,i.length-1)]),"click_handler_4");return r.$$set=R=>{"onPaletteSave"in R&&t(0,a=R.onPaletteSave),"onPaletteExport"in R&&t(1,l=R.onPaletteExport),"onPaletteDelete"in R&&t(2,u=R.onPaletteDelete),"initialPalette"in R&&t(6,d=R.initialPalette);},[a,l,u,n,i,o,d,h,p,m,b,y,w,I,S]}c(zG,"instance$1a");const ly=class ly extends se{constructor(e){super(),le(this,e,zG,YG,re,{onPaletteSave:0,onPaletteExport:1,onPaletteDelete:2,initialPalette:6});}};c(ly,"Color_palette_builder");let Jd=ly;function Rk(r,e,t){const n=r.slice();return n[15]=e[t],n}c(Rk,"get_each_context$w");function Lk(r,e,t){const n=r.slice();return n[15]=e[t],n}c(Lk,"get_each_context_1$b");function Pk(r,e,t){const n=r.slice();return n[15]=e[t],n}c(Pk,"get_each_context_2$5");function Nk(r,e,t){const n=r.slice();return n[15]=e[t],n}c(Nk,"get_each_context_3$3");function Ok(r){let e,t=r[15].name+"",n,i;return {c(){e=v("option"),n=G(t),e.__value=r[15]===r[5].skribblPalette?void 0:r[15].name,de(e,e.__value),e.selected=i=r[15]===r[5].skribblPalette&&r[2]===void 0||r[2]===r[15].name;},m(o,s){k(o,e,s),g(e,n);},p(o,s){s&44&&i!==(i=o[15]===o[5].skribblPalette&&o[2]===void 0||o[2]===o[15].name)&&(e.selected=i);},d(o){o&&A(e);}}}c(Ok,"create_each_block_3$3");function jk(r){let e,t=r[15].name+"",n,i,o;return {c(){e=v("option"),n=G(t),e.__value=i=r[15].name,de(e,e.__value),e.selected=o=r[2]===r[15].name;},m(s,a){k(s,e,a),g(e,n);},p(s,a){a&8&&t!==(t=s[15].name+"")&&K(n,t),a&8&&i!==(i=s[15].name)&&(e.__value=i,de(e,e.__value)),a&44&&o!==(o=s[2]===s[15].name)&&(e.selected=o);},d(s){s&&A(e);}}}c(jk,"create_each_block_2$5");function Gk(r){let e,t;function n(...o){return r[9](r[15],...o)}c(n,"func");function i(){return r[11](r[15])}return c(i,"func_2"),e=new Jd({props:{initialPalette:r[15],onPaletteSave:n,onPaletteExport:r[10],onPaletteDelete:i}}),{c(){V(e.$$.fragment);},m(o,s){x(e,o,s),t=!0;},p(o,s){r=o;const a={};s&8&&(a.initialPalette=r[15]),s&9&&(a.onPaletteSave=n),s&1&&(a.onPaletteExport=r[10]),s&9&&(a.onPaletteDelete=i),e.$set(a);},i(o){t||(T(e.$$.fragment,o),t=!0);},o(o){M(e.$$.fragment,o),t=!1;},d(o){Z(e,o);}}}c(Gk,"create_key_block$1");function $k(r){let e=r[15],t,n,i=Gk(r);return {c(){i.c(),t=je();},m(o,s){i.m(o,s),k(o,t,s),n=!0;},p(o,s){s&8&&re(e,e=o[15])?(fe(),M(i,1,1,j),pe(),i=Gk(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,s);},i(o){n||(T(i),n=!0);},o(o){M(i),n=!1;},d(o){o&&A(t),i.d(o);}}}c($k,"create_each_block_1$b");function Yk(r){let e,t;function n(){return r[12](r[15])}return c(n,"func_3"),e=new Jd({props:{initialPalette:r[15],onPaletteExport:n}}),{c(){V(e.$$.fragment);},m(i,o){x(e,i,o),t=!0;},p(i,o){r=i;const s={};o&1&&(s.onPaletteExport=n),e.$set(s);},i(i){t||(T(e.$$.fragment,i),t=!0);},o(i){M(e.$$.fragment,i),t=!1;},d(i){Z(e,i);}}}c(Yk,"create_each_block$w");function UG(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne,W,he,Pe,me,Ae,Dt,xe,Te,Ze,Ne,ot,Pt,Ue,Xe,nt,Fe,Ge,at,Mn,Ct,Qt,Qn,on,Rn,ci,Zi,Ln=te(Object.values(r[5])),Be=[];for(let ie=0;ie<Ln.length;ie+=1)Be[ie]=Ok(Nk(r,Ln,ie));let ve=te(r[3]),Et=[];for(let ie=0;ie<ve.length;ie+=1)Et[ie]=jk(Pk(r,ve,ie));O=new ke({props:{color:"green",content:"Add new palette"}}),O.$on("click",r[8]);let Gt=te(r[3]),At=[];for(let ie=0;ie<Gt.length;ie+=1)At[ie]=$k(Lk(r,Gt,ie));const Gu=c(ie=>M(At[ie],1,1,()=>{At[ie]=null;}),"out");let hn=te(Object.values(r[5])),mt=[];for(let ie=0;ie<hn.length;ie+=1)mt[ie]=Yk(Rk(r,hn,ie));const xl=c(ie=>M(mt[ie],1,1,()=>{mt[ie]=null;}),"out_1");return Ct=new ke({props:{color:"green",content:"Import palette"}}),Ct.$on("click",r[14]),{c(){e=v("h3"),e.textContent="Active palette",t=G(`
Select one of the saved palettes to customize the colors available in the skribbl toolbar.`),n=v("br"),i=C(),o=v("select");for(let ie=0;ie<Be.length;ie+=1)Be[ie].c();s=je();for(let ie=0;ie<Et.length;ie+=1)Et[ie].c();a=v("br"),l=C(),u=v("br"),d=C(),h=v("h3"),h.textContent="Create a new empty palette",p=G(`
Create a new palette to customize the colors available in the skribbl toolbar.`),m=v("br"),b=G(`
You can enter a name to identify the palette, choose a number of columns for the palette layout and add as many colors as you like.`),y=v("br"),w=G(`
Click a color box to change it, remove the last color with "Remove Color" or add a new color with "Add Color".`),I=v("br"),S=G(`
When you are done, click "Save Palette" to save the changes.`),R=v("br"),E=C(),P=v("br"),L=C(),V(O.$$.fragment),z=v("br"),$=C(),U=v("br"),N=C(),Y=v("h3"),Y.textContent="Saved palettes",ee=C(),B=v("br"),J=C(),q=v("div");for(let ie=0;ie<At.length;ie+=1)At[ie].c();Q=C();for(let ie=0;ie<mt.length;ie+=1)mt[ie].c();X=C(),ne=v("br"),W=C(),he=v("h3"),he.textContent="Import a palette",Pe=G(`
You can import existing palettes by pasting their data here.`),me=v("br"),Ae=G(`
Existing palettes can be exported by clicking the "Export to clipboard" button on the palette.`),Dt=v("br"),xe=G(`
The data is a JSON string that represents the palette; you can also create a new palette without the typo palette builder.`),Te=v("br"),Ze=G(`
The palette has to satisfy following interface: `),Ne=v("i"),Ne.textContent="{ name: string; columns: number; colorHexCodes: string[] }",ot=v("br"),Pt=C(),Ue=v("br"),Xe=C(),nt=v("input"),Fe=v("br"),Ge=C(),at=v("br"),Mn=C(),V(Ct.$$.fragment),Qt=v("br"),Qn=C(),on=v("br"),H(o,"width","auto"),r[2]===void 0&&Ir(()=>r[7].call(o)),_(q,"class","typo-color-palette-manage-list svelte-vvz4gm"),_(nt,"type","text"),_(nt,"placeholder","Paste palette data"),H(nt,"width","auto");},m(ie,ge){k(ie,e,ge),k(ie,t,ge),k(ie,n,ge),k(ie,i,ge),k(ie,o,ge);for(let _e=0;_e<Be.length;_e+=1)Be[_e]&&Be[_e].m(o,null);g(o,s);for(let _e=0;_e<Et.length;_e+=1)Et[_e]&&Et[_e].m(o,null);Li(o,r[2],!0),k(ie,a,ge),k(ie,l,ge),k(ie,u,ge),k(ie,d,ge),k(ie,h,ge),k(ie,p,ge),k(ie,m,ge),k(ie,b,ge),k(ie,y,ge),k(ie,w,ge),k(ie,I,ge),k(ie,S,ge),k(ie,R,ge),k(ie,E,ge),k(ie,P,ge),k(ie,L,ge),x(O,ie,ge),k(ie,z,ge),k(ie,$,ge),k(ie,U,ge),k(ie,N,ge),k(ie,Y,ge),k(ie,ee,ge),k(ie,B,ge),k(ie,J,ge),k(ie,q,ge);for(let _e=0;_e<At.length;_e+=1)At[_e]&&At[_e].m(q,null);g(q,Q);for(let _e=0;_e<mt.length;_e+=1)mt[_e]&&mt[_e].m(q,null);k(ie,X,ge),k(ie,ne,ge),k(ie,W,ge),k(ie,he,ge),k(ie,Pe,ge),k(ie,me,ge),k(ie,Ae,ge),k(ie,Dt,ge),k(ie,xe,ge),k(ie,Te,ge),k(ie,Ze,ge),k(ie,Ne,ge),k(ie,ot,ge),k(ie,Pt,ge),k(ie,Ue,ge),k(ie,Xe,ge),k(ie,nt,ge),de(nt,r[1]),k(ie,Fe,ge),k(ie,Ge,ge),k(ie,at,ge),k(ie,Mn,ge),x(Ct,ie,ge),k(ie,Qt,ge),k(ie,Qn,ge),k(ie,on,ge),Rn=!0,ci||(Zi=[F(o,"change",r[7]),F(nt,"input",r[13])],ci=!0);},p(ie,[ge]){if(ge&36){Ln=te(Object.values(ie[5]));let _e;for(_e=0;_e<Ln.length;_e+=1){const fn=Nk(ie,Ln,_e);Be[_e]?Be[_e].p(fn,ge):(Be[_e]=Ok(fn),Be[_e].c(),Be[_e].m(o,s));}for(;_e<Be.length;_e+=1)Be[_e].d(1);Be.length=Ln.length;}if(ge&12){ve=te(ie[3]);let _e;for(_e=0;_e<ve.length;_e+=1){const fn=Pk(ie,ve,_e);Et[_e]?Et[_e].p(fn,ge):(Et[_e]=jk(fn),Et[_e].c(),Et[_e].m(o,null));}for(;_e<Et.length;_e+=1)Et[_e].d(1);Et.length=ve.length;}if(ge&44&&Li(o,ie[2]),ge&9){Gt=te(ie[3]);let _e;for(_e=0;_e<Gt.length;_e+=1){const fn=Lk(ie,Gt,_e);At[_e]?(At[_e].p(fn,ge),T(At[_e],1)):(At[_e]=$k(fn),At[_e].c(),T(At[_e],1),At[_e].m(q,Q));}for(fe(),_e=Gt.length;_e<At.length;_e+=1)Gu(_e);pe();}if(ge&33){hn=te(Object.values(ie[5]));let _e;for(_e=0;_e<hn.length;_e+=1){const fn=Rk(ie,hn,_e);mt[_e]?(mt[_e].p(fn,ge),T(mt[_e],1)):(mt[_e]=Yk(fn),mt[_e].c(),T(mt[_e],1),mt[_e].m(q,null));}for(fe(),_e=hn.length;_e<mt.length;_e+=1)xl(_e);pe();}ge&2&&nt.value!==ie[1]&&de(nt,ie[1]);},i(ie){if(!Rn){T(O.$$.fragment,ie);for(let ge=0;ge<Gt.length;ge+=1)T(At[ge]);for(let ge=0;ge<hn.length;ge+=1)T(mt[ge]);T(Ct.$$.fragment,ie),Rn=!0;}},o(ie){M(O.$$.fragment,ie),At=At.filter(Boolean);for(let ge=0;ge<At.length;ge+=1)M(At[ge]);mt=mt.filter(Boolean);for(let ge=0;ge<mt.length;ge+=1)M(mt[ge]);M(Ct.$$.fragment,ie),Rn=!1;},d(ie){ie&&(A(e),A(t),A(n),A(i),A(o),A(a),A(l),A(u),A(d),A(h),A(p),A(m),A(b),A(y),A(w),A(I),A(S),A(R),A(E),A(P),A(L),A(z),A($),A(U),A(N),A(Y),A(ee),A(B),A(J),A(q),A(X),A(ne),A(W),A(he),A(Pe),A(me),A(Ae),A(Dt),A(xe),A(Te),A(Ze),A(Ne),A(ot),A(Pt),A(Ue),A(Xe),A(nt),A(Fe),A(Ge),A(at),A(Mn),A(Qt),A(Qn),A(on)),Ie(Be,ie),Ie(Et,ie),Z(O,ie),Ie(At,ie),Ie(mt,ie),Z(Ct,ie),ci=!1,Je(Zi);}}}c(UG,"create_fragment$1g");function BG(r,e,t){let n,i,{feature:o}=e,s="";const a=o.savedPalettesStore;De(r,a,S=>t(3,i=S));const l=o.defaultPalettes,u=o.activePaletteStore;De(r,u,S=>t(2,n=S));function d(){n=yc(this),u.set(n),t(5,l);}c(d,"select_change_handler");const h=c(()=>o.savePalette({name:"palette-"+Date.now(),columns:10,colorHexCodes:["#77c5fa"]}),"click_handler"),p=c((S,R)=>o.savePalette(R,S.name),"func"),m=c(S=>o.exportPalette(S),"func_1"),b=c(S=>o.removePalette(S.name),"func_2"),y=c(S=>o.exportPalette(S),"func_3");function w(){s=this.value,t(1,s);}c(w,"input_input_handler");const I=c(()=>o.savePalette(o.parsePalette(s)),"click_handler_1");return r.$$set=S=>{"feature"in S&&t(0,o=S.feature);},[o,s,n,i,a,l,u,d,h,p,m,b,y,w,I]}c(BG,"instance$19");const cy=class cy extends se{constructor(e){super(),le(this,e,BG,UG,re,{feature:0});}};c(cy,"Drawing_color_palettes_manage");let Gp=cy;function zk(r,e,t){const n=r.slice();return n[3]=e[t],n}c(zk,"get_each_context$v");function Uk(r){let e,t,n;function i(...o){return r[2](r[3],...o)}return c(i,"pointerdown_handler"),{c(){e=v("div"),_(e,"class","typo-palette-picker-item svelte-1mmx4c4"),H(e,"background-color",r[3]),H(e,"width",r[0].preferredColumnWidth?`calc(var(--UNIT) / 2 * ${r[0].preferredColumnWidth}`:"");},m(o,s){k(o,e,s),t||(n=F(e,"pointerdown",i),t=!0);},p(o,s){r=o,s&1&&H(e,"background-color",r[3]),s&1&&H(e,"width",r[0].preferredColumnWidth?`calc(var(--UNIT) / 2 * ${r[0].preferredColumnWidth}`:"");},d(o){o&&A(e),t=!1,n();}}}c(Uk,"create_each_block$v");function xG(r){let e,t,n,i,o=te(r[0].colorHexCodes),s=[];for(let a=0;a<o.length;a+=1)s[a]=Uk(zk(r,o,a));return {c(){e=v("div"),t=v("div");for(let a=0;a<s.length;a+=1)s[a].c();_(t,"class","typo-palette-picker color-scrollbar svelte-1mmx4c4"),H(t,"grid-template-columns","repeat("+r[0].columns+", auto)"),_(e,"class","colors typo-palette svelte-1mmx4c4");},m(a,l){k(a,e,l),g(e,t);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(t,null);n||(i=oi(r[1].createTooltip(t,{title:`Choose a color!
Only typo users see custom colors.`,lock:"Y"})),n=!0);},p(a,[l]){if(l&3){o=te(a[0].colorHexCodes);let u;for(u=0;u<o.length;u+=1){const d=zk(a,o,u);s[u]?s[u].p(d,l):(s[u]=Uk(d),s[u].c(),s[u].m(t,null));}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length;}l&1&&H(t,"grid-template-columns","repeat("+a[0].columns+", auto)");},i:j,o:j,d(a){a&&A(e),Ie(s,a),n=!1,i();}}}c(xG,"create_fragment$1f");function ZG(r,e,t){let{colors:n}=e,{feature:i}=e;const o=c((s,a)=>{const l=a.button!==0;l&&a.preventDefault(),i.setColor(s,l);},"pointerdown_handler");return r.$$set=s=>{"colors"in s&&t(0,n=s.colors),"feature"in s&&t(1,i=s.feature);},[n,i,o]}c(ZG,"instance$18");const uy=class uy extends se{constructor(e){super(),le(this,e,ZG,xG,re,{colors:0,feature:1});}};c(uy,"Color_palette_picker");let $p=uy;function Bk(r,e,t){const n=r.slice();return n[3]=e[t],n}c(Bk,"get_each_context$u");function xk(r){let e,t=r[3]+"",n,i,o;function s(){return r[2](r[3])}return c(s,"click_handler"),{c(){e=v("span"),n=G(t),_(e,"class","typo-palette-switcher-item svelte-144p318");},m(a,l){k(a,e,l),g(e,n),i||(o=F(e,"click",s),i=!0);},p(a,l){r=a,l&1&&t!==(t=r[3]+"")&&K(n,t);},d(a){a&&A(e),i=!1,o();}}}c(xk,"create_each_block$u");function VG(r){let e,t,n,i,o,s=te(r[0]),a=[];for(let l=0;l<s.length;l+=1)a[l]=xk(Bk(r,s,l));return {c(){e=v("span"),e.innerHTML="Select a custom palette for drawing.<br/>Please note that only typo players can see custom colors!",t=C(),n=v("br"),i=C(),o=v("div");for(let l=0;l<a.length;l+=1)a[l].c();_(o,"class","typo-palette-switcher svelte-144p318");},m(l,u){k(l,e,u),k(l,t,u),k(l,n,u),k(l,i,u),k(l,o,u);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(o,null);},p(l,[u]){if(u&3){s=te(l[0]);let d;for(d=0;d<s.length;d+=1){const h=Bk(l,s,d);a[d]?a[d].p(h,u):(a[d]=xk(h),a[d].c(),a[d].m(o,null));}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length;}},i:j,o:j,d(l){l&&(A(e),A(t),A(n),A(i),A(o)),Ie(a,l);}}}c(VG,"create_fragment$1e");function JG(r,e,t){let{palettes:n}=e,{onSubmit:i}=e;const o=c(s=>i(s),"click_handler");return r.$$set=s=>{"palettes"in s&&t(0,n=s.palettes),"onSubmit"in s&&t(1,i=s.onSubmit);},[n,i,o]}c(JG,"instance$17");const dy=class dy extends se{constructor(e){super(),le(this,e,JG,VG,re,{palettes:0,onSubmit:1});}};c(dy,"Color_palette_quick_select");let Yp=dy;var FG=Object.defineProperty,Ru=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&FG(e,t,i),i},"__decorateClass$P");const hy=class hy extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_toastService");f(this,"_drawingService");f(this,"_colorsService");f(this,"_modalService");f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_quickAccessSettingSubscription");f(this,"name","Color Palettes");f(this,"description","Use custom color palettes instead of the default skribbl colors");f(this,"tags",[ye.DRAWING]);f(this,"featureId",32);f(this,"_hideOriginalPaletteStyle",nn(`<style>
    #game #game-toolbar .colors:has(.top) {
      display: none;
    }
  </style>`));f(this,"_importedPalettes",new dt("imported_palettes",!1,this));f(this,"_showQuickAccessSetting",this.useSetting(new He("quick_access",!1,this).withName("Palette Switcher Icon").withDescription("Show an icon in the controls tray to quickly switch between palettes")));f(this,"_activePaletteSubscription");f(this,"_colorPalettePicker");}get boundServices(){return [this._colorsService]}get featureInfoComponent(){return {componentType:jp,props:{}}}get featureManagementComponent(){return {componentType:Gp,props:{feature:this}}}async onActivate(){if(this._activePaletteSubscription=this._colorsService.pickerColors$.subscribe(t=>this.updatePaletteStyle(t)),!await this._importedPalettes.getValue())try{const t=this.parseSavedOldTypoPalettes().filter(n=>n.name!=="sketchfulPalette");for(const n of t)await this._colorsService.savePalette(n);this._logger.info("Imported old typo palettes",t),await this._importedPalettes.setValue(!0);}catch{}this._quickAccessSettingSubscription=this._showQuickAccessSetting.changes$.subscribe(t=>{t?this.addQuickSelectIcon():this.removeQuickSelectIcon();});}async onDestroy(){var t,n,i;this._hideOriginalPaletteStyle.remove(),(t=this._activePaletteSubscription)==null||t.unsubscribe(),this._activePaletteSubscription=void 0,(n=this._colorPalettePicker)==null||n.$destroy(),(i=this._quickAccessSettingSubscription)==null||i.unsubscribe(),this._quickAccessSettingSubscription=void 0,this.removeQuickSelectIcon();}async addQuickSelectIcon(){if(this._iconComponent!==void 0)return;const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.controls,props:{hoverMove:!1,size:"48px",icon:"file-img-palette-gif",name:"Palette Switcher",order:5,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(async()=>{const n=[...Object.values(ml),...await this._colorsService.savedPalettesSetting.getValue()].map(s=>s.name),i={componentType:Yp,propsFactory:c(s=>({palettes:n,onSubmit:s.bind(this)}),"propsFactory")},o=await this._modalService.showPrompt(i.componentType,i.propsFactory,"Switch Color Palette","card");o!==void 0&&await this._colorsService.activePaletteSetting.setValue(o);});}removeQuickSelectIcon(){var t,n;(t=this._iconClickSubscription)==null||t.unsubscribe(),this._iconClickSubscription=void 0,(n=this._iconComponent)==null||n.$destroy(),this._iconComponent=void 0;}async updatePaletteStyle(t){var i;if(this._logger.info("Updating palette style",t),(i=this._colorPalettePicker)==null||i.$destroy(),t===void 0){this._hideOriginalPaletteStyle.remove();return}const n=await this._elementsSetup.complete();this._hideOriginalPaletteStyle.parentElement===null&&document.body.appendChild(this._hideOriginalPaletteStyle),this._colorPalettePicker=new $p({target:n.skribblToolbar,anchor:n.colorContainer,props:{feature:this,colors:t}});}async removePalette(t){if(this._logger.info(`Removing palette ${t}`),!await(await this._toastService.showConfirmToast(`Do you want to remove the palette ${t}?`,void 0,1e4,{confirm:"Delete palette",cancel:"Cancel deletion"})).result){this._logger.info(`User canceled removal of palette ${t}`);return}const n=await this._toastService.showLoadingToast(`Removing palette ${t}`);try{await this._colorsService.removePalette(t);}catch(i){this._logger.error(`Failed to remove palette ${t}`,i),n.reject(`Failed to remove palette ${t}`);return}n.resolve();}parsePalette(t){this._logger.info("Parsing palette from json",t);try{const n=JSON.parse(t);if(typeof n.name!="string"||typeof n.columns!="number"||!Array.isArray(n.colorHexCodes)||!n.colorHexCodes.every(i=>typeof i=="string"))throw this._logger.error("Invalid palette format",n),new Error("Invalid palette format");return n}catch(n){throw this._logger.error("Failed to parse palette from json",n),this._toastService.showToast("Failed to read palette","Invalid palette format. Check the JSON data!"),n}}parseSavedOldTypoPalettes(){this._logger.info("Parsing saved old typo palette");try{const t=localStorage.getItem("customPalettes");if(t===null)return [];const n=JSON.parse(t);if(!Array.isArray(n))throw new Error("Palette data is not an array");const i=[];return n.forEach(o=>{if(typeof o!="object"||o===null)throw new Error("Palette is not an object");const s=new Map(Object.entries(o)),a=s.get("name"),l=s.get("colors"),u=s.get("rowCount");if(typeof a!="string"||!Array.isArray(l)||typeof u!="number")throw new Error("Palette is missing properties");const d=[];for(const h of l){if(typeof h!="object")throw new Error("Color data is not a object");const m=new Map(Object.entries(h)).get("color");if(typeof m!="string")throw new Error("Color is not a string");d.push(tt.fromRgbString(m));}i.push({name:a,columns:u,colorHexCodes:d.map(h=>h.hex)});}),i}catch(t){return this._logger.error("Failed to parse saved old typo palette",t),[]}}async savePalette(t,n=void 0){this._logger.info(`Saving palette ${t.name}`,t);const i=await this._toastService.showLoadingToast(`Saving palette ${t.name}`);if(t.colorHexCodes.length===0){this._logger.error(`Palette ${t.name} has no colors`),i.reject(`Palette ${t.name} has no colors`);return}if(t.name.trim()===""){this._logger.error("Palette has no name set"),i.reject("Palette has no name set");return}if(t.columns<1){this._logger.error(`Palette ${t.name} has less than 1 column`),i.reject(`Palette ${t.name} cannot have less than 1 column`);return}try{await this._colorsService.savePalette(t,n);}catch(o){this._logger.error(`Failed to save palette ${t.name}`,o),i.reject(`Failed to save palette ${t.name}`);return}i.resolve();}async exportPalette(t){this._logger.info(`Exporting palette ${t.name} to clipboard`,t);const n=await this._toastService.showLoadingToast(`Exporting palette ${t.name} to clipboard`);try{const i=JSON.stringify(t);await navigator.clipboard.writeText(i);}catch(i){this._logger.error(`Failed to export palette ${t.name} to clipboard`,i),n.reject(`Failed to export palette ${t.name} to clipboard`);return}n.resolve();}setColor(t,n=!1){this._logger.info(`Setting color to ${t}`);const i=tt.fromHex(t);this._drawingService.setColor(i.skribblCode,n);}get savedPalettesStore(){return this._colorsService.savedPalettesSetting.store}get activePaletteStore(){return this._colorsService.activePaletteSetting.store}get defaultPalettes(){return ml}};c(hy,"DrawingColorPalettesFeature");let bi=hy;Ru([D(Me)],bi.prototype,"_elementsSetup");Ru([D(ft)],bi.prototype,"_toastService");Ru([D(zt)],bi.prototype,"_drawingService");Ru([D(Rr)],bi.prototype,"_colorsService");Ru([D(Dn)],bi.prototype,"_modalService");var WG=Object.defineProperty,HG=Object.getOwnPropertyDescriptor,QG=c((r,e,t,n)=>{for(var i=n>1?void 0:n?HG(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&WG(e,t,i),i},"__decorateClass$O"),La;let ho=(La=class{noLineEffect(e,t,n){return {lines:[e],style:n}}getSelectedColor(e,t){return t?e.secondaryColor:e.color}},c(La,"TypoDrawMod"),La);ho=QG([we()],ho);const fy=class fy extends ho{async applyEffect(e,t,n,i,o,s,a){const l=this.applyConstantEffect(e,t,n,i,o,s,a),u=l instanceof Promise?await l:l;return {lines:[u.line],style:u.style,disableSizeUpdate:u.disableSizeUpdate,disableColorUpdate:u.disableColorUpdate}}noConstantEffect(e,t,n){return {line:e,style:n}}};c(fy,"ConstantDrawMod");let En=fy;const py=class py extends En{constructor(){super(...arguments);f(this,"cursorCanvas",document.createElement("canvas"));}noCommands(){return []}createSkribblLikeCursor(t){const n=tt.fromSkribblCode(t.color).rgbArray;n[3]=.8;const i=t.size+2,o=t.size,s=this.cursorCanvas;s.width=i,s.height=i;const a=s.getContext("2d");if(!a)throw new Error("Could not get 2d context");a.clearRect(0,0,s.width,s.height),a.fillStyle=`rgba(${n[0]}, ${n[1]}, ${n[2]}, ${n[3]})`,a.beginPath(),a.arc(i/2,i/2,o/2-1,0,2*Math.PI),a.fill(),a.strokeStyle="#FFF",a.beginPath(),a.arc(i/2,i/2,o/2-1,0,2*Math.PI),a.stroke(),a.strokeStyle="#000",a.beginPath(),a.arc(i/2,i/2,o/2,0,2*Math.PI),a.stroke();const l=i/2;return {source:`url(${s.toDataURL()})`,x:l,y:l}}};c(py,"TypoDrawTool");let mn=py;var XG=Object.defineProperty,qG=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&XG(e,t,i),i},"__decorateClass$N");const my=class my extends mn{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"createCommands",this.noCommands);}createCursor(){return {source:"var(--file-img-pipette_cur-png)",x:7,y:37}}async applyConstantEffect(t,n,i,o,s,a,l){const h=(await this._elementsSetup.complete()).canvas.getContext("2d");if(h!==null){const m=h.getImageData(t.to[0],t.to[1],1,1).data.slice(0,3);l?i.secondaryColor=tt.fromRgb(m[0],m[1],m[2]).skribblCode:i.color=tt.fromRgb(m[0],m[1],m[2]).skribblCode;}return this.noConstantEffect(t,n,i)}};c(my,"PipetteTool");let gl=my;qG([D(Me)],gl.prototype,"_elementsSetup");const ch=class ch{constructor(e){f(this,"_diContainer",new AL);f(this,"_logging");f(this,"_logger");f(this,"_events");f(this,"_features");this._interceptor=e,this.bindCoreServices(),this._logging=this._diContainer.get(ni),this._logger=this._diContainer.get(rt)(this),this._events=this._diContainer.get(Va),this._features=this._diContainer.get(uo),this._logger.debug("Extension container initialized");}bindCoreServices(){this._diContainer.bind(to).toConstantValue(this._interceptor),this._diContainer.bind(ch).toConstantValue(this),this._diContainer.bind(ni).toSelf().inSingletonScope();const e=this._diContainer.get(ni);this._diContainer.bind(yd).toSelf(),this._diContainer.bind(rt).toFactory(t=>n=>{const i=t.container.get(yd).bindTo(n);return e.trackLoggerInstance(i),i}),this._diContainer.bind(bd).toSelf().inSingletonScope(),this._diContainer.bind(vd).toSelf().inSingletonScope(),this._diContainer.bind(_d).toSelf().inSingletonScope(),this._diContainer.bind(Va).toSelf().inSingletonScope(),this._diContainer.bind(io).toSelf().inSingletonScope(),this._diContainer.bind(uo).toSelf().inSingletonScope();}registerEventProcessors(...e){return e.forEach(t=>{this._diContainer.bind(t.processorType).toSelf().inSingletonScope(),this._diContainer.bind(t.listenerType).toSelf().inRequestScope();}),this}registerFeatures(...e){return e.forEach(t=>{this._diContainer.bind(t).toSelf().inSingletonScope();const n=this._diContainer.get(t);this._features.registerFeature(n);}),this}registerSetups(...e){return e.forEach(t=>{this._diContainer.bind(t).toSelf().inSingletonScope(),_P(t)&&this._diContainer.get(t).complete();}),this}registerServices(...e){return e.forEach(t=>{t.scope==="singleton"?this._diContainer.bind(t.type).toSelf().inSingletonScope():this._diContainer.bind(t.type).toSelf();}),this}resolveService(e){return this._diContainer.resolve(e)}};c(ch,"ExtensionContainer");let hu=ch;const gy=class gy{constructor(e){f(this,"_enabled",!1);f(this,"_sampleRate",1e3/60);f(this,"_currentStroke");f(this,"_strokes$",new be);f(this,"_pointerDown$",new be);f(this,"_pointerUp$",new be);this._canvas=e;}set enabled(e){this._enabled=e;}set fps(e){this._sampleRate=1e3/e;}get strokes$(){return this._strokes$.asObservable()}get pointerDown$(){return this._pointerDown$.asObservable()}get pointerUp$(){return this._pointerUp$.asObservable()}onCanvasPointerDown(e){if(!this._enabled)return;e.stopImmediatePropagation(),this._canvas.setPointerCapture(e.pointerId);const t=this._canvas.getBoundingClientRect(),n=this.mapPointerEventToDrawCoordinate(e,this._canvas,t);this._currentStroke={canvasRect:t,lastSampleDate:Date.now(),pointerDownId:performance.now(),lastCoordinates:n,secondaryActive:(e.buttons&2)===2},this._strokes$.next({from:n,to:n,cause:"down",stroke:this._currentStroke.pointerDownId,secondaryActive:this._currentStroke.secondaryActive}),this._pointerDown$.next(e);}onCanvasPointerMove(e){const t=Date.now();if(this._currentStroke===void 0||t-this._currentStroke.lastSampleDate<this._sampleRate)return;e.stopImmediatePropagation(),this._currentStroke.lastSampleDate=t;const n=this.mapPointerEventToDrawCoordinate(e,this._canvas,this._currentStroke.canvasRect);this._strokes$.next({from:this._currentStroke.lastCoordinates,to:n,cause:"move",stroke:this._currentStroke.pointerDownId,secondaryActive:this._currentStroke.secondaryActive}),this._currentStroke.lastCoordinates=n;}onDocumentPointerUp(e){if(this._currentStroke===void 0)return;const t=this.mapPointerEventToDrawCoordinate(e,this._canvas,this._currentStroke.canvasRect);this._strokes$.next({from:this._currentStroke.lastCoordinates,to:t,cause:"up",stroke:this._currentStroke.pointerDownId,secondaryActive:this._currentStroke.secondaryActive}),this._pointerUp$.next(e),this._currentStroke=void 0;}mapPointerEventToDrawCoordinate(e,t,n){const i=e.offsetX*t.width/n.width,o=e.offsetY*t.height/n.height;return [i,o,e.pointerType==="pen"?e.pressure:void 0]}};c(gy,"CoordinateListener");let zp=gy;var KG=Object.defineProperty,e$=Object.getOwnPropertyDescriptor,xi=c((r,e,t,n)=>{for(var i=n>1?void 0:n?e$(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&KG(e,t,i),i},"__decorateClass$M"),t$=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$4"),Pa;let dn=(Pa=class{constructor(e){f(this,"_prioritizedCanvasEventsSetup");f(this,"_drawingService");f(this,"_toolChangedListener");f(this,"_extensionContainer");f(this,"_lobbyService");f(this,"_sizeChangedListener");f(this,"_colorChangedListener");f(this,"_elementsSetup");f(this,"_logger");f(this,"_activeTool$",new Le(ui.brush));f(this,"_activeMods$",new Le([]));f(this,"_activeBrushStyle$",new Le({color:tt.fromHex("#000000").skribblCode,secondaryColor:tt.fromHex("#FFFFFF").skribblCode,size:1}));f(this,"_lastPointerDownPosition$",new Le(null));f(this,"_canvasCursorStyle",document.createElement("style"));f(this,"_insertedStrokes$",new be);this._logger=e(this);}postConstruct(){this._logger.debug("Post construct"),this.initListeners();}async initListeners(){const e=await this._elementsSetup.complete(),t=await this._prioritizedCanvasEventsSetup.complete();this._toolChangedListener.events$.subscribe(o=>{o.data!==ui.deselected&&o.data!==this._activeTool$.value&&(this._logger.debug("Tool changed event",o.data),this._activeTool$.next(o.data));}),this._activeTool$.pipe(Qe(this._activeBrushStyle$)).subscribe(async([o,s])=>{if(o instanceof mn){this._canvasCursorStyle.parentNode||document.body.appendChild(this._canvasCursorStyle);const a=o.createCursor(s);this._canvasCursorStyle.innerText=`#game-canvas canvas { cursor: ${a.source} ${a.x} ${a.y}, auto !important; }`;}else this._canvasCursorStyle.remove();}),this._sizeChangedListener.events$.pipe(Qe(this._colorChangedListener.events$),Oe(this._activeBrushStyle$),ce(([[o,s],a])=>{const l={...a};return l.size=o.data,s.data.target==="primary"?l.color=s.data.color.skribblCode:l.secondaryColor=s.data.color.skribblCode,l})).subscribe(o=>this._activeBrushStyle$.next(o));const n=new zp(e.canvas);t.add("draw")("pointerdown",n.onCanvasPointerDown.bind(n)),t.add("draw")("pointermove",n.onCanvasPointerMove.bind(n)),document.addEventListener("pointerup",n.onDocumentPointerUp.bind(n));const i=this._activeTool$.pipe(Qe(this._activeMods$,this._activeBrushStyle$),ce(([o,s,a])=>{const l=o instanceof mn?[o,...s]:s;return [a,o,l]}),_t(o=>this._logger.info("Drawing meta updated",o)));this._activeMods$.pipe(Qe(this._activeTool$),Se(([o,s])=>s instanceof mn||o.length>0),lt(()=>n.pointerDown$.pipe(ce(()=>!0),Kt(n.pointerUp$.pipe(ce(()=>!1)))))).subscribe(o=>{this._drawingService.disableCursorUpdates(o);}),n.strokes$.pipe(Kt(this._insertedStrokes$),Oe(i)).subscribe(([o,[s,a,l]])=>{this.processDrawCoordinates(o.from,o.to,o.cause,a,l,s,o.stroke,o.secondaryActive);}),n.pointerDown$.subscribe(o=>this._lastPointerDownPosition$.next(o)),this._lobbyService.lobby$.pipe(ce(o=>(o==null?void 0:o.meId)===(o==null?void 0:o.drawerId)),Qe(this._activeTool$,this._activeMods$),ce(([o,s,a])=>o&&(s instanceof mn||(s===ui.brush||s==ui.fill)&&a.length>0))).subscribe(o=>{n.enabled=o;});}async processDrawCoordinates(e,t,n,i,o,s,a,l){this._logger.debug("Activating tool and applying mods",e,t,o,i);const u=Date.now();let d=[{effect:{line:{from:[e[0],e[1]],to:[t[0],t[1]]},style:structuredClone(s)},strokeId:a}];const h=t[2];let p=a;for(const I of o){const S=[];for(const R of d){const E=await I.applyEffect(R.effect.line,h,R.effect.style,u,R.strokeId,n,l),P=E.lines.map(L=>({line:structuredClone(L),style:structuredClone(E.style),disableColorUpdate:E.disableColorUpdate??R.effect.disableColorUpdate,disableSizeUpdate:E.disableSizeUpdate??R.effect.disableSizeUpdate})).map((L,O)=>({effect:L,strokeId:O===0?R.strokeId:++p}));S.push(...P),this._logger.debug("Mod applied",I);}d=S;}const m=d[d.length-1].effect,b=m.disableSizeUpdate??!1,y=m.disableColorUpdate??!1;!b&&m.style.size!==s.size&&(this._logger.debug("Brush size changed by mods",m.style.size),this._drawingService.setSize(m.style.size)),!y&&m.style.color!==s.color&&(this._logger.debug("Brush color changed by mods",m.style.color),this._drawingService.setColor(m.style.color)),!y&&m.style.secondaryColor!==s.secondaryColor&&(this._logger.debug("Brush secondary color changed by mods",m.style.secondaryColor),this._drawingService.setColor(m.style.secondaryColor,!0));const w=[];if(i instanceof mn)for(const I of d){const S={from:[Math.floor(I.effect.line.from[0]),Math.floor(I.effect.line.from[1])],to:[Math.floor(I.effect.line.to[0]),Math.floor(I.effect.line.to[1])]},R=await i.createCommands(S,h,I.effect.style,u,I.strokeId,n,l);R.length>0?(w.push(...R),this._logger.debug("Adding commands created by tool",i,w)):this._logger.debug("No draw commands created from tool",i);}else if(i===ui.brush)for(const I of d){const S=l?I.effect.style.secondaryColor:I.effect.style.color,R=this._drawingService.createLineCommand([...I.effect.line.from,...I.effect.line.to],S,I.effect.style.size,!1);R!==void 0&&w.push(R);}else if(i===ui.fill&&n==="down")for(const I of d){const S=l?I.effect.style.secondaryColor:I.effect.style.color,R=this._drawingService.createFillCommand([...I.effect.line.from],S);w.push(R);}this._logger.info("Pasting draw commands",w),await this._drawingService.pasteDrawCommands(w,!1);}setSkribblTool(e){this._logger.debug("Setting skribbl tool",e),document.dispatchEvent(new CustomEvent("selectSkribblTool",{detail:e}));}async activateTool(e){this._logger.debug("Activating tool",e);const t=await Ee(this._activeTool$);if(e===t){this._logger.debug("Tool already active",e);return}e instanceof mn?this.setSkribblTool(ui.deselected):this.setSkribblTool(e),this._activeTool$.next(e),e instanceof ho&&e.applyEffect({from:[0,0],to:[0,0]},void 0,{color:tt.fromHex("#000000").skribblCode,secondaryColor:tt.fromHex("#000000").skribblCode,size:1},0,0,"down",!1),e instanceof mn&&e.createCommands({from:[0,0],to:[0,0]},void 0,{color:tt.fromHex("#000000").skribblCode,secondaryColor:tt.fromHex("#000000").skribblCode,size:1},0,0,"down",!1);}async activateMod(e){this._logger.debug("Activating mod",e);let t=await Ee(this._activeMods$);this._logger.debug("Current mods",t),e instanceof En||(t=t.filter(n=>n instanceof En)),t=[...t,e],this._logger.info("Activated mod",t),this._activeMods$.next(t);}async removeMod(e){this._logger.debug("Removing mod",e);let t=await Ee(this._activeMods$);const n=t.length;t=t.filter(i=>i!==e),n!=t.length&&(this._logger.info("Disabled mod",t),this._activeMods$.next(t));}get activeTool$(){return this._activeTool$.asObservable()}get activeMods$(){return this._activeMods$.asObservable()}get activeBrushStyle$(){return this._activeBrushStyle$.asObservable()}get lastPointerDownPosition$(){return this._lastPointerDownPosition$.asObservable()}resolveModOrTool(e){return this._extensionContainer.resolveService(e)}insertStroke(e){this._insertedStrokes$.next(e);}},c(Pa,"ToolsService"),Pa);xi([D(Er)],dn.prototype,"_prioritizedCanvasEventsSetup",2);xi([D(zt)],dn.prototype,"_drawingService",2);xi([D(tu)],dn.prototype,"_toolChangedListener",2);xi([D(hu)],dn.prototype,"_extensionContainer",2);xi([D(ut)],dn.prototype,"_lobbyService",2);xi([D(qc)],dn.prototype,"_sizeChangedListener",2);xi([D(Wa)],dn.prototype,"_colorChangedListener",2);xi([D(Me)],dn.prototype,"_elementsSetup",2);xi([zr()],dn.prototype,"postConstruct",1);dn=xi([we(),t$(0,D(rt))],dn);function n$(r){let e,t,n,i;return {c(){e=G("Add a hotkey to quickly focus the chat input, so you can start guessing right away. "),t=v("br"),n=G(`
If the auto-focus setting is enabled, the chat input will be focused automatically when someone else starts drawing. `),i=v("br");},m(o,s){k(o,e,s),k(o,t,s),k(o,n,s),k(o,i,s);},p:j,i:j,o:j,d(o){o&&(A(e),A(t),A(n),A(i));}}}c(n$,"create_fragment$1d");const by=class by extends se{constructor(e){super(),le(this,e,null,n$,re,{});}};c(by,"Drawing_color_tools_info");let Up=by;function i$(r){let e,t,n,i,o,s,a,l;return o=new pi({props:{color:r[2].primary,allowAlpha:!1,useBackground:!1,height:"auto",borderRadius:"0",colorChanged:r[6],description:"Warning: Only typo users can see custom colors."}}),{c(){e=v("div"),t=v("div"),n=C(),i=v("div"),V(o.$$.fragment),_(t,"class","pipette svelte-iqw7hb"),ue(t,"selected",r[1]instanceof gl),_(i,"class","picker svelte-iqw7hb"),_(e,"class","color-tools svelte-iqw7hb");},m(u,d){k(u,e,d),g(e,t),g(e,n),g(e,i),x(o,i,null),s=!0,a||(l=[F(t,"click",r[5]),oi(r[0].createTooltip(t,{title:"Pipette",lock:"Y"})),oi(r[0].createTooltip(i,{title:"Picker",lock:"Y"}))],a=!0);},p(u,[d]){(!s||d&2)&&ue(t,"selected",u[1]instanceof gl);const h={};d&4&&(h.color=u[2].primary),d&1&&(h.colorChanged=u[6]),o.$set(h);},i(u){s||(T(o.$$.fragment,u),s=!0);},o(u){M(o.$$.fragment,u),s=!1;},d(u){u&&A(e),Z(o),a=!1,Je(l);}}}c(i$,"create_fragment$1c");function r$(r,e,t){let n,i,{feature:o}=e;const s=o.selectedToolStore;De(r,s,d=>t(1,n=d));const a=o.colorStore;De(r,a,d=>t(2,i=d));const l=c(()=>o.selectPipetteTool(),"click_handler"),u=c(d=>o.updatePickedColor(d),"func");return r.$$set=d=>{"feature"in d&&t(0,o=d.feature);},[o,n,i,s,a,l,u]}c(r$,"instance$16");const vy=class vy extends se{constructor(e){super(),le(this,e,r$,i$,re,{feature:0});}};c(vy,"Drawing_color_tools");let Bp=vy;var o$=Object.defineProperty,Gh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&o$(e,t,i),i},"__decorateClass$L");const _y=class _y extends $e{constructor(){super(...arguments);f(this,"elementsSetup");f(this,"_toolsService");f(this,"_drawingService");f(this,"_colorChangedListener");f(this,"name","Color Tools");f(this,"description","Add a pipette and color picker to the toolbar");f(this,"tags",[ye.DRAWING]);f(this,"featureId",31);f(this,"pipetteHotkey",this.useHotkey(new cn("activate_pipette","Use Pipette","Activate the pipette tool to select a color from the canvas",this,()=>this.selectPipetteTool(),void 0)));f(this,"_component");f(this,"_pipetteTool");f(this,"_colorChangeSubscription");f(this,"_currentColor$",new Le({primary:tt.fromHex("#000000"),secondary:tt.fromHex("#ffffff")}));}get featureInfoComponent(){return {componentType:Up,props:{}}}async onActivate(){const t=await this.elementsSetup.complete();this._pipetteTool=this._toolsService.resolveModOrTool(gl),this._colorChangedListener.events$.pipe(Oe(this._currentColor$),Se(([n,i])=>n.data.target==="primary"?n.data.color.hex!==i.primary.hex:n.data.color.hex!==i.secondary.hex)).subscribe(([n,i])=>{const o={...i};n.data.target==="primary"?o.primary=n.data.color:o.secondary=n.data.color,this._currentColor$.next(o);}),this._component=new Bp({target:t.skribblTools,anchor:t.skribblBrushTools,props:{feature:this}});}async onDestroy(){var t,n;(t=this._component)==null||t.$destroy(),this._component=void 0,(n=this._colorChangeSubscription)==null||n.unsubscribe(),this._colorChangeSubscription=void 0,this._pipetteTool=void 0;}async selectPipetteTool(){if(!this._pipetteTool)throw this._logger.error("Pipette tool not initialized"),new Error("Pipette tool not initialized yet");this._logger.info("Pipette tool selected"),await this._toolsService.activateTool(this._pipetteTool);}get selectedToolStore(){return it(this._toolsService.activeTool$,ui.brush)}get colorStore(){return it(this._currentColor$,this._currentColor$.value)}updatePickedColor(t){this._logger.info("Color picked",t),this._drawingService.setColor(t.skribblCode);}};c(_y,"DrawingColorToolsFeature");let Lr=_y;Gh([D(Me)],Lr.prototype,"elementsSetup");Gh([D(dn)],Lr.prototype,"_toolsService");Gh([D(zt)],Lr.prototype,"_drawingService");Gh([D(Wa)],Lr.prototype,"_colorChangedListener");const _b=c((r,e,t)=>{const n=1/(1+Math.exp(t*e)),i=1/(1+Math.exp(-e*(r-t))),o=1/(1+Math.exp(-e*(1-t)));return (i-n)/(o-n)},"calculatePressurePoint"),yy=class yy extends En{constructor(){super(...arguments);f(this,"_maxSize",40);f(this,"_minSize",4);f(this,"_sensitivity",6);f(this,"_balance",.5);}applyConstantEffect(t,n,i){if(n===void 0)return {style:i,line:t};const o=_b(n,this._sensitivity,this._balance),s=Math.floor(this._minSize+(this._maxSize-this._minSize)*o);return i.size=s,{style:i,line:t,disableSizeUpdate:!0}}setParams(t,n){this._sensitivity=t,this._balance=n;}};c(yy,"PressureMod");let Fd=yy;function s$(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S;return {c(){e=v("div"),t=v("p"),t.innerHTML=`Typo modifies pressure so that you can use the full brush size range without switching brush sizes in skribbl.<br/>
    Additionally, you can customize the sensitivity of the pen pressure.<br/>
    By default, a performance mode is activated. This mode is recommended for devices with lower performance.<br/>
    The performance mode uses a simplified pressure function and does not work with the Brush Lab.<br/>
    To use pressure in combination with the typo brush laboratory, disable performance mode or enable the &quot;Disable performance in Lab&quot; to automatically disable performance mode whenever you&#39;re using the lab.<br/>`,n=C(),i=v("br"),o=C(),s=v("b"),s.textContent="Attention!",a=C(),l=v("p"),l.textContent='The performance mode needs "Pressure Sensitivity" enabled in the skribbl settings.',u=C(),d=v("br"),h=C(),p=v("b"),p.textContent="Current sensitivity curve:",m=C(),b=v("p"),b.innerHTML=`The sensitivity curve shows how the brush size changes depending on pen pressure.<br/>
    The x-axis represents the pressure (from light to hard), and the y-axis represents the brush size (small to big).`,y=C(),w=v("br"),I=C(),S=v("canvas"),_(S,"width","100"),_(S,"height","100"),_(S,"class","svelte-18097wc");},m(R,E){k(R,e,E),g(e,t),g(e,n),g(e,i),g(e,o),g(e,s),g(e,a),g(e,l),g(e,u),g(e,d),g(e,h),g(e,p),g(e,m),g(e,b),g(e,y),g(e,w),g(e,I),g(e,S),r[6](S);},p:j,i:j,o:j,d(R){R&&A(e),r[6](null);}}}c(s$,"create_fragment$1b");function a$(r,e,t){let n,i,{feature:o}=e;const s=o.sensitivitySettingStore;De(r,s,d=>t(5,i=d));const a=o.balanceSettingStore;De(r,a,d=>t(4,n=d));let l;function u(d){Ve[d?"unshift":"push"](()=>{l=d,t(0,l);});}return c(u,"canvas_1_binding"),r.$$set=d=>{"feature"in d&&t(3,o=d.feature);},r.$$.update=()=>{if(r.$$.dirty&49){let d=i,h=n;const p=l==null?void 0:l.getContext("2d");if(p){p.imageSmoothingEnabled=!1,p.clearRect(0,0,100,100),p.fillStyle="white",p.lineWidth=2,p.fillRect(0,0,100,100),p.strokeStyle="rgb(0, 0, 0)",p.beginPath();for(let m=0;m<100;m++)p.lineTo(m,100-_b(m/100,d,h)*100);p.stroke();}}},[l,s,a,o,n,i,u]}c(a$,"instance$15");const wy=class wy extends se{constructor(e){super(),le(this,e,a$,s$,re,{feature:3});}};c(wy,"Drawing_pressure_info");let xp=wy;var l$=Object.defineProperty,SE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&l$(e,t,i),i},"__decorateClass$K");const Sy=class Sy extends $e{constructor(){super(...arguments);f(this,"_toolsService");f(this,"_drawingService");f(this,"name","Modified Pen Pressure");f(this,"description","Use the full size range and custom sensitivity for pen pressure");f(this,"tags",[ye.DRAWING]);f(this,"featureId",37);f(this,"_currentPointerType",new be);f(this,"_performanceEnabledSubscription");f(this,"_currentPointerTypeSubscription");f(this,"_pointerOverListener",this.handlePointerOver.bind(this));f(this,"_performanceEnabledSetting",this.useSetting(new He("pressure_performance",!0,this).withName("Performance Mode").withDescription("Better pressure support for less performant devices, but can't be used in combination with the brush laboratory.")));f(this,"_pressureParamSensitivitySetting",this.useSetting(new Wt("pressure_sensitivity",6,this).withName("Pressure Sensitivity").withDescription("The sensitivity of pressure change. A higher value means a more dense pressure range.").withBounds(1,20).withSlider(1)));f(this,"_pressureParamBalanceSetting",this.useSetting(new Wt("pressure_balance",.5,this).withName("Pressure Balance").withDescription("The balance of pressure increase. A higher value moves the size range to a higher pressure range.").withBounds(0,1).withSlider(1/20)));f(this,"_disablePerformanceInBrushlabSetting",this.useSetting(new He("pressure_disable_performance_brushlab",!1,this).withName("Disable Performance in Lab").withDescription("Automatically disables the performance mode (if active) when using the Brush Lab. This might cause lags on less performant devices.")));f(this,"_pressureMod");}handlePointerOver(t){this._currentPointerType.next(t.pointerType);}get featureInfoComponent(){return {componentType:xp,props:{feature:this}}}async onActivate(){const t=this._disablePerformanceInBrushlabSetting.changes$.pipe(Qe(this._toolsService.activeMods$,this._toolsService.activeTool$),ce(([n,i,o])=>n&&(o instanceof mn||i.filter(s=>!(s instanceof Fd)).length>0)));this._performanceEnabledSubscription=this._performanceEnabledSetting.changes$.pipe(Qe(this._pressureParamSensitivitySetting.changes$,this._pressureParamBalanceSetting.changes$,t)).subscribe(async([n,i,o,s])=>{n&&!s?(this._pressureMod&&(await this._toolsService.removeMod(this._pressureMod),this._pressureMod=void 0),document.documentElement.dataset.typo_pressure_performance=this.getPerformanceFunctionEval(i,o)):(this._pressureMod||(this._pressureMod=this._toolsService.resolveModOrTool(Fd),await this._toolsService.activateMod(this._pressureMod)),this._pressureMod.setParams(i,o),document.documentElement.dataset.typo_pressure_performance="");}),document.addEventListener("pointerover",this._pointerOverListener),this._currentPointerTypeSubscription=this._currentPointerType.pipe(ct()).subscribe(n=>{n==="pen"&&(this._logger.info("Pen detected, resetting size to 4"),this._drawingService.setSize(4));});}getPerformanceFunctionEval(t,n){return `(pressure) => (${_b.toString()})(pressure, ${t}, ${n})`}async onDestroy(){var t,n;this._pressureMod&&(this._toolsService.removeMod(this._pressureMod),this._pressureMod=void 0),document.documentElement.dataset.typo_pressure_performance="",(t=this._performanceEnabledSubscription)==null||t.unsubscribe(),this._performanceEnabledSubscription=void 0,document.removeEventListener("pointerover",this._pointerOverListener),(n=this._currentPointerTypeSubscription)==null||n.unsubscribe();}get balanceSettingStore(){return this._pressureParamBalanceSetting.store}get sensitivitySettingStore(){return this._pressureParamSensitivitySetting.store}};c(Sy,"DrawingPressureFeature");let fo=Sy;SE([D(dn)],fo.prototype,"_toolsService");SE([D(zt)],fo.prototype,"_drawingService");const Ay=class Ay{constructor(e,t){f(this,"dispose",c(()=>{for(const e of this.receiverMethod)this.connection.off(e.methodName,e.method);},"dispose"));this.connection=e,this.receiverMethod=t;}};c(Ay,"ReceiverMethodSubscription");let fu=Ay;const c$=c(r=>{if(r==="IGuildLobbiesHub")return Zp.Instance;if(r==="ILobbyHub")return Jp.Instance;if(r==="IOnlineItemsHub")return Wp.Instance},"getHubProxyFactory"),u$=c(r=>{if(r==="IGuildLobbiesReceiver")return Qp.Instance;if(r==="ILobbyReceiver")return Xp.Instance;if(r==="IOnlineItemsReceiver")return qp.Instance},"getReceiverRegister"),lc=class lc{constructor(){f(this,"createHubProxy",c(e=>new Vp(e),"createHubProxy"));}};c(lc,"IGuildLobbiesHub_HubProxyFactory"),f(lc,"Instance",new lc);let Zp=lc;const ky=class ky{constructor(e){f(this,"subscribeGuildLobbies",c(async e=>await this.connection.invoke("SubscribeGuildLobbies",e),"subscribeGuildLobbies"));this.connection=e;}};c(ky,"IGuildLobbiesHub_HubProxy");let Vp=ky;const cc=class cc{constructor(){f(this,"createHubProxy",c(e=>new Fp(e),"createHubProxy"));}};c(cc,"ILobbyHub_HubProxyFactory"),f(cc,"Instance",new cc);let Jp=cc;const Cy=class Cy{constructor(e){f(this,"lobbyDiscovered",c(async e=>await this.connection.invoke("LobbyDiscovered",e),"lobbyDiscovered"));f(this,"claimLobbyOwnership",c(async()=>await this.connection.invoke("ClaimLobbyOwnership"),"claimLobbyOwnership"));f(this,"updateSkribblLobbyState",c(async e=>await this.connection.invoke("UpdateSkribblLobbyState",e),"updateSkribblLobbyState"));f(this,"updateTypoLobbySettings",c(async e=>await this.connection.invoke("UpdateTypoLobbySettings",e),"updateTypoLobbySettings"));f(this,"claimDrop",c(async e=>await this.connection.invoke("ClaimDrop",e),"claimDrop"));f(this,"giftAward",c(async e=>await this.connection.invoke("GiftAward",e),"giftAward"));this.connection=e;}};c(Cy,"ILobbyHub_HubProxy");let Fp=Cy;const uc=class uc{constructor(){f(this,"createHubProxy",c(e=>new Hp(e),"createHubProxy"));}};c(uc,"IOnlineItemsHub_HubProxyFactory"),f(uc,"Instance",new uc);let Wp=uc;const Iy=class Iy{constructor(e){this.connection=e;}};c(Iy,"IOnlineItemsHub_HubProxy");let Hp=Iy;const dc=class dc{constructor(){f(this,"register",c((e,t)=>{const n=c((...o)=>t.guildLobbiesUpdated(...o),"__guildLobbiesUpdated");e.on("GuildLobbiesUpdated",n);const i=[{methodName:"GuildLobbiesUpdated",method:n}];return new fu(e,i)},"register"));}};c(dc,"IGuildLobbiesReceiver_Binder"),f(dc,"Instance",new dc);let Qp=dc;const hc=class hc{constructor(){f(this,"register",c((e,t)=>{const n=c((...d)=>t.typoLobbySettingsUpdated(...d),"__typoLobbySettingsUpdated"),i=c(()=>t.lobbyOwnershipResigned(),"__lobbyOwnershipResigned"),o=c((...d)=>t.dropAnnounced(...d),"__dropAnnounced"),s=c((...d)=>t.awardGifted(...d),"__awardGifted"),a=c((...d)=>t.dropClaimed(...d),"__dropClaimed"),l=c((...d)=>t.dropCleared(...d),"__dropCleared");e.on("TypoLobbySettingsUpdated",n),e.on("LobbyOwnershipResigned",i),e.on("DropAnnounced",o),e.on("AwardGifted",s),e.on("DropClaimed",a),e.on("DropCleared",l);const u=[{methodName:"TypoLobbySettingsUpdated",method:n},{methodName:"LobbyOwnershipResigned",method:i},{methodName:"DropAnnounced",method:o},{methodName:"AwardGifted",method:s},{methodName:"DropClaimed",method:a},{methodName:"DropCleared",method:l}];return new fu(e,u)},"register"));}};c(hc,"ILobbyReceiver_Binder"),f(hc,"Instance",new hc);let Xp=hc;const fc=class fc{constructor(){f(this,"register",c((e,t)=>{const n=c((...o)=>t.onlineItemsUpdated(...o),"__onlineItemsUpdated");e.on("OnlineItemsUpdated",n);const i=[{methodName:"OnlineItemsUpdated",method:n}];return new fu(e,i)},"register"));}};c(fc,"IOnlineItemsReceiver_Binder"),f(fc,"Instance",new fc);let qp=fc;const Ty=class Ty extends Error{constructor(e,t){const n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n;}};c(Ty,"HttpError");let sr=Ty;const Dy=class Dy extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t;}};c(Dy,"TimeoutError");let pu=Dy;const Ey=class Ey extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t;}};c(Ey,"AbortError");let Un=Ey;const My=class My extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=n;}};c(My,"UnsupportedTransportError");let Kp=My;const Ry=class Ry extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=n;}};c(Ry,"DisabledTransportError");let em=Ry;const Ly=class Ly extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=n;}};c(Ly,"FailedToStartTransportError");let tm=Ly;const Py=class Py extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t;}};c(Py,"FailedToNegotiateWithServerError");let Wd=Py;const Ny=class Ny extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n;}};c(Ny,"AggregateErrors");let nm=Ny;const Oy=class Oy{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n;}};c(Oy,"HttpResponse");let Hd=Oy;const jy=class jy{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return ""}};c(jy,"HttpClient");let bl=jy;var oe;(function(r){r[r.Trace=0]="Trace",r[r.Debug=1]="Debug",r[r.Information=2]="Information",r[r.Warning=3]="Warning",r[r.Error=4]="Error",r[r.Critical=5]="Critical",r[r.None=6]="None";})(oe||(oe={}));const Gy=class Gy{constructor(){}log(e,t){}};c(Gy,"NullLogger");let po=Gy;po.instance=new po;const d$="8.0.7",$y=class $y{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}};c($y,"Arg");let Ft=$y;const Ko=class Ko{static get isBrowser(){return !Ko.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return !Ko.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return !Ko.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}};c(Ko,"Platform");let qt=Ko;function mu(r,e){let t="";return mo(r)?(t=`Binary data of length ${r.byteLength}`,e&&(t+=`. Content: '${h$(r)}'`)):typeof r=="string"&&(t=`String data of length ${r.length}`,e&&(t+=`. Content: '${r}'`)),t}c(mu,"getDataDetail");function h$(r){const e=new Uint8Array(r);let t="";return e.forEach(n=>{const i=n<16?"0":"";t+=`0x${i}${n.toString(16)} `;}),t.substr(0,t.length-1)}c(h$,"formatArrayBuffer");function mo(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}c(mo,"isArrayBuffer");async function AE(r,e,t,n,i,o){const s={},[a,l]=_l();s[a]=l,r.log(oe.Trace,`(${e} transport) sending data. ${mu(i,o.logMessageContent)}.`);const u=mo(i)?"arraybuffer":"text",d=await t.post(n,{content:i,headers:{...s,...o.headers},responseType:u,timeout:o.timeout,withCredentials:o.withCredentials});r.log(oe.Trace,`(${e} transport) request complete. Response status: ${d.statusCode}.`);}c(AE,"sendMessage");function f$(r){return r===void 0?new vl(oe.Information):r===null?po.instance:r.log!==void 0?r:new vl(r)}c(f$,"createLogger");const Yy=class Yy{constructor(e,t){this._subject=e,this._observer=t;}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{});}};c(Yy,"SubjectSubscription");let im=Yy;const zy=class zy{constructor(e){this._minLevel=e,this.out=console;}log(e,t){if(e>=this._minLevel){const n=`[${new Date().toISOString()}] ${oe[e]}: ${t}`;switch(e){case oe.Critical:case oe.Error:this.out.error(n);break;case oe.Warning:this.out.warn(n);break;case oe.Information:this.out.info(n);break;default:this.out.log(n);break}}}};c(zy,"ConsoleLogger");let vl=zy;function _l(){let r="X-SignalR-User-Agent";return qt.isNode&&(r="User-Agent"),[r,p$(d$,m$(),b$(),g$())]}c(_l,"getUserAgentHeader");function p$(r,e,t,n){let i="Microsoft SignalR/";const o=r.split(".");return i+=`${o[0]}.${o[1]}`,i+=` (${r}; `,e&&e!==""?i+=`${e}; `:i+="Unknown OS; ",i+=`${t}`,n?i+=`; ${n}`:i+="; Unknown Runtime Version",i+=")",i}c(p$,"constructUserAgent");function m$(){if(qt.isNode)switch(process.platform){case"win32":return "Windows NT";case"darwin":return "macOS";case"linux":return "Linux";default:return process.platform}else return ""}c(m$,"getOsName");function g$(){if(qt.isNode)return process.versions.node}c(g$,"getRuntimeVersion");function b$(){return qt.isNode?"NodeJS":"Browser"}c(b$,"getRuntime");function kf(r){return r.stack?r.stack:r.message?r.message:`${r}`}c(kf,"getErrorString");function v$(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}c(v$,"getGlobalThis");const Uy=class Uy extends bl{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||qt.isNode){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(t("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=t("node-fetch"):this._fetchType=fetch,this._fetchType=t("fetch-cookie")(this._fetchType,this._jar);}else this._fetchType=fetch.bind(v$());if(typeof AbortController>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=t("abort-controller");}else this._abortControllerType=AbortController;}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new Un;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let n;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),n=new Un;});let i=null;if(e.timeout){const l=e.timeout;i=setTimeout(()=>{t.abort(),this._logger.log(oe.Warning,"Timeout from HTTP request."),n=new pu;},l);}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},mo(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");let o;try{o=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal});}catch(l){throw n||(this._logger.log(oe.Warning,`Error from HTTP request. ${l}.`),l)}finally{i&&clearTimeout(i),e.abortSignal&&(e.abortSignal.onabort=null);}if(!o.ok){const l=await Zk(o,"text");throw new sr(l||o.statusText,o.status)}const a=await Zk(o,e.responseType);return new Hd(o.status,o.statusText,a)}getCookieString(e){let t="";return qt.isNode&&this._jar&&this._jar.getCookies(e,(n,i)=>t=i.join("; ")),t}};c(Uy,"FetchHttpClient");let rm=Uy;function Zk(r,e){let t;switch(e){case"arraybuffer":t=r.arrayBuffer();break;case"text":t=r.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:t=r.text();break}return t}c(Zk,"deserializeContent");const By=class By extends bl{constructor(e){super(),this._logger=e;}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Un):e.method?e.url?new Promise((t,n)=>{const i=new XMLHttpRequest;i.open(e.method,e.url,!0),i.withCredentials=e.withCredentials===void 0?!0:e.withCredentials,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(mo(e.content)?i.setRequestHeader("Content-Type","application/octet-stream"):i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const o=e.headers;o&&Object.keys(o).forEach(s=>{i.setRequestHeader(s,o[s]);}),e.responseType&&(i.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),n(new Un);}),e.timeout&&(i.timeout=e.timeout),i.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),i.status>=200&&i.status<300?t(new Hd(i.status,i.statusText,i.response||i.responseText)):n(new sr(i.response||i.responseText||i.statusText,i.status));},i.onerror=()=>{this._logger.log(oe.Warning,`Error from HTTP request. ${i.status}: ${i.statusText}.`),n(new sr(i.statusText,i.status));},i.ontimeout=()=>{this._logger.log(oe.Warning,"Timeout from HTTP request."),n(new pu);},i.send(e.content);}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}};c(By,"XhrHttpClient");let om=By;const xy=class xy extends bl{constructor(e){if(super(),typeof fetch<"u"||qt.isNode)this._httpClient=new rm(e);else if(typeof XMLHttpRequest<"u")this._httpClient=new om(e);else throw new Error("No usable HttpClient found.")}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Un):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}};c(xy,"DefaultHttpClient");let sm=xy;const es=class es{static write(e){return `${e}${es.RecordSeparator}`}static parse(e){if(e[e.length-1]!==es.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(es.RecordSeparator);return t.pop(),t}};c(es,"TextMessageFormat");let hi=es;hi.RecordSeparatorCode=30;hi.RecordSeparator=String.fromCharCode(hi.RecordSeparatorCode);const Zy=class Zy{writeHandshakeRequest(e){return hi.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(mo(e)){const a=new Uint8Array(e),l=a.indexOf(hi.RecordSeparatorCode);if(l===-1)throw new Error("Message is incomplete.");const u=l+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(a.slice(0,u))),n=a.byteLength>u?a.slice(u).buffer:null;}else {const a=e,l=a.indexOf(hi.RecordSeparator);if(l===-1)throw new Error("Message is incomplete.");const u=l+1;t=a.substring(0,u),n=a.length>u?a.substring(u):null;}const i=hi.parse(t),o=JSON.parse(i[0]);if(o.type)throw new Error("Expected a handshake response from the server.");return [n,o]}};c(Zy,"HandshakeProtocol");let am=Zy;var We;(function(r){r[r.Invocation=1]="Invocation",r[r.StreamItem=2]="StreamItem",r[r.Completion=3]="Completion",r[r.StreamInvocation=4]="StreamInvocation",r[r.CancelInvocation=5]="CancelInvocation",r[r.Ping=6]="Ping",r[r.Close=7]="Close",r[r.Ack=8]="Ack",r[r.Sequence=9]="Sequence";})(We||(We={}));const Vy=class Vy{constructor(){this.observers=[];}next(e){for(const t of this.observers)t.next(e);}error(e){for(const t of this.observers)t.error&&t.error(e);}complete(){for(const e of this.observers)e.complete&&e.complete();}subscribe(e){return this.observers.push(e),new im(this,e)}};c(Vy,"Subject");let lm=Vy;const Jy=class Jy{constructor(e,t,n){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=n;}async _send(e){const t=this._protocol.writeMessage(e);let n=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let i=c(()=>{},"backpressurePromiseResolver"),o=c(()=>{},"backpressurePromiseRejector");mo(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(n=new Promise((s,a)=>{i=s,o=a;})),this._messages.push(new um(t,this._totalMessageCount,i,o));}try{this._reconnectInProgress||await this._connection.send(t);}catch{this._disconnected();}await n;}_ack(e){let t=-1;for(let n=0;n<this._messages.length;n++){const i=this._messages[n];if(i._id<=e.sequenceId)t=n,mo(i._message)?this._bufferedByteCount-=i._message.byteLength:this._bufferedByteCount-=i._message.length,i._resolver();else if(this._bufferedByteCount<this._bufferSize)i._resolver();else break}t!==-1&&(this._messages=this._messages.slice(t+1));}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type!==We.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return !0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){if(e.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=e.sequenceId;}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0;}async _resend(){const e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:We.Sequence,sequenceId:e}));const t=this._messages;for(const n of t)await this._connection.send(n._message);this._reconnectInProgress=!1;}_dispose(e){e??(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e);}_isInvocationMessage(e){switch(e.type){case We.Invocation:case We.StreamItem:case We.Completion:case We.StreamInvocation:case We.CancelInvocation:return !0;case We.Close:case We.Sequence:case We.Ping:case We.Ack:return !1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:We.Ack,sequenceId:this._latestReceivedSequenceId}));}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0;},1e3));}};c(Jy,"MessageBuffer");let cm=Jy;const Fy=class Fy{constructor(e,t,n,i){this._message=e,this._id=t,this._resolver=n,this._rejector=i;}};c(Fy,"BufferedItem");let um=Fy;const _$=30*1e3,y$=15*1e3,w$=1e5;var Nt;(function(r){r.Disconnected="Disconnected",r.Connecting="Connecting",r.Connected="Connected",r.Disconnecting="Disconnecting",r.Reconnecting="Reconnecting";})(Nt||(Nt={}));const uh=class uh{static create(e,t,n,i,o,s,a){return new uh(e,t,n,i,o,s,a)}constructor(e,t,n,i,o,s,a){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(oe.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep");},Ft.isRequired(e,"connection"),Ft.isRequired(t,"logger"),Ft.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=o??_$,this.keepAliveIntervalInMilliseconds=s??y$,this._statefulReconnectBufferSize=a??w$,this._logger=t,this._protocol=n,this.connection=e,this._reconnectPolicy=i,this._handshakeProtocol=new am,this.connection.onreceive=l=>this._processIncomingData(l),this.connection.onclose=l=>this._connectionClosed(l),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Nt.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:We.Ping});}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Nt.Disconnected&&this._connectionState!==Nt.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e;}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==Nt.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=Nt.Connecting,this._logger.log(oe.Debug,"Starting HubConnection.");try{await this._startInternal(),qt.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=Nt.Connected,this._connectionStarted=!0,this._logger.log(oe.Debug,"HubConnection connected successfully.");}catch(e){return this._connectionState=Nt.Disconnected,this._logger.log(oe.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((t,n)=>{this._handshakeResolver=t,this._handshakeRejecter=n;});await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const n={protocol:this._protocol.name,version:t};if(this._logger.log(oe.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(n)),this._logger.log(oe.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new cm(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage);}catch(t){throw this._logger.log(oe.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e;}catch{}}_stopInternal(e){if(this._connectionState===Nt.Disconnected)return this._logger.log(oe.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===Nt.Disconnecting)return this._logger.log(oe.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=Nt.Disconnecting,this._logger.log(oe.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(oe.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===Nt.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new Un("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage());}catch{}}stream(e,...t){const[n,i]=this._replaceStreamingParams(t),o=this._createStreamInvocation(e,t,i);let s;const a=new lm;return a.cancelCallback=()=>{const l=this._createCancelInvocation(o.invocationId);return delete this._callbacks[o.invocationId],s.then(()=>this._sendWithProtocol(l))},this._callbacks[o.invocationId]=(l,u)=>{if(u){a.error(u);return}else l&&(l.type===We.Completion?l.error?a.error(new Error(l.error)):a.complete():a.next(l.item));},s=this._sendWithProtocol(o).catch(l=>{a.error(l),delete this._callbacks[o.invocationId];}),this._launchStreams(n,s),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[n,i]=this._replaceStreamingParams(t),o=this._sendWithProtocol(this._createInvocation(e,t,!0,i));return this._launchStreams(n,o),o}invoke(e,...t){const[n,i]=this._replaceStreamingParams(t),o=this._createInvocation(e,t,!1,i);return new Promise((a,l)=>{this._callbacks[o.invocationId]=(d,h)=>{if(h){l(h);return}else d&&(d.type===We.Completion?d.error?l(new Error(d.error)):a(d.result):l(new Error(`Unexpected message type: ${d.type}`)));};const u=this._sendWithProtocol(o).catch(d=>{l(d),delete this._callbacks[o.invocationId];});this._launchStreams(n,u);})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t));}off(e,t){if(!e)return;e=e.toLowerCase();const n=this._methods[e];if(n)if(t){const i=n.indexOf(t);i!==-1&&(n.splice(i,1),n.length===0&&delete this._methods[e]);}else delete this._methods[e];}onclose(e){e&&this._closedCallbacks.push(e);}onreconnecting(e){e&&this._reconnectingCallbacks.push(e);}onreconnected(e){e&&this._reconnectedCallbacks.push(e);}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const n of t)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(n)))switch(n.type){case We.Invocation:this._invokeClientMethod(n).catch(i=>{this._logger.log(oe.Error,`Invoke client method threw error: ${kf(i)}`);});break;case We.StreamItem:case We.Completion:{const i=this._callbacks[n.invocationId];if(i){n.type===We.Completion&&delete this._callbacks[n.invocationId];try{i(n);}catch(o){this._logger.log(oe.Error,`Stream callback threw error: ${kf(o)}`);}}break}case We.Ping:break;case We.Close:{this._logger.log(oe.Information,"Close message received from server.");const i=n.error?new Error("Server returned an error on close: "+n.error):void 0;n.allowReconnect===!0?this.connection.stop(i):this._stopPromise=this._stopInternal(i);break}case We.Ack:this._messageBuffer&&this._messageBuffer._ack(n);break;case We.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(n);break;default:this._logger.log(oe.Warning,`Invalid message type: ${n.type}.`);break}}this._resetTimeoutPeriod();}_processHandshakeResponse(e){let t,n;try{[n,t]=this._handshakeProtocol.parseHandshakeResponse(e);}catch(i){const o="Error parsing handshake response: "+i;this._logger.log(oe.Error,o);const s=new Error(o);throw this._handshakeRejecter(s),s}if(t.error){const i="Server returned handshake error: "+t.error;this._logger.log(oe.Error,i);const o=new Error(i);throw this._handshakeRejecter(o),o}else this._logger.log(oe.Debug,"Server handshake complete.");return this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer());}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===Nt.Connected)try{await this._sendMessage(this._cachedPingMessage);}catch{this._cleanupPingTimer();}},e);}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."));}async _invokeClientMethod(e){const t=e.target.toLowerCase(),n=this._methods[t];if(!n){this._logger.log(oe.Warning,`No client method with the name '${t}' found.`),e.invocationId&&(this._logger.log(oe.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)));return}const i=n.slice(),o=!!e.invocationId;let s,a,l;for(const u of i)try{const d=s;s=await u.apply(this,e.arguments),o&&s&&d&&(this._logger.log(oe.Error,`Multiple results provided for '${t}'. Sending error to server.`),l=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),a=void 0;}catch(d){a=d,this._logger.log(oe.Error,`A callback for the method '${t}' threw error '${d}'.`);}l?await this._sendWithProtocol(l):o?(a?l=this._createCompletionMessage(e.invocationId,`${a}`,null):s!==void 0?l=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(oe.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),l=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(l)):s&&this._logger.log(oe.Error,`Result given for '${t}' method but server is not expecting a result.`);}_connectionClosed(e){this._logger.log(oe.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new Un("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Nt.Disconnecting?this._completeClose(e):this._connectionState===Nt.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Nt.Connected&&this._completeClose(e);}_completeClose(e){if(this._connectionStarted){this._connectionState=Nt.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),qt.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]));}catch(t){this._logger.log(oe.Error,`An onclose callback called with error '${e}' threw error '${t}'.`);}}}async _reconnect(e){const t=Date.now();let n=0,i=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),o=this._getNextRetryDelay(n++,0,i);if(o===null){this._logger.log(oe.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e);return}if(this._connectionState=Nt.Reconnecting,e?this._logger.log(oe.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(oe.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(s=>s.apply(this,[e]));}catch(s){this._logger.log(oe.Error,`An onreconnecting callback called with error '${e}' threw error '${s}'.`);}if(this._connectionState!==Nt.Reconnecting){this._logger.log(oe.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;o!==null;){if(this._logger.log(oe.Information,`Reconnect attempt number ${n} will start in ${o} ms.`),await new Promise(s=>{this._reconnectDelayHandle=setTimeout(s,o);}),this._reconnectDelayHandle=void 0,this._connectionState!==Nt.Reconnecting){this._logger.log(oe.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=Nt.Connected,this._logger.log(oe.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(s=>s.apply(this,[this.connection.connectionId]));}catch(s){this._logger.log(oe.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${s}'.`);}return}catch(s){if(this._logger.log(oe.Information,`Reconnect attempt failed because of error '${s}'.`),this._connectionState!==Nt.Reconnecting){this._logger.log(oe.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===Nt.Disconnecting&&this._completeClose();return}i=s instanceof Error?s:new Error(s.toString()),o=this._getNextRetryDelay(n++,Date.now()-t,i);}}this._logger.log(oe.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose();}_getNextRetryDelay(e,t,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(i){return this._logger.log(oe.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${i}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(n=>{const i=t[n];try{i(null,e);}catch(o){this._logger.log(oe.Error,`Stream 'error' callback called with '${e}' threw error: ${kf(o)}`);}});}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0);}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle);}_createInvocation(e,t,n,i){if(n)return i.length!==0?{arguments:t,streamIds:i,target:e,type:We.Invocation}:{arguments:t,target:e,type:We.Invocation};{const o=this._invocationId;return this._invocationId++,i.length!==0?{arguments:t,invocationId:o.toString(),streamIds:i,target:e,type:We.Invocation}:{arguments:t,invocationId:o.toString(),target:e,type:We.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(const n in e)e[n].subscribe({complete:c(()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(n)));},"complete"),error:c(i=>{let o;i instanceof Error?o=i.message:i&&i.toString?o=i.toString():o="Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(n,o)));},"error"),next:c(i=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(n,i)));},"next")});}}_replaceStreamingParams(e){const t=[],n=[];for(let i=0;i<e.length;i++){const o=e[i];if(this._isObservable(o)){const s=this._invocationId;this._invocationId++,t[s]=o,n.push(s.toString()),e.splice(i,1);}}return [t,n]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,n){const i=this._invocationId;return this._invocationId++,n.length!==0?{arguments:t,invocationId:i.toString(),streamIds:n,target:e,type:We.StreamInvocation}:{arguments:t,invocationId:i.toString(),target:e,type:We.StreamInvocation}}_createCancelInvocation(e){return {invocationId:e,type:We.CancelInvocation}}_createStreamItemMessage(e,t){return {invocationId:e,item:t,type:We.StreamItem}}_createCompletionMessage(e,t,n){return t?{error:t,invocationId:e,type:We.Completion}:{invocationId:e,result:n,type:We.Completion}}_createCloseMessage(){return {type:We.Close}}};c(uh,"HubConnection");let dm=uh;const S$=[0,2e3,1e4,3e4,null],Wy=class Wy{constructor(e){this._retryDelays=e!==void 0?[...e,null]:S$;}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}};c(Wy,"DefaultReconnectPolicy");let Qd=Wy;const Hy=class Hy{};c(Hy,"HeaderNames");let ar=Hy;ar.Authorization="Authorization";ar.Cookie="Cookie";const Qy=class Qy extends bl{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t;}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const n=await this._innerClient.send(e);return t&&n.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):n}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[ar.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[ar.Authorization]&&delete e.headers[ar.Authorization];}getCookieString(e){return this._innerClient.getCookieString(e)}};c(Qy,"AccessTokenHttpClient");let hm=Qy;var sn;(function(r){r[r.None=0]="None",r[r.WebSockets=1]="WebSockets",r[r.ServerSentEvents=2]="ServerSentEvents",r[r.LongPolling=4]="LongPolling";})(sn||(sn={}));var wn;(function(r){r[r.Text=1]="Text",r[r.Binary=2]="Binary";})(wn||(wn={}));var Na;let A$=(Na=class{constructor(){this._isAborted=!1,this.onabort=null;}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort());}get signal(){return this}get aborted(){return this._isAborted}},c(Na,"AbortController"),Na);const Xy=class Xy{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,n){this._httpClient=e,this._logger=t,this._pollAbort=new A$,this._options=n,this._running=!1,this.onreceive=null,this.onclose=null;}async connect(e,t){if(Ft.isRequired(e,"url"),Ft.isRequired(t,"transferFormat"),Ft.isIn(t,wn,"transferFormat"),this._url=e,this._logger.log(oe.Trace,"(LongPolling transport) Connecting."),t===wn.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[n,i]=_l(),o={[n]:i,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:o,timeout:1e5,withCredentials:this._options.withCredentials};t===wn.Binary&&(s.responseType="arraybuffer");const a=`${e}&_=${Date.now()}`;this._logger.log(oe.Trace,`(LongPolling transport) polling: ${a}.`);const l=await this._httpClient.get(a,s);l.statusCode!==200?(this._logger.log(oe.Error,`(LongPolling transport) Unexpected response code: ${l.statusCode}.`),this._closeError=new sr(l.statusText||"",l.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s);}async _poll(e,t){try{for(;this._running;)try{const n=`${e}&_=${Date.now()}`;this._logger.log(oe.Trace,`(LongPolling transport) polling: ${n}.`);const i=await this._httpClient.get(n,t);i.statusCode===204?(this._logger.log(oe.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):i.statusCode!==200?(this._logger.log(oe.Error,`(LongPolling transport) Unexpected response code: ${i.statusCode}.`),this._closeError=new sr(i.statusText||"",i.statusCode),this._running=!1):i.content?(this._logger.log(oe.Trace,`(LongPolling transport) data received. ${mu(i.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(i.content)):this._logger.log(oe.Trace,"(LongPolling transport) Poll timed out, reissuing.");}catch(n){this._running?n instanceof pu?this._logger.log(oe.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=n,this._running=!1):this._logger.log(oe.Trace,`(LongPolling transport) Poll errored after shutdown: ${n.message}`);}}finally{this._logger.log(oe.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose();}}async send(e){return this._running?AE(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(oe.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(oe.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,n]=_l();e[t]=n;const i={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let o;try{await this._httpClient.delete(this._url,i);}catch(s){o=s;}o?o instanceof sr&&(o.statusCode===404?this._logger.log(oe.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(oe.Trace,`(LongPolling transport) Error sending a DELETE request: ${o}`)):this._logger.log(oe.Trace,"(LongPolling transport) DELETE request accepted.");}finally{this._logger.log(oe.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose();}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(oe.Trace,e),this.onclose(this._closeError);}}};c(Xy,"LongPollingTransport");let Xd=Xy;const qy=class qy{constructor(e,t,n,i){this._httpClient=e,this._accessToken=t,this._logger=n,this._options=i,this.onreceive=null,this.onclose=null;}async connect(e,t){return Ft.isRequired(e,"url"),Ft.isRequired(t,"transferFormat"),Ft.isIn(t,wn,"transferFormat"),this._logger.log(oe.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((n,i)=>{let o=!1;if(t!==wn.Text){i(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let s;if(qt.isBrowser||qt.isWebWorker)s=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else {const a=this._httpClient.getCookieString(e),l={};l.Cookie=a;const[u,d]=_l();l[u]=d,s=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...l,...this._options.headers}});}try{s.onmessage=a=>{if(this.onreceive)try{this._logger.log(oe.Trace,`(SSE transport) data received. ${mu(a.data,this._options.logMessageContent)}.`),this.onreceive(a.data);}catch(l){this._close(l);return}},s.onerror=a=>{o?this._close():i(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."));},s.onopen=()=>{this._logger.log(oe.Information,`SSE connected to ${this._url}`),this._eventSource=s,o=!0,n();};}catch(a){i(a);return}})}async send(e){return this._eventSource?AE(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e));}};c(qy,"ServerSentEventsTransport");let fm=qy;const Ky=class Ky{constructor(e,t,n,i,o,s){this._logger=n,this._accessTokenFactory=t,this._logMessageContent=i,this._webSocketConstructor=o,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s;}async connect(e,t){Ft.isRequired(e,"url"),Ft.isRequired(t,"transferFormat"),Ft.isIn(t,wn,"transferFormat"),this._logger.log(oe.Trace,"(WebSockets transport) Connecting.");let n;return this._accessTokenFactory&&(n=await this._accessTokenFactory()),new Promise((i,o)=>{e=e.replace(/^http/,"ws");let s;const a=this._httpClient.getCookieString(e);let l=!1;if(qt.isNode||qt.isReactNative){const u={},[d,h]=_l();u[d]=h,n&&(u[ar.Authorization]=`Bearer ${n}`),a&&(u[ar.Cookie]=a),s=new this._webSocketConstructor(e,void 0,{headers:{...u,...this._headers}});}else n&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(n)}`);s||(s=new this._webSocketConstructor(e)),t===wn.Binary&&(s.binaryType="arraybuffer"),s.onopen=u=>{this._logger.log(oe.Information,`WebSocket connected to ${e}.`),this._webSocket=s,l=!0,i();},s.onerror=u=>{let d=null;typeof ErrorEvent<"u"&&u instanceof ErrorEvent?d=u.error:d="There was an error with the transport",this._logger.log(oe.Information,`(WebSockets transport) ${d}.`);},s.onmessage=u=>{if(this._logger.log(oe.Trace,`(WebSockets transport) data received. ${mu(u.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(u.data);}catch(d){this._close(d);return}},s.onclose=u=>{if(l)this._close(u);else {let d=null;typeof ErrorEvent<"u"&&u instanceof ErrorEvent?d=u.error:d="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(d));}};})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(oe.Trace,`(WebSockets transport) sending data. ${mu(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(oe.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(e)&&(e.wasClean===!1||e.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)):e instanceof Error?this.onclose(e):this.onclose());}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}};c(Ky,"WebSocketTransport");let pm=Ky;const Vk=100,ew=class ew{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,Ft.isRequired(e,"url"),this._logger=f$(t.logger),this.baseUrl=this._resolveUrl(e),t=t||{},t.logMessageContent=t.logMessageContent===void 0?!1:t.logMessageContent,typeof t.withCredentials=="boolean"||t.withCredentials===void 0)t.withCredentials=t.withCredentials===void 0?!0:t.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.timeout=t.timeout===void 0?100*1e3:t.timeout;let n=null,i=null;if(qt.isNode&&typeof require<"u"){const o=typeof __webpack_require__=="function"?__non_webpack_require__:require;n=o("ws"),i=o("eventsource");}!qt.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:qt.isNode&&!t.WebSocket&&n&&(t.WebSocket=n),!qt.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:qt.isNode&&!t.EventSource&&typeof i<"u"&&(t.EventSource=i),this._httpClient=new hm(t.httpClient||new sm(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null;}async start(e){if(e=e||wn.Binary,Ft.isIn(e,wn,"transferFormat"),this._logger.log(oe.Debug,`Starting connection with transfer format '${wn[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(oe.Error,t),await this._stopPromise,Promise.reject(new Un(t))}else if(this._connectionState!=="Connected"){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(oe.Error,t),Promise.reject(new Un(t))}this._connectionStarted=!0;}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new gm(this.transport)),this._sendQueue.send(e))}async stop(e){if(this._connectionState==="Disconnected")return this._logger.log(oe.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(oe.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t;}),await this._stopInternal(e),await this._stopPromise;}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise;}catch{}if(this.transport){try{await this.transport.stop();}catch(t){this._logger.log(oe.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection();}this.transport=void 0;}else this._logger.log(oe.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.");}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===sn.WebSockets)this.transport=this._constructTransport(sn.WebSockets),await this._startTransport(t,e);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else {let n=null,i=0;do{if(n=await this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new Un("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(t=n.url),n.accessToken){const o=n.accessToken;this._accessTokenFactory=()=>o,this._httpClient._accessToken=o,this._httpClient._accessTokenFactory=void 0;}i++;}while(n.url&&i<Vk);if(i===Vk&&n.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,n,e);}this.transport instanceof Xd&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(oe.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected");}catch(n){return this._logger.log(oe.Error,"Failed to start the connection: "+n),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(n)}}async _getNegotiationResponse(e){const t={},[n,i]=_l();t[n]=i;const o=this._resolveNegotiateUrl(e);this._logger.log(oe.Debug,`Sending negotiation request: ${o}.`);try{const s=await this._httpClient.post(o,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(s.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${s.statusCode}'`));const a=JSON.parse(s.content);return (!a.negotiateVersion||a.negotiateVersion<1)&&(a.connectionToken=a.connectionId),a.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new Wd("Client didn't negotiate Stateful Reconnect but the server did.")):a}catch(s){let a="Failed to complete negotiation with the server: "+s;return s instanceof sr&&s.statusCode===404&&(a=a+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(oe.Error,a),Promise.reject(new Wd(a))}}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}async _createTransport(e,t,n,i){let o=this._createConnectUrl(e,n.connectionToken);if(this._isITransport(t)){this._logger.log(oe.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(o,i),this.connectionId=n.connectionId;return}const s=[],a=n.availableTransports||[];let l=n;for(const u of a){const d=this._resolveTransportOrError(u,t,i,(l==null?void 0:l.useStatefulReconnect)===!0);if(d instanceof Error)s.push(`${u.transport} failed:`),s.push(d);else if(this._isITransport(d)){if(this.transport=d,!l){try{l=await this._getNegotiationResponse(e);}catch(h){return Promise.reject(h)}o=this._createConnectUrl(e,l.connectionToken);}try{await this._startTransport(o,i),this.connectionId=l.connectionId;return}catch(h){if(this._logger.log(oe.Error,`Failed to start the transport '${u.transport}': ${h}`),l=void 0,s.push(new tm(`${u.transport} failed: ${h}`,sn[u.transport])),this._connectionState!=="Connecting"){const p="Failed to select transport before stop() was called.";return this._logger.log(oe.Debug,p),Promise.reject(new Un(p))}}}}return s.length>0?Promise.reject(new nm(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case sn.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new pm(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case sn.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new fm(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case sn.LongPolling:return new Xd(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async n=>{let i=!1;if(this.features.reconnect)try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend();}catch{i=!0;}else {this._stopConnection(n);return}i&&this._stopConnection(n);}:this.transport.onclose=n=>this._stopConnection(n),this.transport.connect(e,t)}_resolveTransportOrError(e,t,n,i){const o=sn[e.transport];if(o==null)return this._logger.log(oe.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(k$(t,o))if(e.transferFormats.map(a=>wn[a]).indexOf(n)>=0){if(o===sn.WebSockets&&!this._options.WebSocket||o===sn.ServerSentEvents&&!this._options.EventSource)return this._logger.log(oe.Debug,`Skipping transport '${sn[o]}' because it is not supported in your environment.'`),new Kp(`'${sn[o]}' is not supported in your environment.`,o);this._logger.log(oe.Debug,`Selecting transport '${sn[o]}'.`);try{return this.features.reconnect=o===sn.WebSockets?i:void 0,this._constructTransport(o)}catch(a){return a}}else return this._logger.log(oe.Debug,`Skipping transport '${sn[o]}' because it does not support the requested transfer format '${wn[n]}'.`),new Error(`'${sn[o]}' does not support ${wn[n]}.`);else return this._logger.log(oe.Debug,`Skipping transport '${sn[o]}' because it was disabled by the client.`),new em(`'${sn[o]}' is disabled by the client.`,o)}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(oe.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(oe.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(oe.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(oe.Error,`Connection disconnected with error '${e}'.`):this._logger.log(oe.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(oe.Error,`TransportSendQueue.stop() threw error '${t}'.`);}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e);}catch(t){this._logger.log(oe.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`);}}}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!qt.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(oe.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const n=new URLSearchParams(t.searchParams);return n.has("negotiateVersion")||n.append("negotiateVersion",this._negotiateVersion.toString()),n.has("useStatefulReconnect")?n.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&n.append("useStatefulReconnect","true"),t.search=n.toString(),t.toString()}};c(ew,"HttpConnection");let mm=ew;function k$(r,e){return !r||(e&r)!==0}c(k$,"transportMatches");const dh=class dh{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Xo,this._transportResult=new Xo,this._sendLoopPromise=this._sendLoop();}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Xo),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve();}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Xo;const e=this._transportResult;this._transportResult=void 0;const t=typeof this._buffer[0]=="string"?this._buffer.join(""):dh._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve();}catch(n){e.reject(n);}}}static _concatBuffers(e){const t=e.map(o=>o.byteLength).reduce((o,s)=>o+s),n=new Uint8Array(t);let i=0;for(const o of e)n.set(new Uint8Array(o),i),i+=o.byteLength;return n.buffer}};c(dh,"TransportSendQueue");let gm=dh;const tw=class tw{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t]);}resolve(){this._resolver();}reject(e){this._rejecter(e);}};c(tw,"PromiseSource");let Xo=tw;const C$="json",nw=class nw{constructor(){this.name=C$,this.version=2,this.transferFormat=wn.Text;}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return [];t===null&&(t=po.instance);const n=hi.parse(e),i=[];for(const o of n){const s=JSON.parse(o);if(typeof s.type!="number")throw new Error("Invalid payload.");switch(s.type){case We.Invocation:this._isInvocationMessage(s);break;case We.StreamItem:this._isStreamItemMessage(s);break;case We.Completion:this._isCompletionMessage(s);break;case We.Ping:break;case We.Close:break;case We.Ack:this._isAckMessage(s);break;case We.Sequence:this._isSequenceMessage(s);break;default:t.log(oe.Information,"Unknown message type '"+s.type+"' ignored.");continue}i.push(s);}return i}writeMessage(e){return hi.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.");}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.");}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}};c(nw,"JsonHubProtocol");let bm=nw;const I$={trace:oe.Trace,debug:oe.Debug,info:oe.Information,information:oe.Information,warn:oe.Warning,warning:oe.Warning,error:oe.Error,critical:oe.Critical,none:oe.None};function T$(r){const e=I$[r.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${r}`)}c(T$,"parseLogLevel");const iw=class iw{configureLogging(e){if(Ft.isRequired(e,"logging"),D$(e))this.logger=e;else if(typeof e=="string"){const t=T$(e);this.logger=new vl(t);}else this.logger=new vl(e);return this}withUrl(e,t){return Ft.isRequired(e,"url"),Ft.isNotEmpty(e,"url"),this.url=e,typeof t=="object"?this.httpConnectionOptions={...this.httpConnectionOptions,...t}:this.httpConnectionOptions={...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return Ft.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new Qd(e):this.reconnectPolicy=e:this.reconnectPolicy=new Qd,this}withServerTimeout(e){return Ft.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return Ft.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e==null?void 0:e.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new mm(this.url,e);return dm.create(t,this.logger||po.instance,this.protocol||new bm,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}};c(iw,"HubConnectionBuilder");let vm=iw;function D$(r){return r.log!==void 0}c(D$,"isLogger");var E$=Object.defineProperty,M$=Object.getOwnPropertyDescriptor,R$=c((r,e,t,n)=>{for(var i=n>1?void 0:n?M$(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&E$(e,t,i),i},"__decorateClass$J"),Jk=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$3");const L$={IGuildLobbiesHub:{url:"guildLobbies"},ILobbyHub:{url:"lobby"},IOnlineItemsHub:{url:"onlineItems"}};var Oa;let yl=(Oa=class{constructor(e,t){f(this,"_logger");f(this,"_baseUrl","https://sockets.typo.rip");f(this,"_token","");f(this,"createHub",c$);f(this,"createReceiver",u$);this._logger=e(this),t.token.subscribe(n=>this._token=n??"");}createSignalRConfig(){return {withCredentials:!1,accessTokenFactory:c(()=>this._token,"accessTokenFactory")}}createConnection(e){return new vm().withUrl(`${this._baseUrl}/${L$[e].url}`,this.createSignalRConfig()).configureLogging({log:c((n,i)=>{(n==oe.Trace||n==oe.Debug)&&this._logger.debug(i),(n==oe.Information||n==oe.Warning)&&this._logger.info(i),n==oe.Critical&&this._logger.warn(i),n==oe.Error&&this._logger.error(i);},"log")}).build()}set baseUrl(e){this._baseUrl=e;}reconnectOnUserInteraction(e,t){const n=c(async()=>{this._logger.info("User interaction detected, reconnecting..."),await t();},"interactionListener");e.onclose(()=>{this._logger.info("Connection closed, waiting for user interaction to reconnect..."),document.addEventListener("pointermove",n,{once:!0});});}},c(Oa,"SocketService"),Oa);yl=R$([we(),Jk(0,D(rt)),Jk(1,D(io))],yl);var P$=Object.defineProperty,N$=Object.getOwnPropertyDescriptor,kE=c((r,e,t,n)=>{for(var i=n>1?void 0:n?N$(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&P$(e,t,i),i},"__decorateClass$I"),O$=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$2"),ja;let go=(ja=class{constructor(e){f(this,"_socketService");f(this,"_logger");f(this,"_connection$",new Le(void 0));f(this,"_existingTypoLobbyStates",new Map);f(this,"_abortConnecting");f(this,"_dropAnnounced$",new be);f(this,"_dropClaimed$",new be);f(this,"_dropCleared$",new be);f(this,"_awardGifted$",new be);f(this,"_pausedSetting",new dt("pause_lobby_connection",!1));this._logger=e(this);}async onFeatureActivate(){await this._pausedSetting.getValue()&&this._connection$.next("paused");}async onFeatureDestroy(){await this.destroyConnection(),this._existingTypoLobbyStates.clear();}get dropAnnounced$(){return this._dropAnnounced$.asObservable()}get dropClaimed$(){return this._dropClaimed$.asObservable()}get awardGifted$(){return this._awardGifted$.asObservable()}get dropCleared$(){return this._dropCleared$.asObservable()}get connection(){const e=this._connection$.value;if(e===void 0||e==="unauthorized"||e==="paused")throw this._logger.error("connection is not initialized"),new Error("connection is not initialized");return e}get connection$(){return this._connection$.asObservable()}get isConnected(){return this._connection$.value!==void 0&&this._connection$.value!=="unauthorized"&&this._connection$.value!=="paused"}async setupConnection(e,t,n,i){var u;if(await this._pausedSetting.getValue())return this._logger.debug("Tried to connect, but connection is paused"),this._connection$.next("paused"),"paused";const o=(u=this._existingTypoLobbyStates.get(e))==null?void 0:u.ownershipClaimToken,s=this._socketService.createConnection("ILobbyHub"),a=this._socketService.createHub("ILobbyHub").createHubProxy(s);this._socketService.createReceiver("ILobbyReceiver").register(s,{lobbyOwnershipResigned:this.lobbyOwnershipResigned.bind(this),typoLobbySettingsUpdated:this.typoLobbySettingsUpdated.bind(this),dropAnnounced:c(async d=>this._dropAnnounced$.next(d),"dropAnnounced"),dropClaimed:c(async d=>this._dropClaimed$.next(d),"dropClaimed"),awardGifted:c(async d=>this._awardGifted$.next(d),"awardGifted"),dropCleared:c(async d=>this._dropCleared$.next(d),"dropCleared")}),s.onclose(async d=>{this._logger.debug("SignalR Connection closed",d),this._connection$.next(void 0);}),this._abortConnecting=async()=>{this._logger.info("Aborting connection while still in setup phase"),await s.stop();};try{await s.start();}catch(d){return this._logger.error("Failed to setup socket connection",d),await this.destroyConnection(),this._connection$.next(void 0),"failed"}const l=await a.lobbyDiscovered({ownerClaimToken:o,lobby:t,playerId:n});return this._logger.info("Lobby discovered",l),this._connection$.next({connection:s,hub:a,typoLobbyState:l,member:i}),this._existingTypoLobbyStates.set(l.lobbyId,l),this._abortConnecting=void 0,o?"reconnected":"connected"}async destroyConnection(e){this._connection$.value!==void 0&&this._connection$.value!=="unauthorized"&&this._connection$.value!=="paused"&&await this._connection$.value.connection.stop(),this._abortConnecting&&this._abortConnecting(),e==="unauthorized"?this._connection$.next("unauthorized"):e==="paused"?this._connection$.next("paused"):this._connection$.next(void 0);}async typoLobbySettingsUpdated(e){const t=this._existingTypoLobbyStates.get(this.connection.typoLobbyState.lobbyId);t&&(t.lobbySettings=e),this.connection.typoLobbyState.lobbySettings=e,this.connection.typoLobbyState.playerIsOwner=e.lobbyOwnershipClaim===this.connection.typoLobbyState.ownershipClaim,this._connection$.next(this.connection),this._logger.info("Lobby state updated",this.connection.typoLobbyState);}async lobbyOwnershipResigned(){this._logger.info("Lobby ownership resigned, claiming now"),await this.connection.hub.claimLobbyOwnership();}async setPaused(e){await this._pausedSetting.setValue(e),this.isConnected?await this.destroyConnection("paused"):e||this._connection$.next(void 0);}},c(ja,"LobbyConnectionService"),ja);kE([D(yl)],go.prototype,"_socketService",2);go=kE([we(),O$(0,D(rt))],go);const j$=c(r=>{if(!(r instanceof Error))throw r;const e=r==null?void 0:r.message.match(/.*'(.*)'.*\. (.*): (.*)/);if(e){if(e.length<3)throw r;const[,t,n,i]=e;return {hub:t,exception:n,message:i}}else throw r},"parseSignalRError");function Fk(r){let e,t,n;return {c(){e=v("div"),_(e,"class","typo-drop svelte-15kb90n"),H(e,"left","calc((100% - 48px) * ("+r[1].drop.position+" / 100))"),H(e,"background-image",r[3](r[1].drop.eventDropId,r[1].leagueMode));},m(i,o){k(i,e,o),t||(n=F(e,"pointerdown",r[5]),t=!0);},p(i,o){o&2&&H(e,"left","calc((100% - 48px) * ("+i[1].drop.position+" / 100))"),o&2&&H(e,"background-image",i[3](i[1].drop.eventDropId,i[1].leagueMode));},d(i){i&&A(e),t=!1,n();}}}c(Fk,"create_if_block$w");function G$(r){let e,t=r[1]!==void 0&&r[1].ownClaimed===!1&&Fk(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,[i]){n[1]!==void 0&&n[1].ownClaimed===!1?t?t.p(n,i):(t=Fk(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(G$,"create_fragment$1a");function $$(r,e,t){let n,{feature:i}=e,{drops:o}=e;const s=i.currentDropStore;De(r,s,u=>t(1,n=u));function a(u,d){const h=o.find(p=>p.id===u);return d?"var(--file-img-drop-pink-gif)":h?`url(${h.url})`:"var(--file-img-drop-gif)"}c(a,"getDropUrl");const l=c(async()=>{if(n){const u=await i.claimDrop(n.drop,n.timestamp);u!==void 0&&i.processClaim(u,!0);}},"pointerdown_handler");return r.$$set=u=>{"feature"in u&&t(0,i=u.feature),"drops"in u&&t(4,o=u.drops);},[i,n,s,a,o,l]}c($$,"instance$14");const rw=class rw extends se{constructor(e){super(),le(this,e,$$,G$,re,{feature:0,drops:4});}};c(rw,"Drops");let _m=rw;function Wk(r,e,t){const n=r.slice();return n[3]=e[t],n}c(Wk,"get_each_context$t");function Hk(r){let e,t,n,i=r[3].dropId+"",o,s,a,l=new Date(r[3].dropId).toLocaleTimeString()+"",u,d,h,p=r[3].username+"",m,b,y,w=r[3].catchTime+"",I,S,R,E,P=Math.round(r[3].leagueWeight*100)+"",L,O;return {c(){e=v("div"),t=v("b"),n=G("#"),o=G(i),s=C(),a=v("span"),u=G(l),d=C(),h=v("span"),m=G(p),b=C(),y=v("span"),I=G(w),S=G("ms"),R=C(),E=v("span"),L=G(P),O=G("%"),_(e,"class","typo-drop-claims-claim svelte-qhyy9");},m(z,$){k(z,e,$),g(e,t),g(t,n),g(t,o),g(e,s),g(e,a),g(a,u),g(e,d),g(e,h),g(h,m),g(e,b),g(e,y),g(y,I),g(y,S),g(e,R),g(e,E),g(E,L),g(E,O);},p(z,$){$&1&&i!==(i=z[3].dropId+"")&&K(o,i),$&1&&l!==(l=new Date(z[3].dropId).toLocaleTimeString()+"")&&K(u,l),$&1&&p!==(p=z[3].username+"")&&K(m,p),$&1&&w!==(w=z[3].catchTime+"")&&K(I,w),$&1&&P!==(P=Math.round(z[3].leagueWeight*100)+"")&&K(L,P);},d(z){z&&A(e);}}}c(Hk,"create_each_block$t");function Qk(r){let e;return {c(){e=v("p"),e.textContent="No drop claims yet.";},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(Qk,"create_if_block$v");function Y$(r){let e,t,n,i,o,s,a,l,u=te(r[0]),d=[];for(let p=0;p<u.length;p+=1)d[p]=Hk(Wk(r,u,p));let h=r[0].length===0&&Qk();return {c(){e=v("h3"),e.textContent="Drop Log",t=C(),n=v("p"),n.innerHTML=`In the drop log, you can find all drops claims that happened while you were in lobbies.<br/>
  To report a suspicious drop claim, copy the catch time and drop ID and send it on the typo server.`,i=C(),o=v("br"),s=C(),a=v("div");for(let p=0;p<d.length;p+=1)d[p].c();l=C(),h&&h.c(),_(a,"class","typo-drop-claims svelte-qhyy9");},m(p,m){k(p,e,m),k(p,t,m),k(p,n,m),k(p,i,m),k(p,o,m),k(p,s,m),k(p,a,m);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(a,null);g(a,l),h&&h.m(a,null);},p(p,[m]){if(m&1){u=te(p[0]);let b;for(b=0;b<u.length;b+=1){const y=Wk(p,u,b);d[b]?d[b].p(y,m):(d[b]=Hk(y),d[b].c(),d[b].m(a,l));}for(;b<d.length;b+=1)d[b].d(1);d.length=u.length;}p[0].length===0?h||(h=Qk(),h.c(),h.m(a,null)):h&&(h.d(1),h=null);},i:j,o:j,d(p){p&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a)),Ie(d,p),h&&h.d();}}}c(Y$,"create_fragment$19");function z$(r,e,t){let n,{feature:i}=e;const o=i.recordedClaimsStore;return De(r,o,s=>t(0,n=s)),r.$$set=s=>{"feature"in s&&t(2,i=s.feature);},[n,o,i]}c(z$,"instance$13");const ow=class ow extends se{constructor(e){super(),le(this,e,z$,Y$,re,{feature:2});}};c(ow,"Drops_info");let ym=ow;var U$=Object.defineProperty,Lo=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&U$(e,t,i),i},"__decorateClass$H");const sw=class sw extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_apiDataSetup");f(this,"_lobbyConnectionService");f(this,"_chatService");f(this,"_toastService");f(this,"_lobbyLeftEventListener");f(this,"_lobbyService");f(this,"name","Drops");f(this,"description","Show drops to collect extra bubbles when you're playing");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",40);f(this,"_component");f(this,"_recordedClaims$",new Le([]));f(this,"_currentDrop$",new be);f(this,"_dropSummarySubscription");f(this,"_dropAnnouncedSubscription");f(this,"_enableDropSummary",this.useSetting(new He("drop_summary",!0,this).withName("Drop Summary").withDescription("Show a chat message with all drop catches after a drop")));f(this,"_enableOtherDropNotifications",this.useSetting(new He("drop_notifications",!0,this).withName("Drop Notifications").withDescription("Show a chat message when someone else catches a drop")));}get featureManagementComponent(){return {componentType:ym,props:{feature:this}}}async onActivate(){const t=await this._elementsSetup.complete(),n=await this._apiDataSetup.complete();this._component=new _m({target:t.canvasWrapper,props:{feature:this,drops:n.drops}}),this._dropAnnouncedSubscription=this._lobbyConnectionService.dropAnnounced$.pipe(lt(i=>Tt(i).pipe(Kt(this._lobbyConnectionService.dropCleared$.pipe(Se(o=>o.dropId===i.dropId),_t(()=>this._logger.info("Drop cleared by server event",i)),ce(()=>{}),jl(1e3)),this._lobbyConnectionService.dropClaimed$.pipe(_t(o=>this._logger.info("Other claim arrived",o)),Ba(async o=>(await this.processClaim(o,!1),o)),Se(o=>o.clearedDrop),ce(()=>{})),this._lobbyLeftEventListener.events$.pipe(ce(()=>{}))))),_t(i=>this._logger.info("Setting drop",i)),Oe(this._lobbyService.lobby$)).subscribe(([i,o])=>this._currentDrop$.next(i===void 0?void 0:{drop:i,timestamp:Date.now(),ownClaimed:!1,leagueMode:((o==null?void 0:o.players.length)===1||(o==null?void 0:o.players.every(s=>s.score===0)))??!1})),this._dropSummarySubscription=this._currentDrop$.pipe(lr(void 0),ct(),Cr(),Oe(this._recordedClaims$,this._enableDropSummary.changes$)).subscribe(([[i,o],s,a])=>{var l;if(a&&i!==void 0&&o===void 0){const u=c(y=>y.clearedDrop&&y.firstClaim?"":y.clearedDrop?"":y.firstClaim?"":y.leagueMode?"":"","getEmoji"),d=i,h=s.filter(y=>y.dropId===d.drop.dropId),p=d.drop.eventDropId!==void 0?(l=n.drops.find(y=>y.id===d.drop.eventDropId))==null?void 0:l.name:void 0,m="Drop Summary"+(p!==void 0?`: (${p})`:""),b=`
`+(h.length===0?"The drop timed out :(":h.map(y=>`${u(y)} ${y.username}: ${y.catchTime}ms (${Math.round(y.leagueWeight*100)}%)`).join(`
`));this._chatService.addChatMessage(b,m,"info");}});}onDestroy(){var t,n,i;(t=this._component)==null||t.$destroy(),this._recordedClaims$.next([]),(n=this._dropSummarySubscription)==null||n.unsubscribe(),(i=this._dropAnnouncedSubscription)==null||i.unsubscribe(),this._dropSummarySubscription=void 0,this._dropAnnouncedSubscription=void 0;}get currentDropStore(){return it(this._currentDrop$,void 0)}get recordedClaimsStore(){return it(this._recordedClaims$,[])}async claimDrop(t,n){this._logger.info("Claiming drop after delay",Date.now()-n),this._currentDrop$.next({drop:t,ownClaimed:!0,timestamp:n,leagueMode:!1});try{return await this._lobbyConnectionService.connection.hub.claimDrop({dropToken:t.dropToken})}catch(i){const o=j$(i);this._logger.error("Failed to claim drop",o),await this._toastService.showToast(o.message);return}}async processClaim(t,n){this._logger.debug("Processing claim",t);const i=[...this._recordedClaims$.value,{...t,own:n}];this._recordedClaims$.next(i);const o=await this._enableOtherDropNotifications.getValue();if(n||o){const s=i.some(u=>u.own),a=n?"Yeee!":t.clearedDrop&&!s?"Oops..":"",l=n?`You ${t.clearedDrop?"cleared":"caught"} the drop after ${t.catchTime}ms (${Math.round(t.leagueWeight*100)}%)`:t.clearedDrop?`${t.username} cleared the drop after ${t.catchTime}ms`:`${t.username} caught the drop after ${t.catchTime}ms`;await this._chatService.addChatMessage(l,a,"info");}n&&t.clearedDrop&&this._currentDrop$.next(void 0);}};c(sw,"DropsFeature");let vi=sw;Lo([D(Me)],vi.prototype,"_elementsSetup");Lo([D(Tn)],vi.prototype,"_apiDataSetup");Lo([D(go)],vi.prototype,"_lobbyConnectionService");Lo([D(rn)],vi.prototype,"_chatService");Lo([D(ft)],vi.prototype,"_toastService");Lo([D(Vn)],vi.prototype,"_lobbyLeftEventListener");Lo([D(ut)],vi.prototype,"_lobbyService");const yb="_",CE="",qd={:"a",:"o",:"u",:"a",:"a",:"c",:"e",:"e",:"e",:"e",:"i",:"i",:"o",:"u",:"u",:"y",:"n",:"a",:"i",:"o",:"u",:"a",:"c",:"e",:"n",:"s",:"z",:"z"};function B$(r,e){return r=r.toLowerCase(),e=e.toLowerCase(),r=qd[r]??r,e=qd[e]??e,r===e}c(B$,"isTheSameLetter");function x$(r,e){r=r.replaceAll(" ","").replaceAll("-","");let t="",n=0;for(let i=0;i<e.length;i++){const o=r.charAt(n),s=e.charAt(i);s===" "||s==="-"?t=t.concat(s):B$(o,s)?(t=t.concat(s),n++):o===""?t=t.concat(CE):(t=t.concat(o),n++);}return t}c(x$,"getOverlayContent");function Xk(r,e,t){return t[e]===r||r===CE||t[e]===yb}c(Xk,"guessMatchesHint");function qk(r,e,t){return t[e]===r&&t[e]!==yb}c(qk,"guessCorrectHint");function Z$(r,e,t=!1){let n=0;r=r.replaceAll(" ","").replaceAll("-",""),e=e.replaceAll(" ","").replaceAll("-","");for(let i=0;i<Math.max(r.length,e.length);i++){const o=r.charAt(i),s=e.charAt(i);if(o.length!==s.length)continue;if(t){n++;continue}const a=qd[o.toLowerCase()]??o.toLowerCase(),l=qd[s.toLowerCase()]??s.toLowerCase();(a===l||s===yb)&&n++;}return n/Math.max(r.length,e.length)}c(Z$,"getGuessAccuracy");function Kk(r,e,t){const n=r.slice();return n[3]=e[t],n}c(Kk,"get_each_context$s");function eC(r,e,t){const n=r.slice();return n[6]=e[t],n[8]=t,n}c(eC,"get_each_context_1$a");function tC(r){let e,t=te(r[0].overlayContent),n=[];for(let i=0;i<t.length;i+=1)n[i]=nC(eC(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,o){if(o&1){t=te(i[0].overlayContent);let s;for(s=0;s<t.length;s+=1){const a=eC(i,t,s);n[s]?n[s].p(a,o):(n[s]=nC(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},d(i){i&&A(e),Ie(n,i);}}}c(tC,"create_if_block$u");function nC(r){let e,t=r[6]+"",n,i;return {c(){e=v("span"),n=G(t),i=C(),_(e,"class","overlay-character svelte-dq3z80"),ue(e,"hidden",qk(r[6],r[8],r[0].hints)),ue(e,"warning",!Xk(r[6],r[8],r[0].hints));},m(o,s){k(o,e,s),g(e,n),g(e,i);},p(o,s){s&1&&t!==(t=o[6]+"")&&K(n,t),s&1&&ue(e,"hidden",qk(o[6],o[8],o[0].hints)),s&1&&ue(e,"warning",!Xk(o[6],o[8],o[0].hints));},d(o){o&&A(e);}}}c(nC,"create_each_block_1$a");function iC(r){let e,t,n=r[0]!==null&&tC(r);return {c(){e=v("div"),n&&n.c(),t=C(),_(e,"class","typo-hints-overlay "+r[3]+" svelte-dq3z80");},m(i,o){k(i,e,o),n&&n.m(e,null),g(e,t);},p(i,o){i[0]!==null?n?n.p(i,o):(n=tC(i),n.c(),n.m(e,t)):n&&(n.d(1),n=null);},d(i){i&&A(e),n&&n.d();}}}c(iC,"create_each_block$s");function V$(r){let e,t=te(["warning","correct"]),n=[];for(let i=0;i<2;i+=1)n[i]=iC(Kk(r,t,i));return {c(){for(let i=0;i<2;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<2;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,[o]){if(o&1){t=te(["warning","correct"]);let s;for(s=0;s<2;s+=1){const a=Kk(i,t,s);n[s]?n[s].p(a,o):(n[s]=iC(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<2;s+=1)n[s].d(1);}},i:j,o:j,d(i){i&&A(e),Ie(n,i);}}}c(V$,"create_fragment$18");function J$(r,e,t){let n,{feature:i}=e;const o=i.guessChangedStore;return De(r,o,s=>t(0,n=s)),r.$$set=s=>{"feature"in s&&t(2,i=s.feature);},[n,o,i]}c(J$,"instance$12");const aw=class aw extends se{constructor(e){super(),le(this,e,J$,V$,re,{feature:2});}};c(aw,"Guess_check");let wm=aw;var F$=Object.defineProperty,$h=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&F$(e,t,i),i},"__decorateClass$G");const lw=class lw extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_chatTypedEventListener");f(this,"_lobbyLeftEventListener");f(this,"_drawingService");f(this,"name","Guess Check");f(this,"description","Shows an overlay over the word hints to compare your current guess");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",18);f(this,"_component");}async onActivate(){const t=await this._elementsSetup.complete();this._component=new wm({target:t.hints,props:{feature:this}});}onDestroy(){var t;(t=this._component)==null||t.$destroy();}get guessChangedStore(){const t=this._chatTypedEventListener.events$.pipe(Kt(this._lobbyLeftEventListener.events$.pipe(ce(()=>null))),ce(n=>(n==null?void 0:n.data)??""),ct(),Qe(this._drawingService.imageState$.pipe(ce(n=>n===null||n.word.solution!==void 0?null:n.word.hints),ct())),ce(([n,i])=>i===null?null:{guess:n,hints:i,overlayContent:x$(n,i)}),_t(n=>this._logger.debug("Guess Check data update",n)));return it(t,null)}};c(lw,"GuessCheckFeature");let Pr=lw;$h([D(Me)],Pr.prototype,"_elementsSetup");$h([D(Oc)],Pr.prototype,"_chatTypedEventListener");$h([D(Vn)],Pr.prototype,"_lobbyLeftEventListener");$h([D(zt)],Pr.prototype,"_drawingService");const cw=class cw extends $e{constructor(){super(...arguments);f(this,"name","Hotkeys");f(this,"description","Activate actions of features with key combinations");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",25);f(this,"_pressedKeys",new Set);f(this,"_releaseCandidates",new Set);f(this,"_keysReleased$",new be);f(this,"_keysPressed$",new be);f(this,"_pressedSubscription");f(this,"_releasedSubscription");f(this,"keydownListener",this.handleKeydown.bind(this));f(this,"keyupListener",this.handleKeyup.bind(this));f(this,"visibilityChangeListener",this.handleDocumentVisibilityChange.bind(this));f(this,"inactiveListener",this.handleDocumentInactive.bind(this));}async onActivate(){document.addEventListener("keydown",this.keydownListener),document.addEventListener("keyup",this.keyupListener),document.addEventListener("visibilitychange",this.visibilityChangeListener),window.addEventListener("blur",this.inactiveListener),this._pressedSubscription=this._keysPressed$.pipe(_t(t=>this._logger.debug("Keys pressed",t)),ct((t,n)=>t.length===n.length&&t.every((i,o)=>i===n[o]))).subscribe(t=>{var o;this._logger.info("Keys pressed event",t);const n=this._hotkeysService.registeredHotkeys,i=((o=document.activeElement)==null?void 0:o.tagName)==="INPUT";yD(n.map(s=>this._releaseCandidates.has(s)?Tt({executed:!1,hotkey:s}):s.executeIfMatches(t,i).pipe(_t(a=>{a&&this._releaseCandidates.add(s);}),ce(a=>({hotkey:s,executed:a}))))).subscribe(s=>{const a=s.filter(l=>l.executed);a.length>0&&this._logger.info("Executed hotkeys",a.map(l=>l.hotkey.name));});}),this._releasedSubscription=this._keysReleased$.subscribe(t=>{this._logger.info("Keys released",t),this._releaseCandidates.forEach(n=>{n.releaseIfNotMatches(t).subscribe(i=>{i&&(this._releaseCandidates.delete(n),this._logger.info("Released hotkey",n.name));});});});}async onDestroy(){var t,n;document.removeEventListener("keydown",this.keydownListener),document.removeEventListener("keyup",this.keyupListener),document.removeEventListener("visibilitychange",this.visibilityChangeListener),window.removeEventListener("blur",this.inactiveListener),window.removeEventListener("focusout",this.inactiveListener),(t=this._pressedSubscription)==null||t.unsubscribe(),this._pressedSubscription=void 0,(n=this._releasedSubscription)==null||n.unsubscribe(),this._releasedSubscription=void 0;}handleKeydown(t){t.altKey&&(this._logger.debug("Alt key pressed; preventing default"),t.preventDefault()),this._logger.debug("Keydown",t.code),this._pressedKeys.add(t.code),this._keysPressed$.next([...this._pressedKeys]);}handleKeyup(t){this._logger.debug("Keyup",t.code),this._pressedKeys.delete(t.code),this._keysReleased$.next([...this._pressedKeys]),this._keysPressed$.next([...this._pressedKeys]);}handleDocumentVisibilityChange(){if(!document.hidden)return;this._logger.info("Document hidden; releasing all keys");const t=[...this._pressedKeys];this._pressedKeys.clear(),this._keysReleased$.next(t),this._keysPressed$.next([]);}handleDocumentInactive(){this._logger.info("Document inactive; releasing all keys");const t=[...this._pressedKeys];this._pressedKeys.clear(),this._keysReleased$.next(t),this._keysPressed$.next([]);}};c(cw,"HotkeysFeature");let Kd=cw;function W$(r){return {c:j,m:j,p:j,i:j,o:j,d:j}}c(W$,"create_catch_block$2");function H$(r){let e,t=r[1]!==void 0&&r[2].length>0&&rC(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,i){n[1]!==void 0&&n[2].length>0?t?t.p(n,i):(t=rC(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(H$,"create_then_block$2");function rC(r){let e,t,n,i;function o(...s){return r[8](r[2],...s)}return c(o,"mousedown_handler"),{c(){var s;e=v("img"),ht(e.src,t=((s=r[2])==null?void 0:s[r[1]??0])??"")||_(e,"src",t),_(e,"alt","Image Agent Result"),_(e,"class","svelte-z5nxkg");},m(s,a){k(s,e,a),n||(i=[F(e,"contextmenu",q$),F(e,"mousedown",o)],n=!0);},p(s,a){var l;r=s,a&6&&!ht(e.src,t=((l=r[2])==null?void 0:l[r[1]??0])??"")&&_(e,"src",t);},d(s){s&&A(e),n=!1,Je(i);}}}c(rC,"create_if_block$t");function Q$(r){let e,t;return e=new Yn({}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Q$,"create_pending_block$2");function X$(r){let e,t,n,i,o,s,a,l,u={ctx:r,current:null,token:null,hasCatch:!1,pending:Q$,then:H$,catch:W$,value:2,blocks:[,,,]};return $n(o=r[2],u),{c(){e=v("div"),t=v("div"),n=v("input"),i=C(),u.block.c(),_(n,"type","text"),_(n,"class","typo svelte-z5nxkg"),_(n,"placeholder","Custom image name"),_(t,"class","agent-inputs svelte-z5nxkg"),_(e,"class","agent-content svelte-z5nxkg");},m(d,h){k(d,e,h),g(e,t),g(t,n),de(n,r[0]),g(e,i),u.block.m(e,u.anchor=null),u.mount=()=>e,u.anchor=null,s=!0,a||(l=[F(n,"input",r[6]),F(n,"keydown",r[7])],a=!0);},p(d,[h]){r=d,h&1&&n.value!==r[0]&&de(n,r[0]),u.ctx=r,h&4&&o!==(o=r[2])&&$n(o,u)||To(u,r,h);},i(d){s||(T(u.block),s=!0);},o(d){for(let h=0;h<3;h+=1){const p=u.blocks[h];M(p);}s=!1;},d(d){d&&A(e),u.block.d(),u.token=null,u=null,a=!1,Je(l);}}}c(X$,"create_fragment$17");const q$=c(r=>r.preventDefault(),"contextmenu_handler");function K$(r,e,t){let n,i,{feature:o}=e;const s=o.wordStore;De(r,s,p=>t(5,i=p));let a,l;function u(){a=this.value,t(0,a),t(5,i);}c(u,"input_input_handler");const d=c(p=>{p.key==="Enter"&&s.set(a);},"keydown_handler"),h=c((p,m)=>{l!==void 0&&m.button===2?t(1,l=l===0?p.length-1:l-1):l!==void 0&&m.button===0&&t(1,l=l===p.length-1?0:l+1);},"mousedown_handler");return r.$$set=p=>{"feature"in p&&t(4,o=p.feature);},r.$$.update=()=>{r.$$.dirty&32&&t(0,a=i??void 0),r.$$.dirty&32&&t(1,l=0),r.$$.dirty&48&&t(2,n=i?o.getImages(i):[]);},[a,l,n,s,o,i,u,d,h]}c(K$,"instance$11");const uw=class uw extends se{constructor(e){super(),le(this,e,K$,X$,re,{feature:4});}};c(uw,"Image_agent_flyout");let Sm=uw;var e5=Object.defineProperty,wb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&e5(e,t,i),i},"__decorateClass$F");const dw=class dw extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_lobbyService");f(this,"_drawingService");f(this,"_autoOpenOwnTurnSetting",new dt("autoOpenOwnTurn",!0,this));f(this,"_iconElement");f(this,"_flyoutComponent");f(this,"_iconClickSubscription");f(this,"_flyoutSubscription");f(this,"_activationSubscription");f(this,"name","Image Agent");f(this,"description","Displays a reference image of the word when it's your turn to draw");f(this,"featureId",14);f(this,"tags",[ye.DRAWING]);f(this,"featureEnabledDefault",!1);}async onActivate(){const t=await this._elementsSetup.complete();this._iconElement=new st({target:t.chatControls,props:{icon:"file-img-light-gif",name:"Image Agent",order:1,size:"2rem",hoverMove:!1,greyscaleInactive:!0,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconElement.click$.pipe(Oe(this._drawingService.drawingState$)).subscribe(([,n])=>{this.setAgentVisibility(!0),n==="drawing"&&this._autoOpenOwnTurnSetting.setValue(!0);}),this.listenForActivation();}onDestroy(){var t,n,i,o,s;(t=this._flyoutComponent)==null||t.$destroy(),this._flyoutComponent=void 0,(n=this._iconElement)==null||n.$destroy(),this._iconElement=void 0,(i=this._iconClickSubscription)==null||i.unsubscribe(),this._iconClickSubscription=void 0,(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutSubscription=void 0,(s=this._activationSubscription)==null||s.unsubscribe(),this._activationSubscription=void 0;}get isOpen(){return this._flyoutComponent!==void 0}get wordStore(){const t=this._drawingService.drawingState$.pipe(jl(100),Oe(this._lobbyService.lobby$,this._drawingService.imageState$),ce(([n,i,o])=>n==="idle"||i===null||o===null?null:o.word.solution??null),_t(n=>this._logger.debug("Word change",n)));return it(t,null)}async getImages(t){return await(await fetch(`https://agent.typo.rip/${t}`)).json()}listenForActivation(){this._activationSubscription=this._drawingService.drawingState$.pipe(_t(()=>this._logger.debug("Hidden setting changed")),Oe(this._lobbyService.lobby$,this._drawingService.imageState$,this._autoOpenOwnTurnSetting.changes$)).subscribe(async([t,n,i,o])=>{(n===null||i===null||t==="idle")&&await this.setAgentVisibility(!1),this.isOpen||o&&t==="drawing"&&await this.setAgentVisibility(!0);});}async setAgentVisibility(t){var n;if(!t)this._flyoutComponent&&((n=this._flyoutComponent)==null||n.close());else {const i=await this._elementsSetup.complete(),o={componentType:Sm,props:{feature:this}};this._flyoutComponent=new si({target:i.gameWrapper,props:{componentData:o,areaName:"chat",maxHeight:"600px",maxWidth:"300px",title:"Image Agent",closeStrategy:"explicit",iconName:"file-img-light-gif",alignment:"top",contentPadding:!1}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var s,a;this._logger.info("Destroyed flyout"),(s=this._flyoutComponent)==null||s.$destroy(),(a=this._flyoutSubscription)==null||a.unsubscribe(),this._flyoutComponent=void 0,this._autoOpenOwnTurnSetting.setValue(!1);});}}};c(dw,"ImageAgentFeature");let bo=dw;wb([D(Me)],bo.prototype,"_elementsSetup");wb([D(ut)],bo.prototype,"_lobbyService");wb([D(zt)],bo.prototype,"_drawingService");function t5(r){let e,t,n,i,o,s,a,l,u,d,h,p;return {c(){e=G("The Line Tool helps you draw perfectly straight lines on the canvas. "),t=v("br"),n=G(`
To start the tool, press the configured start hotkey and keep it down. `),i=v("br"),o=G(`
The tool can only be used when you are drawing. `),s=v("br"),a=v("br"),l=G(`
Now, you can drag lines onto the canvas by pressing the mouse button and releasing it somewhere else. `),u=v("br"),d=v("br"),h=G(`
You can also use the Line Tool to connect click positions; to do so, simply click two or more points on the canvas with the mouse to connect them.`),p=v("br");},m(m,b){k(m,e,b),k(m,t,b),k(m,n,b),k(m,i,b),k(m,o,b),k(m,s,b),k(m,a,b),k(m,l,b),k(m,u,b),k(m,d,b),k(m,h,b),k(m,p,b);},p:j,i:j,o:j,d(m){m&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a),A(l),A(u),A(d),A(h),A(p));}}}c(t5,"create_fragment$16");const hw=class hw extends se{constructor(e){super(),le(this,e,null,t5,re,{});}};c(hw,"Line_tool_info");let Am=hw;var n5=Object.defineProperty,zl=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&n5(e,t,i),i},"__decorateClass$E");const fw=class fw extends $e{constructor(){super(...arguments);f(this,"_toastService");f(this,"_prioritizedCanvasEventsSetup");f(this,"_elementsSetup");f(this,"_lobbyService");f(this,"_drawingService");f(this,"_toolsService");f(this,"name","Line Tool");f(this,"description","Draw straight lines between two points");f(this,"tags",[ye.DRAWING]);f(this,"featureId",27);f(this,"_startLineHotkey",this.useHotkey(new cn("start_line","Start Line","While pressed, straight lines can be drawn. Press twice to enable horizontal/vertical snap.",this,()=>{this._originCoordinates$.next(void 0),this._targetCoordinates$.next(void 0),this._lineListenToggle$.next(!0);},!0,["ShiftLeft"],()=>{this._lineListenToggle$.next(!1);})));f(this,"_lineListenToggle$",new Le(!1));f(this,"_originCoordinates$",new Le(void 0));f(this,"_targetCoordinates$",new Le(void 0));f(this,"_lineAccept$",new be);f(this,"_toastHandle");f(this,"_lineStateSubscription");f(this,"_linePreview");f(this,"_canvasClickListener",this.onCanvasDown.bind(this));f(this,"_canvasMoveListener",this.onCanvasMove.bind(this));f(this,"_documentUpListener",this.onDocumentUp.bind(this));}get featureInfoComponent(){return {componentType:Am,props:{}}}async onActivate(){const t=await this._elementsSetup.complete();this._linePreview=document.createElement("canvas"),this._linePreview.width=t.canvas.width,this._linePreview.height=t.canvas.height,this._linePreview.style.position="absolute",this._linePreview.style.pointerEvents="none",t.canvasWrapper.appendChild(this._linePreview);const{add:n}=await this._prioritizedCanvasEventsSetup.complete();n("preDraw")("pointerdown",this._canvasClickListener),n("preDraw")("pointermove",this._canvasMoveListener),document.addEventListener("pointerup",this._documentUpListener);const i=this._lineListenToggle$.pipe(ID(a=>a?Tt("free").pipe(Kt(this._lineListenToggle$.pipe(Se(l=>l),wR(1),vt(1),ce(()=>"snap"),gD(500),Qo(()=>this._lineListenToggle$.pipe(vt(1),ce(l=>l?"free":"disabled")))))):Tt("disabled")),ct(),Qe(this._lobbyService.lobby$.pipe(ce(a=>((a==null?void 0:a.drawerId)??void 0)!==void 0&&(a==null?void 0:a.drawerId)===(a==null?void 0:a.meId)))),ce(([a,l])=>l?a:"disabled"),ct(),_t(a=>this._logger.info("Mode changed",a))),o=this._originCoordinates$.pipe(Oe(this._lineListenToggle$),ce(([a,l])=>l?a:void 0),ct(),_t(a=>this._logger.debug("Origin changed",a))),s=this._targetCoordinates$.pipe(Oe(i,o),ce(([a,l,u])=>l=="disabled"||u===void 0||a===void 0?void 0:l==="free"?a:this.calculateSnap(u,a)),ct(),_t(a=>this._logger.debug("Target changed",a)));this._lineStateSubscription=i.pipe(Qe(o,s),lr(["disabled",void 0,void 0]),Cr(),Oe(this._toolsService.activeBrushStyle$),_t(([[a,l],u])=>this.processUiStateUpdate(a,l,u)),ce(([[,a]])=>a),Pf(()=>this._lineAccept$.pipe(vt(1),_t(()=>this._logger.debug("Line accept debounce emitted")))),lr(["disabled",void 0,void 0])).pipe(Cr(),_t(a=>this._logger.debug("Line accepted",a))).subscribe(async([[,a,l],[u,d,h]])=>{!d||u==="disabled"||(this._logger.info("Line accepted",d,h),h===void 0||h[0]===d[0]&&h[1]===d[1]?(this._logger.info("Line accepted without or same target - connecting with last origin or target, if existing",d,h),l?(this._logger.info("Connecting with last drag end",l),await this.drawLine(l,d)):a?(this._logger.info("Connecting with last click",a),await this.drawLine(a,d)):this._logger.info("No previous line to connect to; waiting for next"),this._originCoordinates$.next(void 0)):await this.drawLine(d,h));});}async onDestroy(){var n,i,o;const{remove:t}=await this._prioritizedCanvasEventsSetup.complete();t("pointerdown",this._canvasClickListener),t("pointermove",this._canvasMoveListener),document.removeEventListener("pointerup",this._documentUpListener),(n=this._linePreview)==null||n.remove(),this._linePreview=void 0,(i=this._toastHandle)==null||i.close(),(o=this._lineStateSubscription)==null||o.unsubscribe(),this._lineStateSubscription=void 0,this._toastHandle=void 0,this._lineListenToggle$.next(!1),this._originCoordinates$.next(void 0),this._targetCoordinates$.next(void 0);}calculateSnap(t,n){const i=n[0]-t[0],o=n[1]-t[1];return Math.abs(i)>2*Math.abs(o)?[n[0],t[1]]:Math.abs(o)>2*Math.abs(i)?[t[0],n[1]]:Math.abs(i)>Math.abs(o)?[t[0]+Math.sign(i)*Math.abs(o),t[1]+o]:[t[0]+i,t[1]+Math.sign(o)*Math.abs(i)]}async setPreview(t,n){if(this._logger.debug("Updating preview",t),this._linePreview===void 0){this._logger.error("Line preview canvas not initialized");return}if(t===void 0||t[2]===void 0||t[3]===void 0){this._linePreview.style.display="none";return}this._linePreview.style.display="block";const i=this._linePreview.getContext("2d");if(i===null){this._logger.error("Line preview context not found");return}i.imageSmoothingEnabled=!1,i.clearRect(0,0,this._linePreview.width,this._linePreview.height),i.lineWidth=n.size,i.strokeStyle=tt.fromSkribblCode(n.color).hex,i.beginPath(),i.moveTo(t[0],t[1]),i.lineTo(t[2],t[3]),i.stroke();}onCanvasDown(t){if(this._logger.debug("Canvas clicked",t),this._lineListenToggle$.value){const n=t.target;n.setPointerCapture(t.pointerId),t.preventDefault(),t.stopImmediatePropagation();const i=n.getBoundingClientRect(),o=n.width*t.offsetX/i.width,s=n.height*t.offsetY/i.height;return this._originCoordinates$.next([o,s]),!1}}async onCanvasMove(t){if(this._lineListenToggle$.value){this._logger.debug("Document pointer moved",t);const n=(await this._elementsSetup.complete()).canvas,i=n.getBoundingClientRect(),o=n.width*(t.clientX-i.left)/i.width,s=n.height*(t.clientY-i.top)/i.height;this._targetCoordinates$.next([o,s]);}}async onDocumentUp(t){this._logger.debug("Document pointer up",t),this._lineAccept$.next(!0);}async processUiStateUpdate([t,n,i],[o,s,a],l){var u;if(this._logger.debug("Line state processing",{prevListening:t,prevOrigin:n,prevTarget:i},{listening:o,origin:s,target:a},this._toastHandle),await this.setPreview(o!=="disabled"&&s!==void 0?[...s,...a??[void 0,void 0]]:void 0,l),t==="disabled"&&o!=="disabled")this._toastHandle&&(this._logger.warn("Toast handle unexpected existing when entering line tool"),this._toastHandle.close()),this._toastHandle=await this._toastService.showStickyToast("Line Tool: "+(o==="snap"?"Snap":"Free"),"Click to start line, release to finish");else if(t!=="disabled"&&o!=="disabled"&&o!==t){if(!this._toastHandle){this._logger.error("Toast handle unexpected not existing when changing mode",{prevListening:t,listening:o});return}this._toastHandle.update("Line Tool: "+(o==="snap"?"Snap":"Free"),"Click to start line, release to finish");}else t!=="disabled"&&o==="disabled"&&(this._toastHandle||this._logger.warn("Toast handle unexpected not existing when exiting line tool"),(u=this._toastHandle)==null||u.close(),this._toastHandle=void 0);}async drawLine(t,n){if(!t||!n)return;const i=Date.now();this._toolsService.insertStroke({from:t,to:t,stroke:i,cause:"down",secondaryActive:!1}),this._toolsService.insertStroke({from:t,to:n,stroke:i,cause:"move",secondaryActive:!1}),this._toolsService.insertStroke({from:n,to:n,stroke:i,cause:"up",secondaryActive:!1}),this._originCoordinates$.next(void 0),this._targetCoordinates$.next(void 0);}};c(fw,"LineToolFeature");let Yi=fw;zl([D(ft)],Yi.prototype,"_toastService");zl([D(Er)],Yi.prototype,"_prioritizedCanvasEventsSetup");zl([D(Me)],Yi.prototype,"_elementsSetup");zl([D(ut)],Yi.prototype,"_lobbyService");zl([D(zt)],Yi.prototype,"_drawingService");zl([D(dn)],Yi.prototype,"_toolsService");function i5(r,e){return r.pipe(gD({each:e,with:c(()=>r.pipe(Wo(vc(e))),"with")}),yR({delay:c(()=>vc(e),"delay")}))}c(i5,"repeatAfterDelay");function oC(r,e,t){const n=r.slice();return n[16]=e[t],n[17]=e,n[18]=t,n}c(oC,"get_each_context$r");function r5(r){let e,t,n,i;return e=new ke({props:{content:"Pause Connection",color:"blue"}}),e.$on("click",r[9]),{c(){V(e.$$.fragment),t=C(),n=v("span"),n.innerHTML="<b>Lobby Connected:</b> Your lobby is connected to typo and will be visible on Discord.<br/>";},m(o,s){x(e,o,s),k(o,t,s),k(o,n,s),i=!0;},p:j,i(o){i||(T(e.$$.fragment,o),i=!0);},o(o){M(e.$$.fragment,o),i=!1;},d(o){o&&(A(t),A(n)),Z(e,o);}}}c(r5,"create_else_block$j");function o5(r){let e,t,n,i;return e=new ke({props:{content:"Resume Connection",color:"blue"}}),e.$on("click",r[8]),{c(){V(e.$$.fragment),t=C(),n=v("span"),n.innerHTML=`<b>Connection paused:</b>
        Your lobby is currently not visible on Discord.<br/>
        You are incognito and no data is sent, but your sprites and scenes won&#39;t show up.<br/>
        Drops won&#39;t appear and you won&#39;t be able to give or receive awards.`;},m(o,s){x(e,o,s),k(o,t,s),k(o,n,s),i=!0;},p:j,i(o){i||(T(e.$$.fragment,o),i=!0);},o(o){M(e.$$.fragment,o),i=!1;},d(o){o&&(A(t),A(n)),Z(e,o);}}}c(o5,"create_if_block_6");function s5(r){let e;return {c(){e=v("span"),e.innerHTML="<b>Log-in required:</b> You need to log in with typo to use the lobby status feature.<br/>";},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(s5,"create_if_block_5$3");function a5(r){let e,t;return e=new Yn({props:{content:"Connecting lobby..."}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(a5,"create_if_block_4$6");function sC(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R;function E($){r[11]($);}c(E,"checkbox_checked_binding");let P={description:"Share link on all servers"};r[2]!==void 0&&(P.checked=r[2]),p=new It({props:P}),Ve.push(()=>bt(p,"checked",E));let L=te(r[4].member.guilds),O=[];for(let $=0;$<L.length;$+=1)O[$]=aC(oC(r,L,$));const z=c($=>M(O[$],1,1,()=>{O[$]=null;}),"out");return w=new ke({props:{content:"Save Settings",color:"green"}}),w.$on("click",r[13]),{c(){e=v("div"),t=v("span"),t.textContent="You are the typo lobby owner. Only you can change these settings.",n=C(),i=v("div"),o=v("b"),o.textContent="Lobby Description:",s=C(),a=v("input"),l=C(),u=v("div"),d=v("b"),d.textContent="Lobby Link Privacy:",h=C(),V(p.$$.fragment),b=C();for(let $=0;$<O.length;$+=1)O[$].c();y=C(),V(w.$$.fragment),_(a,"type","text"),_(a,"placeholder","Description in the Palantir Bot"),_(e,"class","status-settings svelte-1y63bp4");},m($,U){k($,e,U),g(e,t),g(e,n),g(e,i),g(i,o),g(i,s),g(i,a),de(a,r[1]),g(e,l),g(e,u),g(u,d),g(u,h),x(p,u,null),g(u,b);for(let N=0;N<O.length;N+=1)O[N]&&O[N].m(u,null);g(e,y),x(w,e,null),I=!0,S||(R=F(a,"input",r[10]),S=!0);},p($,U){U&2&&a.value!==$[1]&&de(a,$[1]);const N={};if(!m&&U&4&&(m=!0,N.checked=$[2],gt(()=>m=!1)),p.$set(N),U&28){L=te($[4].member.guilds);let Y;for(Y=0;Y<L.length;Y+=1){const ee=oC($,L,Y);O[Y]?(O[Y].p(ee,U),T(O[Y],1)):(O[Y]=aC(ee),O[Y].c(),T(O[Y],1),O[Y].m(u,null));}for(fe(),Y=L.length;Y<O.length;Y+=1)z(Y);pe();}},i($){if(!I){T(p.$$.fragment,$);for(let U=0;U<L.length;U+=1)T(O[U]);T(w.$$.fragment,$),I=!0;}},o($){M(p.$$.fragment,$),O=O.filter(Boolean);for(let U=0;U<O.length;U+=1)M(O[U]);M(w.$$.fragment,$),I=!1;},d($){$&&A(e),Z(p),Ie(O,$),Z(w),S=!1,R();}}}c(sC,"create_if_block_3$6");function aC(r){let e,t,n;function i(s){r[12](s,r[16]);}c(i,"checkbox_checked_binding_1");let o={disabled:r[2],description:r[16].guildName};return r[3][r[16].guildID]!==void 0&&(o.checked=r[3][r[16].guildID]),e=new It({props:o}),Ve.push(()=>bt(e,"checked",i)),{c(){V(e.$$.fragment);},m(s,a){x(e,s,a),n=!0;},p(s,a){r=s;const l={};a&4&&(l.disabled=r[2]),a&16&&(l.description=r[16].guildName),!t&&a&24&&(t=!0,l.checked=r[3][r[16].guildID],gt(()=>t=!1)),e.$set(l);},i(s){n||(T(e.$$.fragment,s),n=!0);},o(s){M(e.$$.fragment,s),n=!1;},d(s){Z(e,s);}}}c(aC,"create_each_block$r");function lC(r){let e,t,n,i,o,s,a=r[4].typoLobbyState.lobbySettings.whitelistAllowedServers?"Only on selected servers by the lobby owner":"On all servers",l,u=r[4].typoLobbyState.lobbySettings.description!==""&&cC(r);return {c(){e=v("div"),u&&u.c(),t=C(),n=v("div"),i=v("b"),i.textContent="Lobby Link Privacy:",o=v("br"),s=C(),l=G(a),_(e,"class","status-settings svelte-1y63bp4");},m(d,h){k(d,e,h),u&&u.m(e,null),g(e,t),g(e,n),g(n,i),g(n,o),g(n,s),g(n,l);},p(d,h){d[4].typoLobbyState.lobbySettings.description!==""?u?u.p(d,h):(u=cC(d),u.c(),u.m(e,t)):u&&(u.d(1),u=null),h&16&&a!==(a=d[4].typoLobbyState.lobbySettings.whitelistAllowedServers?"Only on selected servers by the lobby owner":"On all servers")&&K(l,a);},d(d){d&&A(e),u&&u.d();}}}c(lC,"create_if_block_1$c");function cC(r){let e,t,n,i=r[4].typoLobbyState.lobbySettings.description+"",o;return {c(){e=v("b"),e.textContent="Lobby Description:",t=v("br"),n=C(),o=G(i);},m(s,a){k(s,e,a),k(s,t,a),k(s,n,a),k(s,o,a);},p(s,a){a&16&&i!==(i=s[4].typoLobbyState.lobbySettings.description+"")&&K(o,i);},d(s){s&&(A(e),A(t),A(n),A(o));}}}c(cC,"create_if_block_2$a");function uC(r){var R,E;let e,t,n,i,o=(r[4]===void 0?"/":r[4]==="unauthorized"?"not logged in":r[4]==="paused"?"paused":(R=r[4])==null?void 0:R.typoLobbyState.lobbyId)+"",s,a,l,u,d,h,p=(r[4]===void 0?"/":r[4]==="unauthorized"?"not logged in":r[4]==="paused"?"paused":(E=r[4])==null?void 0:E.typoLobbyState.ownershipClaim)+"",m,b,y,w,I,S;return y=new ke({props:{content:"Reset Connection",color:"orange"}}),y.$on("click",r[14]),I=new ke({props:{content:"Trigger refresh",color:"orange"}}),I.$on("click",r[15]),{c(){e=v("div"),t=v("div"),n=v("b"),n.textContent="Lobby ID:",i=C(),s=G(o),a=C(),l=v("br"),u=C(),d=v("b"),d.textContent="Ownership Claim:",h=C(),m=G(p),b=C(),V(y.$$.fragment),w=C(),V(I.$$.fragment),_(e,"class","status-settings svelte-1y63bp4");},m(P,L){k(P,e,L),g(e,t),g(t,n),g(t,i),g(t,s),g(t,a),g(t,l),g(t,u),g(t,d),g(t,h),g(t,m),g(e,b),x(y,e,null),g(e,w),x(I,e,null),S=!0;},p(P,L){var O,z;(!S||L&16)&&o!==(o=(P[4]===void 0?"/":P[4]==="unauthorized"?"not logged in":P[4]==="paused"?"paused":(O=P[4])==null?void 0:O.typoLobbyState.lobbyId)+"")&&K(s,o),(!S||L&16)&&p!==(p=(P[4]===void 0?"/":P[4]==="unauthorized"?"not logged in":P[4]==="paused"?"paused":(z=P[4])==null?void 0:z.typoLobbyState.ownershipClaim)+"")&&K(m,p);},i(P){S||(T(y.$$.fragment,P),T(I.$$.fragment,P),S=!0);},o(P){M(y.$$.fragment,P),M(I.$$.fragment,P),S=!1;},d(P){P&&A(e),Z(y),Z(I);}}}c(uC,"create_if_block$s");function l5(r){let e,t,n,i,o,s,a,l;const u=[a5,s5,o5,r5],d=[];function h(y,w){return y[4]===void 0?0:y[4]==="unauthorized"?1:y[4]==="paused"?2:3}c(h,"select_block_type"),n=h(r),i=d[n]=u[n](r);let p=r[4]!==void 0&&r[4]!=="unauthorized"&&r[4]!=="paused"&&r[4].typoLobbyState.playerIsOwner&&sC(r),m=r[4]!==void 0&&r[4]!=="unauthorized"&&r[4]!=="paused"&&r[4].typoLobbyState.playerIsOwner===!1&&lC(r),b=r[5]===!0&&uC(r);return {c(){e=v("div"),t=v("div"),i.c(),o=C(),p&&p.c(),s=C(),m&&m.c(),a=C(),b&&b.c(),_(t,"class","status-info svelte-1y63bp4"),_(e,"class","typo-lobby-status-settings svelte-1y63bp4");},m(y,w){k(y,e,w),g(e,t),d[n].m(t,null),g(e,o),p&&p.m(e,null),g(e,s),m&&m.m(e,null),g(e,a),b&&b.m(e,null),l=!0;},p(y,[w]){let I=n;n=h(y),n===I?d[n].p(y,w):(fe(),M(d[I],1,1,()=>{d[I]=null;}),pe(),i=d[n],i?i.p(y,w):(i=d[n]=u[n](y),i.c()),T(i,1),i.m(t,null)),y[4]!==void 0&&y[4]!=="unauthorized"&&y[4]!=="paused"&&y[4].typoLobbyState.playerIsOwner?p?(p.p(y,w),w&16&&T(p,1)):(p=sC(y),p.c(),T(p,1),p.m(e,s)):p&&(fe(),M(p,1,1,()=>{p=null;}),pe()),y[4]!==void 0&&y[4]!=="unauthorized"&&y[4]!=="paused"&&y[4].typoLobbyState.playerIsOwner===!1?m?m.p(y,w):(m=lC(y),m.c(),m.m(e,a)):m&&(m.d(1),m=null),y[5]===!0?b?(b.p(y,w),w&32&&T(b,1)):(b=uC(y),b.c(),T(b,1),b.m(e,null)):b&&(fe(),M(b,1,1,()=>{b=null;}),pe());},i(y){l||(T(i),T(p),T(b),l=!0);},o(y){M(i),M(p),M(b),l=!1;},d(y){y&&A(e),d[n].d(),p&&p.d(),m&&m.d(),b&&b.d();}}}c(l5,"create_fragment$15");function c5(r,e,t){let n,i,{feature:o}=e,s="",a=!1,l={};const u=o.connectionStore;De(r,u,R=>t(4,n=R));const d=o.isDevmodeStore;De(r,d,R=>t(5,i=R)),u.subscribe(R=>{R&&R!=="unauthorized"&&R!=="paused"&&(t(1,s=R.typoLobbyState.lobbySettings.description),t(2,a=!R.typoLobbyState.lobbySettings.whitelistAllowedServers),t(3,l=Object.fromEntries(R.typoLobbyState.lobbySettings.allowedServers.map(E=>[E,!0]))));});const h=c(()=>o.setPaused(!1),"click_handler"),p=c(()=>o.setPaused(!0),"click_handler_1");function m(){s=this.value,t(1,s);}c(m,"input_input_handler");function b(R){a=R,t(2,a);}c(b,"checkbox_checked_binding");function y(R,E){r.$$.not_equal(l[E.guildID],R)&&(l[E.guildID]=R,t(3,l));}c(y,"checkbox_checked_binding_1");const w=c(()=>{o.updateLobbySettings(s,!a,l);},"click_handler_2"),I=c(()=>{o.resetConnection();},"click_handler_3"),S=c(()=>{o.triggerManualRefresh();},"click_handler_4");return r.$$set=R=>{"feature"in R&&t(0,o=R.feature);},[o,s,a,l,n,i,u,d,h,p,m,b,y,w,I,S]}c(c5,"instance$10");const pw=class pw extends se{constructor(e){super(),le(this,e,c5,l5,re,{feature:0});}};c(pw,"Lobby_status");let km=pw;var u5=Object.defineProperty,Ul=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&u5(e,t,i),i},"__decorateClass$D");const mw=class mw extends $e{constructor(){super(...arguments);f(this,"_lobbyService");f(this,"_elementsSetup");f(this,"_memberService");f(this,"_toastService");f(this,"_settingsService");f(this,"_lobbyConnectionService");f(this,"_privateLobbyWhitelistEnabledSetting",new dt("private_whitelist_enabled",!1,this));f(this,"_publicLobbyWhitelistEnabledSetting",new dt("public_whitelist_enabled",!1,this));f(this,"_privateLobbyWhitelistedServersSetting",new dt("private_whitelisted_servers",[],this));f(this,"_publicLobbyWhitelistedServersSetting",new dt("public_whitelisted_servers",[],this));f(this,"_lobbySubscription");f(this,"_currentBackendProcessing");f(this,"_triggerManualRefresh$",new Le(void 0));f(this,"_controlIcon");f(this,"_controlIconSubscription");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_lobbyTypeSubscription");f(this,"name","Lobby Status");f(this,"description","Share your current lobby with typo to use avatar decorations, give awards and catch drops.");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",19);}get boundServices(){return [this._lobbyConnectionService]}get connectionStore(){return it(this._lobbyConnectionService.connection$,void 0)}get isDevmodeStore(){return this._settingsService.settings.devMode.store}async onActivate(){this._lobbyTypeSubscription=this._lobbyService.lobby$.pipe(ce(t=>t===null?null:t.id===null?"practice":t.private?"custom":"public"),ct(),Qe(this._lobbyConnectionService.connection$)).subscribe(async([t,n])=>{var i,o;if((t==="public"||t==="custom")&&n!=="unauthorized"){this._controlIcon||await this.setupSettings();const s=n!=="paused"&&(n==null?void 0:n.typoLobbyState.lobbySettings.whitelistAllowedServers)===!1,a=n===void 0?"file-img-connection-loading-gif":n==="paused"?"file-img-connection-paused-gif":s?"file-img-connection-gif":"file-img-connection-secure-gif",l=n!==void 0;(i=this._controlIcon)==null||i.$set({icon:a,greyscaleInactive:l});}else this.destroySettings(),(o=this._flyoutComponent)==null||o.close();}),this._lobbySubscription=i5(this._lobbyService.lobby$.pipe(Qe(this._triggerManualRefresh$),ce(([t])=>t)),30*1e3).pipe(_t(t=>this._logger.debug("Lobby status update triggered",t)),Pf(()=>this._lobbyConnectionService.isConnected?Tt(null):wD(2e3)),Qe(this._memberService.member$),Pf(()=>this._currentBackendProcessing??Tt(0))).subscribe(([t,n])=>this._currentBackendProcessing=(async()=>{try{await this.processLobbyUpdate(t,n);}catch(i){this._logger.error("Error in lobby status update",i);}})()),this._lobbySubscription.add(()=>this._logger.info("Lobby status update sub stopped")),await this._lobbyConnectionService.setPaused(!1);}async onDestroy(){var t,n;(t=this._lobbySubscription)==null||t.unsubscribe(),(n=this._lobbyTypeSubscription)==null||n.unsubscribe(),this.destroySettings();}async setupSettings(){const t=await this._elementsSetup.complete();this._controlIcon=new st({target:t.chatControls,props:{icon:"file-img-connection-gif",name:"Lobby Status",order:2,size:"2rem",hoverMove:!1,greyscaleInactive:!0,tooltipAction:this.createTooltip}}),this._controlIconSubscription=this._controlIcon.click$.subscribe(()=>{if(this._flyoutComponent)return;const n={componentType:km,props:{feature:this}};this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",title:"Lobby Status",closeStrategy:"explicit",iconName:"file-img-connection-gif",alignment:"top"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var i,o;this._logger.info("Destroyed flyout"),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;});});}destroySettings(){var t,n,i,o;(t=this._controlIcon)==null||t.$destroy(),(n=this._controlIconSubscription)==null||n.unsubscribe(),this._controlIcon=void 0,(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;}async processLobbyUpdate(t,n){if(this._logger.info("processing lobby status update",t,n==null?void 0:n.userName),n==null){await this._lobbyConnectionService.destroyConnection("unauthorized");return}if(t===null||t.id===null){await this._lobbyConnectionService.destroyConnection();return}if(t&&!this._lobbyConnectionService.isConnected){const i=this.mapLobbyToDto(t),o=await this._lobbyConnectionService.setupConnection(t.id,i,t.meId,n);if(o==="failed"){this._logger.error("Failed to setup connection, retrying in next update cycle");return}if(o==="paused"){this._logger.debug("Connection is paused, not connecting");return}const{typoLobbyState:s,hub:a}=this._lobbyConnectionService.connection;if(s.playerIsOwner&&o==="connected"){const l=t.private?{whitelistEnabled:await this._privateLobbyWhitelistEnabledSetting.getValue(),whitelist:await this._privateLobbyWhitelistedServersSetting.getValue()}:{whitelistEnabled:await this._publicLobbyWhitelistEnabledSetting.getValue(),whitelist:await this._publicLobbyWhitelistedServersSetting.getValue()};try{await a.updateTypoLobbySettings({description:"",whitelistAllowedServers:l.whitelistEnabled,allowedServers:l.whitelist});}catch(u){this._logger.error("Failed to set defaults",u);}}}if(t&&this._lobbyConnectionService.isConnected){if(t.id!==this._lobbyConnectionService.connection.typoLobbyState.lobbyId)return this._logger.info("Lobby changed, reconnecting"),await this._lobbyConnectionService.destroyConnection(),this.processLobbyUpdate(t,n);await this._lobbyConnectionService.connection.hub.updateSkribblLobbyState(this.mapLobbyToDto(t));}this._logger.info("Lobby status processed");}mapLobbyToDto(t){if(t.id===null)throw new Error("cannot map practice lobby to state dto");return {link:t.id,ownerId:t.ownerId??void 0,round:t.round,players:t.players.map(n=>({name:n.name,isDrawing:n.id===t.drawerId,score:n.score,playerId:n.id,hasGuessed:n.guessed})),settings:{language:t.settings.language,players:t.settings.players,rounds:t.settings.rounds,drawTime:t.settings.drawTime}}}async updateLobbySettings(t,n,i){const o=await this._toastService.showLoadingToast("Updating lobby settings");this._lobbyService.lobby$.subscribe(s=>{s&&(s.private?(this._privateLobbyWhitelistEnabledSetting.setValue(n),this._privateLobbyWhitelistedServersSetting.setValue(Object.keys(i).filter(a=>i[a]))):(this._publicLobbyWhitelistEnabledSetting.setValue(n),this._publicLobbyWhitelistedServersSetting.setValue(Object.keys(i).filter(a=>i[a]))));});try{await this._lobbyConnectionService.connection.hub.updateTypoLobbySettings({description:t,whitelistAllowedServers:n,allowedServers:Object.entries(i).filter(([,s])=>s).map(([s])=>s)}),o.resolve();}catch(s){this._logger.error("Failed to update lobby settings",s),o.reject();}}async resetConnection(){await this._lobbyConnectionService.destroyConnection(),await this._toastService.showToast(void 0,"Connection reset; reconnecting in next update cycle");}async triggerManualRefresh(){this._triggerManualRefresh$.next(void 0),await this._toastService.showToast(void 0,"Manual refresh triggered");}async setPaused(t){await this._lobbyConnectionService.setPaused(t),t?await this._toastService.showToast("You are now incognito!",`Lobby connection has been paused.
You will no longer be visible on discord.
Sprites, Scenes and Drops are paused as well.`):await this._toastService.showToast("Resumed Connection","Your lobby will be visible on discord and sprites, scenes and drops will show up."),this._triggerManualRefresh$.next(void 0);}};c(mw,"LobbyStatusFeature");let _i=mw;Ul([D(ut)],_i.prototype,"_lobbyService");Ul([D(Me)],_i.prototype,"_elementsSetup");Ul([D(Sn)],_i.prototype,"_memberService");Ul([D(ft)],_i.prototype,"_toastService");Ul([D(xn)],_i.prototype,"_settingsService");Ul([D(go)],_i.prototype,"_lobbyConnectionService");function d5(r){let e,t;return {c(){e=G("Adds a progress bar at the top of the canvas, visualizing the remaining time for selected actions. "),t=v("br");},m(n,i){k(n,e,i),k(n,t,i);},p:j,i:j,o:j,d(n){n&&(A(e),A(t));}}}c(d5,"create_fragment$14");const gw=class gw extends se{constructor(e){super(),le(this,e,null,d5,re,{});}};c(gw,"Lobby_time_visualizer_info");let Cm=gw;var h5=Object.defineProperty,Sb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&h5(e,t,i),i},"__decorateClass$C");const bw=class bw extends $e{constructor(){super(...arguments);f(this,"_lobbyStateChangedEventListener");f(this,"_lobbyJoinedEventListener");f(this,"_lobbyLeftEventListener");f(this,"name","Time Visualizer");f(this,"description","Shows a visual representation of time left to draw/choose");f(this,"tags",[ye.INFORMATION,ye.GAMEPLAY]);f(this,"featureId",30);f(this,"_colorStartSetting",this.useSetting(new ud("visualizer_color_start","#46d536",this).withName("Color Start").withDescription("Start color of the visualizer bar")));f(this,"_colorEndSetting",this.useSetting(new ud("visualizer_color_end","#fa2b08",this).withName("Color End").withDescription("End color of the visualizer bar")));f(this,"_enableChooseVisualizer",this.useSetting(new He("choose_visualizer",!0,this).withName("Choose Visualizer").withDescription("Show a visualizer of the remaining time to choose words")));f(this,"_enableChooseVisualizerOnlyForYourself",this.useSetting(new He("choose_visualizer_self_only",!1,this)).withName("Choose Visualizer Only For Yourself").withDescription("If the choose visualizer is enabled, this makes it so it only shows up when you're choosing your own word"));f(this,"_enableDrawVisualizer",this.useSetting(new He("draw_visualizer",!0,this).withName("Draw Visualizer").withDescription("Show a visualizer of the remaining time to draw a word")));f(this,"_enableGuessVisualizer",this.useSetting(new He("guess_visualizer",!0,this).withName("Guess Visualizer").withDescription("Show a visualizer of the remaining time to guess a word")));f(this,"visualizerEventSubscription");f(this,"_visualizerStyle");}get featureInfoComponent(){return {componentType:Cm,props:{}}}async onActivate(){this._visualizerStyle=Eu(),this._lobbyJoinedEventListener.events$.pipe(Kt(this._lobbyLeftEventListener.events$),ce(t=>t.data),Qe(this._lobbyStateChangedEventListener.events$),Oe(this._enableDrawVisualizer.changes$,this._enableGuessVisualizer.changes$,this._enableChooseVisualizer.changes$,this._enableChooseVisualizerOnlyForYourself.changes$),ce(([[t,n],i,o,s,a])=>{var l,u;return ((l=n.data.timerSet)==null?void 0:l.time)!==0&&t!==null&&(i&&((u=n.data.drawingStarted)==null?void 0:u.drawerId)===t.meId||o&&n.data.drawingStarted!==void 0&&n.data.drawingStarted.drawerId!==t.meId||s&&n.data.drawerChoosingWord!==void 0&&(!a||n.data.drawerChoosingWord.drawerId===t.meId))?{event:n,lobby:t}:n.data.timerSet?{override:n.data.timerSet.time}:void 0}),ce(t=>{if(t===void 0)return;if(t.override)return {override:t.override};const{event:n,lobby:i}=t;if(n!=null&&n.data.drawingStarted)return {max:i.settings.drawTime,time:n.data.drawingStarted.maxTime};if(n!=null&&n.data.drawerChoosingWord)return {max:n.data.drawerChoosingWord.maxTime,time:n.data.drawerChoosingWord.maxTime}}),lr(void 0),Cr(),ce(([t,n])=>{if(n!==void 0)return n.override&&(t!=null&&t.max)?{time:n.override,max:t.max}:n.time&&n.max?{time:n.time,max:n.max}:void 0})).subscribe(t=>{this.visualizeEvent(t);});}async onDestroy(){var t,n;(t=this.visualizerEventSubscription)==null||t.unsubscribe(),this.visualizerEventSubscription=void 0,(n=this._visualizerStyle)==null||n.remove(),this._visualizerStyle=void 0;}async visualizeEvent(t){if(this._logger.debug("Visualize event",t),this._visualizerStyle===void 0){this._logger.error("Visualizer style not set");return}if(this._visualizerStyle.clear(),t===void 0)return;const{time:n,max:i}=t;await Ee(Tt(1).pipe(jl(10)));const o=await this._colorStartSetting.getValue(),s=await this._colorEndSetting.getValue();this._visualizerStyle.replace(`  
      @keyframes countdown {
        0% { width: ${Math.floor(n*100/i)}%; background-color: ${o}; }
        50% { width: ${Math.floor(n*50/i)}%; background-color: ${o}; }
        100% { width: 0%; background-color: ${s}; }
      }
    
      #game-canvas:after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 0;
        height: .3rem;
        animation: countdown ${n*1e3}ms linear;
      }
    `);}get enableChooseVisualizerStore(){return this._enableChooseVisualizer.store}get enableDrawVisualizerStore(){return this._enableDrawVisualizer.store}get enableGuessVisualizerStore(){return this._enableGuessVisualizer.store}};c(bw,"LobbyTimeVisualizerFeature");let Nr=bw;Sb([D(Zn)],Nr.prototype,"_lobbyStateChangedEventListener");Sb([D(Gi)],Nr.prototype,"_lobbyJoinedEventListener");Sb([D(Vn)],Nr.prototype,"_lobbyLeftEventListener");function dC(r,e,t){const n=r.slice();return n[15]=e[t],n[17]=t,n}c(dC,"get_each_context$q");function hC(r,e,t){const n=r.slice();return n[15]=e[t],n[17]=t,n}c(hC,"get_each_context_1$9");function f5(r){let e,t,n,i,o=r[5]&&fC(r),s=te({length:r[4].memberData.slots.unlockedSlots}),a=[];for(let d=0;d<s.length;d+=1)a[d]=pC(hC(r,s,d));let l=te({length:Math.max(9-r[4].memberData.slots.unlockedSlots,3-r[4].memberData.slots.unlockedSlots%3)}),u=[];for(let d=0;d<l.length;d+=1)u[d]=mC(dC(r,l,d));return {c(){e=v("div"),t=v("div"),o&&o.c(),n=C();for(let d=0;d<a.length;d+=1)a[d].c();i=C();for(let d=0;d<u.length;d+=1)u[d].c();_(t,"class","typo-cabin-picker svelte-10x5c2g"),_(e,"class","typo-cabin-scroll svelte-10x5c2g");},m(d,h){k(d,e,h),g(e,t),o&&o.m(t,null),g(t,n);for(let p=0;p<a.length;p+=1)a[p]&&a[p].m(t,null);g(t,i);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(t,null);},p(d,h){if(d[5]?o?o.p(d,h):(o=fC(d),o.c(),o.m(t,n)):o&&(o.d(1),o=null),h&31){s=te({length:d[4].memberData.slots.unlockedSlots});let p;for(p=0;p<s.length;p+=1){const m=hC(d,s,p);a[p]?a[p].p(m,h):(a[p]=pC(m),a[p].c(),a[p].m(t,i));}for(;p<a.length;p+=1)a[p].d(1);a.length=s.length;}if(h&16){l=te({length:Math.max(9-d[4].memberData.slots.unlockedSlots,3-d[4].memberData.slots.unlockedSlots%3)});let p;for(p=0;p<l.length;p+=1){const m=dC(d,l,p);u[p]?u[p].p(m,h):(u[p]=mC(m),u[p].c(),u[p].m(t,null));}for(;p<u.length;p+=1)u[p].d(1);u.length=l.length;}},i:j,o:j,d(d){d&&A(e),o&&o.d(),Ie(a,d),Ie(u,d);}}}c(f5,"create_else_block$i");function p5(r){let e;return {c(){e=v("div"),e.textContent="You need to log in to use sprites.";},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(p5,"create_if_block_1$b");function m5(r){let e,t;return e=new Yn({props:{content:"Loading inventory.."}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(m5,"create_if_block$r");function fC(r){let e,t,n;function i(a,l){return a[4].scene&&a[4].scene.scene?b5:g5}c(i,"select_block_type_1");let o=i(r),s=o(r);return {c(){e=v("div"),s.c(),_(e,"class","typo-cabin-scene svelte-10x5c2g");},m(a,l){k(a,e,l),s.m(e,null),t||(n=[F(e,"click",r[8]),F(e,"contextmenu",r[9])],t=!0);},p(a,l){o===(o=i(a))&&s?s.p(a,l):(s.d(1),s=o(a),s&&(s.c(),s.m(e,null)));},d(a){a&&A(e),s.d(),t=!1,Je(n);}}}c(fC,"create_if_block_3$5");function g5(r){let e;return {c(){e=v("div"),e.textContent="No scene selected",_(e,"class","typo-cabin-scene-info visible svelte-10x5c2g");},m(t,n){k(t,e,n);},p:j,d(t){t&&A(e);}}}c(g5,"create_else_block_2$1");function b5(r){let e,t=r[4].scene.scene.name+"",n,i,o=r[4].scene.scene.id+"",s,a,l,u;return {c(){e=v("div"),n=G(t),i=G(" (#"),s=G(o),a=G(")"),l=C(),u=v("div"),_(e,"class","typo-cabin-scene-info svelte-10x5c2g"),_(u,"class","typo-cabin-scene-thumb svelte-10x5c2g"),H(u,"background-image","url("+r[0].getItemThumbnailUrl(r[4].scene.scene,r[4].scene.shift)+")");},m(d,h){k(d,e,h),g(e,n),g(e,i),g(e,s),g(e,a),k(d,l,h),k(d,u,h);},p(d,h){h&16&&t!==(t=d[4].scene.scene.name+"")&&K(n,t),h&16&&o!==(o=d[4].scene.scene.id+"")&&K(s,o),h&17&&H(u,"background-image","url("+d[0].getItemThumbnailUrl(d[4].scene.scene,d[4].scene.shift)+")");},d(d){d&&(A(e),A(l),A(u));}}}c(b5,"create_if_block_4$5");function v5(r){let e,t,n;return {c(){e=v("div"),e.textContent=`Slot #${r[17]+1}`,t=C(),n=v("div"),n.textContent="Empty",_(e,"class","typo-cabin-slot-info visible svelte-10x5c2g"),_(n,"class","typo-cabin-slot-info visible svelte-10x5c2g");},m(i,o){k(i,e,o),k(i,t,o),k(i,n,o);},p:j,d(i){i&&(A(e),A(t),A(n));}}}c(v5,"create_else_block_1$2");function _5(r){var p,m,b;let e,t,n,i=(((m=(p=r[4].slots.get(r[17]))==null?void 0:p.sprite)==null?void 0:m.name)??"Unknown")+"",o,s,a=((b=r[4].slots.get(r[17]))==null?void 0:b.spriteId)+"",l,u,d,h;return {c(){var y,w;e=v("div"),e.textContent=`Slot #${r[17]+1}`,t=C(),n=v("div"),o=G(i),s=G(`
              (#`),l=G(a),u=G(")"),d=C(),h=v("div"),_(e,"class","typo-cabin-slot-info svelte-10x5c2g"),_(n,"class","typo-cabin-slot-info svelte-10x5c2g"),_(h,"class","typo-cabin-slot-thumb svelte-10x5c2g"),H(h,"background-image","url("+r[0].getItemThumbnailUrl((y=r[4].slots.get(r[17]))==null?void 0:y.sprite,(w=r[4].slots.get(r[17]))==null?void 0:w.colorShift)+")");},m(y,w){k(y,e,w),k(y,t,w),k(y,n,w),g(n,o),g(n,s),g(n,l),g(n,u),k(y,d,w),k(y,h,w);},p(y,w){var I,S,R,E,P;w&16&&i!==(i=(((S=(I=y[4].slots.get(y[17]))==null?void 0:I.sprite)==null?void 0:S.name)??"Unknown")+"")&&K(o,i),w&16&&a!==(a=((R=y[4].slots.get(y[17]))==null?void 0:R.spriteId)+"")&&K(l,a),w&17&&H(h,"background-image","url("+y[0].getItemThumbnailUrl((E=y[4].slots.get(y[17]))==null?void 0:E.sprite,(P=y[4].slots.get(y[17]))==null?void 0:P.colorShift)+")");},d(y){y&&(A(e),A(t),A(n),A(d),A(h));}}}c(_5,"create_if_block_2$9");function pC(r){let e,t,n,i,o;function s(m,b){return b&16&&(t=null),t==null&&(t=!!m[4].slots.has(m[17])),t?_5:v5}c(s,"select_block_type_2");let a=s(r,-1),l=a(r);function u(...m){return r[10](r[17],...m)}c(u,"dragenter_handler");function d(){return r[11](r[17])}c(d,"dragstart_handler");function h(){return r[13](r[17])}c(h,"click_handler_1");function p(...m){return r[14](r[17],...m)}return c(p,"contextmenu_handler_1"),{c(){e=v("div"),l.c(),n=C(),_(e,"class","typo-cabin-slot svelte-10x5c2g"),_(e,"role","gridcell"),_(e,"tabindex",r[17]),_(e,"draggable","true"),H(e,"order",r[2]?r[2][r[17]]:r[17]),ue(e,"dragging",r[1]!==void 0);},m(m,b){k(m,e,b),l.m(e,null),g(e,n),i||(o=[F(e,"dragenter",u),F(e,"dragstart",d),F(e,"dragend",r[12]),F(e,"click",h),F(e,"contextmenu",p)],i=!0);},p(m,b){r=m,a===(a=s(r,b))&&l?l.p(r,b):(l.d(1),l=a(r),l&&(l.c(),l.m(e,n))),b&4&&H(e,"order",r[2]?r[2][r[17]]:r[17]),b&2&&ue(e,"dragging",r[1]!==void 0);},d(m){m&&A(e),l.d(),i=!1,Je(o);}}}c(pC,"create_each_block_1$9");function mC(r){let e,t,n,i=r[17]+r[4].memberData.slots.unlockedSlots+1+"",o,s,a,l;return {c(){e=v("div"),t=v("div"),n=G("Slot #"),o=G(i),s=C(),a=v("div"),a.textContent="Locked",l=C(),_(t,"class","typo-cabin-slot-info svelte-10x5c2g"),_(a,"class","typo-cabin-slot-info svelte-10x5c2g"),_(e,"class","typo-cabin-slot locked svelte-10x5c2g"),H(e,"order",r[17]+r[4].memberData.slots.unlockedSlots+1);},m(u,d){k(u,e,d),g(e,t),g(t,n),g(t,o),g(e,s),g(e,a),g(e,l);},p(u,d){d&16&&i!==(i=u[17]+u[4].memberData.slots.unlockedSlots+1+"")&&K(o,i),d&16&&H(e,"order",u[17]+u[4].memberData.slots.unlockedSlots+1);},d(u){u&&A(e);}}}c(mC,"create_each_block$q");function y5(r){let e,t,n,i,o,s,a;n=new Yn({props:{content:"Saving.."}});const l=[m5,p5,f5],u=[];function d(h,p){return h[4]===void 0?0:h[4]===null?1:2}return c(d,"select_block_type"),o=d(r),s=u[o]=l[o](r),{c(){e=v("div"),t=v("div"),V(n.$$.fragment),i=C(),s.c(),_(t,"class","typo-cabin-saving svelte-10x5c2g"),_(e,"class","typo-cabin svelte-10x5c2g"),ue(e,"loading",r[3]);},m(h,p){k(h,e,p),g(e,t),x(n,t,null),g(e,i),u[o].m(e,null),a=!0;},p(h,[p]){let m=o;o=d(h),o===m?u[o].p(h,p):(fe(),M(u[m],1,1,()=>{u[m]=null;}),pe(),s=u[o],s?s.p(h,p):(s=u[o]=l[o](h),s.c()),T(s,1),s.m(e,null)),(!a||p&8)&&ue(e,"loading",h[3]);},i(h){a||(T(n.$$.fragment,h),T(s),a=!0);},o(h){M(n.$$.fragment,h),M(s),a=!1;},d(h){h&&A(e),Z(n),u[o].d();}}}c(y5,"create_fragment$13");function w5(r,e,t){let n,i,{feature:o}=e;const s=o.memberStore;De(r,s,S=>t(4,n=S));const a=o.scenePickerSettingStore;De(r,a,S=>t(5,i=S));let l,u,d=!1;const h=c(async()=>{const S=await o.promptSceneSelection(n.memberData.sceneInventory);S!==void 0&&(t(3,d=!0),await o.setScene((S==null?void 0:S.scene)??null,S==null?void 0:S.shift,n.memberData.member.userLogin),t(3,d=!1));},"click_handler"),p=c(async S=>{S.preventDefault(),t(3,d=!0),await o.setScene(null,void 0,n.memberData.member.userLogin),t(3,d=!1);},"contextmenu_handler"),m=c((S,R)=>{if(l===S||u===void 0||l===void 0)return;const E=[...Array(n.memberData.slots.unlockedSlots).keys()];for(let P=0;P<u.length;P++)P>=S&&P<l&&(E[P]=P+1),P<=S&&P>l&&(E[P]=P-1);E[l]=u[S],t(2,u=E);},"dragenter_handler"),b=c(S=>{t(1,l=S),t(2,u=[...Array(n.memberData.slots.unlockedSlots).keys()]);},"dragstart_handler"),y=c(async()=>{t(3,d=!0),await o.reorderSlots(u,n.memberData.spriteInventory,Number(n.memberData.member.userLogin)),t(1,l=void 0),t(2,u=void 0),t(3,d=!1);},"dragend_handler"),w=c(async S=>{const R=await o.promptSpriteSelection(n.memberData.spriteInventory);R!==void 0&&(t(3,d=!0),await o.setSpriteOnSlot(S+1,R,n.memberData.member.userLogin),t(3,d=!1));},"click_handler_1"),I=c(async(S,R)=>{R.preventDefault(),t(3,d=!0),await o.setSpriteOnSlot(S+1,null,n.memberData.member.userLogin),t(3,d=!1);},"contextmenu_handler_1");return r.$$set=S=>{"feature"in S&&t(0,o=S.feature);},[o,l,u,d,n,i,s,a,h,p,m,b,y,w,I]}c(w5,"instance$$");const vw=class vw extends se{constructor(e){super(),le(this,e,w5,y5,re,{feature:0});}};c(vw,"Panel_cabin");let Im=vw;function gC(r,e,t){const n=r.slice();return n[11]=e[t],n}c(gC,"get_each_context$p");function bC(r){var w,I;let e,t,n,i,o,s=((w=r[2].get(r[11].spriteId))==null?void 0:w.id)+"",a,l,u,d=((I=r[2].get(r[11].spriteId))==null?void 0:I.name)+"",h,p,m,b;function y(){return r[10](r[11])}return c(y,"click_handler_1"),{c(){var S;e=v("div"),t=v("div"),n=C(),i=v("span"),o=G("#"),a=G(s),l=C(),u=v("span"),h=G(d),p=C(),_(t,"class","typo-sprite-picker-sprite-thumb svelte-1bcvdme"),H(t,"background-image","url("+((S=r[2].get(r[11].spriteId))==null?void 0:S.url)+")"),_(i,"class","svelte-1bcvdme"),_(u,"class","svelte-1bcvdme"),_(e,"class","typo-sprite-picker-sprite svelte-1bcvdme"),H(e,"order",r[11].spriteId);},m(S,R){k(S,e,R),g(e,t),g(e,n),g(e,i),g(i,o),g(i,a),g(e,l),g(e,u),g(u,h),g(e,p),m||(b=F(e,"click",y),m=!0);},p(S,R){var E,P,L;r=S,R&6&&H(t,"background-image","url("+((E=r[2].get(r[11].spriteId))==null?void 0:E.url)+")"),R&6&&s!==(s=((P=r[2].get(r[11].spriteId))==null?void 0:P.id)+"")&&K(a,s),R&6&&d!==(d=((L=r[2].get(r[11].spriteId))==null?void 0:L.name)+"")&&K(h,d),R&2&&H(e,"order",r[11].spriteId);},d(S){S&&A(e),m=!1,b();}}}c(bC,"create_if_block$q");function vC(r){let e=r[11].slot===void 0&&r[5](r[2].get(r[11].spriteId),r[3]),t,n=e&&bC(r);return {c(){n&&n.c(),t=je();},m(i,o){n&&n.m(i,o),k(i,t,o);},p(i,o){o&14&&(e=i[11].slot===void 0&&i[5](i[2].get(i[11].spriteId),i[3])),e?n?n.p(i,o):(n=bC(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null);},d(i){i&&A(t),n&&n.d(i);}}}c(vC,"create_each_block$p");function S5(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b=te(r[1]),y=[];for(let w=0;w<b.length;w+=1)y[w]=vC(gC(r,b,w));return {c(){e=v("div"),t=v("span"),t.innerHTML=`Choose a sprite from your inventory which will be used on the selected slot.<br/>
    You can only choose sprites that are not already in use.`,n=C(),i=v("div"),o=v("span"),o.textContent="Filter sprites:",s=C(),a=v("input"),l=C(),u=v("div"),d=v("div"),d.innerHTML='<div class="typo-sprite-picker-sprite-thumb svelte-1bcvdme"></div> <span class="svelte-1bcvdme">Empty</span>',h=C();for(let w=0;w<y.length;w+=1)y[w].c();_(t,"class","svelte-1bcvdme"),_(o,"class","svelte-1bcvdme"),_(a,"type","text"),_(a,"placeholder","Search for ID or name"),_(a,"class","svelte-1bcvdme"),_(i,"class","typo-sprite-picker-filter svelte-1bcvdme"),_(d,"class","typo-sprite-picker-sprite svelte-1bcvdme"),_(u,"class","typo-sprite-picker-list color-scrollbar svelte-1bcvdme"),_(e,"class","typo-sprite-picker svelte-1bcvdme");},m(w,I){k(w,e,I),g(e,t),g(e,n),g(e,i),g(i,o),g(i,s),g(i,a),de(a,r[3]),g(e,l),g(e,u),g(u,d),g(u,h);for(let S=0;S<y.length;S+=1)y[S]&&y[S].m(u,null);p||(m=[F(a,"input",r[8]),F(d,"click",r[9])],p=!0);},p(w,[I]){if(I&8&&a.value!==w[3]&&de(a,w[3]),I&47){b=te(w[1]);let S;for(S=0;S<b.length;S+=1){const R=gC(w,b,S);y[S]?y[S].p(R,I):(y[S]=vC(R),y[S].c(),y[S].m(u,null));}for(;S<y.length;S+=1)y[S].d(1);y.length=b.length;}},i:j,o:j,d(w){w&&A(e),Ie(y,w),p=!1,Je(m);}}}c(S5,"create_fragment$12");function A5(r,e,t){let n,{feature:i}=e,{onPick:o}=e,{sprites:s}=e,{inventory:a}=e,l=MD("");De(r,l,b=>t(3,n=b));const u=c((b,y)=>{if(!y||b===void 0)return !0;const w=y.toLowerCase();return b.name.toLowerCase().includes(w)||b.id.toString()===y},"matchesFilter");let d=new Map;function h(){n=this.value,l.set(n);}c(h,"input_input_handler");const p=c(()=>o(null),"click_handler"),m=c(b=>o(d.get(b.spriteId)),"click_handler_1");return r.$$set=b=>{"feature"in b&&t(6,i=b.feature),"onPick"in b&&t(0,o=b.onPick),"sprites"in b&&t(7,s=b.sprites),"inventory"in b&&t(1,a=b.inventory);},r.$$.update=()=>{r.$$.dirty&128&&t(2,d=new Map(s.map(b=>[b.id,b])));},[o,a,d,n,l,u,i,s,h,p,m]}c(A5,"instance$_");const _w=class _w extends se{constructor(e){super(),le(this,e,A5,S5,re,{feature:6,onPick:0,sprites:7,inventory:1});}};c(_w,"Panel_cabin_sprite_picker");let Tm=_w;function _C(r,e,t){const n=r.slice();return n[9]=e[t],n}c(_C,"get_each_context$o");function k5(r){var w,I;let e,t,n,i,o,s=((w=r[3].get(r[9].sceneId))==null?void 0:w.id)+"",a,l,u,d=((I=r[3].get(r[9].sceneId))==null?void 0:I.name)+"",h,p,m,b;function y(){return r[8](r[9])}return c(y,"click_handler_2"),{c(){var S;e=v("div"),t=v("div"),n=C(),i=v("span"),o=G("#"),a=G(s),l=C(),u=v("span"),h=G(d),p=C(),_(t,"class","typo-scene-picker-scene-thumb svelte-1s2xvs0"),H(t,"background-image","url("+((S=r[3].get(r[9].sceneId))==null?void 0:S.url)+")"),_(i,"class","id svelte-1s2xvs0"),_(u,"class","name svelte-1s2xvs0"),_(e,"class","typo-scene-picker-scene svelte-1s2xvs0"),H(e,"order",r[9].sceneId);},m(S,R){k(S,e,R),g(e,t),g(e,n),g(e,i),g(i,o),g(i,a),g(e,l),g(e,u),g(u,h),g(e,p),m||(b=F(e,"click",y),m=!0);},p(S,R){var E,P,L;r=S,R&12&&H(t,"background-image","url("+((E=r[3].get(r[9].sceneId))==null?void 0:E.url)+")"),R&12&&s!==(s=((P=r[3].get(r[9].sceneId))==null?void 0:P.id)+"")&&K(a,s),R&12&&d!==(d=((L=r[3].get(r[9].sceneId))==null?void 0:L.name)+"")&&K(h,d),R&4&&H(e,"order",r[9].sceneId);},d(S){S&&A(e),m=!1,b();}}}c(k5,"create_else_block$h");function C5(r){var P,L,O;let e,t,n,i,o,s=((P=r[3].get(r[9].sceneId))==null?void 0:P.id)+"",a,l,u=r[9].sceneShift+"",d,h,p,m,b=((O=(L=r[3].get(r[9].sceneId))==null?void 0:L.themes.find(R))==null?void 0:O.name)+"",y,w,I,S;function R(...z){return r[6](r[9],...z)}c(R,"func");function E(){return r[7](r[9])}return c(E,"click_handler_1"),{c(){e=v("div"),t=v("div"),n=C(),i=v("span"),o=G("#"),a=G(s),l=G(" (color #"),d=G(u),h=G(")"),p=C(),m=v("span"),y=G(b),w=C(),_(t,"class","typo-scene-picker-scene-thumb svelte-1s2xvs0"),H(t,"background-image","url("+r[0].getItemThumbnailUrl(r[3].get(r[9].sceneId),r[9].sceneShift)+")"),_(i,"class","id svelte-1s2xvs0"),_(m,"class","name svelte-1s2xvs0"),_(e,"class","typo-scene-picker-scene svelte-1s2xvs0"),H(e,"order",r[9].sceneId);},m(z,$){k(z,e,$),g(e,t),g(e,n),g(e,i),g(i,o),g(i,a),g(i,l),g(i,d),g(i,h),g(e,p),g(e,m),g(m,y),k(z,w,$),I||(S=F(e,"click",E),I=!0);},p(z,$){var U,N,Y;r=z,$&13&&H(t,"background-image","url("+r[0].getItemThumbnailUrl(r[3].get(r[9].sceneId),r[9].sceneShift)+")"),$&12&&s!==(s=((U=r[3].get(r[9].sceneId))==null?void 0:U.id)+"")&&K(a,s),$&4&&u!==(u=r[9].sceneShift+"")&&K(d,u),$&12&&b!==(b=((Y=(N=r[3].get(r[9].sceneId))==null?void 0:N.themes.find(R))==null?void 0:Y.name)+"")&&K(y,b),$&4&&H(e,"order",r[9].sceneId);},d(z){z&&(A(e),A(w)),I=!1,S();}}}c(C5,"create_if_block$p");function yC(r){let e;function t(o,s){return o[9].sceneShift?C5:k5}c(t,"select_block_type");let n=t(r),i=n(r);return {c(){i.c(),e=je();},m(o,s){i.m(o,s),k(o,e,s);},p(o,s){n===(n=t(o))&&i?i.p(o,s):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)));},d(o){o&&A(e),i.d(o);}}}c(yC,"create_each_block$o");function I5(r){let e,t,n,i,o,s,a,l,u=te(r[2].scenes),d=[];for(let h=0;h<u.length;h+=1)d[h]=yC(_C(r,u,h));return {c(){e=v("div"),t=v("span"),t.textContent="Choose a scene from your inventory which will be used as your avatar background.",n=C(),i=v("div"),o=v("div"),o.innerHTML='<div class="typo-scene-picker-scene-thumb svelte-1s2xvs0"></div> <span class="svelte-1s2xvs0">Empty</span>',s=C();for(let h=0;h<d.length;h+=1)d[h].c();_(t,"class","svelte-1s2xvs0"),_(o,"class","typo-scene-picker-scene svelte-1s2xvs0"),_(i,"class","typo-scene-picker-list color-scrollbar svelte-1s2xvs0"),_(e,"class","typo-scene-picker svelte-1s2xvs0");},m(h,p){k(h,e,p),g(e,t),g(e,n),g(e,i),g(i,o),g(i,s);for(let m=0;m<d.length;m+=1)d[m]&&d[m].m(i,null);a||(l=F(o,"click",r[5]),a=!0);},p(h,[p]){if(p&15){u=te(h[2].scenes);let m;for(m=0;m<u.length;m+=1){const b=_C(h,u,m);d[m]?d[m].p(b,p):(d[m]=yC(b),d[m].c(),d[m].m(i,null));}for(;m<d.length;m+=1)d[m].d(1);d.length=u.length;}},i:j,o:j,d(h){h&&A(e),Ie(d,h),a=!1,l();}}}c(I5,"create_fragment$11");function T5(r,e,t){let{feature:n}=e,{onPick:i}=e,{scenes:o}=e,{inventory:s}=e,a=new Map;const l=c(()=>i(null,void 0),"click_handler"),u=c((p,m)=>m.shift===p.sceneShift,"func"),d=c(p=>i(a.get(p.sceneId),p.sceneShift),"click_handler_1"),h=c(p=>i(a.get(p.sceneId),void 0),"click_handler_2");return r.$$set=p=>{"feature"in p&&t(0,n=p.feature),"onPick"in p&&t(1,i=p.onPick),"scenes"in p&&t(4,o=p.scenes),"inventory"in p&&t(2,s=p.inventory);},r.$$.update=()=>{r.$$.dirty&16&&t(3,a=new Map(o.map(p=>[p.id,p])));},[n,i,s,a,o,l,u,d,h]}c(T5,"instance$Z");const yw=class yw extends se{constructor(e){super(),le(this,e,T5,I5,re,{feature:0,onPick:1,scenes:4,inventory:2});}};c(yw,"Panel_cabin_scene_picker");let Dm=yw;var D5=Object.defineProperty,Bl=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&D5(e,t,i),i},"__decorateClass$B");const ww=class ww extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_apiDataSetup");f(this,"_memberService");f(this,"_apiService");f(this,"_modalService");f(this,"_toastService");f(this,"_component");f(this,"name","Outfit Cabin");f(this,"description","Displays a drag-n-drop interface on the start page to customize your sprite combo");f(this,"tags",[ye.PALANTIR]);f(this,"featureId",3);f(this,"_enableScenePickerSetting",this.useSetting(new He("enable_scene_picker",!0,this).withName("Enable Scene Picker").withDescription("Show the scene picker at the top of the sprite cabin")));}async onActivate(){const t=await this._elements.complete();this._component=new Im({target:t.cabinTab,props:{feature:this}});}onDestroy(){var t;(t=this._component)==null||t.$destroy();}get scenePickerSettingStore(){return this._enableScenePickerSetting.store}get memberStore(){return it(this._memberService.memberData$.pipe(lt(async t=>{if(t==null)return null;const n=await this._apiDataSetup.complete(),i=new Map(t.spriteInventory.filter(s=>s.slot!==void 0).map(s=>({...s,sprite:n.sprites.find(a=>a.id===s.spriteId)})).map(s=>[(s.slot??0)-1,s])),o=t.sceneInventory.activeId?{id:t.sceneInventory.activeId,shift:t.sceneInventory.activeShift,scene:n.scenes.find(s=>s.id===t.sceneInventory.activeId)}:void 0;return {memberData:t,slots:i,scene:o}})),void 0)}getItemThumbnailUrl(t,n){return t?n!==void 0?`https://static.typo.rip/sprites/rainbow/modulate.php?url=${t.url}&hue=${n}`:t.url:""}async reorderSlots(t,n,i){if(this._logger.debug("Reordering slots",t,n),t.every((s,a)=>s===a)){this._logger.info("No change in slot order");return}const o=[];n.forEach(s=>{s.slot!==void 0&&o.push({slotId:t[s.slot-1]+1,spriteId:s.spriteId});}),await this._apiService.getApi(di).setMemberSpriteCombo({login:i,spriteComboDto:{slots:o}}),await this._memberService.refreshInventory(),this._logger.info("Reordered slots",o);}async promptSpriteSelection(t){this._logger.debug("Opening sprite picker");const n=(await this._apiDataSetup.complete()).sprites,i={componentType:Tm,propsFactory:c(s=>({feature:this,inventory:t,sprites:n,onPick:s.bind(this)}),"propsFactory")},o=await this._modalService.showPrompt(i.componentType,i.propsFactory,"Sprite Picker","document");return this._logger.debug("Sprite picker closed",o),o}async setSpriteOnSlot(t,n,i){this._logger.debug("Setting sprite on slot",t,n);try{await this._apiService.getApi(di).setMemberSpriteSlot({login:i,spriteSlotDto:{slotId:t,spriteId:(n==null?void 0:n.id)??0}}),await this._memberService.refreshInventory();}catch(o){this._logger.error("Failed to set sprite on slot",o),await this._toastService.showToast("Failed to set sprite on slot");}}async promptSceneSelection(t){this._logger.debug("Opening scene picker");const n=(await this._apiDataSetup.complete()).scenes,i={componentType:Dm,propsFactory:c(s=>({feature:this,inventory:t,scenes:n,onPick:c((a,l)=>s(a&&{scene:a,shift:l}),"onPick")}),"propsFactory")},o=await this._modalService.showPrompt(i.componentType,i.propsFactory,"Scene Picker","document");return this._logger.debug("Scene picker closed",o),o}async setScene(t,n,i){this._logger.debug("Setting scene",t,n);try{await this._apiService.getApi(di).setMemberScene({login:i,setActiveSceneDto:{scene:t?{sceneId:t.id,sceneShift:n}:void 0}}),await this._memberService.refreshInventory();}catch(o){this._logger.error("Failed to set scene",o),await this._toastService.showToast("Failed to set scene");}}};c(ww,"PanelCabinFeature");let zi=ww;Bl([D(Me)],zi.prototype,"_elements");Bl([D(Tn)],zi.prototype,"_apiDataSetup");Bl([D(Sn)],zi.prototype,"_memberService");Bl([D(mi)],zi.prototype,"_apiService");Bl([D(Dn)],zi.prototype,"_modalService");Bl([D(ft)],zi.prototype,"_toastService");function wC(r,e,t){const n=r.slice();return n[5]=e[t],n}c(wC,"get_each_context$n");function SC(r){let e,t,n=r[0].getVersion()+"",i;return {c(){e=v("p"),t=G("Typo version: "),i=G(n),_(e,"class","typo-version svelte-eh7e5t");},m(o,s){k(o,e,s),g(e,t),g(e,i);},p(o,s){s&1&&n!==(n=o[0].getVersion()+"")&&K(i,n);},d(o){o&&A(e);}}}c(SC,"create_if_block_2$8");function E5(r){let e,t=te(r[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=kC(wC(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,o){if(o&3){t=te(i[1]);let s;for(s=0;s<t.length;s+=1){const a=wC(i,t,s);n[s]?n[s].p(a,o):(n[s]=kC(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},i:j,o:j,d(i){i&&A(e),Ie(n,i);}}}c(E5,"create_else_block$g");function M5(r){let e,t;return e=new Yn({props:{content:"Loading changelog.."}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(M5,"create_if_block$o");function AC(r){let e;return {c(){e=v("span"),e.textContent="Read more..",_(e,"class","details svelte-eh7e5t");},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(AC,"create_if_block_1$a");function kC(r){let e,t,n,i=r[5].title+"",o,s,a,l=r[5].affectedTypoVersion+"",u,d,h=new Date(Number(r[5].date)).toLocaleDateString()+"",p,m,b,y,w=r[5].content+"",I,S,R,E,P,L=r[5].details!==void 0&&AC();function O(){return r[4](r[5])}return c(O,"click_handler"),{c(){e=v("div"),t=v("div"),n=v("b"),o=G(i),s=C(),a=v("span"),u=G(l),d=G(" ("),p=G(h),m=G(")"),b=C(),y=v("p"),I=G(w),S=C(),L&&L.c(),R=C(),_(a,"class","svelte-eh7e5t"),_(t,"class","title svelte-eh7e5t"),_(e,"class","change svelte-eh7e5t");},m(z,$){k(z,e,$),g(e,t),g(t,n),g(n,o),g(t,s),g(t,a),g(a,u),g(a,d),g(a,p),g(a,m),g(e,b),g(e,y),g(y,I),g(e,S),L&&L.m(e,null),g(e,R),E||(P=F(e,"click",O),E=!0);},p(z,$){r=z,$&2&&i!==(i=r[5].title+"")&&K(o,i),$&2&&l!==(l=r[5].affectedTypoVersion+"")&&K(u,l),$&2&&h!==(h=new Date(Number(r[5].date)).toLocaleDateString()+"")&&K(p,h),$&2&&w!==(w=r[5].content+"")&&K(I,w),r[5].details!==void 0?L||(L=AC(),L.c(),L.m(e,R)):L&&(L.d(1),L=null);},d(z){z&&A(e),L&&L.d(),E=!1,P();}}}c(kC,"create_each_block$n");function R5(r){let e,t,n,i,o,s,a=r[2]&&SC(r);const l=[M5,E5],u=[];function d(h,p){return h[1]===void 0?0:1}return c(d,"select_block_type"),i=d(r),o=u[i]=l[i](r),{c(){e=v("div"),a&&a.c(),t=C(),n=v("div"),o.c(),_(n,"class","changelog svelte-eh7e5t"),_(e,"class","panel-changelog svelte-eh7e5t");},m(h,p){k(h,e,p),a&&a.m(e,null),g(e,t),g(e,n),u[i].m(n,null),s=!0;},p(h,[p]){h[2]?a?a.p(h,p):(a=SC(h),a.c(),a.m(e,t)):a&&(a.d(1),a=null);let m=i;i=d(h),i===m?u[i].p(h,p):(fe(),M(u[m],1,1,()=>{u[m]=null;}),pe(),o=u[i],o?o.p(h,p):(o=u[i]=l[i](h),o.c()),T(o,1),o.m(n,null));},i(h){s||(T(o),s=!0);},o(h){M(o),s=!1;},d(h){h&&A(e),a&&a.d(),u[i].d();}}}c(R5,"create_fragment$10");function L5(r,e,t){let n,{feature:i}=e,{changes:o=void 0}=e;const s=i.devmodeStore;De(r,s,l=>t(2,n=l));const a=c(l=>{l.details&&i.showDetailsModal(l);},"click_handler");return r.$$set=l=>{"feature"in l&&t(0,i=l.feature),"changes"in l&&t(1,o=l.changes);},[i,o,n,s,a]}c(L5,"instance$Y");const Sw=class Sw extends se{constructor(e){super(),le(this,e,L5,R5,re,{feature:0,changes:1});}};c(Sw,"Panel_changelog");let Em=Sw;function P5(){const r=console.warn;console.warn=e=>{e.includes("unknown prop")||e.includes("unexpected slot")||r(e);},li(()=>{console.warn=r;});}c(P5,"supressWarnings");function CC(r,e,t){const n=r.slice();return n[18]=e[t],n}c(CC,"get_each_context_5$1");function IC(r,e,t){const n=r.slice();return n[18]=e[t],n}c(IC,"get_each_context_4$1");function TC(r,e,t){const n=r.slice();return n[10]=e[t],n}c(TC,"get_each_context_1$8");function DC(r,e,t){const n=r.slice();return n[13]=e[t],n[15]=t,n}c(DC,"get_each_context_2$4");function EC(r,e,t){const n=r.slice();return n[16]=e[t],n[15]=t,n}c(EC,"get_each_context_3$2");function MC(r,e,t){const n=r.slice();return n[7]=e[t],n}c(MC,"get_each_context$m");function N5(r){let e,t,n,i;const o=[$5,G5,j5],s=[];function a(l,u){return l[0]==="table"?0:l[0]==="list"?1:2}return c(a,"select_block_type_1"),e=a(r),t=s[e]=o[e](r),{c(){t.c(),n=je();},m(l,u){s[e].m(l,u),k(l,n,u),i=!0;},p(l,u){let d=e;e=a(l),e===d?s[e].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n));},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),s[e].d(l);}}}c(N5,"create_if_block_1$9");function O5(r){let e,t,n=te(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=jC(MC(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){for(let s=0;s<i.length;s+=1)i[s].c();e=je();},m(s,a){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,a);k(s,e,a),t=!0;},p(s,a){if(a&34){n=te(s[1]);let l;for(l=0;l<n.length;l+=1){const u=MC(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=jC(u),i[l].c(),T(i[l],1),i[l].m(e.parentNode,e));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(O5,"create_if_block$n");function j5(r){let e,t,n;const i=[r[6]];var o=r[5][r[0]];function s(a,l){let u={$$slots:{default:[U5]},$$scope:{ctx:a}};for(let d=0;d<i.length;d+=1)u=St(u,i[d]);return l!==void 0&&l&64&&(u=St(u,Rt(i,[Lt(a[6])]))),{props:u}}return c(s,"switch_props"),o&&(e=qe(o,s(r))),{c(){e&&V(e.$$.fragment),t=je();},m(a,l){e&&x(e,a,l),k(a,t,l),n=!0;},p(a,l){if(l&33&&o!==(o=a[5][a[0]])){if(e){fe();const u=e;M(u.$$.fragment,1,0,()=>{Z(u,1);}),pe();}o?(e=qe(o,s(a,l)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(o){const u=l&64?Rt(i,[Lt(a[6])]):{};l&8388706&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);}},i(a){n||(e&&T(e.$$.fragment,a),n=!0);},o(a){e&&M(e.$$.fragment,a),n=!1;},d(a){a&&A(t),e&&Z(e,a);}}}c(j5,"create_else_block_1$1");function G5(r){let e,t,n,i;const o=[x5,B5],s=[];function a(l,u){return l[4]?0:1}return c(a,"select_block_type_2"),e=a(r),t=s[e]=o[e](r),{c(){t.c(),n=je();},m(l,u){s[e].m(l,u),k(l,n,u),i=!0;},p(l,u){let d=e;e=a(l),e===d?s[e].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n));},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),s[e].d(l);}}}c(G5,"create_if_block_3$4");function $5(r){let e,t,n;var i=r[5].table;function o(s,a){return {props:{$$slots:{default:[eY]},$$scope:{ctx:s}}}}return c(o,"switch_props"),i&&(e=qe(i,o(r))),{c(){e&&V(e.$$.fragment),t=je();},m(s,a){e&&x(e,s,a),k(s,t,a),n=!0;},p(s,a){if(a&32&&i!==(i=s[5].table)){if(e){fe();const l=e;M(l.$$.fragment,1,0,()=>{Z(l,1);}),pe();}i?(e=qe(i,o(s)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(i){const l={};a&8388716&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);}},i(s){n||(e&&T(e.$$.fragment,s),n=!0);},o(s){e&&M(e.$$.fragment,s),n=!1;},d(s){s&&A(t),e&&Z(e,s);}}}c($5,"create_if_block_2$7");function Y5(r){let e=r[6].raw+"",t;return {c(){t=G(e);},m(n,i){k(n,t,i);},p(n,i){i&64&&e!==(e=n[6].raw+"")&&K(t,e);},i:j,o:j,d(n){n&&A(t);}}}c(Y5,"create_else_block_2");function z5(r){let e,t;return e=new Po({props:{tokens:r[1],renderers:r[5]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&2&&(o.tokens=n[1]),i&32&&(o.renderers=n[5]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(z5,"create_if_block_5$2");function U5(r){let e,t,n,i;const o=[z5,Y5],s=[];function a(l,u){return l[1]?0:1}return c(a,"select_block_type_3"),e=a(r),t=s[e]=o[e](r),{c(){t.c(),n=je();},m(l,u){s[e].m(l,u),k(l,n,u),i=!0;},p(l,u){let d=e;e=a(l),e===d?s[e].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n));},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),s[e].d(l);}}}c(U5,"create_default_slot_11");function B5(r){let e,t,n;const i=[{ordered:r[4]},r[6]];var o=r[5].list;function s(a,l){let u={$$slots:{default:[V5]},$$scope:{ctx:a}};for(let d=0;d<i.length;d+=1)u=St(u,i[d]);return l!==void 0&&l&80&&(u=St(u,Rt(i,[l&16&&{ordered:a[4]},l&64&&Lt(a[6])]))),{props:u}}return c(s,"switch_props"),o&&(e=qe(o,s(r))),{c(){e&&V(e.$$.fragment),t=je();},m(a,l){e&&x(e,a,l),k(a,t,l),n=!0;},p(a,l){if(l&32&&o!==(o=a[5].list)){if(e){fe();const u=e;M(u.$$.fragment,1,0,()=>{Z(u,1);}),pe();}o?(e=qe(o,s(a,l)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(o){const u=l&80?Rt(i,[l&16&&{ordered:a[4]},l&64&&Lt(a[6])]):{};l&8388704&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);}},i(a){n||(e&&T(e.$$.fragment,a),n=!0);},o(a){e&&M(e.$$.fragment,a),n=!1;},d(a){a&&A(t),e&&Z(e,a);}}}c(B5,"create_else_block$f");function x5(r){let e,t,n;const i=[{ordered:r[4]},r[6]];var o=r[5].list;function s(a,l){let u={$$slots:{default:[F5]},$$scope:{ctx:a}};for(let d=0;d<i.length;d+=1)u=St(u,i[d]);return l!==void 0&&l&80&&(u=St(u,Rt(i,[l&16&&{ordered:a[4]},l&64&&Lt(a[6])]))),{props:u}}return c(s,"switch_props"),o&&(e=qe(o,s(r))),{c(){e&&V(e.$$.fragment),t=je();},m(a,l){e&&x(e,a,l),k(a,t,l),n=!0;},p(a,l){if(l&32&&o!==(o=a[5].list)){if(e){fe();const u=e;M(u.$$.fragment,1,0,()=>{Z(u,1);}),pe();}o?(e=qe(o,s(a,l)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(o){const u=l&80?Rt(i,[l&16&&{ordered:a[4]},l&64&&Lt(a[6])]):{};l&8388704&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);}},i(a){n||(e&&T(e.$$.fragment,a),n=!0);},o(a){e&&M(e.$$.fragment,a),n=!1;},d(a){a&&A(t),e&&Z(e,a);}}}c(x5,"create_if_block_4$4");function Z5(r){let e,t,n;return e=new Po({props:{tokens:r[18].tokens,renderers:r[5]}}),{c(){V(e.$$.fragment),t=C();},m(i,o){x(e,i,o),k(i,t,o),n=!0;},p(i,o){const s={};o&64&&(s.tokens=i[18].tokens),o&32&&(s.renderers=i[5]),e.$set(s);},i(i){n||(T(e.$$.fragment,i),n=!0);},o(i){M(e.$$.fragment,i),n=!1;},d(i){i&&A(t),Z(e,i);}}}c(Z5,"create_default_slot_10");function RC(r){let e,t,n;const i=[r[18]];var o=r[5].unorderedlistitem||r[5].listitem;function s(a,l){let u={$$slots:{default:[Z5]},$$scope:{ctx:a}};for(let d=0;d<i.length;d+=1)u=St(u,i[d]);return l!==void 0&&l&64&&(u=St(u,Rt(i,[Lt(a[18])]))),{props:u}}return c(s,"switch_props"),o&&(e=qe(o,s(r))),{c(){e&&V(e.$$.fragment),t=je();},m(a,l){e&&x(e,a,l),k(a,t,l),n=!0;},p(a,l){if(l&32&&o!==(o=a[5].unorderedlistitem||a[5].listitem)){if(e){fe();const u=e;M(u.$$.fragment,1,0,()=>{Z(u,1);}),pe();}o?(e=qe(o,s(a,l)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(o){const u=l&64?Rt(i,[Lt(a[18])]):{};l&8388704&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);}},i(a){n||(e&&T(e.$$.fragment,a),n=!0);},o(a){e&&M(e.$$.fragment,a),n=!1;},d(a){a&&A(t),e&&Z(e,a);}}}c(RC,"create_each_block_5$1");function V5(r){let e,t,n=te(r[6].items),i=[];for(let s=0;s<n.length;s+=1)i[s]=RC(CC(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){for(let s=0;s<i.length;s+=1)i[s].c();e=je();},m(s,a){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,a);k(s,e,a),t=!0;},p(s,a){if(a&96){n=te(s[6].items);let l;for(l=0;l<n.length;l+=1){const u=CC(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=RC(u),i[l].c(),T(i[l],1),i[l].m(e.parentNode,e));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(V5,"create_default_slot_9");function J5(r){let e,t,n;return e=new Po({props:{tokens:r[18].tokens,renderers:r[5]}}),{c(){V(e.$$.fragment),t=C();},m(i,o){x(e,i,o),k(i,t,o),n=!0;},p(i,o){const s={};o&64&&(s.tokens=i[18].tokens),o&32&&(s.renderers=i[5]),e.$set(s);},i(i){n||(T(e.$$.fragment,i),n=!0);},o(i){M(e.$$.fragment,i),n=!1;},d(i){i&&A(t),Z(e,i);}}}c(J5,"create_default_slot_8");function LC(r){let e,t,n;const i=[r[18]];var o=r[5].orderedlistitem||r[5].listitem;function s(a,l){let u={$$slots:{default:[J5]},$$scope:{ctx:a}};for(let d=0;d<i.length;d+=1)u=St(u,i[d]);return l!==void 0&&l&64&&(u=St(u,Rt(i,[Lt(a[18])]))),{props:u}}return c(s,"switch_props"),o&&(e=qe(o,s(r))),{c(){e&&V(e.$$.fragment),t=je();},m(a,l){e&&x(e,a,l),k(a,t,l),n=!0;},p(a,l){if(l&32&&o!==(o=a[5].orderedlistitem||a[5].listitem)){if(e){fe();const u=e;M(u.$$.fragment,1,0,()=>{Z(u,1);}),pe();}o?(e=qe(o,s(a,l)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(o){const u=l&64?Rt(i,[Lt(a[18])]):{};l&8388704&&(u.$$scope={dirty:l,ctx:a}),e.$set(u);}},i(a){n||(e&&T(e.$$.fragment,a),n=!0);},o(a){e&&M(e.$$.fragment,a),n=!1;},d(a){a&&A(t),e&&Z(e,a);}}}c(LC,"create_each_block_4$1");function F5(r){let e,t,n=te(r[6].items),i=[];for(let s=0;s<n.length;s+=1)i[s]=LC(IC(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){for(let s=0;s<i.length;s+=1)i[s].c();e=je();},m(s,a){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,a);k(s,e,a),t=!0;},p(s,a){if(a&96){n=te(s[6].items);let l;for(l=0;l<n.length;l+=1){const u=IC(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=LC(u),i[l].c(),T(i[l],1),i[l].m(e.parentNode,e));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(F5,"create_default_slot_7");function W5(r){let e,t,n;return e=new Po({props:{tokens:r[16].tokens,renderers:r[5]}}),{c(){V(e.$$.fragment),t=C();},m(i,o){x(e,i,o),k(i,t,o),n=!0;},p(i,o){const s={};o&4&&(s.tokens=i[16].tokens),o&32&&(s.renderers=i[5]),e.$set(s);},i(i){n||(T(e.$$.fragment,i),n=!0);},o(i){M(e.$$.fragment,i),n=!1;},d(i){i&&A(t),Z(e,i);}}}c(W5,"create_default_slot_6");function PC(r){let e,t,n;var i=r[5].tablecell;function o(s,a){return {props:{header:!0,align:s[6].align[s[15]]||"center",$$slots:{default:[W5]},$$scope:{ctx:s}}}}return c(o,"switch_props"),i&&(e=qe(i,o(r))),{c(){e&&V(e.$$.fragment),t=je();},m(s,a){e&&x(e,s,a),k(s,t,a),n=!0;},p(s,a){if(a&32&&i!==(i=s[5].tablecell)){if(e){fe();const l=e;M(l.$$.fragment,1,0,()=>{Z(l,1);}),pe();}i?(e=qe(i,o(s)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(i){const l={};a&64&&(l.align=s[6].align[s[15]]||"center"),a&8388644&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);}},i(s){n||(e&&T(e.$$.fragment,s),n=!0);},o(s){e&&M(e.$$.fragment,s),n=!1;},d(s){s&&A(t),e&&Z(e,s);}}}c(PC,"create_each_block_3$2");function H5(r){let e,t,n=te(r[2]),i=[];for(let s=0;s<n.length;s+=1)i[s]=PC(EC(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){for(let s=0;s<i.length;s+=1)i[s].c();e=je();},m(s,a){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,a);k(s,e,a),t=!0;},p(s,a){if(a&100){n=te(s[2]);let l;for(l=0;l<n.length;l+=1){const u=EC(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=PC(u),i[l].c(),T(i[l],1),i[l].m(e.parentNode,e));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(H5,"create_default_slot_5");function Q5(r){let e,t,n;var i=r[5].tablerow;function o(s,a){return {props:{$$slots:{default:[H5]},$$scope:{ctx:s}}}}return c(o,"switch_props"),i&&(e=qe(i,o(r))),{c(){e&&V(e.$$.fragment),t=je();},m(s,a){e&&x(e,s,a),k(s,t,a),n=!0;},p(s,a){if(a&32&&i!==(i=s[5].tablerow)){if(e){fe();const l=e;M(l.$$.fragment,1,0,()=>{Z(l,1);}),pe();}i?(e=qe(i,o(s)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(i){const l={};a&8388708&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);}},i(s){n||(e&&T(e.$$.fragment,s),n=!0);},o(s){e&&M(e.$$.fragment,s),n=!1;},d(s){s&&A(t),e&&Z(e,s);}}}c(Q5,"create_default_slot_4");function X5(r){let e,t;return e=new Po({props:{tokens:r[13].tokens,renderers:r[5]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&8&&(o.tokens=n[13].tokens),i&32&&(o.renderers=n[5]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(X5,"create_default_slot_3");function NC(r){let e,t,n;var i=r[5].tablecell;function o(s,a){return {props:{header:!1,align:s[6].align[s[15]]||"center",$$slots:{default:[X5]},$$scope:{ctx:s}}}}return c(o,"switch_props"),i&&(e=qe(i,o(r))),{c(){e&&V(e.$$.fragment),t=je();},m(s,a){e&&x(e,s,a),k(s,t,a),n=!0;},p(s,a){if(a&32&&i!==(i=s[5].tablecell)){if(e){fe();const l=e;M(l.$$.fragment,1,0,()=>{Z(l,1);}),pe();}i?(e=qe(i,o(s)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(i){const l={};a&64&&(l.align=s[6].align[s[15]]||"center"),a&8388648&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);}},i(s){n||(e&&T(e.$$.fragment,s),n=!0);},o(s){e&&M(e.$$.fragment,s),n=!1;},d(s){s&&A(t),e&&Z(e,s);}}}c(NC,"create_each_block_2$4");function q5(r){let e,t,n=te(r[10]),i=[];for(let s=0;s<n.length;s+=1)i[s]=NC(DC(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){for(let s=0;s<i.length;s+=1)i[s].c();e=C();},m(s,a){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,a);k(s,e,a),t=!0;},p(s,a){if(a&104){n=te(s[10]);let l;for(l=0;l<n.length;l+=1){const u=DC(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=NC(u),i[l].c(),T(i[l],1),i[l].m(e.parentNode,e));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(q5,"create_default_slot_2");function OC(r){let e,t,n;var i=r[5].tablerow;function o(s,a){return {props:{$$slots:{default:[q5]},$$scope:{ctx:s}}}}return c(o,"switch_props"),i&&(e=qe(i,o(r))),{c(){e&&V(e.$$.fragment),t=je();},m(s,a){e&&x(e,s,a),k(s,t,a),n=!0;},p(s,a){if(a&32&&i!==(i=s[5].tablerow)){if(e){fe();const l=e;M(l.$$.fragment,1,0,()=>{Z(l,1);}),pe();}i?(e=qe(i,o(s)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(i){const l={};a&8388712&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);}},i(s){n||(e&&T(e.$$.fragment,s),n=!0);},o(s){e&&M(e.$$.fragment,s),n=!1;},d(s){s&&A(t),e&&Z(e,s);}}}c(OC,"create_each_block_1$8");function K5(r){let e,t,n=te(r[3]),i=[];for(let s=0;s<n.length;s+=1)i[s]=OC(TC(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){for(let s=0;s<i.length;s+=1)i[s].c();e=je();},m(s,a){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,a);k(s,e,a),t=!0;},p(s,a){if(a&104){n=te(s[3]);let l;for(l=0;l<n.length;l+=1){const u=TC(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=OC(u),i[l].c(),T(i[l],1),i[l].m(e.parentNode,e));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(K5,"create_default_slot_1");function eY(r){let e,t,n,i,o;var s=r[5].tablehead;function a(d,h){return {props:{$$slots:{default:[Q5]},$$scope:{ctx:d}}}}c(a,"switch_props"),s&&(e=qe(s,a(r)));var l=r[5].tablebody;function u(d,h){return {props:{$$slots:{default:[K5]},$$scope:{ctx:d}}}}return c(u,"switch_props_1"),l&&(n=qe(l,u(r))),{c(){e&&V(e.$$.fragment),t=C(),n&&V(n.$$.fragment),i=je();},m(d,h){e&&x(e,d,h),k(d,t,h),n&&x(n,d,h),k(d,i,h),o=!0;},p(d,h){if(h&32&&s!==(s=d[5].tablehead)){if(e){fe();const p=e;M(p.$$.fragment,1,0,()=>{Z(p,1);}),pe();}s?(e=qe(s,a(d)),V(e.$$.fragment),T(e.$$.fragment,1),x(e,t.parentNode,t)):e=null;}else if(s){const p={};h&8388708&&(p.$$scope={dirty:h,ctx:d}),e.$set(p);}if(h&32&&l!==(l=d[5].tablebody)){if(n){fe();const p=n;M(p.$$.fragment,1,0,()=>{Z(p,1);}),pe();}l?(n=qe(l,u(d)),V(n.$$.fragment),T(n.$$.fragment,1),x(n,i.parentNode,i)):n=null;}else if(l){const p={};h&8388712&&(p.$$scope={dirty:h,ctx:d}),n.$set(p);}},i(d){o||(e&&T(e.$$.fragment,d),n&&T(n.$$.fragment,d),o=!0);},o(d){e&&M(e.$$.fragment,d),n&&M(n.$$.fragment,d),o=!1;},d(d){d&&(A(t),A(i)),e&&Z(e,d),n&&Z(n,d);}}}c(eY,"create_default_slot");function jC(r){let e,t;const n=[r[7],{renderers:r[5]}];let i={};for(let o=0;o<n.length;o+=1)i=St(i,n[o]);return e=new Po({props:i}),{c(){V(e.$$.fragment);},m(o,s){x(e,o,s),t=!0;},p(o,s){const a=s&34?Rt(n,[s&2&&Lt(o[7]),s&32&&{renderers:o[5]}]):{};e.$set(a);},i(o){t||(T(e.$$.fragment,o),t=!0);},o(o){M(e.$$.fragment,o),t=!1;},d(o){Z(e,o);}}}c(jC,"create_each_block$m");function tY(r){let e,t,n,i;const o=[O5,N5],s=[];function a(l,u){return l[0]?l[5][l[0]]?1:-1:0}return c(a,"select_block_type"),~(e=a(r))&&(t=s[e]=o[e](r)),{c(){t&&t.c(),n=je();},m(l,u){~e&&s[e].m(l,u),k(l,n,u),i=!0;},p(l,[u]){let d=e;e=a(l),e===d?~e&&s[e].p(l,u):(t&&(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe()),~e?(t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n)):t=null);},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),~e&&s[e].d(l);}}}c(tY,"create_fragment$$");function nY(r,e,t){const n=["type","tokens","header","rows","ordered","renderers"];let i=eA(e,n),{type:o=void 0}=e,{tokens:s=void 0}=e,{header:a=void 0}=e,{rows:l=void 0}=e,{ordered:u=!1}=e,{renderers:d}=e;return P5(),r.$$set=h=>{e=St(St({},e),kR(h)),t(6,i=eA(e,n)),"type"in h&&t(0,o=h.type),"tokens"in h&&t(1,s=h.tokens),"header"in h&&t(2,a=h.header),"rows"in h&&t(3,l=h.rows),"ordered"in h&&t(4,u=h.ordered),"renderers"in h&&t(5,d=h.renderers);},[o,s,a,l,u,d,i]}c(nY,"instance$X");var Ga;let Po=(Ga=class extends se{constructor(e){super(),le(this,e,nY,tY,re,{type:0,tokens:1,header:2,rows:3,ordered:4,renderers:5});}},c(Ga,"Parser"),Ga);function Ab(){return {async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}c(Ab,"getDefaults");let Ur=Ab();function IE(r){Ur=r;}c(IE,"changeDefaults");const TE=/[&<>"']/,iY=new RegExp(TE.source,"g"),DE=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,rY=new RegExp(DE.source,"g"),oY={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},GC=c(r=>oY[r],"getEscapeReplacement");function yn(r,e){if(e){if(TE.test(r))return r.replace(iY,GC)}else if(DE.test(r))return r.replace(rY,GC);return r}c(yn,"escape");const sY=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function EE(r){return r.replace(sY,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}c(EE,"unescape");const aY=/(^|[^\[])\^/g;function pt(r,e){r=typeof r=="string"?r:r.source,e=e||"";const t={replace:c((n,i)=>(i=i.source||i,i=i.replace(aY,"$1"),r=r.replace(n,i),t),"replace"),getRegex:c(()=>new RegExp(r,e),"getRegex")};return t}c(pt,"edit");const lY=/[^\w:]/g,cY=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function $C(r,e,t){if(r){let n;try{n=decodeURIComponent(EE(t)).replace(lY,"").toLowerCase();}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}e&&!cY.test(t)&&(t=fY(e,t));try{t=encodeURI(t).replace(/%25/g,"%");}catch{return null}return t}c($C,"cleanUrl");const Ku={},uY=/^[^:]+:\/*[^/]*$/,dY=/^([^:]+:)[\s\S]*$/,hY=/^([^:]+:\/*[^/]*)[\s\S]*$/;function fY(r,e){Ku[" "+r]||(uY.test(r)?Ku[" "+r]=r+"/":Ku[" "+r]=rd(r,"/",!0)),r=Ku[" "+r];const t=r.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:r.replace(dY,"$1")+e:e.charAt(0)==="/"?t?e:r.replace(hY,"$1")+e:r+e}c(fY,"resolveUrl");const eh={exec:c(function(){},"noopTest")};function YC(r,e){const t=r.replace(/\|/g,(o,s,a)=>{let l=!1,u=s;for(;--u>=0&&a[u]==="\\";)l=!l;return l?"|":" |"}),n=t.split(/ \|/);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}c(YC,"splitCells");function rd(r,e,t){const n=r.length;if(n===0)return "";let i=0;for(;i<n;){const o=r.charAt(n-i-1);if(o===e&&!t)i++;else if(o!==e&&t)i++;else break}return r.slice(0,n-i)}c(rd,"rtrim");function pY(r,e){if(r.indexOf(e[1])===-1)return -1;const t=r.length;let n=0,i=0;for(;i<t;i++)if(r[i]==="\\")i++;else if(r[i]===e[0])n++;else if(r[i]===e[1]&&(n--,n<0))return i;return -1}c(pY,"findClosingBracket");function mY(r,e){!r||r.silent||(e&&console.warn("marked(): callback is deprecated since version 5.0.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/using_pro#async"),(r.sanitize||r.sanitizer)&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options"),(r.highlight||r.langPrefix!=="language-")&&console.warn("marked(): highlight and langPrefix parameters are deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-highlight."),r.mangle&&console.warn("marked(): mangle parameter is enabled by default, but is deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install https://www.npmjs.com/package/marked-mangle, or disable by setting `{mangle: false}`."),r.baseUrl&&console.warn("marked(): baseUrl parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-base-url."),r.smartypants&&console.warn("marked(): smartypants parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-smartypants."),r.xhtml&&console.warn("marked(): xhtml parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-xhtml."),(r.headerIds||r.headerPrefix)&&console.warn("marked(): headerIds and headerPrefix parameters enabled by default, but are deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install  https://www.npmjs.com/package/marked-gfm-heading-id, or disable by setting `{headerIds: false}`."));}c(mY,"checkDeprecations");function zC(r,e,t,n){const i=e.href,o=e.title?yn(e.title):null,s=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;const a={type:"link",raw:t,href:i,title:o,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,a}return {type:"image",raw:t,href:i,title:o,text:yn(s)}}c(zC,"outputLink");function gY(r,e){const t=r.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(i=>{const o=i.match(/^\s+/);if(o===null)return i;const[s]=o;return s.length>=n.length?i.slice(n.length):i}).join(`
`)}c(gY,"indentCodeCompensation");const Aw=class Aw{constructor(e){this.options=e||Ur;}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return {type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return {type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:rd(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],i=gY(n,t[3]||"");return {type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const i=rd(n,"#");(this.options.pedantic||!i||/ $/.test(i))&&(n=i.trim());}return {type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return {type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=t[0].replace(/^ *>[ \t]?/gm,""),i=this.lexer.state.top;this.lexer.state.top=!0;const o=this.lexer.blockTokens(n);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:o,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,i,o,s,a,l,u,d,h,p,m,b,y=t[1].trim();const w=y.length>1,I={type:"list",raw:"",ordered:w,start:w?+y.slice(0,-1):"",loose:!1,items:[]};y=w?`\\d{1,9}\\${y.slice(-1)}`:`\\${y}`,this.options.pedantic&&(y=w?y:"[*+-]");const S=new RegExp(`^( {0,3}${y})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(b=!1,!(!(t=S.exec(e))||this.rules.block.hr.test(e)));){if(n=t[0],e=e.substring(n.length),d=t[2].split(`
`,1)[0].replace(/^\t+/,E=>" ".repeat(3*E.length)),h=e.split(`
`,1)[0],this.options.pedantic?(s=2,m=d.trimLeft()):(s=t[2].search(/[^ ]/),s=s>4?1:s,m=d.slice(s),s+=t[1].length),l=!1,!d&&/^ *$/.test(h)&&(n+=h+`
`,e=e.substring(h.length+1),b=!0),!b){const E=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),P=new RegExp(`^ {0,${Math.min(3,s-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),L=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:\`\`\`|~~~)`),O=new RegExp(`^ {0,${Math.min(3,s-1)}}#`);for(;e&&(p=e.split(`
`,1)[0],h=p,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(L.test(h)||O.test(h)||E.test(h)||P.test(e)));){if(h.search(/[^ ]/)>=s||!h.trim())m+=`
`+h.slice(s);else {if(l||d.search(/[^ ]/)>=4||L.test(d)||O.test(d)||P.test(d))break;m+=`
`+h;}!l&&!h.trim()&&(l=!0),n+=p+`
`,e=e.substring(p.length+1),d=h.slice(s);}}I.loose||(u?I.loose=!0:/\n *\n *$/.test(n)&&(u=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(m),i&&(o=i[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),I.items.push({type:"list_item",raw:n,task:!!i,checked:o,loose:!1,text:m}),I.raw+=n;}I.items[I.items.length-1].raw=n.trimRight(),I.items[I.items.length-1].text=m.trimRight(),I.raw=I.raw.trimRight();const R=I.items.length;for(a=0;a<R;a++)if(this.lexer.state.top=!1,I.items[a].tokens=this.lexer.blockTokens(I.items[a].text,[]),!I.loose){const E=I.items[a].tokens.filter(L=>L.type==="space"),P=E.length>0&&E.some(L=>/\n.*\n/.test(L.raw));I.loose=P;}if(I.loose)for(a=0;a<R;a++)I.items[a].loose=!0;return I}}html(e){const t=this.rules.block.html.exec(e);if(t){const n={type:"html",block:!0,raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};if(this.options.sanitize){const i=this.options.sanitizer?this.options.sanitizer(t[0]):yn(t[0]);n.type="paragraph",n.text=i,n.tokens=this.lexer.inline(i);}return n}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return {type:"def",tag:n,raw:t[0],href:i,title:o}}}table(e){const t=this.rules.block.table.exec(e);if(t){const n={type:"table",header:YC(t[1]).map(i=>({text:i})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=t[0];let i=n.align.length,o,s,a,l;for(o=0;o<i;o++)/^ *-+: *$/.test(n.align[o])?n.align[o]="right":/^ *:-+: *$/.test(n.align[o])?n.align[o]="center":/^ *:-+ *$/.test(n.align[o])?n.align[o]="left":n.align[o]=null;for(i=n.rows.length,o=0;o<i;o++)n.rows[o]=YC(n.rows[o],n.header.length).map(u=>({text:u}));for(i=n.header.length,s=0;s<i;s++)n.header[s].tokens=this.lexer.inline(n.header[s].text);for(i=n.rows.length,s=0;s<i;s++)for(l=n.rows[s],a=0;a<l.length;a++)l[a].tokens=this.lexer.inline(l[a].text);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return {type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return {type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return {type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return {type:"escape",raw:t[0],text:yn(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return !this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):yn(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const s=rd(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else {const s=pY(t[2],"()");if(s>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,l).trim(),t[3]="";}}let i=t[2],o="";if(this.options.pedantic){const s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);s&&(i=s[1],o=s[3]);}else o=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(n)?i=i.slice(1):i=i.slice(1,-1)),zC(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i){const o=n[0].charAt(0);return {type:"text",raw:o,text:o}}return zC(n,i,n[0],this.lexer)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=i[0].length-1;let a,l,u=s,d=0;const h=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+s);(i=h.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=a.length,i[3]||i[4]){u+=l;continue}else if((i[5]||i[6])&&s%3&&!((s+l)%3)){d+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+d);const p=e.slice(0,s+i.index+l+1);if(Math.min(s,l)%2){const b=p.slice(1,-1);return {type:"em",raw:p,text:b,tokens:this.lexer.inlineTokens(b)}}const m=p.slice(2,-2);return {type:"strong",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const i=/[^ ]/.test(n),o=/^ /.test(n)&&/ $/.test(n);return i&&o&&(n=n.substring(1,n.length-1)),n=yn(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return {type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return {type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let i,o;return n[2]==="@"?(i=yn(this.options.mangle?t(n[1]):n[1]),o="mailto:"+i):(i=yn(n[1]),o=i),{type:"link",raw:n[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let i,o;if(n[2]==="@")i=yn(this.options.mangle?t(n[0]):n[0]),o="mailto:"+i;else {let s;do s=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(s!==n[0]);i=yn(n[0]),n[1]==="www."?o="http://"+n[0]:o=n[0];}return {type:"link",raw:n[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let i;return this.lexer.state.inRawBlock?i=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):yn(n[0]):n[0]:i=yn(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:i}}}};c(Aw,"Tokenizer");let wl=Aw;const ze={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:eh,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};ze._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;ze._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;ze.def=pt(ze.def).replace("label",ze._label).replace("title",ze._title).getRegex();ze.bullet=/(?:[*+-]|\d{1,9}[.)])/;ze.listItemStart=pt(/^( *)(bull) */).replace("bull",ze.bullet).getRegex();ze.list=pt(ze.list).replace(/bull/g,ze.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ze.def.source+")").getRegex();ze._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";ze._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;ze.html=pt(ze.html,"i").replace("comment",ze._comment).replace("tag",ze._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();ze.lheading=pt(ze.lheading).replace(/bull/g,ze.bullet).getRegex();ze.paragraph=pt(ze._paragraph).replace("hr",ze.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ze._tag).getRegex();ze.blockquote=pt(ze.blockquote).replace("paragraph",ze.paragraph).getRegex();ze.normal={...ze};ze.gfm={...ze.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};ze.gfm.table=pt(ze.gfm.table).replace("hr",ze.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ze._tag).getRegex();ze.gfm.paragraph=pt(ze._paragraph).replace("hr",ze.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",ze.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ze._tag).getRegex();ze.pedantic={...ze.normal,html:pt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ze._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:eh,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:pt(ze.normal._paragraph).replace("hr",ze.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ze.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const Ce={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:eh,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:eh,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};Ce._punctuation="\\p{P}$+<=>`^|~";Ce.punctuation=pt(Ce.punctuation,"u").replace(/punctuation/g,Ce._punctuation).getRegex();Ce.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;Ce.anyPunctuation=/\\[punct]/g;Ce._escapes=/\\([punct])/g;Ce._comment=pt(ze._comment).replace("(?:-->|$)","-->").getRegex();Ce.emStrong.lDelim=pt(Ce.emStrong.lDelim,"u").replace(/punct/g,Ce._punctuation).getRegex();Ce.emStrong.rDelimAst=pt(Ce.emStrong.rDelimAst,"gu").replace(/punct/g,Ce._punctuation).getRegex();Ce.emStrong.rDelimUnd=pt(Ce.emStrong.rDelimUnd,"gu").replace(/punct/g,Ce._punctuation).getRegex();Ce.anyPunctuation=pt(Ce.anyPunctuation,"gu").replace(/punct/g,Ce._punctuation).getRegex();Ce._escapes=pt(Ce._escapes,"gu").replace(/punct/g,Ce._punctuation).getRegex();Ce._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;Ce._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;Ce.autolink=pt(Ce.autolink).replace("scheme",Ce._scheme).replace("email",Ce._email).getRegex();Ce._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;Ce.tag=pt(Ce.tag).replace("comment",Ce._comment).replace("attribute",Ce._attribute).getRegex();Ce._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;Ce._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;Ce._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;Ce.link=pt(Ce.link).replace("label",Ce._label).replace("href",Ce._href).replace("title",Ce._title).getRegex();Ce.reflink=pt(Ce.reflink).replace("label",Ce._label).replace("ref",ze._label).getRegex();Ce.nolink=pt(Ce.nolink).replace("ref",ze._label).getRegex();Ce.reflinkSearch=pt(Ce.reflinkSearch,"g").replace("reflink",Ce.reflink).replace("nolink",Ce.nolink).getRegex();Ce.normal={...Ce};Ce.pedantic={...Ce.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:pt(/^!?\[(label)\]\((.*?)\)/).replace("label",Ce._label).getRegex(),reflink:pt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ce._label).getRegex()};Ce.gfm={...Ce.normal,escape:pt(Ce.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};Ce.gfm.url=pt(Ce.gfm.url,"i").replace("email",Ce.gfm._extended_email).getRegex();Ce.breaks={...Ce.gfm,br:pt(Ce.br).replace("{2,}","*").getRegex(),text:pt(Ce.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function bY(r){return r.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}c(bY,"smartypants");function UC(r){let e="",t,n;const i=r.length;for(t=0;t<i;t++)n=r.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}c(UC,"mangle");const pc=class pc{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ur,this.options.tokenizer=this.options.tokenizer||new wl,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:ze.normal,inline:Ce.normal};this.options.pedantic?(t.block=ze.pedantic,t.inline=Ce.pedantic):this.options.gfm&&(t.block=ze.gfm,this.options.breaks?t.inline=Ce.breaks:t.inline=Ce.gfm),this.tokenizer.rules=t;}static get rules(){return {block:ze,inline:Ce}}static lex(e,t){return new pc(t).lex(e)}static lexInline(e,t){return new pc(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,u)=>l+"    ".repeat(u.length));let n,i,o,s;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let u;this.options.extensions.startBlock.forEach(function(d){u=d.call({lexer:this},l),typeof u=="number"&&u>=0&&(a=Math.min(a,u));}),a<1/0&&a>=0&&(o=e.substring(0,a+1));}if(this.state.top&&(n=this.tokenizer.paragraph(o))){i=t[t.length-1],s&&i.type==="paragraph"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),s=o.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,i,o,s=e,a,l,u;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)d.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex));}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,a.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(u=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(d=>(n=d.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,s,u)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,UC)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,UC))){e=e.substring(n.raw.length),t.push(n);continue}if(o=e,this.options.extensions&&this.options.extensions.startInline){let d=1/0;const h=e.slice(1);let p;this.options.extensions.startInline.forEach(function(m){p=m.call({lexer:this},h),typeof p=="number"&&p>=0&&(d=Math.min(d,p));}),d<1/0&&d>=0&&(o=e.substring(0,d+1));}if(n=this.tokenizer.inlineText(o,bY)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(u=n.raw.slice(-1)),l=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}};c(pc,"Lexer");let Ni=pc;const kw=class kw{constructor(e){this.options=e||Ur;}code(e,t,n){const i=(t||"").match(/\S*/)[0];if(this.options.highlight){const o=this.options.highlight(e,i);o!=null&&o!==e&&(n=!0,e=o);}return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="'+this.options.langPrefix+yn(i)+'">'+(n?e:yn(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:yn(e,!0))+`</code></pre>
`}blockquote(e){return `<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,n,i){if(this.options.headerIds){const o=this.options.headerPrefix+i.slug(n);return `<h${t} id="${o}">${e}</h${t}>
`}return `<h${t}>${e}</h${t}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,n){const i=t?"ol":"ul",o=t&&n!==1?' start="'+n+'"':"";return "<"+i+o+`>
`+e+"</"+i+`>
`}listitem(e){return `<li>${e}</li>
`}checkbox(e){return "<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return `<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return `<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return (t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return `<strong>${e}</strong>`}em(e){return `<em>${e}</em>`}codespan(e){return `<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return `<del>${e}</del>`}link(e,t,n){if(e=$C(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>",i}image(e,t,n){if(e=$C(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${t}"`),i+=this.options.xhtml?"/>":">",i}text(e){return e}};c(kw,"Renderer");let Sl=kw;const Cw=class Cw{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return ""+n}image(e,t,n){return ""+n}br(){return ""}};c(Cw,"TextRenderer");let gu=Cw;const Iw=class Iw{constructor(){this.seen={};}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do i++,n=e+"-"+i;while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}};c(Iw,"Slugger");let Al=Iw;const mc=class mc{constructor(e){this.options=e||Ur,this.options.renderer=this.options.renderer||new Sl,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new gu,this.slugger=new Al;}static parse(e,t){return new mc(t).parse(e)}static parseInline(e,t){return new mc(t).parseInline(e)}parse(e,t=!0){let n="",i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L;const O=e.length;for(i=0;i<O;i++){if(m=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[m.type]&&(L=this.options.extensions.renderers[m.type].call({parser:this},m),L!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type))){n+=L||"";continue}switch(m.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(m.tokens),m.depth,EE(this.parseInline(m.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(m.text,m.lang,m.escaped);continue}case"table":{for(h="",d="",a=m.header.length,o=0;o<a;o++)d+=this.renderer.tablecell(this.parseInline(m.header[o].tokens),{header:!0,align:m.align[o]});for(h+=this.renderer.tablerow(d),p="",a=m.rows.length,o=0;o<a;o++){for(u=m.rows[o],d="",l=u.length,s=0;s<l;s++)d+=this.renderer.tablecell(this.parseInline(u[s].tokens),{header:!1,align:m.align[s]});p+=this.renderer.tablerow(d);}n+=this.renderer.table(h,p);continue}case"blockquote":{p=this.parse(m.tokens),n+=this.renderer.blockquote(p);continue}case"list":{for(b=m.ordered,y=m.start,w=m.loose,a=m.items.length,p="",o=0;o<a;o++)S=m.items[o],R=S.checked,E=S.task,I="",S.task&&(P=this.renderer.checkbox(R),w?S.tokens.length>0&&S.tokens[0].type==="paragraph"?(S.tokens[0].text=P+" "+S.tokens[0].text,S.tokens[0].tokens&&S.tokens[0].tokens.length>0&&S.tokens[0].tokens[0].type==="text"&&(S.tokens[0].tokens[0].text=P+" "+S.tokens[0].tokens[0].text)):S.tokens.unshift({type:"text",text:P}):I+=P),I+=this.parse(S.tokens,w),p+=this.renderer.listitem(I,E,R);n+=this.renderer.list(p,b,y);continue}case"html":{n+=this.renderer.html(m.text,m.block);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(m.tokens));continue}case"text":{for(p=m.tokens?this.parseInline(m.tokens):m.text;i+1<O&&e[i+1].type==="text";)m=e[++i],p+=`
`+(m.tokens?this.parseInline(m.tokens):m.text);n+=t?this.renderer.paragraph(p):p;continue}default:{const z='Token with "'+m.type+'" type was not found.';if(this.options.silent){console.error(z);return}else throw new Error(z)}}}return n}parseInline(e,t){t=t||this.renderer;let n="",i,o,s;const a=e.length;for(i=0;i<a;i++){if(o=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]&&(s=this.options.extensions.renderers[o.type].call({parser:this},o),s!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type))){n+=s||"";continue}switch(o.type){case"escape":{n+=t.text(o.text);break}case"html":{n+=t.html(o.text);break}case"link":{n+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{n+=t.image(o.href,o.title,o.text);break}case"strong":{n+=t.strong(this.parseInline(o.tokens,t));break}case"em":{n+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{n+=t.codespan(o.text);break}case"br":{n+=t.br();break}case"del":{n+=t.del(this.parseInline(o.tokens,t));break}case"text":{n+=t.text(o.text);break}default:{const l='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return n}};c(mc,"Parser");let or=mc;const hh=class hh{constructor(e){this.options=e||Ur;}preprocess(e){return e}postprocess(e){return e}};c(hh,"Hooks"),f(hh,"passThroughHooks",new Set(["preprocess","postprocess"]));let as=hh;var Ao,Rm,ME;const Tw=class Tw{constructor(...e){zS(this,Ao);f(this,"defaults",Ab());f(this,"options",this.setOptions);f(this,"parse",Fu(this,Ao,Rm).call(this,Ni.lex,or.parse));f(this,"parseInline",Fu(this,Ao,Rm).call(this,Ni.lexInline,or.parseInline));f(this,"Parser",or);f(this,"parser",or.parse);f(this,"Renderer",Sl);f(this,"TextRenderer",gu);f(this,"Lexer",Ni);f(this,"lexer",Ni.lex);f(this,"Tokenizer",wl);f(this,"Slugger",Al);f(this,"Hooks",as);this.use(...e);}walkTokens(e,t){let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{for(const o of i.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of i.rows)for(const s of o)n=n.concat(this.walkTokens(s.tokens,t));break}case"list":{n=n.concat(this.walkTokens(i.items,t));break}default:this.defaults.extensions&&this.defaults.extensions.childTokens&&this.defaults.extensions.childTokens[i.type]?this.defaults.extensions.childTokens[i.type].forEach(o=>{n=n.concat(this.walkTokens(i[o],t));}):i.tokens&&(n=n.concat(this.walkTokens(i.tokens,t)));}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if(o.renderer){const s=t.renderers[o.name];s?t.renderers[o.name]=function(...a){let l=o.renderer.apply(this,a);return l===!1&&(l=s.apply(this,a)),l}:t.renderers[o.name]=o.renderer;}if(o.tokenizer){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[o.level]?t[o.level].unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]));}o.childTokens&&(t.childTokens[o.name]=o.childTokens);}),i.extensions=t),n.renderer){const o=this.defaults.renderer||new Sl(this.defaults);for(const s in n.renderer){const a=o[s];o[s]=(...l)=>{let u=n.renderer[s].apply(o,l);return u===!1&&(u=a.apply(o,l)),u};}i.renderer=o;}if(n.tokenizer){const o=this.defaults.tokenizer||new wl(this.defaults);for(const s in n.tokenizer){const a=o[s];o[s]=(...l)=>{let u=n.tokenizer[s].apply(o,l);return u===!1&&(u=a.apply(o,l)),u};}i.tokenizer=o;}if(n.hooks){const o=this.defaults.hooks||new as;for(const s in n.hooks){const a=o[s];as.passThroughHooks.has(s)?o[s]=l=>{if(this.defaults.async)return Promise.resolve(n.hooks[s].call(o,l)).then(d=>a.call(o,d));const u=n.hooks[s].call(o,l);return a.call(o,u)}:o[s]=(...l)=>{let u=n.hooks[s].apply(o,l);return u===!1&&(u=a.apply(o,l)),u};}i.hooks=o;}if(n.walkTokens){const o=this.defaults.walkTokens;i.walkTokens=function(s){let a=[];return a.push(n.walkTokens.call(this,s)),o&&(a=a.concat(o.call(this,s))),a};}this.defaults={...this.defaults,...i};}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}};Ao=new WeakSet,Rm=c(function(e,t){return (n,i,o)=>{typeof i=="function"&&(o=i,i=null);const s={...i};i={...this.defaults,...s};const a=Fu(this,Ao,ME).call(this,i.silent,i.async,o);if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(mY(i,o),i.hooks&&(i.hooks.options=i),o){const l=i.highlight;let u;try{i.hooks&&(n=i.hooks.preprocess(n)),u=e(n,i);}catch(p){return a(p)}const d=c(p=>{let m;if(!p)try{i.walkTokens&&this.walkTokens(u,i.walkTokens),m=t(u,i),i.hooks&&(m=i.hooks.postprocess(m));}catch(b){p=b;}return i.highlight=l,p?a(p):o(null,m)},"done");if(!l||l.length<3||(delete i.highlight,!u.length))return d();let h=0;this.walkTokens(u,p=>{p.type==="code"&&(h++,setTimeout(()=>{l(p.text,p.lang,(m,b)=>{if(m)return d(m);b!=null&&b!==p.text&&(p.text=b,p.escaped=!0),h--,h===0&&d();});},0));}),h===0&&d();return}if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(l=>e(l,i)).then(l=>i.walkTokens?Promise.all(this.walkTokens(l,i.walkTokens)).then(()=>l):l).then(l=>t(l,i)).then(l=>i.hooks?i.hooks.postprocess(l):l).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));const l=e(n,i);i.walkTokens&&this.walkTokens(l,i.walkTokens);let u=t(l,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(l){return a(l)}}},"#parseMarkdown"),ME=c(function(e,t,n){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const o="<p>An error occurred:</p><pre>"+yn(i.message+"",!0)+"</pre>";if(t)return Promise.resolve(o);if(n){n(null,o);return}return o}if(t)return Promise.reject(i);if(n){n(i);return}throw i}},"#onError"),c(Tw,"Marked");let Mm=Tw;const vo=new Mm(Ur);function yt(r,e,t){return vo.parse(r,e,t)}c(yt,"marked");yt.options=yt.setOptions=function(r){return vo.setOptions(r),yt.defaults=vo.defaults,IE(yt.defaults),yt};yt.getDefaults=Ab;yt.defaults=Ur;yt.use=function(...r){return vo.use(...r),yt.defaults=vo.defaults,IE(yt.defaults),yt};yt.walkTokens=function(r,e){return vo.walkTokens(r,e)};yt.parseInline=vo.parseInline;yt.Parser=or;yt.parser=or.parse;yt.Renderer=Sl;yt.TextRenderer=gu;yt.Lexer=Ni;yt.lexer=Ni.lex;yt.Tokenizer=wl;yt.Slugger=Al;yt.Hooks=as;yt.parse=yt;yt.options;yt.setOptions;yt.use;yt.walkTokens;yt.parseInline;or.parse;Ni.lex;const RE={};function vY(r){let e;return {c(){e=G(r[1]);},m(t,n){k(t,e,n);},p(t,n){n&2&&K(e,t[1]);},i:j,o:j,d(t){t&&A(e);}}}c(vY,"create_else_block$e");function _Y(r){let e,t;const n=r[5].default,i=Ut(n,r,r[4],null);return {c(){e=v("h6"),i&&i.c(),_(e,"id",r[2]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&16)&&xt(i,n,o,o[4],t?Bt(n,o[4],s,null):Zt(o[4]),null),(!t||s&4)&&_(e,"id",o[2]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(_Y,"create_if_block_5$1");function yY(r){let e,t;const n=r[5].default,i=Ut(n,r,r[4],null);return {c(){e=v("h5"),i&&i.c(),_(e,"id",r[2]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&16)&&xt(i,n,o,o[4],t?Bt(n,o[4],s,null):Zt(o[4]),null),(!t||s&4)&&_(e,"id",o[2]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(yY,"create_if_block_4$3");function wY(r){let e,t;const n=r[5].default,i=Ut(n,r,r[4],null);return {c(){e=v("h4"),i&&i.c(),_(e,"id",r[2]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&16)&&xt(i,n,o,o[4],t?Bt(n,o[4],s,null):Zt(o[4]),null),(!t||s&4)&&_(e,"id",o[2]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(wY,"create_if_block_3$3");function SY(r){let e,t;const n=r[5].default,i=Ut(n,r,r[4],null);return {c(){e=v("h3"),i&&i.c(),_(e,"id",r[2]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&16)&&xt(i,n,o,o[4],t?Bt(n,o[4],s,null):Zt(o[4]),null),(!t||s&4)&&_(e,"id",o[2]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(SY,"create_if_block_2$6");function AY(r){let e,t;const n=r[5].default,i=Ut(n,r,r[4],null);return {c(){e=v("h2"),i&&i.c(),_(e,"id",r[2]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&16)&&xt(i,n,o,o[4],t?Bt(n,o[4],s,null):Zt(o[4]),null),(!t||s&4)&&_(e,"id",o[2]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(AY,"create_if_block_1$8");function kY(r){let e,t;const n=r[5].default,i=Ut(n,r,r[4],null);return {c(){e=v("h1"),i&&i.c(),_(e,"id",r[2]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&16)&&xt(i,n,o,o[4],t?Bt(n,o[4],s,null):Zt(o[4]),null),(!t||s&4)&&_(e,"id",o[2]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(kY,"create_if_block$m");function CY(r){let e,t,n,i;const o=[kY,AY,SY,wY,yY,_Y,vY],s=[];function a(l,u){return l[0]===1?0:l[0]===2?1:l[0]===3?2:l[0]===4?3:l[0]===5?4:l[0]===6?5:6}return c(a,"select_block_type"),e=a(r),t=s[e]=o[e](r),{c(){t.c(),n=je();},m(l,u){s[e].m(l,u),k(l,n,u),i=!0;},p(l,[u]){let d=e;e=a(l),e===d?s[e].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n));},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),s[e].d(l);}}}c(CY,"create_fragment$_");function IY(r,e,t){let n,{$$slots:i={},$$scope:o}=e,{depth:s}=e,{raw:a}=e,{text:l}=e;const{slug:u,getOptions:d}=ER(RE),h=d();return r.$$set=p=>{"depth"in p&&t(0,s=p.depth),"raw"in p&&t(1,a=p.raw),"text"in p&&t(3,l=p.text),"$$scope"in p&&t(4,o=p.$$scope);},r.$$.update=()=>{r.$$.dirty&8&&t(2,n=h.headerIds?h.headerPrefix+u(l):void 0);},[s,a,n,l,o,i]}c(IY,"instance$W");const Dw=class Dw extends se{constructor(e){super(),le(this,e,IY,CY,re,{depth:0,raw:1,text:3});}};c(Dw,"Heading");let Lm=Dw;function TY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("p"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(TY,"create_fragment$Z");function DY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(DY,"instance$V");const Ew=class Ew extends se{constructor(e){super(),le(this,e,DY,TY,re,{});}};c(Ew,"Paragraph");let Pm=Ew;function EY(r){let e;const t=r[3].default,n=Ut(t,r,r[2],null);return {c(){n&&n.c();},m(i,o){n&&n.m(i,o),e=!0;},p(i,[o]){n&&n.p&&(!e||o&4)&&xt(n,t,i,i[2],e?Bt(t,i[2],o,null):Zt(i[2]),null);},i(i){e||(T(n,i),e=!0);},o(i){M(n,i),e=!1;},d(i){n&&n.d(i);}}}c(EY,"create_fragment$Y");function MY(r,e,t){let{$$slots:n={},$$scope:i}=e,{text:o}=e,{raw:s}=e;return r.$$set=a=>{"text"in a&&t(0,o=a.text),"raw"in a&&t(1,s=a.raw),"$$scope"in a&&t(2,i=a.$$scope);},[o,s,i,n]}c(MY,"instance$U");const Mw=class Mw extends se{constructor(e){super(),le(this,e,MY,EY,re,{text:0,raw:1});}};c(Mw,"Text");let Nm=Mw;function RY(r){let e,t;return {c(){e=v("img"),ht(e.src,t=r[0])||_(e,"src",t),_(e,"title",r[1]),_(e,"alt",r[2]);},m(n,i){k(n,e,i);},p(n,[i]){i&1&&!ht(e.src,t=n[0])&&_(e,"src",t),i&2&&_(e,"title",n[1]),i&4&&_(e,"alt",n[2]);},i:j,o:j,d(n){n&&A(e);}}}c(RY,"create_fragment$X");function LY(r,e,t){let{href:n=""}=e,{title:i=void 0}=e,{text:o=""}=e;return r.$$set=s=>{"href"in s&&t(0,n=s.href),"title"in s&&t(1,i=s.title),"text"in s&&t(2,o=s.text);},[n,i,o]}c(LY,"instance$T");var $a;let PY=($a=class extends se{constructor(e){super(),le(this,e,LY,RY,re,{href:0,title:1,text:2});}},c($a,"Image"),$a);function NY(r){let e,t;const n=r[3].default,i=Ut(n,r,r[2],null);return {c(){e=v("a"),i&&i.c(),_(e,"href",r[0]),_(e,"title",r[1]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&4)&&xt(i,n,o,o[2],t?Bt(n,o[2],s,null):Zt(o[2]),null),(!t||s&1)&&_(e,"href",o[0]),(!t||s&2)&&_(e,"title",o[1]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(NY,"create_fragment$W");function OY(r,e,t){let{$$slots:n={},$$scope:i}=e,{href:o=""}=e,{title:s=void 0}=e;return r.$$set=a=>{"href"in a&&t(0,o=a.href),"title"in a&&t(1,s=a.title),"$$scope"in a&&t(2,i=a.$$scope);},[o,s,i,n]}c(OY,"instance$S");const Rw=class Rw extends se{constructor(e){super(),le(this,e,OY,NY,re,{href:0,title:1});}};c(Rw,"Link");let Om=Rw;function jY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("em"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(jY,"create_fragment$V");function GY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(GY,"instance$R");const Lw=class Lw extends se{constructor(e){super(),le(this,e,GY,jY,re,{});}};c(Lw,"Em");let jm=Lw;function $Y(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("del"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c($Y,"create_fragment$U");function YY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(YY,"instance$Q");const Pw=class Pw extends se{constructor(e){super(),le(this,e,YY,$Y,re,{});}};c(Pw,"Del");let Gm=Pw;function zY(r){let e,t=r[0].replace(/`/g,"")+"",n;return {c(){e=v("code"),n=G(t);},m(i,o){k(i,e,o),g(e,n);},p(i,[o]){o&1&&t!==(t=i[0].replace(/`/g,"")+"")&&K(n,t);},i:j,o:j,d(i){i&&A(e);}}}c(zY,"create_fragment$T");function UY(r,e,t){let{raw:n}=e;return r.$$set=i=>{"raw"in i&&t(0,n=i.raw);},[n]}c(UY,"instance$P");const Nw=class Nw extends se{constructor(e){super(),le(this,e,UY,zY,re,{raw:0});}};c(Nw,"Codespan");let $m=Nw;function BY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("strong"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(BY,"create_fragment$S");function xY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(xY,"instance$O");const Ow=class Ow extends se{constructor(e){super(),le(this,e,xY,BY,re,{});}};c(Ow,"Strong");let Ym=Ow;function ZY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("table"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(ZY,"create_fragment$R");function VY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(VY,"instance$N");const jw=class jw extends se{constructor(e){super(),le(this,e,VY,ZY,re,{});}};c(jw,"Table");let zm=jw;function JY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("thead"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(JY,"create_fragment$Q");function FY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(FY,"instance$M");const Gw=class Gw extends se{constructor(e){super(),le(this,e,FY,JY,re,{});}};c(Gw,"TableHead");let Um=Gw;function WY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("tbody"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(WY,"create_fragment$P");function HY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(HY,"instance$L");const $w=class $w extends se{constructor(e){super(),le(this,e,HY,WY,re,{});}};c($w,"TableBody");let Bm=$w;function QY(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("tr"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(QY,"create_fragment$O");function XY(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(XY,"instance$K");const Yw=class Yw extends se{constructor(e){super(),le(this,e,XY,QY,re,{});}};c(Yw,"TableRow");let xm=Yw;function qY(r){let e,t;const n=r[3].default,i=Ut(n,r,r[2],null);return {c(){e=v("td"),i&&i.c(),_(e,"align",r[1]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&4)&&xt(i,n,o,o[2],t?Bt(n,o[2],s,null):Zt(o[2]),null),(!t||s&2)&&_(e,"align",o[1]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(qY,"create_else_block$d");function KY(r){let e,t;const n=r[3].default,i=Ut(n,r,r[2],null);return {c(){e=v("th"),i&&i.c(),_(e,"align",r[1]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&4)&&xt(i,n,o,o[2],t?Bt(n,o[2],s,null):Zt(o[2]),null),(!t||s&2)&&_(e,"align",o[1]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(KY,"create_if_block$l");function ez(r){let e,t,n,i;const o=[KY,qY],s=[];function a(l,u){return l[0]?0:1}return c(a,"select_block_type"),e=a(r),t=s[e]=o[e](r),{c(){t.c(),n=je();},m(l,u){s[e].m(l,u),k(l,n,u),i=!0;},p(l,[u]){let d=e;e=a(l),e===d?s[e].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n));},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),s[e].d(l);}}}c(ez,"create_fragment$N");function tz(r,e,t){let{$$slots:n={},$$scope:i}=e,{header:o}=e,{align:s}=e;return r.$$set=a=>{"header"in a&&t(0,o=a.header),"align"in a&&t(1,s=a.align),"$$scope"in a&&t(2,i=a.$$scope);},[o,s,i,n]}c(tz,"instance$J");const zw=class zw extends se{constructor(e){super(),le(this,e,tz,ez,re,{header:0,align:1});}};c(zw,"TableCell");let Zm=zw;function nz(r){let e,t;const n=r[3].default,i=Ut(n,r,r[2],null);return {c(){e=v("ul"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&4)&&xt(i,n,o,o[2],t?Bt(n,o[2],s,null):Zt(o[2]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(nz,"create_else_block$c");function iz(r){let e,t;const n=r[3].default,i=Ut(n,r,r[2],null);return {c(){e=v("ol"),i&&i.c(),_(e,"start",r[1]);},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,s){i&&i.p&&(!t||s&4)&&xt(i,n,o,o[2],t?Bt(n,o[2],s,null):Zt(o[2]),null),(!t||s&2)&&_(e,"start",o[1]);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(iz,"create_if_block$k");function rz(r){let e,t,n,i;const o=[iz,nz],s=[];function a(l,u){return l[0]?0:1}return c(a,"select_block_type"),e=a(r),t=s[e]=o[e](r),{c(){t.c(),n=je();},m(l,u){s[e].m(l,u),k(l,n,u),i=!0;},p(l,[u]){let d=e;e=a(l),e===d?s[e].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),t=s[e],t?t.p(l,u):(t=s[e]=o[e](l),t.c()),T(t,1),t.m(n.parentNode,n));},i(l){i||(T(t),i=!0);},o(l){M(t),i=!1;},d(l){l&&A(n),s[e].d(l);}}}c(rz,"create_fragment$M");function oz(r,e,t){let{$$slots:n={},$$scope:i}=e,{ordered:o}=e,{start:s}=e;return r.$$set=a=>{"ordered"in a&&t(0,o=a.ordered),"start"in a&&t(1,s=a.start),"$$scope"in a&&t(2,i=a.$$scope);},[o,s,i,n]}c(oz,"instance$I");const Uw=class Uw extends se{constructor(e){super(),le(this,e,oz,rz,re,{ordered:0,start:1});}};c(Uw,"List");let Vm=Uw;function sz(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("li"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(sz,"create_fragment$L");function az(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(az,"instance$H");const Bw=class Bw extends se{constructor(e){super(),le(this,e,az,sz,re,{});}};c(Bw,"ListItem");let Jm=Bw;function lz(r){let e;return {c(){e=v("hr");},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(lz,"create_fragment$K");const xw=class xw extends se{constructor(e){super(),le(this,e,null,lz,re,{});}};c(xw,"Hr");let Fm=xw;function cz(r){let e,t;return {c(){e=new cd(!1),t=je(),e.a=t;},m(n,i){e.m(r[0],n,i),k(n,t,i);},p(n,[i]){i&1&&e.p(n[0]);},i:j,o:j,d(n){n&&(A(t),e.d());}}}c(cz,"create_fragment$J");function uz(r,e,t){let{text:n}=e;return r.$$set=i=>{"text"in i&&t(0,n=i.text);},[n]}c(uz,"instance$G");const Zw=class Zw extends se{constructor(e){super(),le(this,e,uz,cz,re,{text:0});}};c(Zw,"Html");let Wm=Zw;function dz(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("blockquote"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(e,null),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(dz,"create_fragment$I");function hz(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(hz,"instance$F");const Vw=class Vw extends se{constructor(e){super(),le(this,e,hz,dz,re,{});}};c(Vw,"Blockquote");let Hm=Vw;function fz(r){let e,t,n;return {c(){e=v("pre"),t=v("code"),n=G(r[1]),_(e,"class",r[0]);},m(i,o){k(i,e,o),g(e,t),g(t,n);},p(i,[o]){o&2&&K(n,i[1]),o&1&&_(e,"class",i[0]);},i:j,o:j,d(i){i&&A(e);}}}c(fz,"create_fragment$H");function pz(r,e,t){let{lang:n}=e,{text:i}=e;return r.$$set=o=>{"lang"in o&&t(0,n=o.lang),"text"in o&&t(1,i=o.text);},[n,i]}c(pz,"instance$E");const Jw=class Jw extends se{constructor(e){super(),le(this,e,pz,fz,re,{lang:0,text:1});}};c(Jw,"Code");let Qm=Jw;function mz(r){let e,t;const n=r[1].default,i=Ut(n,r,r[0],null);return {c(){e=v("br"),i&&i.c();},m(o,s){k(o,e,s),i&&i.m(o,s),t=!0;},p(o,[s]){i&&i.p&&(!t||s&1)&&xt(i,n,o,o[0],t?Bt(n,o[0],s,null):Zt(o[0]),null);},i(o){t||(T(i,o),t=!0);},o(o){M(i,o),t=!1;},d(o){o&&A(e),i&&i.d(o);}}}c(mz,"create_fragment$G");function gz(r,e,t){let{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{"$$scope"in o&&t(0,i=o.$$scope);},[i,n]}c(gz,"instance$D");const Fw=class Fw extends se{constructor(e){super(),le(this,e,gz,mz,re,{});}};c(Fw,"Br");let Xm=Fw;const bz={heading:Lm,paragraph:Pm,text:Nm,image:PY,link:Om,em:jm,strong:Ym,codespan:$m,del:Gm,table:zm,tablehead:Um,tablebody:Bm,tablerow:xm,tablecell:Zm,list:Vm,orderedlistitem:null,unorderedlistitem:null,listitem:Jm,hr:Fm,html:Wm,blockquote:Hm,code:Qm,br:Xm},vz={baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,xhtml:!1};function _z(r){let e,t;return e=new Po({props:{tokens:r[0],renderers:r[1]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,[i]){const o={};i&1&&(o.tokens=n[0]),i&2&&(o.renderers=n[1]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(_z,"create_fragment$F");function yz(r,e,t){let n,i,o,s,{source:a=[]}=e,{renderers:l={}}=e,{options:u={}}=e,{isInline:d=!1}=e;const h=ED();let p,m,b;return DR(RE,{slug:c(y=>i?i.slug(y):"","slug"),getOptions:c(()=>o,"getOptions")}),li(()=>{t(7,b=!0);}),r.$$set=y=>{"source"in y&&t(2,a=y.source),"renderers"in y&&t(3,l=y.renderers),"options"in y&&t(4,u=y.options),"isInline"in y&&t(5,d=y.isInline);},r.$$.update=()=>{r.$$.dirty&4&&t(8,n=Array.isArray(a)),r.$$.dirty&4&&(i=a?new Al:void 0),r.$$.dirty&16&&t(9,o={...vz,...u}),r.$$.dirty&869&&(n?t(0,p=a):(t(6,m=new Ni(o)),t(0,p=d?m.inlineTokens(a):m.lex(a)),h("parsed",{tokens:p}))),r.$$.dirty&8&&t(1,s={...bz,...l}),r.$$.dirty&385&&b&&!n&&h("parsed",{tokens:p});},[p,s,a,l,u,d,m,b,n,o]}c(yz,"instance$C");const Ww=class Ww extends se{constructor(e){super(),le(this,e,yz,_z,re,{source:2,renderers:3,options:4,isInline:5});}};c(Ww,"SvelteMarkdown");let qm=Ww;function wz(r){let e,t,n=new Date(Number(r[0].date)).toDateString()+"",i,o,s,a,l=r[0].affectedTypoVersion+"",u,d,h,p,m,b,y;return b=new qm({props:{source:r[0].details}}),{c(){e=v("div"),t=v("span"),i=G(n),o=C(),s=v("span"),a=G("Update changelog for v"),u=G(l),d=C(),h=v("br"),p=C(),m=v("div"),V(b.$$.fragment),_(e,"class","info svelte-mkybs6"),_(m,"class","details svelte-mkybs6");},m(w,I){k(w,e,I),g(e,t),g(t,i),g(e,o),g(e,s),g(s,a),g(s,u),k(w,d,I),k(w,h,I),k(w,p,I),k(w,m,I),x(b,m,null),y=!0;},p(w,[I]){(!y||I&1)&&n!==(n=new Date(Number(w[0].date)).toDateString()+"")&&K(i,n),(!y||I&1)&&l!==(l=w[0].affectedTypoVersion+"")&&K(u,l);const S={};I&1&&(S.source=w[0].details),b.$set(S);},i(w){y||(T(b.$$.fragment,w),y=!0);},o(w){M(b.$$.fragment,w),y=!1;},d(w){w&&(A(e),A(d),A(h),A(p),A(m)),Z(b);}}}c(wz,"create_fragment$E");function Sz(r,e,t){let{change:n}=e;return r.$$set=i=>{"change"in i&&t(0,n=i.change);},[n]}c(Sz,"instance$B");const Hw=class Hw extends se{constructor(e){super(),le(this,e,Sz,wz,re,{change:0});}};c(Hw,"Panel_changelog_details");let Km=Hw;var Az=Object.defineProperty,Yh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Az(e,t,i),i},"__decorateClass$A");const Qw=class Qw extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_apiDataSetup");f(this,"_globalSettingsService");f(this,"_modalService");f(this,"_firstLoadSetting",new He("first_load",!0,this));f(this,"_lastReadVersionSetting",new dt("last_read_version","0.0.0",this));f(this,"_component");f(this,"name","Changelog");f(this,"description","Displays a list of changes since the last updates on the start page");f(this,"tags",[ye.INFORMATION]);f(this,"featureId",4);f(this,"changelog","I am the changelog :)");}async onActivate(){const t=await this._elements.complete();this._component=new Em({target:t.changelogTab,props:{feature:this}});const i=(await this._apiDataSetup.complete()).announcements.filter(l=>l.type===dE.Changelog).sort((l,u)=>Number(u.date)-Number(l.date));this._component.$set({changes:i});const o=i[0],s=Jt.getReleaseDetails().version;await this._firstLoadSetting.getValue()?await this._firstLoadSetting.setValue(!1):(o==null?void 0:o.affectedTypoVersion)===s&&await this._lastReadVersionSetting.getValue()!=s&&(this.showDetailsModal(o),await this._lastReadVersionSetting.setValue(s));}onDestroy(){var t;(t=this._component)==null||t.$destroy();}get devmodeStore(){return this._globalSettingsService.settings.devMode.store}versionIsBiggerThan(t){const n=t.split(".").map(Number),i=Jt.getReleaseDetails().version.split(".").map(Number);for(let o=0;o<Math.max(n.length,i.length);o++){const s=n[o]||0,a=i[o]||0;if(s>a)return !0;if(s<a)return !1}}getVersion(){return Jt.getReleaseDetails().versionName}showDetailsModal(t){if(t.details===void 0)throw this._logger.warn("Change does not have details"),new Error("Change does not have details");const n={componentType:Km,props:{change:t}};this._modalService.showModal(n.componentType,n.props,t.title,"card");}};c(Qw,"PanelChangelogFeature");let Or=Qw;Yh([D(Me)],Or.prototype,"_elements");Yh([D(Tn)],Or.prototype,"_apiDataSetup");Yh([D(xn)],Or.prototype,"_globalSettingsService");Yh([D(Dn)],Or.prototype,"_modalService");function BC(r,e,t){const n=r.slice();return n[9]=e[t],n}c(BC,"get_each_context$l");function xC(r,e,t){const n=r.slice();return n[9]=e[t],n}c(xC,"get_each_context_1$7");function kz(r){let e,t,n,i=te(r[1]),o=[];for(let l=0;l<i.length;l+=1)o[l]=ZC(xC(r,i,l));const s=c(l=>M(o[l],1,1,()=>{o[l]=null;}),"out");let a=r[1].length===0&&VC();return {c(){e=v("div");for(let l=0;l<o.length;l+=1)o[l].c();t=C(),a&&a.c(),_(e,"class","typo-lobbies-discord-buttons svelte-tkvjrc");},m(l,u){k(l,e,u);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(e,null);g(e,t),a&&a.m(e,null),n=!0;},p(l,u){if(u&3){i=te(l[1]);let d;for(d=0;d<i.length;d+=1){const h=xC(l,i,d);o[d]?(o[d].p(h,u),T(o[d],1)):(o[d]=ZC(h),o[d].c(),T(o[d],1),o[d].m(e,t));}for(fe(),d=i.length;d<o.length;d+=1)s(d);pe();}l[1].length===0?a||(a=VC(),a.c(),a.m(e,null)):a&&(a.d(1),a=null);},i(l){if(!n){for(let u=0;u<i.length;u+=1)T(o[u]);n=!0;}},o(l){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)M(o[u]);n=!1;},d(l){l&&A(e),Ie(o,l),a&&a.d();}}}c(kz,"create_else_block$b");function Cz(r){let e,t;return e=new Yn({props:{content:"Loading connected servers.."}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Cz,"create_if_block_3$2");function Iz(r){let e;return {c(){e=v("span"),e.innerHTML="You need to log in to see lobbies of your discord friends.<br/>",_(e,"class","svelte-tkvjrc");},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(Iz,"create_if_block_2$5");function ZC(r){let e,t,n,i,o,s;function a(){return r[7](r[9])}return c(a,"click_handler"),t=new ke({props:{content:r[9].userName,color:r[9].private?"green":"blue"}}),t.$on("click",a),{c(){e=v("div"),V(t.$$.fragment);},m(l,u){k(l,e,u),x(t,e,null),i=!0,o||(s=oi(n=r[0].createTooltip(e,{title:r[0].buildButtonTooltip(r[9]),lock:"Y"})),o=!0);},p(l,u){r=l;const d={};u&2&&(d.content=r[9].userName),u&2&&(d.color=r[9].private?"green":"blue"),t.$set(d),n&&Yr(n.update)&&u&3&&n.update.call(null,{title:r[0].buildButtonTooltip(r[9]),lock:"Y"});},i(l){i||(T(t.$$.fragment,l),i=!0);},o(l){M(t.$$.fragment,l),i=!1;},d(l){l&&A(e),Z(t),o=!1,s();}}}c(ZC,"create_each_block_1$7");function VC(r){let e;return {c(){e=v("span"),e.textContent="None of your friends are online.",_(e,"class","svelte-tkvjrc");},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(VC,"create_if_block_4$2");function JC(r){let e,t,n,i,o,s=r[3].length===0&&FC(),a=te(r[3]),l=[];for(let u=0;u<a.length;u+=1)l[u]=WC(BC(r,a,u));return {c(){e=v("div"),t=v("b"),t.textContent="Discovered Lobbies",n=C(),s&&s.c(),i=C(),o=v("div");for(let u=0;u<l.length;u+=1)l[u].c();_(t,"class","svelte-tkvjrc"),_(o,"class","typo-lobbies-discovered-buttons svelte-tkvjrc"),_(e,"class","typo-lobbies-discovered svelte-tkvjrc");},m(u,d){k(u,e,d),g(e,t),g(e,n),s&&s.m(e,null),g(e,i),g(e,o);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(o,null);},p(u,d){if(u[3].length===0?s||(s=FC(),s.c(),s.m(e,i)):s&&(s.d(1),s=null),d&9){a=te(u[3]);let h;for(h=0;h<a.length;h+=1){const p=BC(u,a,h);l[h]?l[h].p(p,d):(l[h]=WC(p),l[h].c(),l[h].m(o,null));}for(;h<l.length;h+=1)l[h].d(1);l.length=a.length;}},d(u){u&&A(e),s&&s.d(),Ie(l,u);}}}c(JC,"create_if_block$j");function FC(r){let e;return {c(){e=v("div"),e.textContent="Join a lobby to see it here afterwards.";},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(FC,"create_if_block_1$7");function WC(r){let e,t,n=new Date(Number(r[9].seenAt)).toLocaleTimeString()+"",i,o,s,a=r[9].players.map(HC).join(", ")+"",l,u,d,h;function p(){return r[8](r[9])}return c(p,"click_handler_1"),{c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("span"),l=G(a),u=C(),_(t,"class","svelte-tkvjrc"),_(s,"class","svelte-tkvjrc"),H(e,"order",r[9].seenAt%1e8),_(e,"class","svelte-tkvjrc");},m(m,b){k(m,e,b),g(e,t),g(t,i),g(e,o),g(e,s),g(s,l),g(e,u),d||(h=F(e,"click",p),d=!0);},p(m,b){r=m,b&8&&n!==(n=new Date(Number(r[9].seenAt)).toLocaleTimeString()+"")&&K(i,n),b&8&&a!==(a=r[9].players.map(HC).join(", ")+"")&&K(l,a),b&8&&H(e,"order",r[9].seenAt%1e8);},d(m){m&&A(e),d=!1,h();}}}c(WC,"create_each_block$l");function Tz(r){let e,t,n,i,o,s,a,l;const u=[Iz,Cz,kz],d=[];function h(m,b){return m[1]===null?0:m[1]===void 0?1:2}c(h,"select_block_type"),o=h(r),s=d[o]=u[o](r);let p=r[2]&&JC(r);return {c(){e=v("div"),t=v("div"),n=v("b"),n.textContent="Online Friends",i=C(),s.c(),a=C(),p&&p.c(),_(n,"class","svelte-tkvjrc"),_(t,"class","typo-lobbies-discord svelte-tkvjrc"),_(e,"class","svelte-tkvjrc");},m(m,b){k(m,e,b),g(e,t),g(t,n),g(t,i),d[o].m(t,null),g(e,a),p&&p.m(e,null),l=!0;},p(m,[b]){let y=o;o=h(m),o===y?d[o].p(m,b):(fe(),M(d[y],1,1,()=>{d[y]=null;}),pe(),s=d[o],s?s.p(m,b):(s=d[o]=u[o](m),s.c()),T(s,1),s.m(t,null)),m[2]?p?p.p(m,b):(p=JC(m),p.c(),p.m(e,null)):p&&(p.d(1),p=null);},i(m){l||(T(s),l=!0);},o(m){M(s),l=!1;},d(m){m&&A(e),d[o].d(),p&&p.d();}}}c(Tz,"create_fragment$D");const HC=c(r=>r.name,"func$3");function Dz(r,e,t){let n,i,o,{feature:s}=e;const a=s.lobbiesStore;De(r,a,p=>t(1,n=p));const l=s.showDiscoveredLobbiesStore;De(r,l,p=>t(2,i=p));const u=s.discoveredLobbiesStore;De(r,u,p=>t(3,o=p));const d=c(p=>s.joinLobby(p.lobbyId,p.userName),"click_handler"),h=c(p=>s.joinLobby(p.id??""),"click_handler_1");return r.$$set=p=>{"feature"in p&&t(0,s=p.feature);},[s,n,i,o,a,l,u,d,h]}c(Dz,"instance$A");const Xw=class Xw extends se{constructor(e){super(),le(this,e,Dz,Tz,re,{feature:0});}};c(Xw,"Panel_lobbies");let eg=Xw;var Ez=Object.defineProperty,Lu=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Ez(e,t,i),i},"__decorateClass$z");const qw=class qw extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_socketService");f(this,"_memberService");f(this,"_lobbyService");f(this,"_toastService");f(this,"_showDiscoveredLobbiesSetting",this.useSetting(new He("show_discovered",!0,this).withName("Show discovered lobbies").withDescription("Shows a list of lobbies that you were in before")));f(this,"_lobbies$",new Le(void 0));f(this,"_component");f(this,"_connection");f(this,"_memberSubscription");f(this,"name","Lobby List");f(this,"description","Displays online players from your connected discord servers on the start page");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",6);}async onActivate(){const t=await this._elements.complete();this._component=new eg({target:t.lobbiesTab,props:{feature:this}}),this._memberSubscription=this._memberService.member$.subscribe(n=>this.processMemberChange(n));}onDestroy(){var t,n,i;(t=this._component)==null||t.$destroy(),(n=this._connection)==null||n.stop(),(i=this._memberSubscription)==null||i.unsubscribe(),this._memberSubscription=void 0;}get lobbiesStore(){return it(this._lobbies$.pipe(ce(t=>t==null?t:this.mapLobbiesToPlayerList(t)),_t(t=>this._logger.info("Lobbies updated",t))),[])}get discoveredLobbiesStore(){return it(this._lobbyService.discoveredLobbies$,[])}get showDiscoveredLobbiesStore(){return this._showDiscoveredLobbiesSetting.store}async processMemberChange(t){var o;if(this._logger.debug("Member changed",t),(o=this._connection)==null||o.stop(),t==null){this._lobbies$.next(t);return}this._lobbies$.next(new Map);const n=c(async()=>{const{connection:s,hubProxy:a}=await this.setupConnection();return this._connection=s,await this.subscribeToLobbies(t,a),s},"initConnection"),i=await n();this._socketService.reconnectOnUserInteraction(i,()=>n());}async setupConnection(){const t=this._socketService.createConnection("IGuildLobbiesHub"),n=this._socketService.createHub("IGuildLobbiesHub").createHubProxy(t);return this._socketService.createReceiver("IGuildLobbiesReceiver").register(t,{guildLobbiesUpdated:this.onGuildLobbiesUpdated.bind(this)}),await t.start(),{connection:t,hubProxy:n}}async subscribeToLobbies(t,n){const i=t.guilds.map(async o=>{const s=await n.subscribeGuildLobbies(o.guildID);await this.onGuildLobbiesUpdated(s);});await Promise.all(i);}async onGuildLobbiesUpdated(t){this._logger.info("Received guild lobbies for guild",t.guildId);const n=this._lobbies$.value;if(n==null){this._logger.warn("Received guild lobbies but lobbies are not initialized yet",t);return}n.set(t.guildId,t.lobbies),this._lobbies$.next(n);}mapLobbiesToPlayerList(t){const n=[];return Array.from(t.values()).flat().forEach(o=>{n.some(s=>s.lobbyId===o.lobbyId&&s.userName===o.userName)||n.push(o);}),n}buildButtonTooltip(t){return `  ${t.private?"Custom":"Public"}
 ${t.currentPlayers} Players
 ${t.language}`}async joinLobby(t,n){await this._lobbyService.joinLobby(t)?await this._toastService.showToast(n?`Joined the lobby of ${n}`:"Joined discovered lobby"):await this._toastService.showToast(n?`Failed to join the lobby of ${n}`:"Failed to join discovered lobby");}};c(qw,"PanelLobbiesFeature");let mr=qw;Lu([D(Me)],mr.prototype,"_elements");Lu([D(yl)],mr.prototype,"_socketService");Lu([D(Sn)],mr.prototype,"_memberService");Lu([D(ut)],mr.prototype,"_lobbyService");Lu([D(ft)],mr.prototype,"_toastService");function QC(r,e,t){const n=r.slice();return n[2]=e[t],n}c(QC,"get_each_context$k");function Mz(r){let e,t=te(r[0]),n=[];for(let i=0;i<t.length;i+=1)n[i]=XC(QC(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,o){if(o&1){t=te(i[0]);let s;for(s=0;s<t.length;s+=1){const a=QC(i,t,s);n[s]?n[s].p(a,o):(n[s]=XC(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},i:j,o:j,d(i){i&&A(e),Ie(n,i);}}}c(Mz,"create_else_block$a");function Rz(r){let e,t;return e=new Yn({props:{content:"Loading news.."}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(Rz,"create_if_block$i");function XC(r){let e,t,n,i=r[2].title+"",o,s,a,l=new Date(Number(r[2].date)).toDateString()+"",u,d,h,p=r[2].content+"",m,b;return {c(){e=v("div"),t=v("div"),n=v("b"),o=G(i),s=C(),a=v("span"),u=G(l),d=C(),h=v("p"),m=G(p),b=C(),_(a,"class","svelte-1x3jcfi"),_(t,"class","title svelte-1x3jcfi"),_(e,"class","announcement svelte-1x3jcfi");},m(y,w){k(y,e,w),g(e,t),g(t,n),g(n,o),g(t,s),g(t,a),g(a,u),g(e,d),g(e,h),g(h,m),g(e,b);},p(y,w){w&1&&i!==(i=y[2].title+"")&&K(o,i),w&1&&l!==(l=new Date(Number(y[2].date)).toDateString()+"")&&K(u,l),w&1&&p!==(p=y[2].content+"")&&K(m,p);},d(y){y&&A(e);}}}c(XC,"create_each_block$k");function Lz(r){let e,t,n,i,o;const s=[Rz,Mz],a=[];function l(u,d){return u[0]===void 0?0:1}return c(l,"select_block_type"),n=l(r),i=a[n]=s[n](r),{c(){e=v("div"),t=v("div"),i.c(),_(t,"class","news svelte-1x3jcfi"),_(e,"class","typo-news svelte-1x3jcfi");},m(u,d){k(u,e,d),g(e,t),a[n].m(t,null),o=!0;},p(u,[d]){let h=n;n=l(u),n===h?a[n].p(u,d):(fe(),M(a[h],1,1,()=>{a[h]=null;}),pe(),i=a[n],i?i.p(u,d):(i=a[n]=s[n](u),i.c()),T(i,1),i.m(t,null));},i(u){o||(T(i),o=!0);},o(u){M(i),o=!1;},d(u){u&&A(e),a[n].d();}}}c(Lz,"create_fragment$C");function Pz(r,e,t){let{feature:n}=e,{announcements:i=void 0}=e;return r.$$set=o=>{"feature"in o&&t(1,n=o.feature),"announcements"in o&&t(0,i=o.announcements);},[i,n]}c(Pz,"instance$z");const Kw=class Kw extends se{constructor(e){super(),le(this,e,Pz,Lz,re,{feature:1,announcements:0});}};c(Kw,"Panel_news");let tg=Kw;var Nz=Object.defineProperty,LE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Nz(e,t,i),i},"__decorateClass$y");const e0=class e0 extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_apiDataSetup");f(this,"_component");f(this,"name","Typo News");f(this,"description","Displays updates and typo hints on the start page");f(this,"tags",[ye.INFORMATION]);f(this,"featureId",7);}async onActivate(){const t=await this._elements.complete();this._component=new tg({target:t.newsTab,props:{feature:this}});const n=await this._apiDataSetup.complete(),i=Jt.getReleaseDetails().versionName,o=n.announcements.filter(s=>s.type===dE.Announcement&&(s.affectedTypoVersion===i||s.affectedTypoVersion===void 0)).sort((s,a)=>Number(a.date)-Number(s.date));this._component.$set({announcements:o});}onDestroy(){var t;(t=this._component)==null||t.$destroy();}};c(e0,"PanelNewsFeature");let kl=e0;LE([D(Me)],kl.prototype,"_elements");LE([D(Tn)],kl.prototype,"_apiDataSetup");var Oz=Object.defineProperty,jz=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Oz(e,t,i),i},"__decorateClass$x");const t0=class t0 extends $e{constructor(){super(...arguments);f(this,"_playersService");f(this,"name","Player IDs");f(this,"description","Show player IDs in the lobby to execute commands like kick");f(this,"tags",[ye.INFORMATION,ye.GAMEPLAY]);f(this,"featureId",29);f(this,"_revealIdsHotkey",this.useHotkey(new cn("reveal_id","Reveal IDs","Reveal the lobby player ID of all players",this,()=>this.setRevealState(!0),!0,["AltLeft"],()=>this.setRevealState(!1),!1)));}setRevealState(t){this._playersService.players$.pipe(vt(1)).subscribe(n=>{for(const i of n)i.viewPlayerId=t;});}onDestroy(){this.setRevealState(!1);}};c(t0,"PlayerIdsFeature");let Cl=t0;jz([D(en)],Cl.prototype,"_playersService");function Gz(r){let e;return {c(){e=G(r[0]);},m(t,n){k(t,e,n);},p(t,n){n&1&&K(e,t[0]);},d(t){t&&A(e);}}}c(Gz,"create_else_block$9");function $z(r){let e,t;return {c(){e=new cd(!1),t=je(),e.a=t;},m(n,i){e.m(r[1],n,i),k(n,t,i);},p(n,i){i&2&&e.p(n[1]);},d(n){n&&(A(t),e.d());}}}c($z,"create_if_block$h");function Yz(r){let e,t,n,i,o;function s(u,d){return u[1]?$z:Gz}c(s,"select_block_type");let a=s(r),l=a(r);return {c(){e=v("div"),t=v("div"),n=C(),i=v("div"),l.c(),_(t,"class","typo-tooltip-arrow svelte-1s7wcc7"),_(i,"class","typo-tooltip-title svelte-1s7wcc7"),_(e,"class",o="typo-tooltip "+r[2]+" svelte-1s7wcc7"),H(e,"top",r[4]+"px"),H(e,"left",r[3]+"px");},m(u,d){k(u,e,d),g(e,t),g(e,n),g(e,i),l.m(i,null);},p(u,[d]){a===(a=s(u))&&l?l.p(u,d):(l.d(1),l=a(u),l&&(l.c(),l.m(i,null))),d&4&&o!==(o="typo-tooltip "+u[2]+" svelte-1s7wcc7")&&_(e,"class",o),d&16&&H(e,"top",u[4]+"px"),d&8&&H(e,"left",u[3]+"px");},i:j,o:j,d(u){u&&A(e),l.d();}}}c(Yz,"create_fragment$B");function zz(r,e,t){let{title:n}=e,{htmlTitle:i}=e,{direction:o}=e,{anchorX:s}=e,{anchorY:a}=e;return r.$$set=l=>{"title"in l&&t(0,n=l.title),"htmlTitle"in l&&t(1,i=l.htmlTitle),"direction"in l&&t(2,o=l.direction),"anchorX"in l&&t(3,s=l.anchorX),"anchorY"in l&&t(4,a=l.anchorY);},[n,i,o,s,a]}c(zz,"instance$y");const n0=class n0 extends se{constructor(e){super(),le(this,e,zz,Yz,re,{title:0,htmlTitle:1,direction:2,anchorX:3,anchorY:4});}};c(n0,"Tooltip");let ng=n0;const i0=class i0 extends $e{constructor(){super(...arguments);f(this,"name","Tooltips");f(this,"description","Show helpful information when hovering over icons and buttons");f(this,"tags",[ye.INTERFACE]);f(this,"featureId",35);f(this,"_pointeroverListener",this.handlePointerover.bind(this));f(this,"_currentTarget",new Le(null));f(this,"_targetSubscription");f(this,"_activeTooltips",new Map);}async onActivate(){this._targetSubscription=this._currentTarget.pipe(Qe(this._tooltipsService.tooltips$)).subscribe(([t,n])=>{this.handleTooltipChange(t,n);}),document.addEventListener("pointerover",this._pointeroverListener);}async onDestroy(){var t;(t=this._targetSubscription)==null||t.unsubscribe(),this._targetSubscription=void 0,document.removeEventListener("pointerover",this._pointeroverListener),this._activeTooltips.forEach(n=>n.tooltip.remove()),this._activeTooltips.clear();}handlePointerover(t){this._logger.debug("Pointerover",t.target);const n=t.target;if(n instanceof HTMLElement){const i=this._tooltipsService.getTooltipsUntilElement(n);if(i.length>=1){const o=i[0];o!==this._currentTarget.value&&(this._logger.info("Found new target",i),this._currentTarget.next(o));}else this._currentTarget.value!==null&&(this._logger.info("Removed tooltip target",i),this._currentTarget.next(null));}else this._currentTarget.next(null);}handleTooltipChange(t,n){if(this._logger.info("Tooltip change",t,n),this._activeTooltips.forEach(i=>{i.registration.target!==t&&(this._activeTooltips.delete(i.registration.target),i.tooltip.$destroy());}),t!==null&&!this._activeTooltips.has(t)){const i=n.find(s=>s.target===t);if(!i)return;const o=this.buildTooltip(i);this._activeTooltips.set(t,{registration:i,tooltip:o});}}buildTooltip(t){const n=this.getVisibleDimensionsAndCoordinates(t.target),i=window.innerWidth,o=window.innerHeight,s=n.top,a=o-n.top-n.height,l=n.left,u=i-n.left-n.width;let d=t.lock!=="Y"?"E":"N",h=t.lock!=="Y"?n.left+n.width:n.left+n.width/2,p=t.lock!=="Y"?n.top+n.height/2:n.top;return t.lock!=="X"&&s>a&&(s>l&&s>u||t.lock==="Y")?(d="N",h=n.left+n.width/2,p=n.top):t.lock!=="X"&&a>s&&(a>l&&a>u||t.lock==="Y")?(d="S",h=n.left+n.width/2,p=n.top+n.height):t.lock!=="Y"&&l>u&&(d="W",h=n.left,p=n.top+n.height/2),new ng({target:document.body,props:{title:t.title,htmlTitle:t.htmlTitle,anchorX:h,anchorY:p,direction:d}})}getVisibleDimensionsAndCoordinates(t){const n=t.getBoundingClientRect(),i={top:n.top,left:n.left,width:n.width,height:n.height};let o=t;for(;o!==null;){const s=o.parentElement;if(s){const a=s.getBoundingClientRect();getComputedStyle(s).overflow!=="visible"&&(i.top=Math.max(i.top,a.top),i.left=Math.max(i.left,a.left),i.width=Math.min(i.width,a.right-i.left),i.height=Math.min(i.height,a.bottom-i.top));}o=s;}return i.width=Math.min(i.width,window.innerWidth-i.left),i.height=Math.min(i.height,window.innerHeight-i.top),i.top=Math.max(i.top,0),i.left=Math.max(i.left,0),{width:Math.max(0,i.width),height:Math.max(0,i.height),top:i.top,left:i.left}}};c(i0,"TooltipsFeature");let bu=i0;function Uz(r){let e,t,n,i,o,s=r[1].userName+"",a,l,u,d,h,p,m,b,y,w,I,S=r[1].bubbles+"",R,E,P,L,O,z,$=Math.round(r[1].drops*10)/10+"",U,N,Y,ee,B,J=r[2]&&qC(r);return {c(){e=v("div"),t=v("a"),n=v("img"),o=C(),a=G(s),l=C(),u=v("a"),u.textContent="Manage",d=C(),h=v("span"),h.textContent="Logout",p=C(),m=v("div"),b=v("div"),y=v("div"),w=v("span"),w.textContent="Bubbles:",I=v("span"),R=G(S),E=C(),P=v("div"),L=v("div"),O=v("span"),O.textContent="Drops:",z=v("span"),U=G($),N=C(),J&&J.c(),Y=je(),_(n,"class","typo-icon svelte-j680fu"),_(n,"alt","typo icon"),ht(n.src,i="")||_(n,"src",i),_(t,"href","https://www.typo.rip"),_(t,"class","svelte-j680fu"),_(u,"href","https://www.typo.rip/user"),_(u,"class","svelte-j680fu"),_(h,"role","button"),_(h,"tabindex","0"),_(h,"class","svelte-j680fu"),_(e,"class","member-info-header svelte-j680fu"),_(y,"class","stat-icon svelte-j680fu"),H(y,"content","var(--file-img-palantir-gif)"),_(w,"class","svelte-j680fu"),_(I,"class","svelte-j680fu"),_(b,"class","svelte-j680fu"),_(L,"class","stat-icon svelte-j680fu"),H(L,"content","var(--file-img-drop-gif)"),_(O,"class","svelte-j680fu"),_(z,"class","svelte-j680fu"),_(P,"class","svelte-j680fu"),_(m,"class","member-info-stats svelte-j680fu");},m(q,Q){k(q,e,Q),g(e,t),g(t,n),g(t,o),g(t,a),g(e,l),g(e,u),g(e,d),g(e,h),k(q,p,Q),k(q,m,Q),g(m,b),g(b,y),g(b,w),g(b,I),g(I,R),g(m,E),g(m,P),g(P,L),g(P,O),g(P,z),g(z,U),k(q,N,Q),J&&J.m(q,Q),k(q,Y,Q),ee||(B=[F(h,"keydown",r[7]),F(h,"click",r[8])],ee=!0);},p(q,Q){Q&2&&s!==(s=q[1].userName+"")&&K(a,s),Q&2&&S!==(S=q[1].bubbles+"")&&K(R,S),Q&2&&$!==($=Math.round(q[1].drops*10)/10+"")&&K(U,$),q[2]?J?J.p(q,Q):(J=qC(q),J.c(),J.m(Y.parentNode,Y)):J&&(J.d(1),J=null);},i:j,o:j,d(q){q&&(A(e),A(p),A(m),A(N),A(Y)),J&&J.d(q),ee=!1,Je(B);}}}c(Uz,"create_else_block$8");function Bz(r){let e,t,n;return t=new Yn({props:{content:"Loading..."}}),{c(){e=v("div"),V(t.$$.fragment);},m(i,o){k(i,e,o),x(t,e,null),n=!0;},p:j,i(i){n||(T(t.$$.fragment,i),n=!0);},o(i){M(t.$$.fragment,i),n=!1;},d(i){i&&A(e),Z(t);}}}c(Bz,"create_if_block_1$6");function xz(r){let e,t,n,i,o,s,a;return {c(){e=v("div"),t=v("img"),i=C(),o=v("span"),o.textContent="Log in with typo to collect bubbles and upgrade your avatar.",_(t,"class","typo-icon svelte-j680fu"),ht(t.src,n="")||_(t,"src",n),_(t,"alt","typo icon"),_(o,"role","button"),_(o,"tabindex","0"),_(e,"class","member-login svelte-j680fu");},m(l,u){k(l,e,u),g(e,t),g(e,i),g(e,o),s||(a=[F(o,"keydown",r[5]),F(o,"click",r[6])],s=!0);},p:j,i:j,o:j,d(l){l&&A(e),s=!1,Je(a);}}}c(xz,"create_if_block$g");function qC(r){let e,t,n,i,o,s=r[1].userLogin+"",a;return {c(){e=v("div"),t=v("div"),n=v("span"),i=v("span"),i.textContent="Typo ID:",o=v("span"),a=G(s),_(n,"class","svelte-j680fu"),_(i,"class","svelte-j680fu"),_(o,"class","svelte-j680fu"),_(t,"class","svelte-j680fu"),_(e,"class","member-info-stats svelte-j680fu");},m(l,u){k(l,e,u),g(e,t),g(t,n),g(t,i),g(t,o),g(o,a);},p(l,u){u&2&&s!==(s=l[1].userLogin+"")&&K(a,s);},d(l){l&&A(e);}}}c(qC,"create_if_block_2$4");function Zz(r){let e,t,n,i;const o=[xz,Bz,Uz],s=[];function a(l,u){return l[1]===null?0:l[1]===void 0?1:2}return c(a,"select_block_type"),t=a(r),n=s[t]=o[t](r),{c(){e=v("div"),n.c(),_(e,"class","member-info panel svelte-j680fu");},m(l,u){k(l,e,u),s[t].m(e,null),i=!0;},p(l,[u]){let d=t;t=a(l),t===d?s[t].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),n=s[t],n?n.p(l,u):(n=s[t]=o[t](l),n.c()),T(n,1),n.m(e,null));},i(l){i||(T(n),i=!0);},o(l){M(n),i=!1;},d(l){l&&A(e),s[t].d();}}}c(Zz,"create_fragment$A");function Vz(r,e,t){let n,i,{feature:o}=e;const s=o.memberStore;De(r,s,p=>t(1,n=p));const a=o.devmodeStore;De(r,a,p=>t(2,i=p));const l=c(()=>o.login(),"keydown_handler"),u=c(()=>o.login(),"click_handler"),d=c(()=>o.logout(),"keydown_handler_1"),h=c(()=>o.logout(),"click_handler_1");return r.$$set=p=>{"feature"in p&&t(0,o=p.feature);},[o,n,i,s,a,l,u,d,h]}c(Vz,"instance$x");const r0=class r0 extends se{constructor(e){super(),le(this,e,Vz,Zz,re,{feature:0});}};c(r0,"User_info");let ig=r0;function Jz(r){let e,t,n,i,o,s,a,l,u,d,h,p,m;return d=new ke({props:{color:"green",content:"Log In"}}),d.$on("click",r[3]),{c(){e=v("h3"),e.textContent="Emergency Login",t=C(),n=v("div"),n.textContent="If the regular login is not working, you may log in here with a secret code that you can receive from the administrator.",i=C(),o=v("br"),s=C(),a=v("div"),l=v("input"),u=C(),V(d.$$.fragment),H(l,"width","auto"),_(l,"type","text"),_(l,"placeholder","Enter token");},m(b,y){k(b,e,y),k(b,t,y),k(b,n,y),k(b,i,y),k(b,o,y),k(b,s,y),k(b,a,y),g(a,l),de(l,r[1]),g(a,u),x(d,a,null),h=!0,p||(m=F(l,"input",r[2]),p=!0);},p(b,[y]){y&2&&l.value!==b[1]&&de(l,b[1]);},i(b){h||(T(d.$$.fragment,b),h=!0);},o(b){M(d.$$.fragment,b),h=!1;},d(b){b&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a)),Z(d),p=!1,m();}}}c(Jz,"create_fragment$z");function Fz(r,e,t){let{feature:n}=e,i="";function o(){i=this.value,t(1,i);}c(o,"input_input_handler");const s=c(()=>{n.setToken(i),t(1,i="");},"click_handler");return r.$$set=a=>{"feature"in a&&t(0,n=a.feature);},[n,i,o,s]}c(Fz,"instance$w");const o0=class o0 extends se{constructor(e){super(),le(this,e,Fz,Jz,re,{feature:0});}};c(o0,"User_info_management");let rg=o0;var Wz=Object.defineProperty,Pu=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Wz(e,t,i),i},"__decorateClass$w");const s0=class s0 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_memberService");f(this,"_tokenService");f(this,"_globalSettingsService");f(this,"_toastService");f(this,"_element");f(this,"name","User Info");f(this,"description","Shows information about the logged-in user beneath the avatar selection");f(this,"tags",[ye.INFORMATION,ye.PALANTIR]);f(this,"featureId",13);}get featureManagementComponent(){return {componentType:rg,props:{feature:this}}}async onActivate(){const t=await this._elementsSetup.complete();this._element=new ig({target:t.avatarPanel,anchor:t.playButton,props:{feature:this}});}onDestroy(){var t;(t=this._element)==null||t.$destroy();}get memberStore(){return it(this._memberService.member$,null)}get devmodeStore(){return this._globalSettingsService.settings.devMode.store}login(){this._memberService.login();}logout(){this._memberService.logout();}async setToken(t){await this._tokenService.setToken(t),await this._toastService.showToast("Token has been set.","If the secret was valid, you are now logged in!");}};c(s0,"UserInfoFeature");let gr=s0;Pu([D(Me)],gr.prototype,"_elementsSetup");Pu([D(Sn)],gr.prototype,"_memberService");Pu([D(io)],gr.prototype,"_tokenService");Pu([D(xn)],gr.prototype,"_globalSettingsService");Pu([D(ft)],gr.prototype,"_toastService");function Hz(r){let e,t;return {c(){e=v("img"),_(e,"class","typo-onboarding-emote svelte-1593rkb"),ht(e.src,t="")||_(e,"src",t),H(e,"top",r[1]+"px"),H(e,"left",r[0]+"px"),H(e,"content","var(--"+r[2]+")");},m(n,i){k(n,e,i);},p(n,[i]){i&2&&H(e,"top",n[1]+"px"),i&1&&H(e,"left",n[0]+"px"),i&4&&H(e,"content","var(--"+n[2]+")");},i:j,o:j,d(n){n&&A(e);}}}c(Hz,"create_fragment$y");function Qz(r,e,t){let{x:n}=e,{y:i}=e,{src:o}=e;const s=c((a,l)=>{const u=[n+15,i+15],d=[a+15,l+15];return Math.sqrt((u[0]-d[0])**2+(u[1]-d[1])**2)>60},"hasEnoughDistance");return r.$$set=a=>{"x"in a&&t(0,n=a.x),"y"in a&&t(1,i=a.y),"src"in a&&t(2,o=a.src);},[n,i,o,s]}c(Qz,"instance$v");const a0=class a0 extends se{constructor(e){super(),le(this,e,Qz,Hz,re,{x:0,y:1,src:2,hasEnoughDistance:3});}get hasEnoughDistance(){return this.$$.ctx[3]}};c(a0,"Controls_onboarding_emoji");let og=a0;function Xz(r){let e,t,n;return {c(){e=v("h3"),e.textContent="Introducing the new Typo",t=C(),n=v("div"),n.innerHTML=`<p class="svelte-115f3km">Starting in April 2025, Typo is receiving its biggest update so far.<br class="svelte-115f3km"/>
    Typo still has the same features, but makes them much more user-friendly, accessible and customizable.<br class="svelte-115f3km"/>
    So far, Typo provided the tools, but now it&#39;s the whole workshop!</p> <h4 class="svelte-115f3km">A quick-start guide</h4> <p class="svelte-115f3km">All Typo features can now be customized, so you don&#39;t have anything that messes with your optimal skribbl experience.<br class="svelte-115f3km"/>
    To set up Typo to your preferences, click the wrench icon at the top left (unless customized to somewhere else ;).<br class="svelte-115f3km"/>
    There, you can:</p> <ul class="svelte-115f3km"><li class="svelte-115f3km">Enable or disable every feature</li> <li class="svelte-115f3km">Adjust feature settings to your likes</li> <li class="svelte-115f3km">Change and toggle hotkeys and chat commands of features</li> <li class="svelte-115f3km">View some extra info &amp; hints about features</li></ul> <p class="svelte-115f3km">To get started, you can browse through the list of features and view their details.<br class="svelte-115f3km"/>
    Features are also categorized by tags so you can easily find what you are looking for.<br class="svelte-115f3km"/>
    While you might see many features that you already know of, you could discover some that were newly added or features that you didn&#39;t notice yet!<br class="svelte-115f3km"/>
    To change general Typo settings, choose the &quot;Typo Settings&quot; feature in the Typo Features view.<br class="svelte-115f3km"/>
    You can reset all data or switch between profiles in the &quot;Typo Profiles&quot; feature.<br class="svelte-115f3km"/>
    If you have any questions or feedback, join the community on <a href="https://discord.com/invite/pAapmUmWAM" class="svelte-115f3km">Discord</a>!</p> <br/> <h4 class="svelte-115f3km">The most important changes</h4> <p class="svelte-115f3km"><b class="svelte-115f3km"> Typo Settings</b><br class="svelte-115f3km"/>
    Typo settings are now located directly on skribbl (read the quick-start-guide ;) instead of the extension popup menu.<br class="svelte-115f3km"/>
    You can customize everything that you&#39;re used to from the popup menu, now found in the respective feature dialog.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Typo Pen Pressure</b><br class="svelte-115f3km"/>
    Typo pressure has now an improved adjustment system which allows more precise control.<br class="svelte-115f3km"/>
    You will notice that your previous setting has been reset.<br class="svelte-115f3km"/>
    To adjust the sensitivity, go to the &quot;Typo Settings&quot;, choose the &quot;Pressure&quot; feature, and adjust the sliders to your liking.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Lobby Privacy</b><br class="svelte-115f3km"/>
    Instead of the lock icon at the very left side, a connection icon is displayed at the top-right corner of the chat.<br class="svelte-115f3km"/>
    An icon with a checkmark means that the lobby has privacy settings active (not visible to everyone).<br class="svelte-115f3km"/>
    If you&#39;re the lobby owner (first Typo player to join), you can change lobby settings there.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Filter Search</b><br class="svelte-115f3km"/>
    To start a lobby search with filters, you need to use the &quot;Start Search&quot; button in the &quot;Filters&quot; tab on the home screen.<br class="svelte-115f3km"/>
    Clicking &quot;Play&quot; will always just join the next public/private lobby.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Chat Commands</b><br class="svelte-115f3km"/>
    Chat commands received a massive facelift!<br class="svelte-115f3km"/>
    To start using commands, type a &quot;/&quot; in the chat box. <br class="svelte-115f3km"/>
    A popout with available commands will open; you can continue typing the command and arguments and submit the command with &quot;Enter&quot;.<br class="svelte-115f3km"/>
    You can also customize the &quot;/&quot; prefix to another character in the settings of the &quot;Chat Commands&quot; feature.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> QuickReact and Hotkeys</b><br class="svelte-115f3km"/>
    Hotkeys are now individually customizable for every feature and have changed here and there.<br class="svelte-115f3km"/>
    As an example, QuickReact now uses the right-hand side Ctrl key, exclusively.<br class="svelte-115f3km"/>
    To change hotkeys for any feature or check the current configuration, open its feature settings.<br class="svelte-115f3km"/>
    Hotkeys can also consist of combinations.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Zoom Drawing</b><br class="svelte-115f3km"/>
    Zooming still uses the Ctrl hotkey, but now starts immediately at the last cursor position without clicking on the canvas.<br class="svelte-115f3km"/>
    To exit zoom, click Ctrl again.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Custom Colors</b><br class="svelte-115f3km"/>
    When you use custom colors in public lobbies, Typo will now show the closest skribbl color for non-Typo users.<br class="svelte-115f3km"/>
    It is still recommended that you use custom colors only in lobbies with Typo players, because fill behavior might appear differently for non-Typo-users.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Practice Lobby</b><br class="svelte-115f3km"/>
    Instead of clicking your avatar on the home screen, you can enter the offline free draw mode using the palette icon next to your avatar.<br class="svelte-115f3km"/></p> <p class="svelte-115f3km"><b class="svelte-115f3km"> Drop Catch Reports</b><br class="svelte-115f3km"/>
    When someone catches drops suspiciously fast, you could report the catch by revealing the drop ID in the drop message.<br class="svelte-115f3km"/>
    To report drops in the new Typo, open the &quot;Drops&quot; feature in the Typo setting, where you will find a log of all drop catches.<br class="svelte-115f3km"/>
    To report a drop, you can copy its ID and the catch time and send it on the Typo discord server.<br class="svelte-115f3km"/></p>`,_(e,"class","svelte-115f3km");},m(i,o){k(i,e,o),k(i,t,o),k(i,n,o);},p:j,i:j,o:j,d(i){i&&(A(e),A(t),A(n));}}}c(Xz,"create_fragment$x");const l0=class l0 extends se{constructor(e){super(),le(this,e,null,Xz,re,{});}};c(l0,"Old_typo_onboarding");let sg=l0;function qz(r){let e,t,n;return {c(){e=v("h3"),e.textContent="Credits & Imprint",t=C(),n=v("div"),n.innerHTML=`<p class="svelte-1d2n9p6">Glad to see you using Typo!<br/><br/>
    This extension grew with me and my coding skills over the years from a small script to a complex project.<br/>
    The awesome skribbl.io community (&amp; game ;) was my main drive to keep improving adding more and more features.<br/>
    Thanks so much to every user, beta tester and developer for making this passion of mine more than a hobby.<br/></p> <h4 class="svelte-1d2n9p6">Helpful links</h4> <ul class="svelte-1d2n9p6"><li><a href="https://typo.rip" class="svelte-1d2n9p6">typo.rip</a> - The official website with a bunch of tools and infos</li> <li><a href="https://discord.com/invite/pAapmUmWAM" class="svelte-1d2n9p6">Discord</a> - Join the community, talk about Typo &amp; skribbl or ask for feature support</li> <li><a href="https://www.patreon.com/skribbltypo" class="svelte-1d2n9p6">Patreon</a> - Feed the developer </li> <li><a href="https://github.com/toobeeh/skribbltypo" class="svelte-1d2n9p6">GitHub</a> - Contribute to the project, view the sourcecode or report issues &amp; improvements</li></ul> <h4 class="svelte-1d2n9p6">Legal stuff &amp; rules</h4> <ul class="svelte-1d2n9p6"><li><a href="https://typo.rip/privacy" class="svelte-1d2n9p6">Privacy Policy</a> - How Typo handles your data</li> <li><a href="https://typo.rip/help/rules" class="svelte-1d2n9p6">Rules &amp; Fair Play</a> - How to behave using Typo</li> <li>I prefer to stay anonymous though :] - enjoy, tobeh</li></ul>`,_(e,"class","svelte-1d2n9p6");},m(i,o){k(i,e,o),k(i,t,o),k(i,n,o);},p:j,i:j,o:j,d(i){i&&(A(e),A(t),A(n));}}}c(qz,"create_fragment$w");const c0=class c0 extends se{constructor(e){super(),le(this,e,null,qz,re,{});}};c(c0,"Typo_credits_onboarding");let ag=c0;function KC(r,e,t){const n=r.slice();return n[30]=e[t],n}c(KC,"get_each_context$j");function eI(r,e,t){const n=r.slice();return n[34]=e[t],n}c(eI,"get_each_context_1$6");function tI(r,e,t){const n=r.slice();return n[34]=e[t],n}c(tI,"get_each_context_2$3");function nI(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w;return {c(){e=v("p"),e.innerHTML=`To customize your experience, you can select from a variety of feature presets below.<br/>
      You can always activate, deactivate, or customize features in the settings (the wrench icon), or come back to this page (magic wand icon).`,t=C(),n=v("br"),i=C(),o=v("div"),s=v("div"),s.innerHTML="<h3>Recommended</h3> <div>A set of the most popular typo features that will enhance your skribbl.io experience.</div>",a=C(),l=v("div"),l.innerHTML="<h3>Phone</h3> <div>Activates only features that will - probably - work on mobile devices. Limited support!</div>",u=C(),d=v("div"),d.innerHTML="<h3>Minimal</h3> <div>Skribbl looks as close to original as possible, but essential features are still present.</div>",h=C(),p=v("div"),p.innerHTML="<h3>Everything</h3> <div>The full package; all nifty tools that Typo has to offer!</div>",m=C(),b=v("div"),b.innerHTML="<h3>Nothing</h3> <div>Vanilla skribbl.io experience. You will only notice the settings button.</div>",H(e,"text-align","center"),_(s,"class","typo-onboarding-preset svelte-bu1e3"),_(l,"class","typo-onboarding-preset svelte-bu1e3"),_(d,"class","typo-onboarding-preset svelte-bu1e3"),_(p,"class","typo-onboarding-preset svelte-bu1e3"),_(b,"class","typo-onboarding-preset svelte-bu1e3"),_(o,"class","typo-onboarding-presets svelte-bu1e3");},m(I,S){k(I,e,S),k(I,t,S),k(I,n,S),k(I,i,S),k(I,o,S),g(o,s),g(o,a),g(o,l),g(o,u),g(o,d),g(o,h),g(o,p),g(o,m),g(o,b),y||(w=[F(s,"click",r[16]),F(l,"click",r[17]),F(d,"click",r[18]),F(p,"click",r[19]),F(b,"click",r[20])],y=!0);},p:j,d(I){I&&(A(e),A(t),A(n),A(i),A(o)),y=!1,Je(w);}}}c(nI,"create_if_block_4$1");function iI(r){let e,t,n,i={ctx:r,current:null,token:null,hasCatch:!1,pending:oU,then:eU,catch:Kz,value:33,blocks:[,,,]};return $n(t=r[0].getChecklist(),i),{c(){e=je(),i.block.c();},m(o,s){k(o,e,s),i.block.m(o,i.anchor=s),i.mount=()=>e.parentNode,i.anchor=e,n=!0;},p(o,s){r=o,i.ctx=r,s[0]&1&&t!==(t=r[0].getChecklist())&&$n(t,i)||To(i,r,s);},i(o){n||(T(i.block),n=!0);},o(o){for(let s=0;s<3;s+=1){const a=i.blocks[s];M(a);}n=!1;},d(o){o&&A(e),i.block.d(o),i.token=null,i=null;}}}c(iI,"create_if_block_1$5");function Kz(r){return {c:j,m:j,p:j,i:j,o:j,d:j}}c(Kz,"create_catch_block$1");function eU(r){let e,t,n,i,o,s;function a(b,y){return y[0]&1&&(e=null),e==null&&(e=!!b[33].every(aU)),e?nU:tU}c(a,"select_block_type");let l=a(r,[-1,-1]),u=l(r),d=te(r[33].filter(lI)),h=[];for(let b=0;b<d.length;b+=1)h[b]=rI(tI(r,d,b));let p=te(r[33].filter(cI)),m=[];for(let b=0;b<p.length;b+=1)m[b]=oI(eI(r,p,b));return {c(){u.c(),t=C(),n=v("div"),i=v("div");for(let b=0;b<h.length;b+=1)h[b].c();o=C(),s=v("div");for(let b=0;b<m.length;b+=1)m[b].c();_(i,"class","typo-onboarding-checklist svelte-bu1e3"),_(s,"class","typo-onboarding-checklist svelte-bu1e3"),_(n,"class","typo-onboarding-checklist-wrapper svelte-bu1e3");},m(b,y){u.m(b,y),k(b,t,y),k(b,n,y),g(n,i);for(let w=0;w<h.length;w+=1)h[w]&&h[w].m(i,null);g(n,o),g(n,s);for(let w=0;w<m.length;w+=1)m[w]&&m[w].m(s,null);},p(b,y){if(l!==(l=a(b,y))&&(u.d(1),u=l(b),u&&(u.c(),u.m(t.parentNode,t))),y[0]&1){d=te(b[33].filter(lI));let w;for(w=0;w<d.length;w+=1){const I=tI(b,d,w);h[w]?h[w].p(I,y):(h[w]=rI(I),h[w].c(),h[w].m(i,null));}for(;w<h.length;w+=1)h[w].d(1);h.length=d.length;}if(y[0]&1){p=te(b[33].filter(cI));let w;for(w=0;w<p.length;w+=1){const I=eI(b,p,w);m[w]?m[w].p(I,y):(m[w]=oI(I),m[w].c(),m[w].m(s,null));}for(;w<m.length;w+=1)m[w].d(1);m.length=p.length;}},i:j,o:j,d(b){b&&(A(t),A(n)),u.d(b),Ie(h,b),Ie(m,b);}}}c(eU,"create_then_block$1");function tU(r){let e;return {c(){e=v("span"),e.textContent="You can complete following tasks to familiarize yourself with Typo:";},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(tU,"create_else_block_1");function nU(r){let e;return {c(){e=v("span"),e.textContent="Congrats, you have completed all tasks!";},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(nU,"create_if_block_3$1");function rI(r){let e,t,n=r[34].name+"",i,o,s,a,l,u,d,h=r[34].description+"",p,m,b,y;function w(){return r[21](r[34])}return c(w,"click_handler_9"),{c(){e=v("div"),t=v("h4"),i=G(n),o=C(),s=v("div"),a=v("img"),u=C(),d=v("div"),p=G(h),m=C(),ht(a.src,l="")||_(a,"src",l),H(a,"content","var(--file-img-arrow-right-gif)"),H(a,"height","1.5rem"),_(d,"class","description svelte-bu1e3"),_(s,"class","details svelte-bu1e3"),_(e,"class","typo-onboarding-task svelte-bu1e3"),H(e,"order",r[34].priority);},m(I,S){k(I,e,S),g(e,t),g(t,i),g(e,o),g(e,s),g(s,a),g(s,u),g(s,d),g(d,p),g(e,m),b||(y=F(e,"click",w),b=!0);},p(I,S){r=I,S[0]&1&&n!==(n=r[34].name+"")&&K(i,n),S[0]&1&&h!==(h=r[34].description+"")&&K(p,h),S[0]&1&&H(e,"order",r[34].priority);},d(I){I&&A(e),b=!1,y();}}}c(rI,"create_each_block_2$3");function iU(r){let e,t;return {c(){e=v("img"),ht(e.src,t="")||_(e,"src",t),H(e,"content","var(--file-img-arrow-right-gif)"),H(e,"height","1.5rem");},m(n,i){k(n,e,i);},d(n){n&&A(e);}}}c(iU,"create_else_block$7");function rU(r){let e,t,n,i;return {c(){e=v("img"),n=C(),i=v("b"),i.textContent="Done",ht(e.src,t="")||_(e,"src",t),H(e,"content","var(--file-img-enabled-gif)"),H(e,"height","1.5rem");},m(o,s){k(o,e,s),k(o,n,s),k(o,i,s);},d(o){o&&(A(e),A(n),A(i));}}}c(rU,"create_if_block_2$3");function oI(r){let e,t,n=r[34].name+"",i,o,s,a,l,u=r[34].description+"",d,h;function p(y,w){return y[34].completed?rU:iU}c(p,"select_block_type_1");let m=p(r),b=m(r);return {c(){e=v("div"),t=v("h4"),i=G(n),o=C(),s=v("div"),b.c(),a=C(),l=v("div"),d=G(u),h=C(),_(l,"class","description svelte-bu1e3"),_(s,"class","details svelte-bu1e3"),_(e,"class","typo-onboarding-task done svelte-bu1e3"),H(e,"order",r[34].priority);},m(y,w){k(y,e,w),g(e,t),g(t,i),g(e,o),g(e,s),b.m(s,null),g(s,a),g(s,l),g(l,d),g(e,h);},p(y,w){w[0]&1&&n!==(n=y[34].name+"")&&K(i,n),m!==(m=p(y))&&(b.d(1),b=m(y),b&&(b.c(),b.m(s,a))),w[0]&1&&u!==(u=y[34].description+"")&&K(d,u),w[0]&1&&H(e,"order",y[34].priority);},d(y){y&&A(e),b.d();}}}c(oI,"create_each_block_1$6");function oU(r){let e,t;return e=new Yn({props:{content:"Loading checklist.."}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(oU,"create_pending_block$1");function sI(r){let e,t,n,i,o,s,a=te(r[9]),l=[];for(let h=0;h<a.length;h+=1)l[h]=aI(KC(r,a,h));var u=r[6].component;function d(h,p){return {}}return c(d,"switch_props"),u&&(o=qe(u,d())),{c(){e=v("div"),t=v("div");for(let h=0;h<l.length;h+=1)l[h].c();n=C(),i=v("div"),o&&V(o.$$.fragment),_(t,"class","typo-onboarding-extras-sections svelte-bu1e3"),_(i,"class","typo-onboarding-extras-content svelte-bu1e3"),_(e,"class","typo-onboarding-extras svelte-bu1e3");},m(h,p){k(h,e,p),g(e,t);for(let m=0;m<l.length;m+=1)l[m]&&l[m].m(t,null);g(e,n),g(e,i),o&&x(o,i,null),s=!0;},p(h,p){if(p[0]&576){a=te(h[9]);let m;for(m=0;m<a.length;m+=1){const b=KC(h,a,m);l[m]?l[m].p(b,p):(l[m]=aI(b),l[m].c(),l[m].m(t,null));}for(;m<l.length;m+=1)l[m].d(1);l.length=a.length;}if(p[0]&64&&u!==(u=h[6].component)){if(o){fe();const m=o;M(m.$$.fragment,1,0,()=>{Z(m,1);}),pe();}u?(o=qe(u,d()),V(o.$$.fragment),T(o.$$.fragment,1),x(o,i,null)):o=null;}},i(h){s||(o&&T(o.$$.fragment,h),s=!0);},o(h){o&&M(o.$$.fragment,h),s=!1;},d(h){h&&A(e),Ie(l,h),o&&Z(o);}}}c(sI,"create_if_block$f");function aI(r){let e,t,n;function i(){return r[22](r[30])}return c(i,"click_handler_10"),{c(){e=v("b"),e.textContent=`${r[30].name}`,_(e,"class","svelte-bu1e3"),ue(e,"active",r[6]===r[30]);},m(o,s){k(o,e,s),t||(n=F(e,"click",i),t=!0);},p(o,s){r=o,s[0]&576&&ue(e,"active",r[6]===r[30]);},d(o){o&&A(e),t=!1,n();}}}c(aI,"create_each_block$j");function sU(r){let e,t,n,i,o=r[1]?"Welcome to":"Thanks for using",s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N,Y=r[4]==="presets"&&nI(r),ee=r[4]==="tasks"&&iI(r),B=r[4]==="extras"&&sI(r);return {c(){e=v("div"),t=v("div"),n=v("div"),i=v("h2"),s=G(o),a=G(" typo "),l=C(),u=v("b"),u.textContent="Typo is the toolbox for everything you need on skribbl.io",d=C(),h=v("div"),h.innerHTML="XOXO to all beta testers &lt;3<br/>Alpha, Foley, Hex, hunt3r, ibot, Max, Oivoo, shawty, Tuc, ShortM, XVIdevilIVX",m=C(),b=v("div"),y=v("h4"),y.textContent="Feature Presets",w=C(),I=v("h4"),I.textContent="Onboarding Tasks",S=C(),R=v("h4"),R.textContent="More Info",E=C(),P=v("br"),L=C(),Y&&Y.c(),O=C(),ee&&ee.c(),z=C(),B&&B.c(),_(n,"class","svelte-bu1e3"),_(h,"class","beta-credits svelte-bu1e3"),_(t,"class",p="typo-onboarding-hero "+(r[5]?"hidden":"")+" svelte-bu1e3"),_(y,"class","svelte-bu1e3"),ue(y,"active",r[4]==="presets"),_(I,"class","svelte-bu1e3"),ue(I,"active",r[4]==="tasks"),_(R,"class","svelte-bu1e3"),ue(R,"active",r[4]==="extras"),_(b,"class","onboarding-tabs svelte-bu1e3"),_(e,"class","typo-onboarding-wrapper color-scrollbar svelte-bu1e3");},m(J,q){k(J,e,q),g(e,t),g(t,n),g(n,i),g(i,s),g(i,a),g(n,l),g(n,u),r[10](n),g(t,d),g(t,h),r[11](t),g(e,m),g(e,b),g(b,y),g(b,w),g(b,I),g(b,S),g(b,R),g(e,E),g(e,P),g(e,L),Y&&Y.m(e,null),g(e,O),ee&&ee.m(e,null),g(e,z),B&&B.m(e,null),$=!0,U||(N=[F(t,"click",r[12]),F(y,"click",r[13]),F(I,"click",r[14]),F(R,"click",r[15])],U=!0);},p(J,q){(!$||q[0]&2)&&o!==(o=J[1]?"Welcome to":"Thanks for using")&&K(s,o),(!$||q[0]&32&&p!==(p="typo-onboarding-hero "+(J[5]?"hidden":"")+" svelte-bu1e3"))&&_(t,"class",p),(!$||q[0]&16)&&ue(y,"active",J[4]==="presets"),(!$||q[0]&16)&&ue(I,"active",J[4]==="tasks"),(!$||q[0]&16)&&ue(R,"active",J[4]==="extras"),J[4]==="presets"?Y?Y.p(J,q):(Y=nI(J),Y.c(),Y.m(e,O)):Y&&(Y.d(1),Y=null),J[4]==="tasks"?ee?(ee.p(J,q),q[0]&16&&T(ee,1)):(ee=iI(J),ee.c(),T(ee,1),ee.m(e,z)):ee&&(fe(),M(ee,1,1,()=>{ee=null;}),pe()),J[4]==="extras"?B?(B.p(J,q),q[0]&16&&T(B,1)):(B=sI(J),B.c(),T(B,1),B.m(e,null)):B&&(fe(),M(B,1,1,()=>{B=null;}),pe());},i(J){$||(T(ee),T(B),$=!0);},o(J){M(ee),M(B),$=!1;},d(J){J&&A(e),r[10](null),r[11](null),Y&&Y.d(),ee&&ee.d(),B&&B.d(),U=!1,Je(N);}}}c(sU,"create_fragment$v");const aU=c(r=>r.completed,"func$2"),lI=c(r=>!r.completed,"func_1"),cI=c(r=>r.completed,"func_2$1");function lU(r,e,t){let{feature:n}=e,{firstLoad:i}=e,o,s,l=["file-img-challenge-gif","file-img-light-gif","file-img-letter-gif","file-img-line-rainbow-gif","file-img-cloud-gif","file-img-award-gif","file-img-wand-gif","file-img-wrench-gif","file-img-floppy-drive-gif","file-img-palantir-gif","file-img-mask-gif","file-img-palette-gif","file-img-typo-gif","file-img-trash-gif","file-img-line-random-color-gif","file-img-discord-gif","file-img-connection-gif","file-img-tasks-gif","file-img-coin-gif"].sort(()=>Math.random()-.5),u=0,d=[],h;const p=c(()=>{const Q=l[u];u=(u+1)%l.length;const X=o.getBoundingClientRect(),ne=s.getBoundingClientRect(),W=ne.width+50,he=ne.height+50;let Pe=X.width/2,me=X.height/2,Ae=0;for(;Pe>(X.width-W)/2&&Pe<X.width/2+W&&me>(X.height-he)/2&&me<X.height/2+he||d.some(xe=>!xe.hasEnoughDistance(Pe,me));){if(Ae++>20)return;Pe=Math.random()*X.width,me=Math.random()*X.height;}const Dt=new og({target:o,props:{x:Pe,y:me,src:Q}});d.push(Dt),setTimeout(()=>{Dt.$destroy(),d=d.filter(xe=>xe!==Dt);},3e3);},"addIcon"),m=c(Q=>{n.activateFeaturePreset(Q),i?I("tasks"):n.closeOnboardingIfOpen();},"activateFeaturePreset");let b=i?"presets":"tasks";n.tabFocusRequestsStore.subscribe(Q=>{Q!==void 0&&I(Q);});let w=!1;const I=c(Q=>{t(5,w=!0),t(4,b=Q),d.forEach(X=>X.$destroy()),Q==="extras"&&n.completeInfoTask();},"useTab");let S=[{name:"Introducing the new Typo",component:sg},{name:"Credits & Imprint",component:ag}],R=S[0];li(()=>{h=setInterval(()=>{p();},250);for(let Q=0;Q<5;Q++)p();}),vh(()=>{clearInterval(h);});function E(Q){Ve[Q?"unshift":"push"](()=>{s=Q,t(3,s);});}c(E,"div0_binding");function P(Q){Ve[Q?"unshift":"push"](()=>{o=Q,t(2,o);});}c(P,"div2_binding");const L=c(()=>I(b),"click_handler"),O=c(()=>I("presets"),"click_handler_1"),z=c(()=>I("tasks"),"click_handler_2"),$=c(()=>I("extras"),"click_handler_3"),U=c(()=>m("recommended"),"click_handler_4"),N=c(()=>m("mobile"),"click_handler_5"),Y=c(()=>m("minimal"),"click_handler_6"),ee=c(()=>m("all"),"click_handler_7"),B=c(()=>m("none"),"click_handler_8"),J=c(async Q=>{await Q.start()!==!1&&n.closeOnboardingIfOpen();},"click_handler_9"),q=c(Q=>t(6,R=Q),"click_handler_10");return r.$$set=Q=>{"feature"in Q&&t(0,n=Q.feature),"firstLoad"in Q&&t(1,i=Q.firstLoad);},[n,i,o,s,b,w,R,m,I,S,E,P,L,O,z,$,U,N,Y,ee,B,J,q]}c(lU,"instance$u");const u0=class u0 extends se{constructor(e){super(),le(this,e,lU,sU,re,{feature:0,firstLoad:1},null,[-1,-1]);}};c(u0,"Controls_onboarding");let lg=u0;var cU=Object.defineProperty,zh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&cU(e,t,i),i},"__decorateClass$v"),kr;const Nu=(kr=class extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_modalService");f(this,"_featuresService");f(this,"_toastService");f(this,"name","Get Started");f(this,"description","Quickly set up typo to your likes");f(this,"tags",[ye.INTERFACE,ye.INFORMATION]);f(this,"featureId",47);f(this,"_firstLoadSetting",new He("first_load",!0,this));f(this,"_finishOnboardingTask",this.useOnboardingTask({key:"finalize_onboarding",name:"Finish Onboarding",description:"Choose whether to disable 'Get Started'. This should be your last task! ;)",start:c(()=>this.finalizeOnboarding(),"start"),priority:Number.MAX_SAFE_INTEGER}));f(this,"_viewInfoTask",this.useOnboardingTask({key:"info_opened",name:"Read about the new typo",description:"Open the 'more info' tab to read an intro and changes of the new typo.",start:c(async()=>(this._tabFocusRequests$.next("extras"),!1),"start"),priority:1}));f(this,"_featurePresets",{recommended:{mode:"blacklist",features:[Cl,bi,bo,dl]},minimal:{mode:"whitelist",features:[ao,Pr,_i,Fn,dr,hr,Kd,$i,Yi,ul,Cl,Nr,bi,pr,cl,fo,ll,vi,so,cu,pl,Mr,kr,bu]},none:{mode:"whitelist",features:[]},all:{mode:"blacklist",features:[]},mobile:{mode:"whitelist",features:[_i,dr,hr,Nr,fo,so,pl,Mr,kr,bu,gi,gr,mr,zi,kl,Or,Lr,iu]}});f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_currentModal");f(this,"_taskCompletedSubscription");f(this,"_tabFocusRequests$",new be);}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.controls,props:{hoverMove:!1,size:"48px",icon:"file-img-tasks-gif",name:"Get Started",order:4,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{this.showOnboarding();}),await this._firstLoadSetting.getValue()&&(this.showOnboarding(!0),await this._firstLoadSetting.setValue(!1)),this._taskCompletedSubscription=this._onboardingService.taskCompleted$.subscribe(i=>{this._toastService.showToast(" Congrats!",`You have completed the onboarding task "${i.name}"!`);});}async onDestroy(){var t,n,i;(t=this._iconComponent)==null||t.$destroy(),(n=this._iconClickSubscription)==null||n.unsubscribe(),this._iconClickSubscription=void 0,(i=this._taskCompletedSubscription)==null||i.unsubscribe(),this._taskCompletedSubscription=void 0;}get tabFocusRequestsStore(){return it(this._tabFocusRequests$,void 0)}showOnboarding(t=!1){var i;(i=this._currentModal)==null||i.close();const n={componentType:lg,props:{feature:this,firstLoad:t}};this._currentModal=this._modalService.showModal(n.componentType,n.props,t?"":"Get Started");}async activateFeaturePreset(t){this._logger.debug("Activating preset",t);const n=await this._toastService.showLoadingToast("Activating preset..."),i=this._featurePresets[t],o=this._featuresService.features,s=i.mode==="blacklist"?o.filter(l=>!l.toggleEnabled||!i.features.some(u=>l instanceof u)):o.filter(l=>!l.toggleEnabled||i.features.some(u=>l instanceof u)),a=o.map(async l=>{const u=await Ee(l.activated$),d=s.includes(l);u&&!d&&await l.destroy(),!u&&d&&await l.activate();});try{await Promise.all(a),n.resolve("Preset activated");}catch(l){this._logger.error("Failed to activate preset",l),n.reject("Failed to activate preset");return}}async getChecklist(){return this._onboardingService.getOnboardingTasks()}closeOnboardingIfOpen(){var t;(t=this._currentModal)==null||t.close();}async finalizeOnboarding(){const t=await this._finishOnboardingTask,i=(await this._onboardingService.getOnboardingTasks()).every(u=>u.completed||u.key===t.task.key),o=i?" You have completed all onboarding tasks!":"Not all tasks completed yet!",s=i?`Do you want to remove the onboarding icon?
You can always enable it again in the settings to read guides or select presets.`:`You have not completed all onboarding tasks yet.
Do you still want to disable onboarding?
You can always enable it again in the settings to read guides or select presets.`,l=await(await this._toastService.showConfirmToast(o,s,3e4,{confirm:"Disable onboarding",cancel:"Keep enabled"})).result;return i&&t.complete(),l&&this.destroy(),!1}async completeInfoTask(){(await this._viewInfoTask).complete();}},c(kr,"_ControlsOnboardingFeature"),kr);zh([D(Me)],Nu.prototype,"_elementsSetup");zh([D(Dn)],Nu.prototype,"_modalService");zh([D(uo)],Nu.prototype,"_featuresService");zh([D(ft)],Nu.prototype,"_toastService");let uU=Nu;function uI(r,e,t){const n=r.slice();return n[6]=e[t],n}c(uI,"get_each_context$i");function dU(r){return {c:j,m:j,p:j,i:j,o:j,d:j}}c(dU,"create_catch_block");function hU(r){let e,t,n,i,o,s,a,l,u=te(r[5]),d=[];for(let p=0;p<u.length;p+=1)d[p]=dI(uI(r,u,p));const h=c(p=>M(d[p],1,1,()=>{d[p]=null;}),"out");return {c(){e=v("h3"),e.textContent="Saved Profiles",t=C(),n=v("p"),n.innerHTML=`Typo profiles let you save and switch the entire data of typo.<br/>
    Switching to a profile or deleting a profile will reload the page.`,i=C(),o=v("br"),s=C(),a=v("div");for(let p=0;p<d.length;p+=1)d[p].c();_(a,"class","typo-profiles svelte-16buojm");},m(p,m){k(p,e,m),k(p,t,m),k(p,n,m),k(p,i,m),k(p,o,m),k(p,s,m),k(p,a,m);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(a,null);l=!0;},p(p,m){if(m&1){u=te(p[5]);let b;for(b=0;b<u.length;b+=1){const y=uI(p,u,b);d[b]?(d[b].p(y,m),T(d[b],1)):(d[b]=dI(y),d[b].c(),T(d[b],1),d[b].m(a,null));}for(fe(),b=u.length;b<d.length;b+=1)h(b);pe();}},i(p){if(!l){for(let m=0;m<u.length;m+=1)T(d[m]);l=!0;}},o(p){d=d.filter(Boolean);for(let m=0;m<d.length;m+=1)M(d[m]);l=!1;},d(p){p&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a)),Ie(d,p);}}}c(hU,"create_then_block");function dI(r){let e,t,n=r[6].name+"",i,o,s,a,l,u,d;function h(...m){return r[1](r[6],...m)}c(h,"click_handler"),s=new st({props:{size:"1.5rem",icon:r[6].active?"file-img-enabled-gif":"file-img-trash-gif",name:"Delete",hoverMove:!1,greyscaleInactive:!0}}),s.$on("click",h);function p(){return r[2](r[6])}return c(p,"click_handler_1"),{c(){e=v("div"),t=v("span"),i=G(n),o=C(),V(s.$$.fragment),a=C(),_(e,"class","typo-profile svelte-16buojm"),ue(e,"active",r[6].active);},m(m,b){k(m,e,b),g(e,t),g(t,i),g(e,o),x(s,e,null),g(e,a),l=!0,u||(d=F(e,"click",p),u=!0);},p(m,b){r=m,(!l||b&1)&&n!==(n=r[6].name+"")&&K(i,n);const y={};b&1&&(y.icon=r[6].active?"file-img-enabled-gif":"file-img-trash-gif"),s.$set(y),(!l||b&1)&&ue(e,"active",r[6].active);},i(m){l||(T(s.$$.fragment,m),l=!0);},o(m){M(s.$$.fragment,m),l=!1;},d(m){m&&A(e),Z(s),u=!1,d();}}}c(dI,"create_each_block$i");function fU(r){let e,t;return e=new Yn({props:{content:"Loading Profiles"}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(fU,"create_pending_block");function pU(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$={ctx:r,current:null,token:null,hasCatch:!1,pending:fU,then:hU,catch:dU,value:5,blocks:[,,,]};return $n(e=r[0].getProfiles(),$),h=new ke({props:{content:"Create profile",color:"green"}}),h.$on("click",r[3]),O=new ke({props:{content:"Reset typo",color:"orange"}}),O.$on("click",r[4]),{c(){$.block.c(),t=C(),n=v("br"),i=C(),o=v("h3"),o.textContent="Create new profile",s=C(),a=v("p"),a.innerHTML=`A new empty profile will be added.<br/>
  This will reload the page.`,l=C(),u=v("br"),d=C(),V(h.$$.fragment),p=C(),m=v("br"),b=C(),y=v("br"),w=C(),I=v("h3"),I.textContent="Reset typo",S=C(),R=v("p"),R.innerHTML=`Resetting typo will erase all data. Typo will behave like after a fresh installation.<br/>
  This is irreversible and will reload the page.`,E=C(),P=v("br"),L=C(),V(O.$$.fragment);},m(U,N){$.block.m(U,$.anchor=N),$.mount=()=>t.parentNode,$.anchor=t,k(U,t,N),k(U,n,N),k(U,i,N),k(U,o,N),k(U,s,N),k(U,a,N),k(U,l,N),k(U,u,N),k(U,d,N),x(h,U,N),k(U,p,N),k(U,m,N),k(U,b,N),k(U,y,N),k(U,w,N),k(U,I,N),k(U,S,N),k(U,R,N),k(U,E,N),k(U,P,N),k(U,L,N),x(O,U,N),z=!0;},p(U,[N]){r=U,$.ctx=r,N&1&&e!==(e=r[0].getProfiles())&&$n(e,$)||To($,r,N);},i(U){z||(T($.block),T(h.$$.fragment,U),T(O.$$.fragment,U),z=!0);},o(U){for(let N=0;N<3;N+=1){const Y=$.blocks[N];M(Y);}M(h.$$.fragment,U),M(O.$$.fragment,U),z=!1;},d(U){U&&(A(t),A(n),A(i),A(o),A(s),A(a),A(l),A(u),A(d),A(p),A(m),A(b),A(y),A(w),A(I),A(S),A(R),A(E),A(P),A(L)),$.block.d(U),$.token=null,$=null,Z(h,U),Z(O,U);}}}c(pU,"create_fragment$u");function mU(r,e,t){let{feature:n}=e;const i=c((l,u)=>{u.stopImmediatePropagation(),l.active||n.deleteProfile(l.name);},"click_handler"),o=c(l=>{l.active||n.switchToProfile(l.name);},"click_handler_1"),s=c(()=>n.createProfile(),"click_handler_2"),a=c(()=>n.resetTypo(),"click_handler_3");return r.$$set=l=>{"feature"in l&&t(0,n=l.feature);},[n,i,o,s,a]}c(mU,"instance$t");const d0=class d0 extends se{constructor(e){super(),le(this,e,mU,pU,re,{feature:0});}};c(d0,"Controls_profiles");let cg=d0;var gU=Object.defineProperty,PE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&gU(e,t,i),i},"__decorateClass$u");const h0=class h0 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_toastService");f(this,"name","Typo Profiles");f(this,"description","Switch between different typo profiles.");f(this,"tags",[ye.DEVELOPMENT]);f(this,"featureId",48);f(this,"toggleEnabled",!1);}get featureManagementComponent(){return {componentType:cg,props:{feature:this}}}async getProfiles(){const t=await Jt.currentProfile();return (await Jt.getProfiles()).map(n=>({name:n,active:n===t}))}async deleteProfile(t){const n=await Jt.currentProfile();if(t===n){this._logger.error("Cannot delete the current profile."),await this._toastService.showToast("Cannot delete the current profile "+t);return}await(await this._toastService.showConfirmToast(`Delete profile ${t}?`,"Deleting a profile will reload the page.",1e4,{confirm:"Delete profile",cancel:"Cancel deletion"})).result&&(await Jt.deleteProfile(t),window.location.reload());}async switchToProfile(t){await(await this._toastService.showConfirmToast(`Switch to profile ${t}?`,"Switching a profile will reload the page.",1e4,{confirm:"Switch now",cancel:"Cancel switch"})).result&&(await Jt.switchToProfile(t),window.location.reload());}async createProfile(){const n=await(await this._toastService.showPromptToast("Create and activate profile","Enter a name for the new profile")).result;if(n===null||n.length===0)return;if((await Jt.getProfiles()).includes(n)){this._logger.error("Profile already exists"),await this._toastService.showToast("Profile already exists","A profile with the name "+n+` already exists.
Please choose a different name.`);return}await Jt.createAndSwitchToProfile(n),window.location.reload();}async resetTypo(){await(await this._toastService.showConfirmToast("Reset Typo?","This will delete ALL saved data (themes, palettes, login, profiles, filters..) and reload the page.",1e4,{confirm:"Reset typo (think twice)",cancel:"Cancel reset (panic!)"})).result&&(await Jt.resetTypo(),window.location.reload());}};c(h0,"ControlsProfilesFeature");let vu=h0;PE([D(Me)],vu.prototype,"_elementsSetup");PE([D(ft)],vu.prototype,"_toastService");function hI(r){let e,t;return {c(){e=v("br"),t=v("span"),t.textContent="Disabled in text inputs",_(t,"class","inputs-disabled-hint svelte-10zlzgr");},m(n,i){k(n,e,i),k(n,t,i);},d(n){n&&(A(e),A(t));}}}c(hI,"create_if_block$e");function bU(r){let e,t,n=r[0].name+"",i,o,s,a=r[0].description+"",l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N=r[0].disabledOnInputs&&hI();p=new ke({props:{content:"Reset to default",color:"orange"}}),p.$on("click",r[9]),y=new ke({props:{content:"Save combo",color:"green"}}),y.$on("click",r[10]);function Y(B){r[11](B);}c(Y,"checkbox_checked_binding");let ee={disabled:r[2].length===0,description:r[5]?"Enabled":"Disabled"};return r[5]!==void 0&&(ee.checked=r[5]),S=new It({props:ee}),Ve.push(()=>bt(S,"checked",Y)),{c(){e=v("div"),t=v("h3"),i=G(n),o=C(),s=v("div"),l=G(a),u=C(),N&&N.c(),d=C(),h=v("div"),V(p.$$.fragment),m=C(),b=v("div"),V(y.$$.fragment),w=C(),I=v("div"),V(S.$$.fragment),E=C(),P=v("div"),L=v("input"),_(h,"class","button-container svelte-10zlzgr"),_(b,"class","button-container svelte-10zlzgr"),L.value=O=r[4].join(" + "),_(L,"type","text"),_(L,"placeholder","Press Keys"),H(P,"grid-column","2 / span 3"),_(e,"class","typo-feature-settings-hotkey svelte-10zlzgr");},m(B,J){k(B,e,J),g(e,t),g(t,i),g(e,o),g(e,s),g(s,l),g(s,u),N&&N.m(s,null),g(e,d),g(e,h),x(p,h,null),g(e,m),g(e,b),x(y,b,null),g(e,w),g(e,I),x(S,I,null),g(e,E),g(e,P),g(P,L),r[12](L),z=!0,$||(U=[F(L,"click",r[13]),F(L,"keydown",r[14])],$=!0);},p(B,[J]){(!z||J&1)&&n!==(n=B[0].name+"")&&K(i,n),(!z||J&1)&&a!==(a=B[0].description+"")&&K(l,a),B[0].disabledOnInputs?N||(N=hI(),N.c(),N.m(s,null)):N&&(N.d(1),N=null);const q={};J&4&&(q.disabled=B[2].length===0),J&32&&(q.description=B[5]?"Enabled":"Disabled"),!R&&J&32&&(R=!0,q.checked=B[5],gt(()=>R=!1)),S.$set(q),(!z||J&16&&O!==(O=B[4].join(" + "))&&L.value!==O)&&(L.value=O);},i(B){z||(T(p.$$.fragment,B),T(y.$$.fragment,B),T(S.$$.fragment,B),z=!0);},o(B){M(p.$$.fragment,B),M(y.$$.fragment,B),M(S.$$.fragment,B),z=!1;},d(B){B&&A(e),N&&N.d(),Z(p),Z(y),Z(S),r[12](null),$=!1,Je(U);}}}c(bU,"create_fragment$t");function vU(r,e,t){let n,i,{hotkey:o}=e,{feature:s}=e;const a=o.enabledSetting.store;De(r,a,S=>t(5,i=S));const l=o.comboSetting.store;De(r,l,S=>t(2,n=S));let u,d;const h=c(async S=>{var R;if((R=navigator==null?void 0:navigator.keyboard)!=null&&R.getLayoutMap){const E=await navigator.keyboard.getLayoutMap();return S.map(P=>E.get(P)||P).join(" + ")}else return S.join(" + ")},"getHotkeyComboHumanReadable"),p=c(async()=>{const S=await s.resetHotkeyCombo(o);S&&(t(4,d=S),t(3,u.value=await h(d),u));},"click_handler"),m=c(()=>{s.setHotkeyCombo(o,d),d.length>0&&gn(a,i=!0,i);},"click_handler_1");function b(S){i=S,a.set(i);}c(b,"checkbox_checked_binding");function y(S){Ve[S?"unshift":"push"](()=>{u=S,t(3,u);});}c(y,"input_binding");const w=c(()=>{t(4,d=[]),t(3,u.value="",u);},"click_handler_2"),I=c(async S=>{S.preventDefault(),d.includes(S.code)?(t(4,d=d.filter(R=>R!==S.code)),t(3,u.value=await h(d),u)):(d.push(S.code),t(3,u.value=await h(d),u));},"keydown_handler");return r.$$set=S=>{"hotkey"in S&&t(0,o=S.hotkey),"feature"in S&&t(1,s=S.feature);},r.$$.update=()=>{r.$$.dirty&4&&t(4,d=[...n]);},[o,s,n,u,d,i,a,l,h,p,m,b,y,w,I]}c(vU,"instance$s");const f0=class f0 extends se{constructor(e){super(),le(this,e,vU,bU,re,{hotkey:0,feature:1});}};c(f0,"Controls_settings_hotkey");let ug=f0;function _U(r){let e,t,n=r[0].name+"",i,o,s,a=r[0].description+"",l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z;h=new ke({props:{content:"Reset name",color:"orange"}}),h.$on("click",r[7]),b=new ke({props:{content:"Save name",color:"green"}}),b.$on("click",r[8]);function $(N){r[9](N);}c($,"checkbox_checked_binding");let U={description:r[3]?"Enabled":"Disabled"};return r[3]!==void 0&&(U.checked=r[3]),I=new It({props:U}),Ve.push(()=>bt(I,"checked",$)),{c(){e=v("div"),t=v("h3"),i=G(n),o=C(),s=v("div"),l=G(a),u=C(),d=v("div"),V(h.$$.fragment),p=C(),m=v("div"),V(b.$$.fragment),y=C(),w=v("div"),V(I.$$.fragment),R=C(),E=v("div"),P=v("input"),_(d,"class","button-container svelte-lvvgs4"),_(m,"class","button-container svelte-lvvgs4"),_(P,"type","text"),_(P,"placeholder","Enter command name"),H(E,"grid-column","2 / span 3"),_(e,"class","typo-feature-settings-command svelte-lvvgs4");},m(N,Y){k(N,e,Y),g(e,t),g(t,i),g(e,o),g(e,s),g(s,l),g(e,u),g(e,d),x(h,d,null),g(e,p),g(e,m),x(b,m,null),g(e,y),g(e,w),x(I,w,null),g(e,R),g(e,E),g(E,P),de(P,r[2]),L=!0,O||(z=F(P,"input",r[10]),O=!0);},p(N,[Y]){(!L||Y&1)&&n!==(n=N[0].name+"")&&K(i,n),(!L||Y&1)&&a!==(a=N[0].description+"")&&K(l,a);const ee={};Y&8&&(ee.description=N[3]?"Enabled":"Disabled"),!S&&Y&8&&(S=!0,ee.checked=N[3],gt(()=>S=!1)),I.$set(ee),Y&4&&P.value!==N[2]&&de(P,N[2]);},i(N){L||(T(h.$$.fragment,N),T(b.$$.fragment,N),T(I.$$.fragment,N),L=!0);},o(N){M(h.$$.fragment,N),M(b.$$.fragment,N),M(I.$$.fragment,N),L=!1;},d(N){N&&A(e),Z(h),Z(b),Z(I),O=!1,z();}}}c(_U,"create_fragment$s");function yU(r,e,t){let n,i,{command:o}=e,{feature:s}=e;const a=o.enabledSetting.store;De(r,a,b=>t(3,i=b));const l=o.idSetting.store;De(r,l,b=>t(1,n=b));let u="";const d=c(()=>{gn(l,n=o.defaultId,n);},"click_handler"),h=c(()=>{gn(l,n=u.length===0?o.defaultId:u,n);},"click_handler_1");function p(b){i=b,a.set(i);}c(p,"checkbox_checked_binding");function m(){u=this.value,t(2,u),t(1,n);}return c(m,"input_input_handler"),r.$$set=b=>{"command"in b&&t(0,o=b.command),"feature"in b&&t(6,s=b.feature);},r.$$.update=()=>{r.$$.dirty&2&&t(2,u=n);},[o,n,u,i,a,l,s,d,h,p,m]}c(yU,"instance$r");const p0=class p0 extends se{constructor(e){super(),le(this,e,yU,_U,re,{command:0,feature:6});}};c(p0,"Controls_settings_command");let dg=p0;function fI(r,e,t){const n=r.slice();return n[9]=e[t],n}c(fI,"get_each_context$h");function pI(r,e,t){const n=r.slice();return n[12]=e[t],n}c(pI,"get_each_context_1$5");function mI(r,e,t){const n=r.slice();return n[15]=e[t],n}c(mI,"get_each_context_2$2");function gI(r){let e,t,n,i,o,s;const a=[r[4].props];var l=r[4].componentType;function u(d,h){let p={};for(let m=0;m<a.length;m+=1)p=St(p,a[m]);return h!==void 0&&h&16&&(p=St(p,Rt(a,[Lt(d[4].props)]))),{props:p}}return c(u,"switch_props"),l&&(o=qe(l,u(r))),{c(){e=v("div"),t=v("h2"),t.textContent="Feature Information",n=C(),i=v("div"),o&&V(o.$$.fragment),_(t,"class","svelte-1njssi3"),_(e,"class","typo-feature-settings-info svelte-1njssi3");},m(d,h){k(d,e,h),g(e,t),g(e,n),g(e,i),o&&x(o,i,null),s=!0;},p(d,h){if(h&16&&l!==(l=d[4].componentType)){if(o){fe();const p=o;M(p.$$.fragment,1,0,()=>{Z(p,1);}),pe();}l?(o=qe(l,u(d,h)),V(o.$$.fragment),T(o.$$.fragment,1),x(o,i,null)):o=null;}else if(l){const p=h&16?Rt(a,[Lt(d[4].props)]):{};o.$set(p);}},i(d){s||(o&&T(o.$$.fragment,d),s=!0);},o(d){o&&M(o.$$.fragment,d),s=!1;},d(d){d&&A(e),o&&Z(o);}}}c(gI,"create_if_block_5");function bI(r){let e,t,n,i,o,s=te(r[1].settings),a=[];for(let u=0;u<s.length;u+=1)a[u]=vI(mI(r,s,u));const l=c(u=>M(a[u],1,1,()=>{a[u]=null;}),"out");return {c(){e=v("div"),t=v("h2"),t.textContent="Feature Settings",n=C(),i=v("div");for(let u=0;u<a.length;u+=1)a[u].c();_(t,"class","svelte-1njssi3"),_(i,"class","typo-feature-settings-default-list svelte-1njssi3"),_(e,"class","typo-feature-settings-default svelte-1njssi3");},m(u,d){k(u,e,d),g(e,t),g(e,n),g(e,i);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(i,null);o=!0;},p(u,d){if(d&2){s=te(u[1].settings);let h;for(h=0;h<s.length;h+=1){const p=mI(u,s,h);a[h]?(a[h].p(p,d),T(a[h],1)):(a[h]=vI(p),a[h].c(),T(a[h],1),a[h].m(i,null));}for(fe(),h=s.length;h<a.length;h+=1)l(h);pe();}},i(u){if(!o){for(let d=0;d<s.length;d+=1)T(a[d]);o=!0;}},o(u){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)M(a[d]);o=!1;},d(u){u&&A(e),Ie(a,u);}}}c(bI,"create_if_block_4");function vI(r){let e,t,n,i;const o=[r[15].componentData.props];var s=r[15].componentData.componentType;function a(l,u){let d={};for(let h=0;h<o.length;h+=1)d=St(d,o[h]);return u!==void 0&&u&2&&(d=St(d,Rt(o,[Lt(l[15].componentData.props)]))),{props:d}}return c(a,"switch_props"),s&&(t=qe(s,a(r))),{c(){e=v("div"),t&&V(t.$$.fragment),n=C(),_(e,"class","typo-feature-settings-default-item svelte-1njssi3");},m(l,u){k(l,e,u),t&&x(t,e,null),g(e,n),i=!0;},p(l,u){if(u&2&&s!==(s=l[15].componentData.componentType)){if(t){fe();const d=t;M(d.$$.fragment,1,0,()=>{Z(d,1);}),pe();}s?(t=qe(s,a(l,u)),V(t.$$.fragment),T(t.$$.fragment,1),x(t,e,n)):t=null;}else if(s){const d=u&2?Rt(o,[Lt(l[15].componentData.props)]):{};t.$set(d);}},i(l){i||(t&&T(t.$$.fragment,l),i=!0);},o(l){t&&M(t.$$.fragment,l),i=!1;},d(l){l&&A(e),t&&Z(t);}}}c(vI,"create_each_block_2$2");function _I(r){let e,t,n,i,o,s;const a=[r[3].props];var l=r[3].componentType;function u(d,h){let p={};for(let m=0;m<a.length;m+=1)p=St(p,a[m]);return h!==void 0&&h&8&&(p=St(p,Rt(a,[Lt(d[3].props)]))),{props:p}}return c(u,"switch_props"),l&&(o=qe(l,u(r))),{c(){e=v("div"),t=v("h2"),t.textContent="Feature Management",n=C(),i=v("div"),o&&V(o.$$.fragment),_(t,"class","svelte-1njssi3"),_(e,"class","typo-feature-settings-management svelte-1njssi3");},m(d,h){k(d,e,h),g(e,t),g(e,n),g(e,i),o&&x(o,i,null),s=!0;},p(d,h){if(h&8&&l!==(l=d[3].componentType)){if(o){fe();const p=o;M(p.$$.fragment,1,0,()=>{Z(p,1);}),pe();}l?(o=qe(l,u(d,h)),V(o.$$.fragment),T(o.$$.fragment,1),x(o,i,null)):o=null;}else if(l){const p=h&8?Rt(a,[Lt(d[3].props)]):{};o.$set(p);}},i(d){s||(o&&T(o.$$.fragment,d),s=!0);},o(d){o&&M(o.$$.fragment,d),s=!1;},d(d){d&&A(e),o&&Z(o);}}}c(_I,"create_if_block_3");function yI(r){let e,t,n,i,o,s,a,l,u,d,h=!r[7]&&wU(),p=te(r[5]),m=[];for(let y=0;y<p.length;y+=1)m[y]=wI(pI(r,p,y));const b=c(y=>M(m[y],1,1,()=>{m[y]=null;}),"out");return {c(){e=v("div"),t=v("h2"),t.textContent="Feature Hotkeys",n=C(),i=v("p"),i.innerHTML=`Hotkeys are key combinations to quickly access feature functions. You can disable hotkeys that you don&#39;t need.<br/>
      To change a hotkey, click in the input field and press the desired key combination. To remove a key from the combination, press it again.<br/>
      Empty combinations will be disabled automatically.`,o=C(),h&&h.c(),s=C(),a=v("br"),l=C(),u=v("div");for(let y=0;y<m.length;y+=1)m[y].c();_(t,"class","svelte-1njssi3"),_(u,"class","typo-feature-settings-hotkeys-list svelte-1njssi3"),_(e,"class","typo-feature-settings-hotkeys svelte-1njssi3");},m(y,w){k(y,e,w),g(e,t),g(e,n),g(e,i),g(e,o),h&&h.m(e,null),g(e,s),g(e,a),g(e,l),g(e,u);for(let I=0;I<m.length;I+=1)m[I]&&m[I].m(u,null);d=!0;},p(y,w){if(w&36){p=te(y[5]);let I;for(I=0;I<p.length;I+=1){const S=pI(y,p,I);m[I]?(m[I].p(S,w),T(m[I],1)):(m[I]=wI(S),m[I].c(),T(m[I],1),m[I].m(u,null));}for(fe(),I=p.length;I<m.length;I+=1)b(I);pe();}},i(y){if(!d){for(let w=0;w<p.length;w+=1)T(m[w]);d=!0;}},o(y){m=m.filter(Boolean);for(let w=0;w<m.length;w+=1)M(m[w]);d=!1;},d(y){y&&A(e),h&&h.d(),Ie(m,y);}}}c(yI,"create_if_block_1$4");function wU(r){let e;return {c(){e=v("p"),e.innerHTML=`Your browser does not support localized key names. Hotkeys will use US keyboard layout names.<br/>
        Switch to any Chrome-based browser to see the real key names.`;},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(wU,"create_if_block_2$2");function wI(r){let e,t;return e=new ug({props:{hotkey:r[12],feature:r[2]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&32&&(o.hotkey=n[12]),i&4&&(o.feature=n[2]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(wI,"create_each_block_1$5");function SI(r){let e,t,n,i,o,s,a,l,u,d=te(r[6]),h=[];for(let m=0;m<d.length;m+=1)h[m]=AI(fI(r,d,m));const p=c(m=>M(h[m],1,1,()=>{h[m]=null;}),"out");return {c(){e=v("div"),t=v("h2"),t.textContent="Feature Commands",n=C(),i=v("p"),i.innerHTML=`Commands are a quick way to execute actions of a feature from the chat.<br/>
      Here, you can toggle commands on or off and customize the command name.<br/>
      To use a command, type &quot;/&quot; and continue with the command name.`,o=C(),s=v("br"),a=C(),l=v("div");for(let m=0;m<h.length;m+=1)h[m].c();_(t,"class","svelte-1njssi3"),_(l,"class","typo-feature-settings-commands-list svelte-1njssi3"),_(e,"class","typo-feature-settings-hotkeys svelte-1njssi3");},m(m,b){k(m,e,b),g(e,t),g(e,n),g(e,i),g(e,o),g(e,s),g(e,a),g(e,l);for(let y=0;y<h.length;y+=1)h[y]&&h[y].m(l,null);u=!0;},p(m,b){if(b&68){d=te(m[6]);let y;for(y=0;y<d.length;y+=1){const w=fI(m,d,y);h[y]?(h[y].p(w,b),T(h[y],1)):(h[y]=AI(w),h[y].c(),T(h[y],1),h[y].m(l,null));}for(fe(),y=d.length;y<h.length;y+=1)p(y);pe();}},i(m){if(!u){for(let b=0;b<d.length;b+=1)T(h[b]);u=!0;}},o(m){h=h.filter(Boolean);for(let b=0;b<h.length;b+=1)M(h[b]);u=!1;},d(m){m&&A(e),Ie(h,m);}}}c(SI,"create_if_block$d");function AI(r){let e,t;return e=new dg({props:{command:r[9],feature:r[2]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&64&&(o.command=n[9]),i&4&&(o.feature=n[2]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(AI,"create_each_block$h");function SU(r){let e,t,n,i,o=r[1].name+"",s,a,l,u,d,h=r[1].description+"",p,m,b,y,w,I,S,R,E,P,L=r[4]&&gI(r),O=r[1].settings.length>0&&bI(r),z=r[3]&&_I(r),$=r[5].length>0&&yI(r),U=r[6].length>0&&SI(r);return {c(){e=v("div"),t=v("div"),t.textContent="Feature Details",n=C(),i=v("h1"),s=G(o),a=C(),l=v("div"),l.textContent="Back to Features ",u=C(),d=v("div"),p=G(h),m=C(),L&&L.c(),b=C(),O&&O.c(),y=C(),z&&z.c(),w=C(),$&&$.c(),I=C(),U&&U.c(),S=je(),_(t,"class","typo-feature-settings-hero svelte-1njssi3"),_(i,"class","svelte-1njssi3"),_(l,"class","typo-feature-settings-back svelte-1njssi3"),_(e,"class","typo-feature-settings-title svelte-1njssi3"),_(d,"class","typo-feature-settings-summary svelte-1njssi3");},m(N,Y){k(N,e,Y),g(e,t),g(e,n),g(e,i),g(i,s),g(e,a),g(e,l),k(N,u,Y),k(N,d,Y),g(d,p),k(N,m,Y),L&&L.m(N,Y),k(N,b,Y),O&&O.m(N,Y),k(N,y,Y),z&&z.m(N,Y),k(N,w,Y),$&&$.m(N,Y),k(N,I,Y),U&&U.m(N,Y),k(N,S,Y),R=!0,E||(P=F(l,"click",r[8]),E=!0);},p(N,[Y]){(!R||Y&2)&&o!==(o=N[1].name+"")&&K(s,o),(!R||Y&2)&&h!==(h=N[1].description+"")&&K(p,h),N[4]?L?(L.p(N,Y),Y&16&&T(L,1)):(L=gI(N),L.c(),T(L,1),L.m(b.parentNode,b)):L&&(fe(),M(L,1,1,()=>{L=null;}),pe()),N[1].settings.length>0?O?(O.p(N,Y),Y&2&&T(O,1)):(O=bI(N),O.c(),T(O,1),O.m(y.parentNode,y)):O&&(fe(),M(O,1,1,()=>{O=null;}),pe()),N[3]?z?(z.p(N,Y),Y&8&&T(z,1)):(z=_I(N),z.c(),T(z,1),z.m(w.parentNode,w)):z&&(fe(),M(z,1,1,()=>{z=null;}),pe()),N[5].length>0?$?($.p(N,Y),Y&32&&T($,1)):($=yI(N),$.c(),T($,1),$.m(I.parentNode,I)):$&&(fe(),M($,1,1,()=>{$=null;}),pe()),N[6].length>0?U?(U.p(N,Y),Y&64&&T(U,1)):(U=SI(N),U.c(),T(U,1),U.m(S.parentNode,S)):U&&(fe(),M(U,1,1,()=>{U=null;}),pe());},i(N){R||(T(L),T(O),T(z),T($),T(U),R=!0);},o(N){M(L),M(O),M(z),M($),M(U),R=!1;},d(N){N&&(A(e),A(u),A(d),A(m),A(b),A(y),A(w),A(I),A(S)),L&&L.d(N),O&&O.d(N),z&&z.d(N),$&&$.d(N),U&&U.d(N),E=!1,P();}}}c(SU,"create_fragment$r");function AU(r,e,t){var p;let{detailsClosed:n}=e,{feature:i}=e,{settingsFeature:o}=e;o.completeOnboardingTask();let s,a,l=[],u=[];const d=((p=navigator==null?void 0:navigator.keyboard)==null?void 0:p.getLayoutMap)!==void 0,h=c(()=>n(),"click_handler");return r.$$set=m=>{"detailsClosed"in m&&t(0,n=m.detailsClosed),"feature"in m&&t(1,i=m.feature),"settingsFeature"in m&&t(2,o=m.settingsFeature);},r.$$.update=()=>{r.$$.dirty&2&&(t(5,l=[...i.hotkeys]),t(6,u=[...i.commands]),t(3,s=i.featureManagementComponent),t(4,a=i.featureInfoComponent));},[n,i,o,s,a,l,u,d,h]}c(AU,"instance$q");const m0=class m0 extends se{constructor(e){super(),le(this,e,AU,SU,re,{detailsClosed:0,feature:1,settingsFeature:2});}};c(m0,"Controls_settings_details");let hg=m0;function kU(r){let e,t=r[0].description+"",n;return {c(){e=v("div"),n=G(t),_(e,"class","description svelte-xje42n");},m(i,o){k(i,e,o),g(e,n);},p(i,o){o&1&&t!==(t=i[0].description+"")&&K(n,t);},d(i){i&&A(e);}}}c(kU,"create_else_block$6");function CU(r){let e,t,n,i,o,s,a=r[0].description+"",l,u,d;return {c(){e=v("div"),t=v("img"),o=C(),s=v("span"),l=G(a),ht(t.src,n="")||_(t,"src",n),_(t,"alt",i=r[4]?"enabled":"disabled"),H(t,"content","var(--file-img-wrench-gif)"),_(t,"class","svelte-xje42n"),_(s,"class","svelte-xje42n"),_(e,"class","description svelte-xje42n"),_(e,"role","button");},m(h,p){k(h,e,p),g(e,t),g(e,o),g(e,s),g(s,l),u||(d=F(e,"click",r[8]),u=!0);},p(h,p){p&16&&i!==(i=h[4]?"enabled":"disabled")&&_(t,"alt",i),p&1&&a!==(a=h[0].description+"")&&K(l,a);},d(h){h&&A(e),u=!1,d();}}}c(CU,"create_if_block$c");function IU(r){let e,t,n,i,o,s,a,l=r[0].name+"",u,d,h,p=r[4]?"enabled":"disabled",m,b,y,w,I=r[0].tags.map(kI).join(" ")+"",S,R,E,P,L=r[0].featureId+"",O,z,$;function U(ee,B){return ee[0].hasDetailComponents?CU:kU}c(U,"select_block_type");let N=U(r),Y=N(r);return {c(){e=v("div"),t=v("div"),n=v("img"),s=C(),a=v("span"),u=G(l),d=C(),h=v("span"),m=G(p),b=C(),Y.c(),y=C(),w=v("div"),S=G(I),R=C(),E=v("div"),P=G("#"),O=G(L),ht(n.src,i="")||_(n,"src",i),_(n,"alt",o=r[4]?"enabled":"disabled"),H(n,"content","var(--"+(r[4]?"file-img-enabled-gif":"file-img-disabled-gif")+")"),_(n,"class","svelte-xje42n"),_(a,"class","svelte-xje42n"),_(h,"class","svelte-xje42n"),_(t,"class","name-toggle svelte-xje42n"),_(t,"role","button"),_(t,"tabindex","0"),ue(t,"locked",!r[0].toggleEnabled),_(w,"class","feature-tags svelte-xje42n"),_(E,"class","feature-id svelte-xje42n"),_(e,"class","typo-feature-item svelte-xje42n"),ue(e,"devMode",r[1]),ue(e,"hidden",r[0].developerFeature&&!r[1]);},m(ee,B){k(ee,e,B),g(e,t),g(t,n),g(t,s),g(t,a),g(a,u),g(t,d),g(t,h),g(h,m),g(e,b),Y.m(e,null),g(e,y),g(e,w),g(w,S),g(e,R),g(e,E),g(E,P),g(E,O),z||($=[F(t,"click",r[6]),F(t,"keypress",r[7])],z=!0);},p(ee,[B]){B&16&&o!==(o=ee[4]?"enabled":"disabled")&&_(n,"alt",o),B&16&&H(n,"content","var(--"+(ee[4]?"file-img-enabled-gif":"file-img-disabled-gif")+")"),B&1&&l!==(l=ee[0].name+"")&&K(u,l),B&16&&p!==(p=ee[4]?"enabled":"disabled")&&K(m,p),B&1&&ue(t,"locked",!ee[0].toggleEnabled),N===(N=U(ee))&&Y?Y.p(ee,B):(Y.d(1),Y=N(ee),Y&&(Y.c(),Y.m(e,y))),B&1&&I!==(I=ee[0].tags.map(kI).join(" ")+"")&&K(S,I),B&1&&L!==(L=ee[0].featureId+"")&&K(O,L),B&2&&ue(e,"devMode",ee[1]),B&3&&ue(e,"hidden",ee[0].developerFeature&&!ee[1]);},i:j,o:j,d(ee){ee&&A(e),Y.d(),z=!1,Je($);}}}c(IU,"create_fragment$q");const kI=c(r=>"#"+r,"func$1");function TU(r,e,t){let n,i=j,o=c(()=>(i(),i=Io(d,b=>t(4,n=b)),d),"$$subscribe_featureState");r.$$.on_destroy.push(()=>i());let{devmodeEnabled:s}=e,{feature:a}=e,{featureSettingsClicked:l}=e;const u=c(async b=>(b.toggleEnabled===!1||(await Ee(b.activated$)?await b.destroy():await b.activate()),b),"toggleFeature");let d;const h=c(async()=>t(0,a=await u(a)),"click_handler"),p=c(async b=>{b.key==="Enter"&&t(0,a=await u(a));},"keypress_handler"),m=c(()=>l(),"click_handler_1");return r.$$set=b=>{"devmodeEnabled"in b&&t(1,s=b.devmodeEnabled),"feature"in b&&t(0,a=b.feature),"featureSettingsClicked"in b&&t(2,l=b.featureSettingsClicked);},r.$$.update=()=>{r.$$.dirty&1&&o(t(3,d=it(a.activated$,!1)));},[a,s,l,d,n,u,h,p,m]}c(TU,"instance$p");const g0=class g0 extends se{constructor(e){super(),le(this,e,TU,IU,re,{devmodeEnabled:1,feature:0,featureSettingsClicked:2});}};c(g0,"Controls_settings_feature");let fg=g0;function CI(r,e,t){const n=r.slice();return n[11]=e[t],n}c(CI,"get_each_context$g");function II(r,e,t){const n=r.slice();return n[14]=e[t],n}c(II,"get_each_context_1$4");function TI(r){let e,t,n;function i(){return r[6](r[14])}return c(i,"click_handler"),{c(){e=v("span"),e.textContent=`#${r[14]}`,_(e,"class","filter svelte-1ly2c3r"),ue(e,"selected",r[2].includes(r[14]));},m(o,s){k(o,e,s),t||(n=F(e,"click",i),t=!0);},p(o,s){r=o,s&4&&ue(e,"selected",r[2].includes(r[14]));},d(o){o&&A(e),t=!1,n();}}}c(TI,"create_each_block_1$4");function DI(r){let e,t;function n(){return r[8](r[11])}return c(n,"func"),e=new fg({props:{feature:r[11],devmodeEnabled:r[4],featureSettingsClicked:n}}),{c(){V(e.$$.fragment);},m(i,o){x(e,i,o),t=!0;},p(i,o){r=i;const s={};o&13&&(s.feature=r[11]),o&16&&(s.devmodeEnabled=r[4]),o&15&&(s.featureSettingsClicked=n),e.$set(s);},i(i){t||(T(e.$$.fragment,i),t=!0);},o(i){M(e.$$.fragment,i),t=!1;},d(i){Z(e,i);}}}c(DI,"create_each_block$g");function EI(r){let e,t;return e=new hg({props:{feature:r[1],detailsClosed:r[9],settingsFeature:r[0]}}),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p(n,i){const o={};i&2&&(o.feature=n[1]),i&2&&(o.detailsClosed=n[9]),i&1&&(o.settingsFeature=n[0]),e.$set(o);},i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(EI,"create_if_block$b");function DU(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E=te(DA),P=[];for(let U=0;U<E.length;U+=1)P[U]=TI(II(r,E,U));let L=te(r[0].searchFeatures(r[0].features,r[2],r[3])),O=[];for(let U=0;U<L.length;U+=1)O[U]=DI(CI(r,L,U));const z=c(U=>M(O[U],1,1,()=>{O[U]=null;}),"out");let $=r[1]&&EI(r);return {c(){e=v("div"),t=v("div"),n=v("div"),n.innerHTML=`All features of skribbltypo can be managed here.<br/>
      You can click on a feature name to toggle it. To open feature settings, click the settings icon.<br/>
      If you are unsure how a feature works, you can have a look at the typo website or join the typo discord server and get help there!`,i=C(),o=v("div"),s=v("h3"),s.textContent="Filter by tags:",a=C(),l=v("div");for(let U=0;U<P.length;U+=1)P[U].c();u=C(),d=v("h3"),d.textContent="Filter by text:",h=C(),p=v("input"),m=C(),b=v("div");for(let U=0;U<O.length;U+=1)O[U].c();y=C(),w=v("div"),$&&$.c(),_(n,"class","typo-features-info svelte-1ly2c3r"),_(l,"class","filters svelte-1ly2c3r"),_(p,"type","text"),_(p,"placeholder","Search for feature/hotkey/command/setting name or description"),_(o,"class","typo-features-filter svelte-1ly2c3r"),_(b,"class","typo-features-list color-scrollbar svelte-1ly2c3r"),_(t,"class","typo-features svelte-1ly2c3r"),ue(t,"settingsVisible",r[1]!==void 0),_(w,"class","typo-feature-settings color-scrollbar svelte-1ly2c3r"),ue(w,"settingsVisible",r[1]!==void 0),_(e,"class","typo-features-container svelte-1ly2c3r");},m(U,N){k(U,e,N),g(e,t),g(t,n),g(t,i),g(t,o),g(o,s),g(o,a),g(o,l);for(let Y=0;Y<P.length;Y+=1)P[Y]&&P[Y].m(l,null);g(o,u),g(o,d),g(o,h),g(o,p),de(p,r[3]),g(t,m),g(t,b);for(let Y=0;Y<O.length;Y+=1)O[Y]&&O[Y].m(b,null);g(e,y),g(e,w),$&&$.m(w,null),I=!0,S||(R=F(p,"input",r[7]),S=!0);},p(U,[N]){if(N&4){E=te(DA);let Y;for(Y=0;Y<E.length;Y+=1){const ee=II(U,E,Y);P[Y]?P[Y].p(ee,N):(P[Y]=TI(ee),P[Y].c(),P[Y].m(l,null));}for(;Y<P.length;Y+=1)P[Y].d(1);P.length=E.length;}if(N&8&&p.value!==U[3]&&de(p,U[3]),N&31){L=te(U[0].searchFeatures(U[0].features,U[2],U[3]));let Y;for(Y=0;Y<L.length;Y+=1){const ee=CI(U,L,Y);O[Y]?(O[Y].p(ee,N),T(O[Y],1)):(O[Y]=DI(ee),O[Y].c(),T(O[Y],1),O[Y].m(b,null));}for(fe(),Y=L.length;Y<O.length;Y+=1)z(Y);pe();}(!I||N&2)&&ue(t,"settingsVisible",U[1]!==void 0),U[1]?$?($.p(U,N),N&2&&T($,1)):($=EI(U),$.c(),T($,1),$.m(w,null)):$&&(fe(),M($,1,1,()=>{$=null;}),pe()),(!I||N&2)&&ue(w,"settingsVisible",U[1]!==void 0);},i(U){if(!I){for(let N=0;N<L.length;N+=1)T(O[N]);T($),I=!0;}},o(U){O=O.filter(Boolean);for(let N=0;N<O.length;N+=1)M(O[N]);M($),I=!1;},d(U){U&&A(e),Ie(P,U),Ie(O,U),$&&$.d(),S=!1,R();}}}c(DU,"create_fragment$p");function EU(r,e,t){let n,{feature:i}=e;const o=i.devModeStore;De(r,o,m=>t(4,n=m));let s,a=[],l="";const u=c(m=>{a.includes(m)?t(2,a=a.filter(b=>b!==m)):t(2,a=[...a,m]);},"click_handler");function d(){l=this.value,t(3,l);}c(d,"input_input_handler");const h=c(m=>t(1,s=m),"func"),p=c(()=>t(1,s=void 0),"func_1");return r.$$set=m=>{"feature"in m&&t(0,i=m.feature);},[i,s,a,l,n,o,u,d,h,p]}c(EU,"instance$o");const b0=class b0 extends se{constructor(e){super(),le(this,e,EU,DU,re,{feature:0});}};c(b0,"Controls_settings");let pg=b0;var MU=Object.defineProperty,Ou=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&MU(e,t,i),i},"__decorateClass$t");const v0=class v0 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_modalService");f(this,"_toastService");f(this,"_featuresService");f(this,"_settingsService");f(this,"name","Typo Settings");f(this,"description","Customize Typo to your liking");f(this,"tags",[ye.INFORMATION,ye.DEVELOPMENT]);f(this,"toggleEnabled",!1);f(this,"featureId",1);f(this,"_onboardingTask",this.useOnboardingTask({key:"feature_opened",name:"Open settings of a feature",description:"Click the wrench icon and open the settings of a typo feature to adjust it to your liking.",start:c(()=>this.openSettingsPopup(),"start"),priority:2}));f(this,"_iconComponent");f(this,"_iconClickSubscription");}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.controls,props:{hoverMove:!1,size:"48px",icon:"file-img-wrench-gif",name:"Typo Features",order:1,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{this.openSettingsPopup();});}openSettingsPopup(){const t={componentType:pg,props:{feature:this}};this._modalService.showModal(t.componentType,t.props,"Typo Features");}postConstruct(){this._settingsService.globalHotkeysList.forEach(t=>this.useHotkey(t)),this.useSetting(this._settingsService.settings.devMode),this.useSetting(this._settingsService.settings.controlsPosition),this.useSetting(this._settingsService.settings.controlsDirection),this.useSetting(this._settingsService.settings.showLandingOutfit);}onDestroy(){var t,n;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy();}get hotkeys(){return this._settingsService.globalHotkeysList}get features(){return this._featuresService.features}get devModeStore(){return it(this._settingsService.settings.devMode.changes$,!1)}async setHotkeyCombo(t,n){const i=await this._toastService.showLoadingToast(`Updating hotkey ${t.name} to ${n.join(" + ")}`);try{await this._hotkeysService.setHotkeyCombo(t,n);}catch{i.reject();return}i.resolve();}async resetHotkeyCombo(t){var o;const n=await this._toastService.showLoadingToast(`Resetting hotkey ${t.name} to default ${((o=t.defaultCombo)==null?void 0:o.join(" + "))??"(disabled)"}`);let i;try{i=await this._hotkeysService.resetHotkeyCombo(t);}catch{n.reject();return}return n.resolve(),i}featureImportance(t){return t.includes(ye.DRAWING)?7:t.includes(ye.GAMEPLAY)||t.includes(ye.INTERFACE)?6:t.includes(ye.SOCIAL)?4:t.includes(ye.PALANTIR)?3:t.includes(ye.INFORMATION)?2:t.includes(ye.DEVELOPMENT)?1:0}featureContainsText(t,n){const i=n.toLowerCase();return t.name.toLowerCase().includes(i)||t.description.toLowerCase().includes(i)||t.settings.some(o=>{var s,a;return ((s=o.name)==null?void 0:s.toLowerCase().includes(i))||((a=o.description)==null?void 0:a.toLowerCase().includes(i))})||t.commands.some(o=>{var s,a;return ((s=o.name)==null?void 0:s.toLowerCase().includes(i))||((a=o.description)==null?void 0:a.toLowerCase().includes(i))})||t.hotkeys.some(o=>{var s,a;return ((s=o.name)==null?void 0:s.toLowerCase().includes(i))||((a=o.description)==null?void 0:a.toLowerCase().includes(i))})}searchFeatures(t,n,i){return t.filter(o=>n.length===0||o.tags.some(s=>n.includes(s))).filter(o=>i.length===0||this.featureContainsText(o,i)).sort((o,s)=>this.featureImportance(s.tags)-this.featureImportance(o.tags))}async completeOnboardingTask(){(await this._onboardingTask).complete();}};c(v0,"ControlsSettingsFeature");let jr=v0;Ou([D(Me)],jr.prototype,"_elementsSetup");Ou([D(Dn)],jr.prototype,"_modalService");Ou([D(ft)],jr.prototype,"_toastService");Ou([D(uo)],jr.prototype,"_featuresService");Ou([D(xn)],jr.prototype,"_settingsService");var RU=Object.defineProperty,LU=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&RU(e,t,i),i},"__decorateClass$s");const _0=class _0 extends ho{constructor(){super(...arguments);f(this,"_toolsService");f(this,"description","Draws an additional mirrored line to create a mandala effect.");f(this,"icon","var(--file-img-line-mandala-gif)");f(this,"name","Mandala");f(this,"_mirrorCenterSetting",new cr("brushlab.mandala.center","center").withName("Mandala Mirror Center").withDescription("The center of the mandala mirroring effect").withChoices([{choice:"click",name:"At last click"},{choice:"center",name:"At canvas center"}]));f(this,"_axisSetting",new cr("brushlab.mandala.axis","xy").withName("Mandala Mirror Axis").withDescription("The axis where the mandala line will be mirrored on").withChoices([{choice:"x",name:"Horizontal"},{choice:"y",name:"Vertical"},{choice:"xy",name:"Both"}]));f(this,"settings",[this._mirrorCenterSetting,this._axisSetting]);}async applyEffect(t,n,i){const o=await Ee(this._axisSetting.changes$),s=await Ee(this._mirrorCenterSetting.changes$);let a=[400,300];if(s==="click"){const u=await Ee(this._toolsService.lastPointerDownPosition$);u?a=[u.offsetX,u.offsetY]:a=t.from;}const l=this.calculateMirroredLine(o,a,t.from,t.to);return {style:i,lines:[t,l]}}calculateMirroredLine(t,n,i,o){return t==="y"?{from:[n[0]-(i[0]-n[0]),i[1]],to:[n[0]-(o[0]-n[0]),o[1]]}:t==="x"?{from:[i[0],n[1]-(i[1]-n[1])],to:[o[0],n[1]-(o[1]-n[1])]}:{from:[n[0]-(i[0]-n[0]),n[1]-(i[1]-n[1])],to:[n[0]-(o[0]-n[0]),n[1]-(o[1]-n[1])]}}};c(_0,"MandalaMod");let th=_0;LU([D(dn)],th.prototype,"_toolsService");const y0=class y0 extends En{constructor(){super(...arguments);f(this,"description","Randomly adds noise to drawn lines.");f(this,"icon","var(--file-img-line-noise-gif)");f(this,"name","Noise");f(this,"_scaleSetting",new Wt("brushlab.noise.scale",5).withName("Noise Scale").withDescription("Select how much noise is added to the line").withSlider(1).withBounds(1,100));f(this,"settings",[this._scaleSetting]);}async applyConstantEffect(t,n,i){const o=await Ee(this._scaleSetting.changes$),s=(Math.random()-.5)*Math.PI,a=1+(Math.random()-.5)*o*i.size/40,l=(t.from[0]+t.to[0])/2,u=(t.from[1]+t.to[1])/2,d=c((m,b,y)=>{const w=Math.cos(y),I=Math.sin(y);return [w*(m-l)-I*(b-u)+l,I*(m-l)+w*(b-u)+u]},"rotatePoint"),h=d(t.from[0],t.from[1],s),p=d(t.to[0],t.to[1],s);return h[0]=l+(h[0]-l)*a,h[1]=u+(h[1]-u)*a,p[0]=l+(p[0]-l)*a,p[1]=u+(p[1]-u)*a,{style:i,line:{from:h,to:p}}}};c(y0,"NoiseMod");let mg=y0;const w0=class w0 extends ho{constructor(){super(...arguments);f(this,"description","Draws additional parallel lines in a angle and distance. In public lobbies, a max of 1 parallel line should be used.");f(this,"icon","var(--file-img-line-parallel-gif)");f(this,"name","Parallel");f(this,"_distanceSetting",new Wt("brushlab.parallel.distance",20).withName("Line Distance").withDescription("The distance between the lines").withSlider(1).withBounds(1,100));f(this,"_distanceDependencySetting",new He("brushlab.parallel.dependency",!1).withName("Size Dependency").withDescription("Make line distance proportionally dependent on brush size"));f(this,"_angleSetting",new Wt("brushlab.parallel.angle",180).withName("Line Angle").withDescription("The clockwise angle where the parallel lines are drawn with the distance offset").withSlider(1).withBounds(1,360));f(this,"_lineCountSetting",new Wt("brushlab.parallel.count",1).withName("Line Count").withDescription("The amount of parallel lines drawn").withSlider(1).withBounds(1,4));f(this,"settings",[this._distanceSetting,this._distanceDependencySetting,this._angleSetting,this._lineCountSetting]);}async applyEffect(t,n,i){const o=await Ee(this._distanceSetting.changes$),s=await Ee(this._angleSetting.changes$),a=await Ee(this._lineCountSetting.changes$),l=await Ee(this._distanceDependencySetting.changes$),u=[],d=this.getOffset(o,s);l&&(d[0]*=i.size/40,d[1]*=i.size/40);for(let h=0;h<a;h++){const p={from:[t.from[0]+d[0]*(h+1),t.from[1]+d[1]*(h+1)],to:[t.to[0]+d[0]*(h+1),t.to[1]+d[1]*(h+1)]};u.push(p);}return {style:i,lines:[t,...u]}}getOffset(t,n){const i=n*Math.PI/180,o=Math.cos(i)*t,s=Math.sin(i)*t;return [o,s]}};c(w0,"ParallelLineMod");let gg=w0;const S0=class S0 extends En{constructor(){super(...arguments);f(this,"description","Changes color brightness or hue channel depending on pen pressure.");f(this,"icon","var(--file-img-line-pressure-ink-gif)");f(this,"name","Pressure Ink");f(this,"_brightnessEnabledSetting",new He("brushlab.pressureink.brightness",!0).withName("Brightness").withDescription("Changes the luminance of the selected color depending on pressure."));f(this,"_brightnessAbsoluteSetting",new He("brushlab.pressureink.brightnessAbsolute",!0).withName("Absolute Brightness").withDescription("When enabled, acts on the full brightness range, regardless of current color brightness."));f(this,"_brightnessInvertSetting",new He("brushlab.pressureink.brightnessInvert",!1).withName("Invert Brightness Modification").withDescription("When enabled, the color will get darker the more pressure is applied."));f(this,"_brightnessSensitivitySetting",new Wt("brushlab.pressureink.brightnessSensitivity",50).withName("Brightness Sensitivity").withDescription("Select how much the brightness changes with pressure.").withSlider(1).withBounds(0,100));f(this,"_brightnessRangeSetting",new Wt("brushlab.pressureink.brightnessRange",80).withName("Brightness Pressure range").withDescription("A lower range will cut off low and high pressure, making it easier to use the full brightness range.").withSlider(1).withBounds(0,100));f(this,"_degreeEnabledSetting",new He("brushlab.pressureink.degree",!1).withName("Color").withDescription("Changes the HUE of the selected color depending on pressure."));f(this,"_degreeSensitivitySetting",new Wt("brushlab.pressureink.degreeSensitivity",50).withName("Color Sensitivity").withDescription("Select how much the color changes with pressure.").withSlider(1).withBounds(0,100));f(this,"_degreeInvertSetting",new He("brushlab.pressureink.degreeInvert",!1).withName("Invert Color Modification").withDescription("When enabled, the color will shift in the opposite direction when pressure is enabled."));f(this,"_degreeRangeSetting",new Wt("brushlab.pressureink.degreeRange",80).withName("Color Pressure range").withDescription("A lower range will cut off low and high pressure, making it easier to use the full color range.").withSlider(1).withBounds(0,100));f(this,"settings",[this._brightnessEnabledSetting,this._degreeEnabledSetting,this._brightnessAbsoluteSetting,this._brightnessSensitivitySetting,this._degreeSensitivitySetting,this._brightnessRangeSetting,this._degreeRangeSetting,this._brightnessInvertSetting,this._degreeInvertSetting]);f(this,"_lastColorCode");}async applyConstantEffect(t,n,i,o,s,a,l){const u=await Ee(this._brightnessEnabledSetting.changes$),d=await Ee(this._degreeEnabledSetting.changes$);if(a==="up"&&this._lastColorCode!==void 0)return l?i.secondaryColor=this._lastColorCode:i.color=this._lastColorCode,this._lastColorCode=void 0,{style:i,line:t,disableColorUpdate:!0};if(n===void 0||!u&&!d)return {style:i,line:t};const h=this.getSelectedColor(i,l),p=tt.fromSkribblCode(h).hsl;if(u){const b=await Ee(this._brightnessSensitivitySetting.changes$),y=await Ee(this._brightnessAbsoluteSetting.changes$),w=await Ee(this._brightnessInvertSetting.changes$),I=await Ee(this._brightnessRangeSetting.changes$),S=y?w?100:0:p[2],R=this.calculateAdjustedOffset(n,(50+b)/100,I,w,100,S);p[2]=Math.round(Math.max(0,Math.min(100,R)));}if(d){const b=await Ee(this._degreeSensitivitySetting.changes$),y=await Ee(this._degreeInvertSetting.changes$),w=await Ee(this._degreeRangeSetting.changes$);p[0]=Math.round(this.calculateAdjustedOffset(n,(50+b)/100,w,y,360,p[0])%360);}const m=tt.fromHsl(p[0],p[1],p[2],p[3]);return this._lastColorCode=m.skribblCode,i={size:i.size,color:l?i.color:m.typoCode,secondaryColor:l?m.typoCode:i.color},{style:i,line:t,disableColorUpdate:!0}}calculateAdjustedOffset(t,n,i,o,s,a){const l=(t-(1-i/100)/2)/(i/100),d=Math.max(0,Math.min(1,l))*n*s;return a+(o?-d:d)}};c(S0,"PressureInkMod");let bg=S0;const A0=class A0 extends En{constructor(){super(...arguments);f(this,"description","Switches colors while drawing to create a rainbow effect.");f(this,"icon","var(--file-img-line-rainbow-gif)");f(this,"name","Rainbow");f(this,"_rainbowModeSetting",new cr("brushlab.rainbow.mode","light").withName("Rainbow Colors").withDescription("Choose between the rainbow color shades").withChoices([{choice:"light",name:"Light Colors"},{choice:"dark",name:"Dark Colors"}]));f(this,"_strokeModeSetting",new He("brushlab.rainbow.strokeMode",!1).withName("Change Per Stroke").withDescription("If enabled, the color will change per stroke instead of continuously."));f(this,"_colorSwitchSetting",new Wt("brushlab.rainbow.distance",20).withName("Color Switch Distance").withDescription("The distance between the color switches").withSlider(1).withBounds(0,100));f(this,"strokeSwitches",new Map);f(this,"initIndex",-1);f(this,"settings",[this._rainbowModeSetting,this._colorSwitchSetting,this._strokeModeSetting]);}async applyConstantEffect(t,n,i,o,s,a){const l=await Ee(this._rainbowModeSetting.changes$),u=await Ee(this._strokeModeSetting.changes$),d=await Ee(this._colorSwitchSetting.changes$),h=tt.skribblColors.filter((m,b)=>b%2===0?l==="light":l==="dark"),p=this.strokeSwitches.get(s);if(p!==void 0&&a==="up"&&this.strokeSwitches.delete(s),p===void 0||u==!1&&(d<=0||this.getDistance(p.position,t.from)>i.size/10*d)){const m=(((p==null?void 0:p.index)??this.initIndex++%(h.length-4))+1)%(h.length-4),b=m+2;i.color=b*2+(l==="light"?0:1);const y={eventId:o,position:t.from,index:m};this.strokeSwitches.set(s,y);}else i.color=(p.index+2)*2+(l==="light"?0:1);return {style:i,line:t,disableColorUpdate:!1}}getDistance(t,n){return Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2))}};c(A0,"RainbowMod");let vg=A0;var PU=Object.defineProperty,NU=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&PU(e,t,i),i},"__decorateClass$r");const k0=class k0 extends En{constructor(){super(...arguments);f(this,"_colorsService");f(this,"description","Switches colors of the current palette randomly while drawing.");f(this,"icon","var(--file-img-line-random-color-gif)");f(this,"name","Random Colors");f(this,"_colorSwitchSetting",new Wt("brushlab.randomcolor.distance",20).withName("Color Switch Distance").withDescription("The distance between the color switches").withSlider(1).withBounds(0,100));f(this,"_strokeModeSetting",new He("brushlab.randomcolor.strokeMode",!1).withName("Change Per Stroke").withDescription("If enabled, the color will change per stroke instead of continuously."));f(this,"strokeSwitches",new Map);f(this,"settings",[this._colorSwitchSetting,this._strokeModeSetting]);}async applyConstantEffect(t,n,i,o,s,a){const l=await Ee(this._colorSwitchSetting.changes$),u=await Ee(this._strokeModeSetting.changes$),d=await Ee(this._colorsService.pickerColors$)??ml.skribblPalette,h=this.strokeSwitches.get(s);if(h!==void 0&&a==="up"&&this.strokeSwitches.delete(s),h===void 0||u===!1&&(l<=0||this.getDistance(h.position,t.from)>i.size/10*l)){const p=Math.floor(Math.random()*d.colorHexCodes.length),m=tt.fromHex(d.colorHexCodes[p]);i.color=m.typoCode;const b={eventId:o,position:t.from,color:i.color};this.strokeSwitches.set(s,b);}else i.color=h.color;return {style:i,line:t,disableColorUpdate:!1}}getDistance(t,n){return Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2))}};c(k0,"RandomColorMod");let nh=k0;NU([D(Rr)],nh.prototype,"_colorsService");var OU=Object.defineProperty,jU=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&OU(e,t,i),i},"__decorateClass$q");const C0=class C0 extends ho{constructor(){super(...arguments);f(this,"_toolsService");f(this,"description","Creates a figure by mirroring and connecting the line on a axis.");f(this,"icon","var(--file-img-line-sculpt-gif)");f(this,"name","Sculpt");f(this,"_mirrorCenterSetting",new cr("brushlab.sculpt.center","center").withName("Sculpt Mirror Center").withDescription("The center of the sculpt figure mirroring effect").withChoices([{choice:"click",name:"At last click"},{choice:"center",name:"At canvas center"}]));f(this,"_axisSetting",new cr("brushlab.sculpt.axis","xy").withName("Sculpt Mirror Axis").withDescription("The axis where the sculpt figure will be mirrored on").withChoices([{choice:"x",name:"Horizontal"},{choice:"y",name:"Vertical"},{choice:"xy",name:"Both"}]));f(this,"settings",[this._mirrorCenterSetting,this._axisSetting]);}async applyEffect(t,n,i){const o=await Ee(this._axisSetting.changes$),s=await Ee(this._mirrorCenterSetting.changes$);let a=[400,300];if(s==="click"){const d=await Ee(this._toolsService.lastPointerDownPosition$);d?a=[d.offsetX,d.offsetY]:a=t.from;}const l=[(t.from[0]+t.to[0])/2,(t.from[1]+t.to[1])/2],u=this.calculateMirroredPoint(a,l,o);return {style:i,lines:[{from:t.from,to:u},{from:u,to:t.to}]}}calculateMirroredPoint(t,n,i){return i==="x"?[n[0],2*t[1]-n[1]]:i==="y"?[2*t[0]-n[0],n[1]]:[2*t[0]-n[0],2*t[1]-n[1]]}};c(C0,"SculptMod");let ih=C0;jU([D(dn)],ih.prototype,"_toolsService");const I0=class I0 extends En{constructor(){super(...arguments);f(this,"description","Tilt the line into a direction.");f(this,"icon","var(--file-img-line-tilt-gif)");f(this,"name","Tilt");f(this,"_distanceSetting",new Wt("brushlab.tilt.size",20).withName("Tilt Size").withDescription("The size of the tilted line").withSlider(1).withBounds(1,100));f(this,"_distanceDependencySetting",new He("brushlab.tilt.dependency",!1).withName("Size Dependency").withDescription("Make tilt size proportionally dependent on brush size"));f(this,"_angleSetting",new Wt("brushlab.tilt.angle",180).withName("Tilt Angle").withDescription("The clockwise angle where the tilt lines created").withSlider(1).withBounds(1,360));f(this,"settings",[this._distanceSetting,this._distanceDependencySetting,this._angleSetting]);}async applyConstantEffect(t,n,i){const o=await Ee(this._distanceSetting.changes$),s=await Ee(this._angleSetting.changes$),a=await Ee(this._distanceDependencySetting.changes$),l=this.getOffset(o,s-90);a&&(l[0]*=i.size/40,l[1]*=i.size/40);const u={from:t.from,to:[t.to[0]+l[0],t.to[1]+l[1]]};return {style:i,line:u}}getOffset(t,n){const i=n*Math.PI/180,o=Math.cos(i)*t,s=Math.sin(i)*t;return [o,s]}};c(I0,"TiltMod");let _g=I0;const T0=class T0 extends mn{constructor(){super(...arguments);f(this,"name","Dashed Lines");f(this,"description","Draw dashed lines with a customizable interval and blank size");f(this,"icon","var(--file-img-line-dash-gif)");f(this,"_intervalSetting",new Wt("brushlab.dash.interval",10).withName("Dash Interval").withDescription("The time interval between making line blanks in milliseconds").withSlider(1).withBounds(1,300));f(this,"_blankSizeSetting",new Wt("brushlab.dash.blank",20).withName("Blank Size").withDescription("The size of the blanks between dashes, depending on brush size").withSlider(1).withBounds(1,100));f(this,"settings",[this._intervalSetting,this._blankSizeSetting]);f(this,"dashStart");f(this,"lineStart");f(this,"applyConstantEffect",this.noConstantEffect);}createCursor(t){return this.createSkribblLikeCursor(t)}async createCommands(t,n,i,o,s,a,l){const u=await Ee(this._intervalSetting.changes$),d=await Ee(this._blankSizeSetting.changes$),h=Date.now();return this.dashStart!==void 0?(this.getDistance(this.dashStart.position,t.from)>i.size/10*d&&(this.dashStart=void 0),[]):this.lineStart!==void 0&&h-this.lineStart.time>u?(this.lineStart=void 0,this.dashStart={eventId:o,position:t.to},[]):(this.lineStart===void 0&&(this.lineStart={eventId:o,time:h}),[[0,this.getSelectedColor(i,l),i.size,...t.from,...t.to]])}getDistance(t,n){return Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2))}};c(T0,"DashTool");let yg=T0;const D0=class D0 extends mn{constructor(){super(...arguments);f(this,"name","Dotted Lines");f(this,"description","Draw dotted lines with a customizable interval");f(this,"icon","var(--file-img-line-dot-gif)");f(this,"_intervalSetting",new Wt("brushlab.dot.interval",10).withName("Dot Interval").withDescription("The time interval between making dots in milliseconds").withSlider(1).withBounds(1,1e3));f(this,"settings",[this._intervalSetting]);f(this,"lastDown",{eventId:0,time:Date.now()});f(this,"applyConstantEffect",this.noConstantEffect);}createCursor(t){return this.createSkribblLikeCursor(t)}async createCommands(t,n,i,o,s,a,l){const u=await Ee(this._intervalSetting.changes$),d=Date.now(),h=this.getSelectedColor(i,l);return this.lastDown.eventId===o?[[0,h,i.size,...t.to,...t.to]]:d-this.lastDown.time>u?(this.lastDown.time=d,this.lastDown.eventId=o,[[0,h,i.size,...t.to,...t.to]]):[]}};c(D0,"DotTool");let wg=D0;var GU=Object.defineProperty,$U=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&GU(e,t,i),i},"__decorateClass$p");const E0=class E0 extends mn{constructor(){super(...arguments);f(this,"_toolsService");f(this,"name","Grid Generator");f(this,"description","Click anywhere on the canvas to create a grid");f(this,"icon","var(--file-img-line-grid-gif)");f(this,"_rowsSetting",new Wt("brushlab.grid.rows",6).withName("Row Count").withDescription("The amount of rows in the grid").withSlider(1).withBounds(1,30));f(this,"_columnsSetting",new Wt("brushlab.grid.columns",8).withName("Column Count").withDescription("The amount of columns in the grid").withSlider(1).withBounds(1,30));f(this,"settings",[this._rowsSetting,this._columnsSetting]);f(this,"_lastDownEvent",null);f(this,"applyConstantEffect",this.noConstantEffect);}createCursor(){return {source:"var(--file-img-grid_cur-png)",x:7,y:37}}async createCommands(t,n,i){const o=await Ee(this._toolsService.lastPointerDownPosition$);if(o===null||this._lastDownEvent===o)return [];this._lastDownEvent=o;const s=800,a=600,l=await Ee(this._rowsSetting.changes$),u=await Ee(this._columnsSetting.changes$),d=Math.ceil(a/l),h=Math.ceil(s/u),p=[];for(let m=1;m<l;m++)p.push([0,i.color,i.size,0,m*d,s,m*d]);for(let m=1;m<u;m++)p.push([0,i.color,i.size,m*h,0,m*h,a]);return p}};c(E0,"GridTool");let rh=E0;$U([D(dn)],rh.prototype,"_toolsService");function YU(r){let e;return {c(){e=v("div"),e.innerHTML="";},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(YU,"create_fragment$o");function zU(r,e,t){let{feature:n}=e;return r.$$set=i=>{"feature"in i&&t(0,n=i.feature);},[n]}c(zU,"instance$n");const M0=class M0 extends se{constructor(e){super(),le(this,e,zU,YU,re,{feature:0});}};c(M0,"Drawing_brush_lab_info");let Sg=M0;function UU(r){let e,t,n;return {c(){e=v("div"),e.innerHTML='<div class="icon" style="background-image: var(--file-img-wand-gif)"></div>',_(e,"class","typo-brush-lab-switch tool clickable"),ue(e,"expanded",r[1]);},m(i,o){k(i,e,o),t||(n=[F(e,"click",r[3]),oi(r[0].createTooltip(e,{title:"Toggle Brush Lab",lock:"Y"}))],t=!0);},p(i,[o]){o&2&&ue(e,"expanded",i[1]);},i:j,o:j,d(i){i&&A(e),t=!1,Je(n);}}}c(UU,"create_fragment$n");function BU(r,e,t){const n=c(()=>{t(1,o=!o);},"toggle");let{feature:i}=e,o=!1;const s=c(()=>t(1,o=!o),"click_handler");return r.$$set=a=>{"feature"in a&&t(0,i=a.feature);},[i,o,n,s]}c(BU,"instance$m");const R0=class R0 extends se{constructor(e){super(),le(this,e,BU,UU,re,{toggle:2,feature:0});}get toggle(){return this.$$.ctx[2]}};c(R0,"Drawing_brush_lab_switch");let Ag=R0;function MI(r,e,t){const n=r.slice();return n[8]=e[t],n}c(MI,"get_each_context$f");function RI(r,e,t){const n=r.slice();return n[11]=e[t],n}c(RI,"get_each_context_1$3");function LI(r){let e,t,n,i,o,s;function a(){return r[4](r[11])}c(a,"click_handler_1");function l(...u){return r[5](r[11],...u)}return c(l,"contextmenu_handler"),{c(){e=v("div"),t=v("div"),n=C(),_(t,"class","icon"),H(t,"background-image",r[11].item.icon),_(e,"class","tool clickable"),ue(e,"selected",r[11].active);},m(u,d){k(u,e,d),g(e,t),g(e,n),o||(s=[oi(i=r[0].createTooltip(e,{title:r[11].item.name,lock:"Y"})),F(e,"click",a),F(e,"contextmenu",l)],o=!0);},p(u,d){r=u,d&2&&H(t,"background-image",r[11].item.icon),i&&Yr(i.update)&&d&2&&i.update.call(null,{title:r[11].item.name,lock:"Y"}),d&2&&ue(e,"selected",r[11].active);},d(u){u&&A(e),o=!1,Je(s);}}}c(LI,"create_each_block_1$3");function PI(r){let e,t,n,i,o,s;function a(){return r[6](r[8])}c(a,"click_handler_2");function l(...u){return r[7](r[8],...u)}return c(l,"contextmenu_handler_1"),{c(){e=v("div"),t=v("div"),n=C(),_(t,"class","icon"),H(t,"background-image",r[8].item.icon),_(e,"class","tool clickable"),ue(e,"selected",r[8].active);},m(u,d){k(u,e,d),g(e,t),g(e,n),o||(s=[oi(i=r[0].createTooltip(e,{title:r[8].item.name,lock:"Y"})),F(e,"click",a),F(e,"contextmenu",l)],o=!0);},p(u,d){r=u,d&2&&H(t,"background-image",r[8].item.icon),i&&Yr(i.update)&&d&2&&i.update.call(null,{title:r[8].item.name,lock:"Y"}),d&2&&ue(e,"selected",r[8].active);},d(u){u&&A(e),o=!1,Je(s);}}}c(PI,"create_each_block$f");function xU(r){let e,t,n,i,o,s,a,l,u,d=te(r[1].mods),h=[];for(let b=0;b<d.length;b+=1)h[b]=LI(RI(r,d,b));let p=te(r[1].tools),m=[];for(let b=0;b<p.length;b+=1)m[b]=PI(MI(r,p,b));return {c(){e=v("div"),t=v("div"),n=v("div"),n.innerHTML='<div class="icon" style="background-image: var(--file-img-wrench-gif)"></div>',i=C(),o=v("div");for(let b=0;b<h.length;b+=1)h[b].c();s=C(),a=v("div");for(let b=0;b<m.length;b+=1)m[b].c();_(n,"class","tool clickable"),_(t,"class","typo-brush-lab-settings"),_(o,"class","typo-brush-lab-mods svelte-p5jc91"),_(a,"class","typo-brush-lab-tools svelte-p5jc91"),_(e,"class","typo-brush-lab-group svelte-p5jc91");},m(b,y){k(b,e,y),g(e,t),g(t,n),g(e,i),g(e,o);for(let w=0;w<h.length;w+=1)h[w]&&h[w].m(o,null);g(e,s),g(e,a);for(let w=0;w<m.length;w+=1)m[w]&&m[w].m(a,null);l||(u=[oi(r[0].createTooltip(n,{title:"Brush Lab Settings",lock:"Y"})),F(n,"click",r[3])],l=!0);},p(b,[y]){if(y&3){d=te(b[1].mods);let w;for(w=0;w<d.length;w+=1){const I=RI(b,d,w);h[w]?h[w].p(I,y):(h[w]=LI(I),h[w].c(),h[w].m(o,null));}for(;w<h.length;w+=1)h[w].d(1);h.length=d.length;}if(y&3){p=te(b[1].tools);let w;for(w=0;w<p.length;w+=1){const I=MI(b,p,w);m[w]?m[w].p(I,y):(m[w]=PI(I),m[w].c(),m[w].m(a,null));}for(;w<m.length;w+=1)m[w].d(1);m.length=p.length;}},i:j,o:j,d(b){b&&A(e),Ie(h,b),Ie(m,b),l=!1,Je(u);}}}c(xU,"create_fragment$m");function ZU(r,e,t){let n,{feature:i}=e;const o=i.toolbarItemsStore;De(r,o,h=>t(1,n=h));const s=c(()=>i.openBrushLabSettings(),"click_handler"),a=c(h=>{h.active?i.removeMod(h.item):i.activateMod(h.item);},"click_handler_1"),l=c((h,p)=>{p.preventDefault(),i.openBrushLabSettings(h.item);},"contextmenu_handler"),u=c(h=>{h.active?i.activateTool(ui.brush):i.activateTool(h.item);},"click_handler_2"),d=c((h,p)=>{p.preventDefault(),i.openBrushLabSettings(h.item);},"contextmenu_handler_1");return r.$$set=h=>{"feature"in h&&t(0,i=h.feature);},[i,n,o,s,a,l,u,d]}c(ZU,"instance$l");const L0=class L0 extends se{constructor(e){super(),le(this,e,ZU,xU,re,{feature:0});}};c(L0,"Drawing_brush_lab_group");let kg=L0;function NI(r,e,t){const n=r.slice();return n[10]=e[t],n}c(NI,"get_each_context$e");function OI(r,e,t){const n=r.slice();return n[13]=e[t],n}c(OI,"get_each_context_1$2");function jI(r,e,t){const n=r.slice();return n[13]=e[t],n}c(jI,"get_each_context_2$1");function GI(r,e,t){const n=r.slice();return n[18]=e[t],n}c(GI,"get_each_context_3$1");function $I(r){let e,t,n,i,o,s=r[18].item.name+"",a,l,u;function d(){return r[5](r[18])}return c(d,"click_handler"),{c(){e=v("div"),t=v("img"),i=C(),o=v("b"),a=G(s),ht(t.src,n="")||_(t,"src",n),H(t,"content",r[18].item.icon),_(t,"alt","icon"),_(t,"class","svelte-fdmon8"),_(o,"class","svelte-fdmon8"),_(e,"class","item-sidebar-entry svelte-fdmon8");},m(h,p){k(h,e,p),g(e,t),g(e,i),g(e,o),g(o,a),l||(u=F(e,"click",d),l=!0);},p(h,p){r=h,p&1&&H(t,"content",r[18].item.icon),p&1&&s!==(s=r[18].item.name+"")&&K(a,s);},d(h){h&&A(e),l=!1,u();}}}c($I,"create_each_block_3$1");function YI(r){let e,t,n,i,o,s=r[13].item.name+"",a,l,u;function d(){return r[7](r[13])}return c(d,"click_handler_1"),{c(){e=v("div"),t=v("img"),i=C(),o=v("b"),a=G(s),ht(t.src,n="")||_(t,"src",n),H(t,"content",r[13].item.icon),_(t,"alt","icon"),_(t,"class","svelte-fdmon8"),_(o,"class","svelte-fdmon8"),_(e,"class","item-sidebar-entry svelte-fdmon8");},m(h,p){k(h,e,p),g(e,t),g(e,i),g(e,o),g(o,a),l||(u=F(e,"click",d),l=!0);},p(h,p){r=h,p&1&&H(t,"content",r[13].item.icon),p&1&&s!==(s=r[13].item.name+"")&&K(a,s);},d(h){h&&A(e),l=!1,u();}}}c(YI,"create_each_block_2$1");function zI(r){let e,t,n,i,o,s=r[13].item.name+"",a,l,u,d;function h(){return r[9](r[13])}return c(h,"click_handler_2"),{c(){e=v("div"),t=v("img"),i=C(),o=v("b"),a=G(s),l=C(),ht(t.src,n="")||_(t,"src",n),H(t,"content",r[13].item.icon),_(t,"alt","icon"),_(t,"class","svelte-fdmon8"),_(o,"class","svelte-fdmon8"),_(e,"class","item-sidebar-entry svelte-fdmon8");},m(p,m){k(p,e,m),g(e,t),g(e,i),g(e,o),g(o,a),g(e,l),u||(d=F(e,"click",h),u=!0);},p(p,m){r=p,m&1&&H(t,"content",r[13].item.icon),m&1&&s!==(s=r[13].item.name+"")&&K(a,s);},d(p){p&&A(e),u=!1,d();}}}c(zI,"create_each_block_1$2");function UI(r){let e,t,n=te(r[1].settings),i=[];for(let s=0;s<n.length;s+=1)i[s]=BI(NI(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();_(e,"class","item-details-settings-list svelte-fdmon8");},m(s,a){k(s,e,a);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);t=!0;},p(s,a){if(a&2){n=te(s[1].settings);let l;for(l=0;l<n.length;l+=1){const u=NI(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=BI(u),i[l].c(),T(i[l],1),i[l].m(e,null));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(UI,"create_if_block$a");function BI(r){let e,t,n,i;const o=[r[10].componentData.props];var s=r[10].componentData.componentType;function a(l,u){let d={};for(let h=0;h<o.length;h+=1)d=St(d,o[h]);return u!==void 0&&u&2&&(d=St(d,Rt(o,[Lt(l[10].componentData.props)]))),{props:d}}return c(a,"switch_props"),s&&(t=qe(s,a(r))),{c(){e=v("div"),t&&V(t.$$.fragment),n=C(),_(e,"class","item-details-settings-item svelte-fdmon8");},m(l,u){k(l,e,u),t&&x(t,e,null),g(e,n),i=!0;},p(l,u){if(u&2&&s!==(s=l[10].componentData.componentType)){if(t){fe();const d=t;M(d.$$.fragment,1,0,()=>{Z(d,1);}),pe();}s?(t=qe(s,a(l,u)),V(t.$$.fragment),T(t.$$.fragment,1),x(t,e,n)):t=null;}else if(s){const d=u&2?Rt(o,[Lt(l[10].componentData.props)]):{};t.$set(d);}},i(l){i||(t&&T(t.$$.fragment,l),i=!0);},o(l){t&&M(t.$$.fragment,l),i=!1;},d(l){l&&A(e),t&&Z(t);}}}c(BI,"create_each_block$e");function VU(r){var Dt,xe;let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E=((Dt=r[1])==null?void 0:Dt.name)+"",P,L,O,z,$=r[1]instanceof En?r[1]instanceof mn?"TOOL":"COMBO MOD":"MOD",U,N,Y,ee,B=((xe=r[1])==null?void 0:xe.description)+"",J,q,Q,X=te(r[0].tools),ne=[];for(let Te=0;Te<X.length;Te+=1)ne[Te]=$I(GI(r,X,Te));let W=te(r[0].mods.filter(r[6])),he=[];for(let Te=0;Te<W.length;Te+=1)he[Te]=YI(jI(r,W,Te));let Pe=te(r[0].mods.filter(r[8])),me=[];for(let Te=0;Te<Pe.length;Te+=1)me[Te]=zI(OI(r,Pe,Te));let Ae=r[1]!==void 0&&r[1].settings.length>0&&UI(r);return {c(){var Te;e=v("p"),e.innerHTML=`The Brush Laboratory has many mods and tools to create unique masterpices.<br/>
  Below, you can find all available tools and mods and their settings.<br/>
  Additionally to a tool, you can select one mod and multiple combo mods. Activation order matters!`,t=C(),n=v("div"),i=v("div"),o=v("h3"),o.textContent="Tools",s=C();for(let Ze=0;Ze<ne.length;Ze+=1)ne[Ze].c();a=C(),l=v("h3"),l.textContent="Mods",u=C();for(let Ze=0;Ze<he.length;Ze+=1)he[Ze].c();d=C(),h=v("h3"),h.textContent="Combo Mods",p=C();for(let Ze=0;Ze<me.length;Ze+=1)me[Ze].c();m=C(),b=v("div"),y=v("div"),w=v("img"),S=C(),R=v("h2"),P=G(E),L=C(),O=v("b"),z=G("("),U=G($),N=G(")"),Y=C(),ee=v("p"),J=G(B),q=C(),Ae&&Ae.c(),_(e,"class","description svelte-fdmon8"),_(o,"class","svelte-fdmon8"),_(l,"class","svelte-fdmon8"),_(h,"class","svelte-fdmon8"),_(i,"class","item-sidebar svelte-fdmon8"),ht(w.src,I="")||_(w,"src",I),H(w,"content",(Te=r[1])==null?void 0:Te.icon),_(w,"alt","icon"),_(w,"class","svelte-fdmon8"),_(O,"class","svelte-fdmon8"),_(y,"class","item-title svelte-fdmon8"),_(b,"class","item-details svelte-fdmon8"),_(n,"class","item-selection svelte-fdmon8");},m(Te,Ze){k(Te,e,Ze),k(Te,t,Ze),k(Te,n,Ze),g(n,i),g(i,o),g(i,s);for(let Ne=0;Ne<ne.length;Ne+=1)ne[Ne]&&ne[Ne].m(i,null);g(i,a),g(i,l),g(i,u);for(let Ne=0;Ne<he.length;Ne+=1)he[Ne]&&he[Ne].m(i,null);g(i,d),g(i,h),g(i,p);for(let Ne=0;Ne<me.length;Ne+=1)me[Ne]&&me[Ne].m(i,null);g(n,m),g(n,b),g(b,y),g(y,w),g(y,S),g(y,R),g(R,P),g(y,L),g(y,O),g(O,z),g(O,U),g(O,N),g(b,Y),g(b,ee),g(ee,J),g(b,q),Ae&&Ae.m(b,null),Q=!0;},p(Te,[Ze]){var Ne,ot,Pt;if(Ze&3){X=te(Te[0].tools);let Ue;for(Ue=0;Ue<X.length;Ue+=1){const Xe=GI(Te,X,Ue);ne[Ue]?ne[Ue].p(Xe,Ze):(ne[Ue]=$I(Xe),ne[Ue].c(),ne[Ue].m(i,a));}for(;Ue<ne.length;Ue+=1)ne[Ue].d(1);ne.length=X.length;}if(Ze&3){W=te(Te[0].mods.filter(Te[6]));let Ue;for(Ue=0;Ue<W.length;Ue+=1){const Xe=jI(Te,W,Ue);he[Ue]?he[Ue].p(Xe,Ze):(he[Ue]=YI(Xe),he[Ue].c(),he[Ue].m(i,d));}for(;Ue<he.length;Ue+=1)he[Ue].d(1);he.length=W.length;}if(Ze&3){Pe=te(Te[0].mods.filter(Te[8]));let Ue;for(Ue=0;Ue<Pe.length;Ue+=1){const Xe=OI(Te,Pe,Ue);me[Ue]?me[Ue].p(Xe,Ze):(me[Ue]=zI(Xe),me[Ue].c(),me[Ue].m(i,null));}for(;Ue<me.length;Ue+=1)me[Ue].d(1);me.length=Pe.length;}(!Q||Ze&2)&&H(w,"content",(Ne=Te[1])==null?void 0:Ne.icon),(!Q||Ze&2)&&E!==(E=((ot=Te[1])==null?void 0:ot.name)+"")&&K(P,E),(!Q||Ze&2)&&$!==($=Te[1]instanceof En?Te[1]instanceof mn?"TOOL":"COMBO MOD":"MOD")&&K(U,$),(!Q||Ze&2)&&B!==(B=((Pt=Te[1])==null?void 0:Pt.description)+"")&&K(J,B),Te[1]!==void 0&&Te[1].settings.length>0?Ae?(Ae.p(Te,Ze),Ze&2&&T(Ae,1)):(Ae=UI(Te),Ae.c(),T(Ae,1),Ae.m(b,null)):Ae&&(fe(),M(Ae,1,1,()=>{Ae=null;}),pe());},i(Te){Q||(T(Ae),Q=!0);},o(Te){M(Ae),Q=!1;},d(Te){Te&&(A(e),A(t),A(n)),Ie(ne,Te),Ie(he,Te),Ie(me,Te),Ae&&Ae.d();}}}c(VU,"create_fragment$l");function JU(r,e,t){let n,{feature:i}=e,{initTool:o=void 0}=e;const s=i.toolbarItemsStore;De(r,s,m=>t(0,n=m));let a=o;const l=c(m=>t(1,a=m.item),"click_handler"),u=c(m=>!(m.item instanceof En),"func"),d=c(m=>t(1,a=m.item),"click_handler_1"),h=c(m=>m.item instanceof En,"func_1"),p=c(m=>t(1,a=m.item),"click_handler_2");return r.$$set=m=>{"feature"in m&&t(3,i=m.feature),"initTool"in m&&t(4,o=m.initTool);},r.$$.update=()=>{var m;r.$$.dirty&17&&t(1,a=o??((m=n.tools.find(b=>b.active)??n.mods.find(b=>b.active)??n.tools[0])==null?void 0:m.item));},[n,a,s,i,o,l,u,d,h,p]}c(JU,"instance$k");const P0=class P0 extends se{constructor(e){super(),le(this,e,JU,VU,re,{feature:3,initTool:4});}};c(P0,"Drawing_brush_lab_manage");let Cg=P0;var FU=Object.defineProperty,kb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&FU(e,t,i),i},"__decorateClass$o");const N0=class N0 extends $e{constructor(){super(...arguments);f(this,"_toolsService");f(this,"_elementsSetup");f(this,"_modalService");f(this,"name","Brush Laboratory");f(this,"description","Add custom drawing tools for special effects to the toolbar");f(this,"tags",[ye.DRAWING]);f(this,"featureId",39);f(this,"_labSwitchComponent");f(this,"_labGroupComponent");f(this,"_toolbarItems$",new Le({tools:[],mods:[]}));f(this,"_items",[gg,th,ih,wg,yg,vg,nh,bg,rh,mg,_g]);f(this,"_brushLabToggleHotkey",this.useHotkey(new cn("toggle_lab","Toggle Brush Lab","Toggle the visibility of the brush lab below skribbl tools",this,()=>{var t;return (t=this._labSwitchComponent)==null?void 0:t.toggle()},!0,["ShiftLeft","KeyL"])));}get featureInfoComponent(){return {componentType:Sg,props:{feature:this}}}async onActivate(){const t=await this._elementsSetup.complete();this._labGroupComponent=new kg({target:t.skribblToolbar,props:{feature:this}}),this._labSwitchComponent=new Ag({target:t.skribblActions,props:{feature:this}}),this.createItems();}async onDestroy(){this._labSwitchComponent&&(this._labSwitchComponent.$destroy(),this._labSwitchComponent=void 0),this._labGroupComponent&&(this._labGroupComponent.$destroy(),this._labGroupComponent=void 0),(await Ee(this._toolbarItems$)).mods.forEach(({item:n})=>this._toolsService.removeMod(n)),await this._toolsService.activateTool(ui.brush);}get toolbarItemsStore(){return it(this._toolbarItems$.pipe(Qe(this._toolsService.activeTool$,this._toolsService.activeMods$),ce(([t,n,i])=>({mods:t.mods.map(o=>({item:o.item,active:i.includes(o.item)})),tools:t.tools.map(o=>({item:o.item,active:n===o.item}))}))),this._toolbarItems$.value)}createItems(){const t=this._items.map(o=>this._toolsService.resolveModOrTool(o)),n=t.filter(o=>o instanceof mn).map(o=>({item:o,active:!1})),i=t.filter(o=>!(o instanceof mn)).map(o=>({item:o,active:!1}));this._toolbarItems$.next({tools:n,mods:i});}async activateTool(t){await this._toolsService.activateTool(t);}async activateMod(t){await this._toolsService.activateMod(t);}async removeMod(t){await this._toolsService.removeMod(t);}openBrushLabSettings(t){const n={componentType:Cg,props:{feature:this,initTool:t}};this._modalService.showModal(n.componentType,n.props,"Brush Laboratory");}};c(N0,"DrawingBrushLabFeature");let Il=N0;kb([D(dn)],Il.prototype,"_toolsService");kb([D(Me)],Il.prototype,"_elementsSetup");kb([D(Dn)],Il.prototype,"_modalService");const O0=class O0{constructor(e,t){f(this,"_events$",new be);f(this,"_eventListener",this.onEvent.bind(this));this._element=e,this._eventType=t,e.addEventListener(t,this._eventListener);}onEvent(e){this._events$.next(e);}get events$(){return this._events$.asObservable()}unsubscribe(){this._element.removeEventListener(this._eventType,this._eventListener),this._events$.complete();}};c(O0,"DomEventSubscription");let Xr=O0;var WU=Object.defineProperty,Uh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&WU(e,t,i),i},"__decorateClass$n");const j0=class j0 extends $e{constructor(){super(...arguments);f(this,"_toastService");f(this,"_elementsSetup");f(this,"_drawingService");f(this,"_lobbyService");f(this,"name","Lock Clear");f(this,"description","Asks for confirmation before clearing the canvas in practice mode, and optionally in lobbies.");f(this,"tags",[ye.DRAWING]);f(this,"featureId",53);f(this,"_onlyPracticeLobbies",this.useSetting(new He("only_private",!0,this).withName("Lock only for practice lobbies").withDescription("Clearing in public/private lobbies will be enabled.")));f(this,"_clearButtonSubscription");f(this,"_clearLockedSubscription");}async onActivate(){const t=await this._elementsSetup.complete();this._clearButtonSubscription=new Xr(t.clearButton,"click"),this._clearLockedSubscription=this._onlyPracticeLobbies.changes$.pipe(Qe(this._lobbyService.lobby$)).subscribe(([n,i])=>{if(i===null){this._drawingService.lockManualClear(!1);return}n?this._drawingService.lockManualClear(i.id===null):this._drawingService.lockManualClear(!0);}),this._clearButtonSubscription.events$.pipe(Oe(this._drawingService.manualClearLocked$),Se(([,n])=>n===!0),lt(async()=>(await this._toastService.showConfirmToast("Clear drawing?","Clearing the drawing cannot be undone.",1e4)).result),Se(n=>n===!0)).subscribe(()=>this._drawingService.clearImage());}async onDestroy(){var t,n;this._drawingService.lockManualClear(!1),(t=this._clearButtonSubscription)==null||t.unsubscribe(),this._clearButtonSubscription=void 0,(n=this._clearLockedSubscription)==null||n.unsubscribe(),this._clearLockedSubscription=void 0;}};c(j0,"DrawingClearLockFeature");let _o=j0;Uh([D(ft)],_o.prototype,"_toastService");Uh([D(Me)],_o.prototype,"_elementsSetup");Uh([D(zt)],_o.prototype,"_drawingService");Uh([D(ut)],_o.prototype,"_lobbyService");var HU=Object.defineProperty,QU=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&HU(e,t,i),i},"__decorateClass$m");const G0=class G0 extends $e{constructor(){super(...arguments);f(this,"_drawingService");f(this,"name","Brush Size Hotkeys");f(this,"description","Adds hotkeys to change the brush size");f(this,"tags",[ye.DRAWING]);f(this,"featureId",51);f(this,"_sizeHotkeys",[1,2,3,4,5].map(t=>this.useHotkey(new cn(`size_${t}`,`Brush size ${t}`,`Set the brush size to level ${t}`,this,()=>this._drawingService.setSize([4,10,20,32,40][t-1]),!0,[`Digit${t}`]))));}};c(G0,"DrawingSizeHotkeysFeature");let oh=G0;QU([D(zt)],oh.prototype,"_drawingService");const XU=["#ed2b34","#ff7b00","#ffff1b","#67dc14","#00f2fe","#4058f6","#a805fc","#ff75dc","#01eda2","#fd7b7b","#847f86","#413f42","#8f563b","#663a31","#eec399","#ed3036","#ffd50e","#4f9500","#3dbffd","#465af7","#de2fff","#88828e","#683d34","#e8a26f","#00ae85","#ff7c80","#a5b0b6","#a5b0b6"],$0=class $0{constructor(e,t,n){f(this,"_events",[]);f(this,"_archive",new Map);f(this,"_aggregation","single");f(this,"_ordering","time");f(this,"_metricUnit");f(this,"_metricTemporalUnit");f(this,"_yLabels");f(this,"_xLabels");this._name=e,this._description=t,this._valueSelector=n;}get datasetMode(){return this._aggregation==="single"?"line":"bar"}get name(){return this._name}get description(){return this._description}withAggregation(e){return this._aggregation=e,this}withOrdering(e){return this._ordering=e,this}withMetricUnit(e){return this._metricUnit=e,this}withMetricTemporalUnit(e){return this._metricTemporalUnit=e,this}withYLabels(e){return this._yLabels=e,this}withXLabels(e){return this._xLabels=e,this}addEvent(e){this._events.push(e);}archiveEvents(e){this._archive.set(e,this._events),this._events=[];}clearEvents(e=!1){this._events=[],e&&this._archive.clear();}drawChart(e,t,n){const i=n?this._archive.get(n)??[]:this._events,o=this.getDatasetForPlayers(e,i);if(o.length===0)throw new Error("No dataset found for players");t.setDataset(o,{title:this._name,description:this._description,xUnit:this._metricTemporalUnit,yUnit:this._metricUnit,yLabels:this._yLabels,xLabels:this._xLabels,mode:this.datasetMode});}filterPlayersWithData(e,t){const n=t?this._archive.get(t)??[]:this._events;return e.filter(i=>n.some(o=>o.playerId===i.id))}generateTable(e,t){const n=t?this._archive.get(t)??[]:this._events,i=this.getDatasetForPlayers(e,n);if(i.length===0)throw new Error("No dataset found for players");const s=[["Name","Id","Time","Round","Turn",this.name]];return i.forEach(a=>{a.data.forEach(l=>{s.push([a.label,l.originalEvent?l.originalEvent.playerId.toString():"-",l.originalEvent?new Date(l.originalEvent.timestamp).toISOString():"-",l.originalEvent?`${l.originalEvent.lobbyRound}`:"-",l.originalEvent?`${l.originalEvent.turnPlayerId}`:"-",l.y.toString()]);});}),s}generateSummary(e,t){const n=t?this._archive.get(t)??[]:this._events,i=this.getDatasetForPlayers(e,n);if(i.length===0)throw new Error("No dataset found for players");const o=i.map(s=>{const a=s.data[s.data.length-1].y,l=s.label;return {result:a,unit:this._metricUnit??"",player:l}});return this._ordering==="minValue"?o.sort((s,a)=>s.result-a.result):this._ordering==="maxValue"?o.sort((s,a)=>a.result-s.result):o}getDatasetForPlayers(e,t){const n=this.buildTemporalLookup(t),o=e.map(s=>{const a=t.filter(u=>u.playerId===s.id);if(a.length===0)return;let l=[];if(this._aggregation==="single")l=a.map(u=>({x:n.get(this.buildTemporalKey(u.lobbyRound,u.turnPlayerId))??0,y:this._valueSelector(u),originalEvent:u}));else if(this._aggregation==="cumulative")l=[{y:a.map(d=>this._valueSelector(d)).reduce((d,h)=>d+h,0),x:0}];else if(this._aggregation==="average")l=[{y:a.map(d=>this._valueSelector(d)).reduce((d,h)=>d+h,0)/a.length,x:0}];else if(this._aggregation==="ranking"){if(this._ordering==="minValue"){const u=a.reduce((d,h)=>this._valueSelector(d)<this._valueSelector(h)?d:h);l=[{y:this._valueSelector(u),x:0}];}else if(this._ordering==="maxValue"){const u=a.reduce((d,h)=>this._valueSelector(d)>this._valueSelector(h)?d:h);l=[{y:this._valueSelector(u),x:0}];}}return {label:s.name,color:XU[s.avatar[0]],data:l}}).filter(s=>s!==void 0&&s.data.length>0);return this._aggregation==="single"?o:this._ordering==="minValue"?o.sort((s,a)=>{const l=Math.min(...s.data.map(d=>d.y)),u=Math.min(...a.data.map(d=>d.y));return l-u}):this._ordering==="maxValue"?o.sort((s,a)=>{const l=Math.max(...s.data.map(d=>d.y));return Math.max(...a.data.map(d=>d.y))-l}):o}buildTemporalLookup(e){const t=new Set;e.forEach(s=>t.add(this.buildTemporalKey(s.lobbyRound,s.turnPlayerId)));const i=Array.from(t).map(s=>s.split("_")).map(([s,a])=>({round:Number(s),turn:Number(a)})).map(s=>({round:s.round,turn:s.turn})).sort((s,a)=>a.round===s.round?a.turn-s.turn:s.round-a.round).map((s,a)=>({key:this.buildTemporalKey(s.round,s.turn),index:a})),o=new Map;return i.forEach(s=>o.set(s.key,s.index)),o}buildTemporalKey(e,t){return `${e}_${t}`}};c($0,"MetricView");let tn=$0;const Jr=c(r=>Math.round(r/100)/10,"millisAsSeconds"),pn=c((r,e)=>t=>{const n=[];for(let i=0;i<=t.maxY;i+=r){const o=r<1?1:0;n.push({y:i,label:i.toFixed(o)+(e?` ${e}`:"")});}return n},"yLabelIncrements"),qU=c(()=>Object.freeze({totalScore:new tn("Score Ranking","The total ranking, progressing over time",r=>r.score).withYLabels(pn(500,"pts")).withMetricUnit("pts").withOrdering("maxValue"),finalStandings:new tn("Final Score Ranking","The final ranking of the lobby leaderboard",r=>r.score).withYLabels(pn(500,"pts")).withMetricUnit("pts").withAggregation("ranking").withOrdering("maxValue"),averageCompletionTime:new tn("Average Completion Time","The average time a player needed to guess the word, or until everyone guessed the drawing",r=>Jr(r.completionTimeMs)).withYLabels(pn(10,"s")).withMetricUnit("s").withAggregation("average").withOrdering("minValue"),completionTime:new tn("Completion Time","The time a player needed to guess the word, or until everyone guessed the drawing, progressing over time",r=>Jr(r.completionTimeMs)).withYLabels(pn(10,"s")).withMetricUnit("s").withOrdering("minValue").withAggregation("single"),averageGuessTime:new tn("Average Guess Time","The average time a player needed to guess a word",r=>Jr(r.guessTimeMs)).withYLabels(pn(2,"s")).withMetricUnit("s").withAggregation("average").withOrdering("minValue"),averageGuessScore:new tn("Average Guess Score","The average score a player got per correct guess",r=>r.score).withYLabels(pn(50,"pts")).withMetricUnit("pts").withAggregation("average").withOrdering("maxValue"),averageGuessSpeed:new tn("Average Guess Speed","The average time between guesses a player sent",r=>Jr(r.gapTimeMs)).withYLabels(pn(5,"s")).withMetricUnit("s").withAggregation("average").withOrdering("minValue"),averageNeededGuesses:new tn("Average Guesses Needed","The average number of guesses a player needed to guess a word",r=>r.guessCount).withYLabels(pn(1)).withAggregation("average").withOrdering("minValue"),fastestGuess:new tn("Fastest Guess","The fastest correct guess for a word",r=>Jr(r.guessTimeMs)).withYLabels(pn(2,"s")).withMetricUnit("s").withAggregation("ranking").withOrdering("minValue"),longestGuessStreak:new tn("Longest Guess Streak","The longest streak of correct guesses in a row",r=>r.streak).withYLabels(pn(1)).withAggregation("ranking").withOrdering("maxValue"),averageGuessAccuracy:new tn("Average Guess Accuracy","The average letter count accuracy of player guesses",r=>r.accuracy*100).withYLabels(pn(10)).withAggregation("average").withOrdering("maxValue"),averageGuessRank:new tn("Average Guess Rank","The average rank of player's correct guess",r=>r.rank).withYLabels(pn(1)).withAggregation("average").withOrdering("minValue"),averageDrawTime:new tn("Average Draw Time","The average draw time of a player",r=>Jr(r.drawTimeMs)).withMetricUnit("s").withAggregation("average").withYLabels(pn(5,"s")).withOrdering("minValue"),fastestDrawTime:new tn("Fastest Draw Time","The fastest draw time of a player",r=>Jr(r.drawTimeMs)).withYLabels(pn(2,"s")).withMetricUnit("s").withAggregation("ranking").withOrdering("minValue"),averageGuessedPlayers:new tn("Average Guessed Players","The average amount of players that guessed a player's drawing",r=>r.guessedPlayers).withYLabels(pn(1)).withAggregation("average").withOrdering("maxValue"),averageDrawScore:new tn("Average Draw Score","The average score for a player's drawing",r=>r.score).withYLabels(pn(500,"pts")).withAggregation("average").withOrdering("maxValue").withMetricUnit("pts"),averageDrawLikes:new tn("Average Draw Likes","The average likes for player drawings",r=>r.likes).withYLabels(pn(1)).withAggregation("average").withOrdering("maxValue"),mostDrawDislikes:new tn("Most Draw Dislikes","The most dislikes a player received for a drawing",r=>r.dislikes).withYLabels(pn(1)).withAggregation("ranking").withOrdering("maxValue")}),"createMetricViews");var KU=Object.defineProperty,e6=Object.getOwnPropertyDescriptor,yr=c((r,e,t,n)=>{for(var i=n>1?void 0:n?e6(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&KU(e,t,i),i},"__decorateClass$l"),t6=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam$1"),Ya;let ai=(Ya=class{constructor(e){f(this,"_lobbyService");f(this,"_lobbyInteractedEventListener");f(this,"_lobbyStateChangedEventListener");f(this,"_wordGuessedEventListener");f(this,"_chatService");f(this,"_drawingService");f(this,"_lobbyJoinedEventListener");f(this,"_logger");f(this,"_guessTimeStats$",new be);f(this,"_completionTimeStats$",new be);f(this,"_guessCountStats$",new be);f(this,"_guessMessageGapStats$",new be);f(this,"_guessScoreStats$",new be);f(this,"_guessAccuracyStats$",new be);f(this,"_guessStreakStats$",new be);f(this,"_guessRankStats$",new be);f(this,"_drawTimeStats$",new be);f(this,"_drawGuessedPlayersStats$",new be);f(this,"_drawScoreStats$",new be);f(this,"_drawLikesStats$",new be);f(this,"_drawDislikesStats$",new be);f(this,"_turnStandingScoreStats$",new be);this._logger=e(this);}get guessTimeStats$(){return this._guessTimeStats$.asObservable()}get completionTimeStats$(){return this._completionTimeStats$.asObservable()}get guessCountStats$(){return this._guessCountStats$.asObservable()}get guessMessageGapStats$(){return this._guessMessageGapStats$.asObservable()}get guessScoreStats$(){return this._guessScoreStats$.asObservable()}get guessAccuracyStats$(){return this._guessAccuracyStats$.asObservable()}get guessStreakStats$(){return this._guessStreakStats$.asObservable()}get guessRankStats$(){return this._guessRankStats$.asObservable()}get drawTimeStats$(){return this._drawTimeStats$.asObservable()}get drawGuessedPlayersStats$(){return this._drawGuessedPlayersStats$.asObservable()}get drawScoreStats$(){return this._drawScoreStats$.asObservable()}get drawLikesStats$(){return this._drawLikesStats$.asObservable()}get drawDislikesStats$(){return this._drawDislikesStats$.asObservable()}get turnStandingScoreStats$(){return this._turnStandingScoreStats$.asObservable()}postConstruct(){this.processEvents();}createEventSignature(e,t,n){if(e.id===null)throw new Error("lobbyId must be provided");return {lobbyId:e.id,lobbyRound:e.round,playerId:n,turnPlayerId:t,timestamp:Date.now()}}processEvents(){const e=this._lobbyService.lobby$.pipe(Oe(this._lobbyStateChangedEventListener.events$.pipe(ce(o=>{var s;return (s=o.data.drawingStarted)==null?void 0:s.drawerId}),Se(o=>o!==void 0))),ce(([o,s])=>o===null||o.id===null?null:{lobby:o,turnPlayerId:s})),t=new be;e.subscribe(t);const n=this._lobbyStateChangedEventListener.events$.pipe(ce(o=>o.data.drawingStarted),Se(o=>o!==void 0)),i=new be;n.subscribe(i),i.pipe(lt(()=>this._lobbyInteractedEventListener.events$.pipe(Se(o=>o.data.likeInteraction!==void 0),Wo(this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.drawingRevealed!==void 0))),gf(),Oe(t),Se(([,o])=>o!==null),ce(([o,s])=>{if(s===null)throw new Error("lobbyData must be provided");return {...this.createEventSignature(s.lobby,s.turnPlayerId,s.turnPlayerId),likes:o}})))).subscribe(o=>this._drawLikesStats$.next(o)),i.pipe(lt(()=>this._lobbyInteractedEventListener.events$.pipe(Se(o=>o.data.dislikeInteraction!==void 0),Wo(this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.drawingRevealed!==void 0))),gf(),Oe(t),Se(([,o])=>o!==null),ce(([o,s])=>{if(s===null)throw new Error("lobbyData must be provided");return {...this.createEventSignature(s.lobby,s.turnPlayerId,s.turnPlayerId),dislikes:o}})))).subscribe(o=>this._drawDislikesStats$.next(o)),i.pipe(lt(()=>this._wordGuessedEventListener.events$.pipe(Wo(this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.drawingRevealed!==void 0))),gf(),Oe(t),Se(([,o])=>o!==null),ce(([o,s])=>{if(s===null)throw new Error("lobbyData must be provided");return {...this.createEventSignature(s.lobby,s.turnPlayerId,s.turnPlayerId),guessedPlayers:o}})))).subscribe(o=>this._drawGuessedPlayersStats$.next(o)),i.pipe(ce(()=>Date.now()),lt(o=>this._lobbyStateChangedEventListener.events$.pipe(Se(s=>s.data.drawingRevealed!==void 0),vt(1),ce(()=>Date.now()-o))),Oe(t),Se(([,o])=>o!==null),ce(([o,s])=>{if(s===null)throw new Error("lobbyData must be provided");return {...this.createEventSignature(s.lobby,s.turnPlayerId,s.turnPlayerId),drawTimeMs:o}})).subscribe(o=>this._drawTimeStats$.next(o)),i.pipe(lt(()=>this._lobbyStateChangedEventListener.events$.pipe(ce(o=>o.data.drawingRevealed),Se(o=>o!==void 0),vt(1),Oe(t),Se(([,o])=>o!==null)))).subscribe(([o,s])=>{if(s===null)throw new Error("lobby must be provided");for(const a of o.scores){const l={...this.createEventSignature(s.lobby,s.turnPlayerId,a.playerId),score:a.rewarded};a.playerId===s.turnPlayerId?this._drawScoreStats$.next(l):this._guessScoreStats$.next(l);const u={...this.createEventSignature(s.lobby,s.turnPlayerId,a.playerId),score:a.score};this._turnStandingScoreStats$.next(u);}}),i.pipe(ce(()=>Date.now()),lt(o=>this._wordGuessedEventListener.events$.pipe(ce(s=>({playerId:s.data.playerId,guessTimeMs:Date.now()-o})),Wo(this._lobbyStateChangedEventListener.events$.pipe(Se(s=>s.data.drawingRevealed!==void 0))),Kt(this._lobbyStateChangedEventListener.events$.pipe(Se(s=>s.data.drawingRevealed!==void 0),vt(1),lt(s=>{var u;const a=Date.now()-o,l=((u=s.data.drawingRevealed)==null?void 0:u.scores.filter(d=>d.rewarded===0).map(d=>({playerId:d.playerId,guessTimeMs:a})))??[];return ji(l)}))),Oe(t),Se(([,s])=>s!==null),ce(([s,a])=>{if(a===null)throw new Error("lobbyData must be provided");return {...this.createEventSignature(a.lobby,a.turnPlayerId,s.playerId),guessTimeMs:s.guessTimeMs}})))).subscribe(o=>this._guessTimeStats$.next(o)),this._lobbyStateChangedEventListener.events$.pipe(ce(o=>o.data.drawingRevealed),Se(o=>o!==void 0),vt(1),Oe(t),Se(([,o])=>o!==null)).subscribe(([o,s])=>{if(s===null)throw new Error("lobby must be provided");const a=o.scores.filter(l=>l.playerId!==s.turnPlayerId).sort((l,u)=>u.rewarded-l.rewarded).map(l=>l.playerId);for(const l of o.scores){const u=a.indexOf(l.playerId);if(u===-1)continue;const h={...this.createEventSignature(s.lobby,s.turnPlayerId,l.playerId),rank:u+1};this._guessRankStats$.next(h);}}),this._wordGuessedEventListener.events$.pipe(Oe(i.pipe(ce(()=>new Map),lt(o=>this._chatService.playerMessageReceived$.pipe(Se(s=>!s.player.guessed),_t(s=>{const a=o.get(s.player.id)??0;o.set(s.player.id,a+1);}),ce(()=>o))))),ce(([o,s])=>({playerId:o.data.playerId,count:(s.get(o.data.playerId)??0)+1})),Oe(t),Se(([,o])=>o!==null)).subscribe(([o,s])=>{if(s===null)throw new Error("lobby must be provided");const a={...this.createEventSignature(s.lobby,s.turnPlayerId,o.playerId),guessCount:o.count};this._guessCountStats$.next(a);}),this._chatService.playerMessageReceived$.pipe(Se(o=>!o.player.guessed),ce(o=>({message:o.content,playerId:o.player.id})),Kt(this._wordGuessedEventListener.events$.pipe(ce(o=>({message:void 0,playerId:o.data.playerId})))),Oe(i.pipe(ce(()=>({guesses:new Map,turnStart:Date.now()}))),this._lobbyService.lobby$,this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.timerSet===void 0))),Se(([,,,o])=>o.data.drawingStarted!==void 0),ce(([o,s])=>{const a=s.guesses.get(o.playerId)??s.turnStart;return s.guesses.set(o.playerId,Date.now()),{playerId:o.playerId,gapTimeMs:Date.now()-a,message:o.message}}),Oe(t,this._drawingService.imageState$),Se(([o,s])=>s!==null&&s.turnPlayerId!==o.playerId)).subscribe(([o,s,a])=>{if(s===null)throw new Error("lobby must be provided");if(a===null||a.word===void 0)throw new Error("drawing must be provided");const l={...this.createEventSignature(s.lobby,s.turnPlayerId,o.playerId),gapTimeMs:o.gapTimeMs,message:o.message,hints:a.word.hints};this._guessMessageGapStats$.next(l);const u=o.message===void 0?1:Z$(o.message,a.word.hints,!0),d={...this.createEventSignature(s.lobby,s.turnPlayerId,o.playerId),accuracy:u,message:o.message,hints:a.word.hints};this._guessAccuracyStats$.next(d);}),this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.gameEnded!==void 0),Kt(this._lobbyJoinedEventListener.events$),ce(()=>new Map),lt(o=>this._wordGuessedEventListener.events$.pipe(ce(s=>{const a=o.get(s.data.playerId)??0;return o.set(s.data.playerId,a+1),{streak:a+1,playerId:s.data.playerId}}),Kt(this._lobbyStateChangedEventListener.events$.pipe(Oe(this._lobbyService.lobby$),lt(([s,a])=>{var u;const l=[];return (u=s.data.drawingRevealed)==null||u.scores.forEach(d=>{d.rewarded===0&&d.playerId!==(a==null?void 0:a.drawerId)&&(o.set(d.playerId,0),l.push({streak:0,playerId:d.playerId}));}),ji(l)}))))),Oe(t),Se(([,o])=>o!==null)).subscribe(([o,s])=>{if(s===null)throw new Error("lobby must be provided");const a={...this.createEventSignature(s.lobby,s.turnPlayerId,o.playerId),streak:o.streak};this._guessStreakStats$.next(a);}),i.pipe(lt(()=>this._guessTimeStats$.pipe(Wo(this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.drawingRevealed!==void 0),jl(50))),ce(o=>o.guessTimeMs),kD((o,s)=>({sum:o.sum+s,count:o.count+1}),{sum:0,count:0}),ce(o=>o.count===0?0:o.sum/o.count),Oe(t),ce(([o,s])=>{if(s===null)throw new Error("lobby must be provided");return {...this.createEventSignature(s.lobby,s.turnPlayerId,s.turnPlayerId),completionTimeMs:o}}))),Kt(this._guessTimeStats$.pipe(ce(o=>({...o,completionTimeMs:o.guessTimeMs}))))).subscribe(o=>this._completionTimeStats$.next(o));}},c(Ya,"LobbyStatsService"),Ya);yr([D(ut)],ai.prototype,"_lobbyService",2);yr([D(Ka)],ai.prototype,"_lobbyInteractedEventListener",2);yr([D(Zn)],ai.prototype,"_lobbyStateChangedEventListener",2);yr([D(Dr)],ai.prototype,"_wordGuessedEventListener",2);yr([D(rn)],ai.prototype,"_chatService",2);yr([D(zt)],ai.prototype,"_drawingService",2);yr([D(Gi)],ai.prototype,"_lobbyJoinedEventListener",2);yr([zr()],ai.prototype,"postConstruct",1);ai=yr([we(),t6(0,D(rt))],ai);const Y0=class Y0{constructor(e,t){f(this,"_canvas");f(this,"_context");f(this,"_chartArea");this._chartLayout=e,this._canvas=t??document.createElement("canvas"),this._canvas.width=this._chartLayout.width,this._canvas.height=this._chartLayout.height,this._chartArea=this._chartLayout.chartArea;const n=this._canvas.getContext("2d");if(!n)throw new Error("Could not get 2D context from canvas");this._context=n,this._canvas.style.imageRendering="auto",this._canvas.style.width="100%",this.clear();}get canvas(){return this._canvas}setDataset(e,t){this.clear();const n=this.getChartDataProperties(e);this.drawTitle(t.title),this.drawDescription(t.description),this.drawGridlines(n,t),t.mode==="bar"?this.drawBars(e,n,t):t.mode==="line"&&this.drawLines(e,n,t),this.drawAxis(),this.drawAxisLabels(n,t),this.drawLegend(e);}getChartDataProperties(e){const t=e.flatMap(i=>i.data.map(o=>o.x)),n=e.flatMap(i=>i.data.map(o=>o.y));return {minX:Math.min(...t),maxX:Math.max(...t),minY:Math.min(...n),maxY:Math.max(...n),datasets:e.length}}clear(){this._context.clearRect(0,0,this._chartLayout.width,this._chartLayout.height),this._context.fillStyle="#FFF",this._context.fillRect(0,0,this._chartLayout.width,this._chartLayout.height);}drawTitle(e){this._context.font="bold 40px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="top",this._context.textAlign="center",this._context.fillText(e,this._chartLayout.width/2,30);}drawDescription(e){this._context.font="25px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="top",this._context.textAlign="center",this._context.fillText(e,this._chartLayout.width/2,80);}drawTypoIcon(){}drawAxis(){this._context.strokeStyle="#000",this._context.lineWidth=2,this._context.beginPath(),this._context.moveTo(this._chartArea.x,this._chartArea.y),this._context.lineTo(this._chartArea.x,this._chartArea.y+this._chartArea.height),this._context.lineTo(this._chartArea.x+this._chartArea.width,this._chartArea.y+this._chartArea.height),this._context.stroke();}drawGridlines(e,t){const n=Math.floor(this._chartArea.height/this._chartLayout.yGridGap);if(this._context.strokeStyle="#0002",this._context.lineWidth=1,this._context.beginPath(),t.yLabels)t.yLabels(e).forEach(i=>{const o=this.chartToCanvasY(i.y,e);this._context.moveTo(this._chartArea.x,o),this._context.lineTo(this._chartArea.x+this._chartArea.width,o);});else for(let i=0;i<=n;i++){const o=this._chartArea.y+i*this._chartLayout.yGridGap;this._context.moveTo(this._chartArea.x,o),this._context.lineTo(this._chartArea.x+this._chartArea.width,o);}t.xLabels&&t.xLabels(e).forEach(i=>{const o=this.chartToCanvasX(i.x,e);this._context.moveTo(o,this._chartArea.y),this._context.lineTo(o,this._chartArea.y+this._chartArea.height);}),this._context.stroke();}drawAxisLabels(e,t){if(t.yLabels)this._context.font="20px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="middle",this._context.textAlign="right",t.yLabels(e).forEach(n=>{const i=this.chartToCanvasY(n.y,e);this._context.fillText(n.label,this._chartArea.x-10,i);});else {const n=Math.floor(this._chartArea.height/this._chartLayout.yGridGap),i=e.maxY/n;this._context.font="20px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="middle",this._context.textAlign="right";const o=e.maxY/n<10?1:0;for(let s=0;s<=n;s++){const a=s*i,l=this._chartArea.y+this._chartArea.height-s*this._chartLayout.yGridGap;this._context.fillText(a.toFixed(o)+(t.yUnit??""),this._chartArea.x-10,l);}}t.xLabels&&(this._context.font="20px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="top",this._context.textAlign="center",t.xLabels(e).forEach(n=>{const i=this.chartToCanvasX(n.x,e);this._context.fillText(n.label,i,this._chartArea.y+this._chartArea.height+10);}));}drawBars(e,t,n){const i=this._chartLayout.barPadding,o=this._chartArea.width-i*2,s=Math.min(50,o/e.length+(e.length-1)*i);e.forEach((a,l)=>{if(this._context.fillStyle=a.color+"80",this._context.strokeStyle=a.color,this._context.lineWidth=2,a.data.length===0)throw new Error("Dataset has no data points");a.data.slice(0,1).forEach(u=>{const d=this._chartArea.x+i+l*(s+i),h=this.chartToCanvasY(u.y,t),p=this._chartArea.y+this._chartArea.height-h;if(this._context.fillRect(d,h,s,p),this._context.strokeRect(d,h,s,p),u.label)this._context.font="15px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="bottom",this._context.textAlign="center",this._context.fillText(u.label,d+s/2,h-5);else {this._context.font="15px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="bottom",this._context.textAlign="center",this._context.fillText(`${a.label}`,d+s/2,h-30);const m=u.y<10?2:u.y<100?1:0;this._context.fillText(`${u.y.toFixed(m)}${n.yUnit??""}`,d+s/2,h-5);}});});}drawLines(e,t,n){e.forEach(i=>{this._context.strokeStyle=i.color,this._context.lineWidth=3,this._context.beginPath(),i.data.forEach((o,s)=>{const a=this.chartToCanvasX(o.x,t),l=this.chartToCanvasY(o.y,t);if(s===0?this._context.moveTo(a,l):this._context.lineTo(a,l),o.label)this._context.font="15px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="bottom",this._context.textAlign=s===0||s!=i.data.length-1?"left":"center",this._context.fillText(o.label,a,l-5);else if(s===i.data.length-1&&o.y>0){this._context.font="15px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="bottom",this._context.textAlign=s===0?"left":"center";const u=o.y<10?2:o.y<100?1:0;this._context.fillText(`${i.label} (${o.y.toFixed(u)}${n.yUnit})`,a+5,l-5);}}),this._context.stroke(),i.data.forEach(o=>{if(o.y===0)return;const s=this.chartToCanvasX(o.x,t),a=this.chartToCanvasY(o.y,t);this._context.fillStyle=i.color,this._context.beginPath(),this._context.arc(s,a,4,0,Math.PI*2),this._context.fill();});});}drawLegend(e){let t=this._chartArea.x;for(const n of e){const i=t,o=this._chartLayout.height-50;this._context.fillStyle=n.color,this._context.beginPath(),this._context.arc(i,o,10,0,Math.PI*2),this._context.fill(),this._context.font="20px Nunito, monospace",this._context.fillStyle="#000",this._context.textBaseline="middle",this._context.textAlign="left",this._context.fillText(n.label,i+20,o);const s=this._context.measureText(n.label).width;t+=60+s;}}chartToCanvasX(e,t){return t.maxX===0?this._chartArea.x:this._chartArea.x+e/t.maxX*this._chartArea.width}chartToCanvasY(e,t){return this._chartArea.y+this._chartArea.height-e/t.maxY*this._chartArea.height}};c(Y0,"Chart");let Ig=Y0;function xI(r,e,t){const n=r.slice();return n[27]=e[t],n}c(xI,"get_each_context$d");function ZI(r,e,t){const n=r.slice();return n[30]=e[t],n}c(ZI,"get_each_context_1$1");function VI(r,e,t){const n=r.slice();return n[33]=e[t],n}c(VI,"get_each_context_2");function JI(r,e,t){const n=r.slice();return n[36]=e[t],n[37]=e,n[38]=t,n}c(JI,"get_each_context_3");function FI(r,e,t){const n=r.slice();return n[39]=e[t],n[41]=t,n}c(FI,"get_each_context_4");function WI(r,e,t){const n=r.slice();return n[42]=e[t],n}c(WI,"get_each_context_5");function HI(r){let e,t=r[42][1].name+"",n,i,o,s;return {c(){e=v("option"),n=G(t),i=C(),e.__value=o=r[42][0],de(e,e.__value),e.selected=s=r[42][0]===r[3];},m(a,l){k(a,e,l),g(e,n),g(e,i);},p(a,l){l[0]&128&&t!==(t=a[42][1].name+"")&&K(n,t),l[0]&128&&o!==(o=a[42][0])&&(e.__value=o,de(e,e.__value)),l[0]&136&&s!==(s=a[42][0]===a[3])&&(e.selected=s);},d(a){a&&A(e);}}}c(HI,"create_each_block_5");function QI(r){let e,t=r[39].name+"",n,i,o;return {c(){e=v("option"),n=G(t),i=C(),e.__value=r[41],de(e,e.__value),e.selected=o=r[39]===r[8][r[2]];},m(s,a){k(s,e,a),g(e,n),g(e,i);},p(s,a){a[0]&4&&o!==(o=s[39]===s[8][s[2]])&&(e.selected=o);},d(s){s&&A(e);}}}c(QI,"create_each_block_4");function XI(r){let e,t,n;function i(s){r[20](s,r[36]);}c(i,"checkbox_checked_binding");let o={description:r[36].name+" (#"+r[36].id+")"};return r[5][r[36].id]!==void 0&&(o.checked=r[5][r[36].id]),e=new It({props:o}),Ve.push(()=>bt(e,"checked",i)),e.$on("change",r[21]),{c(){V(e.$$.fragment);},m(s,a){x(e,s,a),n=!0;},p(s,a){r=s;const l={};a[0]&16&&(l.description=r[36].name+" (#"+r[36].id+")"),!t&&a[0]&48&&(t=!0,l.checked=r[5][r[36].id],gt(()=>t=!1)),e.$set(l);},i(s){n||(T(e.$$.fragment,s),n=!0);},o(s){M(e.$$.fragment,s),n=!1;},d(s){Z(e,s);}}}c(XI,"create_each_block_3");function n6(r){let e;return {c(){e=v("p"),e.textContent="No data available for the selected players and view.";},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(n6,"create_else_block$5");function i6(r){let e,t,n,i,o,s,a,l,u,d,h,p,m;i=new ke({props:{color:"green",content:"Download as CSV"}}),i.$on("click",r[22]),s=new ke({props:{color:"green",content:"Download Chart"}}),s.$on("click",r[23]);let b=te(r[6][0]),y=[];for(let S=0;S<b.length;S+=1)y[S]=qI(VI(r,b,S));let w=te(r[6].slice(1)),I=[];for(let S=0;S<w.length;S+=1)I[S]=eT(xI(r,w,S));return {c(){e=v("h3"),e.textContent="Chart Data",t=C(),n=v("div"),V(i.$$.fragment),o=C(),V(s.$$.fragment),a=C(),l=v("table"),u=v("thead"),d=v("tr");for(let S=0;S<y.length;S+=1)y[S].c();h=C(),p=v("tbody");for(let S=0;S<I.length;S+=1)I[S].c();_(n,"class","typo-stats-chart-table-download"),_(d,"class","svelte-10kahpp"),_(l,"class","svelte-10kahpp");},m(S,R){k(S,e,R),k(S,t,R),k(S,n,R),x(i,n,null),g(n,o),x(s,n,null),k(S,a,R),k(S,l,R),g(l,u),g(u,d);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(d,null);g(l,h),g(l,p);for(let E=0;E<I.length;E+=1)I[E]&&I[E].m(p,null);m=!0;},p(S,R){if(R[0]&64){b=te(S[6][0]);let E;for(E=0;E<b.length;E+=1){const P=VI(S,b,E);y[E]?y[E].p(P,R):(y[E]=qI(P),y[E].c(),y[E].m(d,null));}for(;E<y.length;E+=1)y[E].d(1);y.length=b.length;}if(R[0]&64){w=te(S[6].slice(1));let E;for(E=0;E<w.length;E+=1){const P=xI(S,w,E);I[E]?I[E].p(P,R):(I[E]=eT(P),I[E].c(),I[E].m(p,null));}for(;E<I.length;E+=1)I[E].d(1);I.length=w.length;}},i(S){m||(T(i.$$.fragment,S),T(s.$$.fragment,S),m=!0);},o(S){M(i.$$.fragment,S),M(s.$$.fragment,S),m=!1;},d(S){S&&(A(e),A(t),A(n),A(a),A(l)),Z(i),Z(s),Ie(y,S),Ie(I,S);}}}c(i6,"create_if_block$9");function qI(r){let e,t=r[33]+"",n;return {c(){e=v("th"),n=G(t),_(e,"class","svelte-10kahpp");},m(i,o){k(i,e,o),g(e,n);},p(i,o){o[0]&64&&t!==(t=i[33]+"")&&K(n,t);},d(i){i&&A(e);}}}c(qI,"create_each_block_2");function KI(r){let e,t=r[30]+"",n;return {c(){e=v("td"),n=G(t),_(e,"class","svelte-10kahpp");},m(i,o){k(i,e,o),g(e,n);},p(i,o){o[0]&64&&t!==(t=i[30]+"")&&K(n,t);},d(i){i&&A(e);}}}c(KI,"create_each_block_1$1");function eT(r){let e,t,n=te(r[27]),i=[];for(let o=0;o<n.length;o+=1)i[o]=KI(ZI(r,n,o));return {c(){e=v("tr");for(let o=0;o<i.length;o+=1)i[o].c();t=C(),_(e,"class","svelte-10kahpp");},m(o,s){k(o,e,s);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(e,null);g(e,t);},p(o,s){if(s[0]&64){n=te(o[27]);let a;for(a=0;a<n.length;a+=1){const l=ZI(o,n,a);i[a]?i[a].p(l,s):(i[a]=KI(l),i[a].c(),i[a].m(e,t));}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length;}},d(o){o&&A(e),Ie(i,o);}}}c(eT,"create_each_block$d");function r6(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U=te(r[7]),N=[];for(let W=0;W<U.length;W+=1)N[W]=HI(WI(r,U,W));let Y=te(r[8]),ee=[];for(let W=0;W<Y.length;W+=1)ee[W]=QI(FI(r,Y,W));let B=te(r[4]),J=[];for(let W=0;W<B.length;W+=1)J[W]=XI(JI(r,B,W));const q=c(W=>M(J[W],1,1,()=>{J[W]=null;}),"out"),Q=[i6,n6],X=[];function ne(W,he){return W[6].length>0?0:1}return c(ne,"select_block_type"),P=ne(r),L=X[P]=Q[P](r),{c(){e=v("div"),t=v("span"),t.textContent="View statistics of this or previous recorded lobby rounds",n=C(),i=v("div"),o=v("label"),o.textContent="Select round:",s=C(),a=v("select"),l=v("option"),u=G(`Current Round
      `);for(let W=0;W<N.length;W+=1)N[W].c();h=C(),p=v("label"),p.textContent="Select view:",m=C(),b=v("select");for(let W=0;W<ee.length;W+=1)ee[W].c();y=C(),w=v("canvas"),I=C(),S=v("div");for(let W=0;W<J.length;W+=1)J[W].c();R=C(),E=v("div"),L.c(),_(t,"class","typo-stats-chart-caption svelte-10kahpp"),_(o,"for","typo-stats-archive"),_(o,"class","svelte-10kahpp"),l.__value="",de(l,l.__value),l.selected=d=r[3].length===0,_(a,"id","typo-stats-archive"),r[3]===void 0&&Ir(()=>r[15].call(a)),_(p,"for","typo-stats-view"),_(p,"class","svelte-10kahpp"),_(b,"id","typo-stats-view"),r[2]===void 0&&Ir(()=>r[17].call(b)),_(i,"class","typo-stats-chart-selection svelte-10kahpp"),_(w,"class","svelte-10kahpp"),ue(w,"hidden",r[6].length===0),_(S,"class","typo-stats-chart-players svelte-10kahpp"),_(E,"class","typo-stats-chart-table svelte-10kahpp"),_(e,"class","typo-stats-chart svelte-10kahpp");},m(W,he){k(W,e,he),g(e,t),g(e,n),g(e,i),g(i,o),g(i,s),g(i,a),g(a,l),g(l,u);for(let Pe=0;Pe<N.length;Pe+=1)N[Pe]&&N[Pe].m(a,null);Li(a,r[3],!0),g(i,h),g(i,p),g(i,m),g(i,b);for(let Pe=0;Pe<ee.length;Pe+=1)ee[Pe]&&ee[Pe].m(b,null);Li(b,r[2],!0),g(e,y),g(e,w),r[19](w),g(e,I),g(e,S);for(let Pe=0;Pe<J.length;Pe+=1)J[Pe]&&J[Pe].m(S,null);g(e,R),g(e,E),X[P].m(E,null),O=!0,z||($=[F(a,"change",r[15]),F(a,"change",r[16]),F(b,"change",r[17]),F(b,"change",r[18])],z=!0);},p(W,he){if((!O||he[0]&136&&d!==(d=W[3].length===0))&&(l.selected=d),he[0]&136){U=te(W[7]);let me;for(me=0;me<U.length;me+=1){const Ae=WI(W,U,me);N[me]?N[me].p(Ae,he):(N[me]=HI(Ae),N[me].c(),N[me].m(a,null));}for(;me<N.length;me+=1)N[me].d(1);N.length=U.length;}if(he[0]&136&&Li(a,W[3]),he[0]&260){Y=te(W[8]);let me;for(me=0;me<Y.length;me+=1){const Ae=FI(W,Y,me);ee[me]?ee[me].p(Ae,he):(ee[me]=QI(Ae),ee[me].c(),ee[me].m(b,null));}for(;me<ee.length;me+=1)ee[me].d(1);ee.length=Y.length;}if(he[0]&4&&Li(b,W[2]),(!O||he[0]&64)&&ue(w,"hidden",W[6].length===0),he[0]&8240){B=te(W[4]);let me;for(me=0;me<B.length;me+=1){const Ae=JI(W,B,me);J[me]?(J[me].p(Ae,he),T(J[me],1)):(J[me]=XI(Ae),J[me].c(),T(J[me],1),J[me].m(S,null));}for(fe(),me=B.length;me<J.length;me+=1)q(me);pe();}let Pe=P;P=ne(W),P===Pe?X[P].p(W,he):(fe(),M(X[Pe],1,1,()=>{X[Pe]=null;}),pe(),L=X[P],L?L.p(W,he):(L=X[P]=Q[P](W),L.c()),T(L,1),L.m(E,null));},i(W){if(!O){for(let he=0;he<B.length;he+=1)T(J[he]);T(L),O=!0;}},o(W){J=J.filter(Boolean);for(let he=0;he<J.length;he+=1)M(J[he]);M(L),O=!1;},d(W){W&&A(e),Ie(N,W),Ie(ee,W),r[19](null),Ie(J,W),X[P].d(),z=!1,Je($);}}}c(r6,"create_fragment$k");function o6(r,e,t){let n,i,o,{feature:s}=e,{defaultArchiveKey:a=""}=e,l,u;const d=s.getViews(),h=s.lobbyStore;De(r,h,B=>t(25,i=B));const p=s.archiveStore;De(r,p,B=>t(7,n=B));const m=s.seenPlayersStore;De(r,m,B=>t(26,o=B));let b=0,y=a,w=[],I={},S=[];li(()=>{if(l===void 0)throw new Error("canvas is undefined");u=s.createChart(l),R(),E();});function R(){var q;let B=[];if(y.length===0){if(i===null||i.id===null){console.log("Lobby is null but required for current round stats"),t(4,w=[]),t(5,I={});return}B=[...((q=o.get(i.id))==null?void 0:q.values())??[]];}else {const Q=n.get(y);if(Q===void 0){console.log("Archive entry is undefined but required for selected archive stats"),t(4,w=[]),t(5,I={});return}B=Q.players;}const J=d[b];t(4,w=J.filterPlayersWithData(B,y)),t(5,I={});for(const Q of B)t(5,I[Q.id]=!0,I);}c(R,"updatePlayerSelection");function E(){const B=d[b];if(u===void 0){console.log("Chart is undefined"),t(6,S=[]);return}const J=y.length>0?n.get(y):void 0,q=w.filter(Q=>I[Q.id]);try{B.drawChart(q,u,J==null?void 0:J.key),t(6,S=B.generateTable(q,J==null?void 0:J.key));}catch(Q){console.error("Error drawing chart:",Q),u.clear(),t(6,S=[]);}}c(E,"updateChart");function P(){y=yc(this),t(3,y);}c(P,"select0_change_handler");const L=c(()=>{R(),E();},"change_handler");function O(){b=yc(this),t(2,b);}c(O,"select1_change_handler");const z=c(()=>E(),"change_handler_1");function $(B){Ve[B?"unshift":"push"](()=>{l=B,t(1,l);});}c($,"canvas_1_binding");function U(B,J){r.$$.not_equal(I[J.id],B)&&(I[J.id]=B,t(5,I));}c(U,"checkbox_checked_binding");const N=c(()=>{E();},"change_handler_2"),Y=c(()=>{var B;return s.downloadCsv(S,d[b].name,y.length===0?"current":((B=n.get(y))==null?void 0:B.name)??"archive")},"click_handler"),ee=c(()=>{var B;if(l===void 0)throw new Error("Can't download Chart");s.downloadChart(l,d[b].name,y.length===0?"current":((B=n.get(y))==null?void 0:B.name)??"archive");},"click_handler_1");return r.$$set=B=>{"feature"in B&&t(0,s=B.feature),"defaultArchiveKey"in B&&t(14,a=B.defaultArchiveKey);},[s,l,b,y,w,I,S,n,d,h,p,m,R,E,a,P,L,O,z,$,U,N,Y,ee]}c(o6,"instance$j");const z0=class z0 extends se{constructor(e){super(),le(this,e,o6,r6,re,{feature:0,defaultArchiveKey:14},null,[-1,-1]);}};c(z0,"Charts");let sh=z0;function tT(r,e,t){const n=r.slice();return n[11]=e[t].view,n[12]=e[t].key,n[13]=e,n[14]=t,n}c(tT,"get_each_context$c");function nT(r){let e,t,n;function i(a){r[9](a,r[12]);}c(i,"checkbox_checked_binding");function o(){return r[10](r[12])}c(o,"change_handler");let s={description:r[11].name+" "+(r[0].indexOf(r[12])!==-1?`(page ${r[0].indexOf(r[12])+1})`:"")};return r[1][r[12]]!==void 0&&(s.checked=r[1][r[12]]),e=new It({props:s}),Ve.push(()=>bt(e,"checked",i)),e.$on("change",o),{c(){V(e.$$.fragment);},m(a,l){x(e,a,l),n=!0;},p(a,l){r=a;const u={};l&1&&(u.description=r[11].name+" "+(r[0].indexOf(r[12])!==-1?`(page ${r[0].indexOf(r[12])+1})`:"")),!t&&l&34&&(t=!0,u.checked=r[1][r[12]],gt(()=>t=!1)),e.$set(u);},i(a){n||(T(e.$$.fragment,a),n=!0);},o(a){M(e.$$.fragment,a),n=!1;},d(a){Z(e,a);}}}c(nT,"create_each_block$c");function s6(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S=te(r[5]),R=[];for(let P=0;P<S.length;P+=1)R[P]=nT(tT(r,S,P));const E=c(P=>M(R[P],1,1,()=>{R[P]=null;}),"out");return {c(){e=v("h3"),e.textContent="Chat Summary Ranks",t=C(),n=v("p"),n.textContent="Set the amount of ranks that will be shown in the chat after a round has passed.",i=C(),o=v("input"),s=C(),a=v("br"),l=v("br"),u=C(),d=v("h3"),d.textContent="Chat Summary Categories",h=C(),p=v("p"),p.textContent=`Select categories that will show up in the chat after a round has passed.
  Categories will appear in the order in which they are selected.`,m=C();for(let P=0;P<R.length;P+=1)R[P].c();b=je(),_(o,"type","number"),_(o,"min","0"),_(o,"class","svelte-1bkcudg");},m(P,L){k(P,e,L),k(P,t,L),k(P,n,L),k(P,i,L),k(P,o,L),de(o,r[2]),k(P,s,L),k(P,a,L),k(P,l,L),k(P,u,L),k(P,d,L),k(P,h,L),k(P,p,L),k(P,m,L);for(let O=0;O<R.length;O+=1)R[O]&&R[O].m(P,L);k(P,b,L),y=!0,w||(I=F(o,"input",r[8]),w=!0);},p(P,[L]){if(L&4&&ln(o.value)!==P[2]&&de(o,P[2]),L&99){S=te(P[5]);let O;for(O=0;O<S.length;O+=1){const z=tT(P,S,O);R[O]?(R[O].p(z,L),T(R[O],1)):(R[O]=nT(z),R[O].c(),T(R[O],1),R[O].m(b.parentNode,b));}for(fe(),O=S.length;O<R.length;O+=1)E(O);pe();}},i(P){if(!y){for(let L=0;L<S.length;L+=1)T(R[L]);y=!0;}},o(P){R=R.filter(Boolean);for(let L=0;L<R.length;L+=1)M(R[L]);y=!1;},d(P){P&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a),A(l),A(u),A(d),A(h),A(p),A(m),A(b)),Ie(R,P),w=!1,I();}}}c(s6,"create_fragment$j");function a6(r,e,t){let n,i,{feature:o}=e;const s=o.chatSummarizeCategoriesStore;De(r,s,b=>t(0,n=b));const a=o.chatSummarizeTopStore;De(r,a,b=>t(2,i=b));const l=o.getViewsWithKeys(),u={},d=c(b=>{const y=[];for(const w of [...n,b])u[w]===!0&&l.some(I=>I.key===w)&&!y.includes(w)&&y.push(w);gn(s,n=y,n);},"updateCategories");function h(){i=ln(this.value),a.set(i);}c(h,"input_input_handler");function p(b,y){r.$$.not_equal(u[y],b)&&(u[y]=b,t(1,u),t(7,o),t(0,n));}c(p,"checkbox_checked_binding");const m=c(b=>d(b),"change_handler");return r.$$set=b=>{"feature"in b&&t(7,o=b.feature);},r.$$.update=()=>{if(r.$$.dirty&129)for(const b of o.getViewsWithKeys())t(1,u[b.key]=n.includes(b.key),u);},[n,u,i,s,a,l,d,o,h,p,m]}c(a6,"instance$i");const U0=class U0 extends se{constructor(e){super(),le(this,e,a6,s6,re,{feature:7});}};c(U0,"Lobby_stats_manage");let Tg=U0;function iT(r,e,t){const n=r.slice();return n[7]=e[t],n}c(iT,"get_each_context$b");function rT(r){let e,t,n=r[1][r[3]].name+"",i,o,s,a,l;function u(m,b){return m[1][m[3]].summary.length>0?c6:l6}c(u,"select_block_type");let d=u(r),h=d(r),p=r[1].length>1&&sT(r);return {c(){e=v("div"),t=v("b"),i=G(n),o=C(),h.c(),s=C(),p&&p.c(),a=je(),_(e,"class","chat-summary-stats-category");},m(m,b){k(m,e,b),g(e,t),g(t,i),g(e,o),h.m(e,null),k(m,s,b),p&&p.m(m,b),k(m,a,b),l=!0;},p(m,b){(!l||b&10)&&n!==(n=m[1][m[3]].name+"")&&K(i,n),d===(d=u(m))&&h?h.p(m,b):(h.d(1),h=d(m),h&&(h.c(),h.m(e,null))),m[1].length>1?p?(p.p(m,b),b&2&&T(p,1)):(p=sT(m),p.c(),T(p,1),p.m(a.parentNode,a)):p&&(fe(),M(p,1,1,()=>{p=null;}),pe());},i(m){l||(T(p),l=!0);},o(m){M(p),l=!1;},d(m){m&&(A(e),A(s),A(a)),h.d(),p&&p.d(m);}}}c(rT,"create_if_block$8");function l6(r){let e;return {c(){e=v("p"),e.textContent="No data available.";},m(t,n){k(t,e,n);},p:j,d(t){t&&A(e);}}}c(l6,"create_else_block$4");function c6(r){let e,t=te(r[1][r[3]].summary),n=[];for(let i=0;i<t.length;i+=1)n[i]=oT(iT(r,t,i));return {c(){e=v("ol");for(let i=0;i<n.length;i+=1)n[i].c();_(e,"class","svelte-13zbhcg");},m(i,o){k(i,e,o);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null);},p(i,o){if(o&10){t=te(i[1][i[3]].summary);let s;for(s=0;s<t.length;s+=1){const a=iT(i,t,s);n[s]?n[s].p(a,o):(n[s]=oT(a),n[s].c(),n[s].m(e,null));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},d(i){i&&A(e),Ie(n,i);}}}c(c6,"create_if_block_2$1");function oT(r){let e,t=r[7].player+"",n,i,o=r[7].result.toFixed(r[7].result<100?1:0)+"",s,a=(r[7].unit??"")+"",l;return {c(){e=v("li"),n=G(t),i=G(": "),s=G(o),l=G(a),_(e,"class","svelte-13zbhcg");},m(u,d){k(u,e,d),g(e,n),g(e,i),g(e,s),g(e,l);},p(u,d){d&10&&t!==(t=u[7].player+"")&&K(n,t),d&10&&o!==(o=u[7].result.toFixed(u[7].result<100?1:0)+"")&&K(s,o),d&10&&a!==(a=(u[7].unit??"")+"")&&K(l,a);},d(u){u&&A(e);}}}c(oT,"create_each_block$b");function sT(r){let e,t,n,i,o,s,a,l,u=r[3]+1+"",d,h,p=r[1].length+"",m,b,y,w,I;return n=new st({props:{tabIndex:-1,icon:"file-img-arrow-left-gif",name:"Next",size:"1.5rem",hoverMove:!1,disabled:r[3]<=0}}),n.$on("click",r[4]),s=new st({props:{tabIndex:-1,icon:"file-img-arrow-right-gif",name:"Next",size:"1.5rem",hoverMove:!1,disabled:r[3]>=r[1].length-1}}),s.$on("click",r[5]),w=new st({props:{tabIndex:-1,icon:"file-img-chart-gif",name:"View All Stats",size:"1.5rem",hoverMove:!1}}),w.$on("click",r[6]),{c(){e=v("div"),t=v("div"),V(n.$$.fragment),i=C(),o=v("div"),V(s.$$.fragment),a=C(),l=v("span"),d=G(u),h=G(" / "),m=G(p),b=C(),y=v("div"),V(w.$$.fragment),_(t,"class","chat-summary-stats-nav-arrow svelte-13zbhcg"),_(o,"class","chat-summary-stats-nav-arrow svelte-13zbhcg"),_(y,"class","svelte-13zbhcg"),_(e,"class","chat-summary-stats-nav svelte-13zbhcg");},m(S,R){k(S,e,R),g(e,t),x(n,t,null),g(e,i),g(e,o),x(s,o,null),g(e,a),g(e,l),g(l,d),g(l,h),g(l,m),g(e,b),g(e,y),x(w,y,null),I=!0;},p(S,R){const E={};R&8&&(E.disabled=S[3]<=0),n.$set(E);const P={};R&10&&(P.disabled=S[3]>=S[1].length-1),s.$set(P),(!I||R&8)&&u!==(u=S[3]+1+"")&&K(d,u),(!I||R&2)&&p!==(p=S[1].length+"")&&K(m,p);},i(S){I||(T(n.$$.fragment,S),T(s.$$.fragment,S),T(w.$$.fragment,S),I=!0);},o(S){M(n.$$.fragment,S),M(s.$$.fragment,S),M(w.$$.fragment,S),I=!1;},d(S){S&&A(e),Z(n),Z(s),Z(w);}}}c(sT,"create_if_block_1$3");function u6(r){let e,t,n,i,o=r[1].length>0&&rT(r);return {c(){e=v("div"),t=v("b"),t.textContent="Lobby Stats Summary",n=C(),o&&o.c(),_(t,"class","svelte-13zbhcg"),_(e,"class","typo-chat-summary-stats svelte-13zbhcg");},m(s,a){k(s,e,a),g(e,t),g(e,n),o&&o.m(e,null),i=!0;},p(s,[a]){s[1].length>0?o?(o.p(s,a),a&2&&T(o,1)):(o=rT(s),o.c(),T(o,1),o.m(e,null)):o&&(fe(),M(o,1,1,()=>{o=null;}),pe());},i(s){i||(T(o),i=!0);},o(s){M(o),i=!1;},d(s){s&&A(e),o&&o.d();}}}c(u6,"create_fragment$i");function d6(r,e,t){let{feature:n}=e,{summaries:i}=e,{summaryArchiveKey:o}=e,s=0;const a=c(()=>t(3,s--,s),"click_handler"),l=c(()=>t(3,s++,s),"click_handler_1"),u=c(()=>n.openStatsPopup(o),"click_handler_2");return r.$$set=d=>{"feature"in d&&t(0,n=d.feature),"summaries"in d&&t(1,i=d.summaries),"summaryArchiveKey"in d&&t(2,o=d.summaryArchiveKey);},[n,i,o,s,a,l,u]}c(d6,"instance$h");const B0=class B0 extends se{constructor(e){super(),le(this,e,d6,u6,re,{feature:0,summaries:1,summaryArchiveKey:2});}};c(B0,"Chat_summary_stats");let Dg=B0;var h6=Object.defineProperty,Br=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&h6(e,t,i),i},"__decorateClass$k");const x0=class x0 extends $e{constructor(){super(...arguments);f(this,"_lobbyStatsService");f(this,"_lobbyService");f(this,"_lobbyLeftEventListener");f(this,"_roundStartedEventListener");f(this,"_lobbyStateChangedEventListener");f(this,"_elementsSetup");f(this,"_modalService");f(this,"_chatService");f(this,"name","Game Stats");f(this,"description","Collects and visualizes competitive game statistics of lobbies.");f(this,"tags",[ye.GAMEPLAY,ye.SOCIAL]);f(this,"featureId",55);f(this,"_metricViews",qU());f(this,"_statArchive$",new Le(new Map));f(this,"_seenLobbyPlayers$",new Le(new Map));f(this,"_statsSubscriptions",[]);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_quickAccessSettingSubscription");f(this,"_statViewCommand",this.useCommand(new ti("stat",this,"View stats in popup","Opens a popup with detailed lobby statistics")).run(async t=>{const n={componentType:sh,props:{feature:this}};return this._modalService.showModal(n.componentType,n.props,"Lobby Statistics","card"),new Pi(t)}));f(this,"_showQuickAccessSetting",this.useSetting(new He("quick_access",!0,this).withName("Stats View Access").withDescription("Show an icon in the controls tray to quickly access the stats view.")));f(this,"_chatStatSummarySetting",this.useSetting(new He("chat_summary",!0,this).withName("Chat Summary").withDescription("Show a brief summary of stats in the chat after a round has ended.")));f(this,"_chatSummarizeMetricCategories",new dt("summary_categories",["averageCompletionSpeed","averageDrawLikes","averageGuessedPlayers","fastestGuess"],this));f(this,"_chatSummarizeTopMetrics",new dt("summary_top",8,this));}get featureManagementComponent(){return {componentType:Tg,props:{feature:this}}}async onActivate(){this.subscribeMetric(this._lobbyStatsService.guessTimeStats$,this._metricViews.averageGuessTime),this.subscribeMetric(this._lobbyStatsService.turnStandingScoreStats$,this._metricViews.totalScore),this.subscribeMetric(this._lobbyStatsService.turnStandingScoreStats$,this._metricViews.finalStandings),this.subscribeMetric(this._lobbyStatsService.guessCountStats$,this._metricViews.averageNeededGuesses),this.subscribeMetric(this._lobbyStatsService.guessMessageGapStats$,this._metricViews.averageGuessSpeed),this.subscribeMetric(this._lobbyStatsService.guessTimeStats$,this._metricViews.fastestGuess),this.subscribeMetric(this._lobbyStatsService.guessScoreStats$,this._metricViews.averageGuessScore),this.subscribeMetric(this._lobbyStatsService.guessAccuracyStats$,this._metricViews.averageGuessAccuracy),this.subscribeMetric(this._lobbyStatsService.guessStreakStats$,this._metricViews.longestGuessStreak),this.subscribeMetric(this._lobbyStatsService.guessRankStats$,this._metricViews.averageGuessRank),this.subscribeMetric(this._lobbyStatsService.drawTimeStats$,this._metricViews.averageDrawTime),this.subscribeMetric(this._lobbyStatsService.drawTimeStats$,this._metricViews.fastestDrawTime),this.subscribeMetric(this._lobbyStatsService.drawScoreStats$,this._metricViews.averageDrawScore),this.subscribeMetric(this._lobbyStatsService.drawGuessedPlayersStats$,this._metricViews.averageGuessedPlayers),this.subscribeMetric(this._lobbyStatsService.drawLikesStats$,this._metricViews.averageDrawLikes),this.subscribeMetric(this._lobbyStatsService.drawDislikesStats$,this._metricViews.mostDrawDislikes),this.subscribeMetric(this._lobbyStatsService.completionTimeStats$,this._metricViews.averageCompletionTime),this.subscribeMetric(this._lobbyStatsService.completionTimeStats$,this._metricViews.completionTime);const t=this._lobbyLeftEventListener.events$.pipe(Kt(this._roundStartedEventListener.events$.pipe(Se(o=>o.data===1)))).subscribe(()=>this.resetMetrics()),n=this._lobbyStateChangedEventListener.events$.pipe(Se(o=>o.data.gameEnded!==void 0),Oe(this._lobbyService.lobby$,this._statArchive$,this._seenLobbyPlayers$,this._chatStatSummarySetting.changes$)).subscribe(([,o,s,a,l])=>{var m;if(o===null||o.id===null)return;const u=new Date().toLocaleTimeString(),d=`${o.id}-${Date.now()}`;Object.values(this._metricViews).forEach(b=>b.archiveEvents(d));const h=o.players.sort((b,y)=>y.score-b.score)[0],p={key:d,lobbyId:o.id,date:u,name:`${o.id}, ${u} - ${h.name} ${h.score}pts`,players:Array.from(((m=a.get(o.id))==null?void 0:m.entries().map(([,b])=>b))??[])};s.set(d,p),this._statArchive$.next(s),l&&this.summarizeGameInChat(p);}),i=this._lobbyService.lobby$.pipe(Se(o=>o!==null),ce(o=>({players:(o==null?void 0:o.players)??[],lobbyId:o.id??""})),ct((o,s)=>o.players.map(a=>a.id).join(",")===s.players.map(a=>a.id).join(",")),Oe(this._seenLobbyPlayers$)).subscribe(([{players:o,lobbyId:s},a])=>{const l=a.get(s)??new Map;let u=!1;o.forEach(d=>{l.has(d.id)||(l.set(d.id,d),u=!0);}),u&&(a.set(s,l),this._seenLobbyPlayers$.next(a));});this._statsSubscriptions.push(t,n,i),this._quickAccessSettingSubscription=this._showQuickAccessSetting.changes$.subscribe(o=>{o?this.addQuickAccessIcon():this.removeQuickAccessIcon();});}async onDestroy(){var t;this._statsSubscriptions.forEach(n=>n.unsubscribe()),this._statsSubscriptions=[],this.resetMetrics(!0),(t=this._quickAccessSettingSubscription)==null||t.unsubscribe(),this._quickAccessSettingSubscription=void 0,this.removeQuickAccessIcon();}openStatsPopup(t){const n={componentType:sh,props:{feature:this,defaultArchiveKey:t}};this._modalService.showModal(n.componentType,n.props,"Lobby Statistics","card");}async summarizeGameInChat(t){this._logger.debug("summarizeGameInChat",t);const n=await this._chatSummarizeMetricCategories.getValue(),i=await this._chatSummarizeTopMetrics.getValue(),o=Object.entries(this._metricViews).filter(([u])=>n.includes(u)).map(([,u])=>{let d=[];try{d=u.generateSummary(t.players,t.key).slice(0,i);}catch{}return {name:u.name,summary:d}});if(o.length===0||o.every(u=>u.summary.length===0))return;const a=await(await this._chatService.addChatMessage("","")).message,l=await this._chatService.isScrolledDown();new Dg({target:a.wrapperElement,props:{feature:this,summaries:o,summaryArchiveKey:t.key}}),l&&await this._chatService.scrollToBottom();}async addQuickAccessIcon(){if(this._iconComponent!==void 0)return;const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.controls,props:{hoverMove:!1,size:"48px",icon:"file-img-chart-gif",name:"Lobby Statistics",order:6,tooltipAction:this.createTooltip}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>this.openStatsPopup());}removeQuickAccessIcon(){var t,n;(t=this._iconClickSubscription)==null||t.unsubscribe(),this._iconClickSubscription=void 0,(n=this._iconComponent)==null||n.$destroy(),this._iconComponent=void 0;}subscribeMetric(t,n){const i=t.subscribe(o=>n.addEvent(o));this._statsSubscriptions.push(i);}resetMetrics(t=!1){Object.values(this._metricViews).forEach(n=>n.clearEvents(t));}createChart(t){return new Ig({width:2e3,height:1e3,chartArea:{x:200,y:200,width:1600,height:700},barPadding:30,barMaxWidth:100,yGridGap:50},t)}downloadCsv(t,n,i){const o=t.map(a=>a.join(",")).join(`
`),s=`typo-stats-${n}-${i}.csv`.replaceAll(" ","_");mb(o,s);}async downloadChart(t,n,i){const o=`typo-stats-${n}-${i}.png`.replaceAll(" ","_"),s=await hl.fromImageUrl(t.toDataURL("image/png"));fl(s.blob,o);}getViews(){return Object.values(this._metricViews)}getViewsWithKeys(){return Object.entries(this._metricViews).map(([t,n])=>({key:t,view:n}))}get lobbyStore(){return it(this._lobbyService.lobby$,null)}get archiveStore(){return it(this._statArchive$.asObservable(),this._statArchive$.value)}get seenPlayersStore(){return it(this._seenLobbyPlayers$.asObservable(),this._seenLobbyPlayers$.value)}get chatSummarizeCategoriesStore(){return it(this._chatSummarizeMetricCategories.changes$,[],t=>this._chatSummarizeMetricCategories.setValue(t))}get chatSummarizeTopStore(){return it(this._chatSummarizeTopMetrics.changes$,3,t=>this._chatSummarizeTopMetrics.setValue(t))}};c(x0,"LobbyStatisticsFeature");let yi=x0;Br([D(ai)],yi.prototype,"_lobbyStatsService");Br([D(ut)],yi.prototype,"_lobbyService");Br([D(Vn)],yi.prototype,"_lobbyLeftEventListener");Br([D(ol)],yi.prototype,"_roundStartedEventListener");Br([D(Zn)],yi.prototype,"_lobbyStateChangedEventListener");Br([D(Me)],yi.prototype,"_elementsSetup");Br([D(Dn)],yi.prototype,"_modalService");Br([D(rn)],yi.prototype,"_chatService");function aT(r,e,t){const n=r.slice();return n[10]=e[t],n}c(aT,"get_each_context$a");function lT(r){let e,t,n=r[10].boundTo+"",i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P;function L(...O){return r[9](r[10],...O)}return c(L,"change_handler"),{c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("select"),a=v("option"),l=G("Debug"),d=v("option"),h=G("Information"),m=v("option"),b=G("Warn"),w=v("option"),I=G("Error"),R=C(),a.__value="debug",de(a,a.__value),a.selected=u=r[10].level==="debug",d.__value="info",de(d,d.__value),d.selected=p=r[10].level==="info",m.__value="warn",de(m,m.__value),m.selected=y=r[10].level==="warn",w.__value="error",de(w,w.__value),w.selected=S=r[10].level==="error",_(e,"class","typo-logs-logger svelte-oun24t"),ue(e,"hidden",!r[10].boundTo.toLowerCase().includes(r[3].toLowerCase()));},m(O,z){k(O,e,z),g(e,t),g(t,i),g(e,o),g(e,s),g(s,a),g(a,l),g(s,d),g(d,h),g(s,m),g(m,b),g(s,w),g(w,I),g(e,R),E||(P=F(s,"change",L),E=!0);},p(O,z){r=O,z&4&&n!==(n=r[10].boundTo+"")&&K(i,n),z&4&&u!==(u=r[10].level==="debug")&&(a.selected=u),z&4&&p!==(p=r[10].level==="info")&&(d.selected=p),z&4&&y!==(y=r[10].level==="warn")&&(m.selected=y),z&4&&S!==(S=r[10].level==="error")&&(w.selected=S),z&12&&ue(e,"hidden",!r[10].boundTo.toLowerCase().includes(r[3].toLowerCase()));},d(O){O&&A(e),E=!1,P();}}}c(lT,"create_each_block$a");function f6(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N;i=new ke({props:{content:"Copy logs text",color:"blue"}}),i.$on("click",r[4]),s=new ke({props:{content:"Copy logs JSON",color:"blue"}}),s.$on("click",r[5]),I=new ke({props:{content:"Reset to selection",color:"orange"}}),I.$on("click",r[7]);let Y=te(r[2]),ee=[];for(let B=0;B<Y.length;B+=1)ee[B]=lT(aT(r,Y,B));return {c(){e=v("h3"),e.textContent="Export Logs",t=C(),n=v("div"),V(i.$$.fragment),o=C(),V(s.$$.fragment),a=C(),l=v("h3"),l.textContent="Reset Log Level",u=C(),d=v("div"),h=v("select"),p=v("option"),p.textContent="Debug",m=v("option"),m.textContent="Information",b=v("option"),b.textContent="Warn",y=v("option"),y.textContent="Error",w=C(),V(I.$$.fragment),S=C(),R=v("h3"),R.textContent="Customize Log Level",E=C(),P=v("div"),L=v("input"),O=C(),z=v("div");for(let B=0;B<ee.length;B+=1)ee[B].c();_(n,"class","typo-logs-export svelte-oun24t"),p.__value="debug",de(p,p.__value),m.__value="info",de(m,m.__value),b.__value="warn",de(b,b.__value),y.__value="error",de(y,y.__value),H(h,"width","auto"),_(d,"class","typo-logs-overwrite svelte-oun24t"),H(L,"max-width","20rem"),_(L,"type","text"),_(L,"placeholder","Filter loggers"),_(P,"class","typo-logs-logger-list svelte-oun24t"),_(z,"class","typo-logs-logger-list svelte-oun24t");},m(B,J){k(B,e,J),k(B,t,J),k(B,n,J),x(i,n,null),g(n,o),x(s,n,null),k(B,a,J),k(B,l,J),k(B,u,J),k(B,d,J),g(d,h),g(h,p),g(h,m),g(h,b),g(h,y),r[6](h),g(d,w),x(I,d,null),k(B,S,J),k(B,R,J),k(B,E,J),k(B,P,J),g(P,L),de(L,r[3]),k(B,O,J),k(B,z,J);for(let q=0;q<ee.length;q+=1)ee[q]&&ee[q].m(z,null);$=!0,U||(N=F(L,"input",r[8]),U=!0);},p(B,[J]){if(J&8&&L.value!==B[3]&&de(L,B[3]),J&13){Y=te(B[2]);let q;for(q=0;q<Y.length;q+=1){const Q=aT(B,Y,q);ee[q]?ee[q].p(Q,J):(ee[q]=lT(Q),ee[q].c(),ee[q].m(z,null));}for(;q<ee.length;q+=1)ee[q].d(1);ee.length=Y.length;}},i(B){$||(T(i.$$.fragment,B),T(s.$$.fragment,B),T(I.$$.fragment,B),$=!0);},o(B){M(i.$$.fragment,B),M(s.$$.fragment,B),M(I.$$.fragment,B),$=!1;},d(B){B&&(A(e),A(t),A(n),A(a),A(l),A(u),A(d),A(S),A(R),A(E),A(P),A(O),A(z)),Z(i),Z(s),r[6](null),Z(I),Ie(ee,B),U=!1,N();}}}c(f6,"create_fragment$h");function p6(r,e,t){let{feature:n}=e,i,o=n.loggers,s="";const a=c(()=>n.copyLogsToClipboard(!1),"click_handler"),l=c(()=>n.copyLogsToClipboard(!0),"click_handler_1");function u(m){Ve[m?"unshift":"push"](()=>{i=m,t(1,i);});}c(u,"select_binding");const d=c(async()=>{await n.resetAllLogLevels(i.value),t(2,o=n.loggers);},"click_handler_2");function h(){s=this.value,t(3,s);}c(h,"input_input_handler");const p=c((m,b)=>n.setLogLevelOfLogger(m,b.currentTarget.value),"change_handler");return r.$$set=m=>{"feature"in m&&t(0,n=m.feature);},[n,i,o,s,a,l,u,d,h,p]}c(p6,"instance$g");const Z0=class Z0 extends se{constructor(e){super(),le(this,e,p6,f6,re,{feature:0});}};c(Z0,"Logging_manage");let Eg=Z0;function m6(r){let e,t,n,i,o,s,a,l,u;return {c(){e=G("Logging collects debug data from events of all parts of the typo extension."),t=v("br"),n=G(`
In case of bugs or unexpected behavior, this data can be used to identify the cause of issues.`),i=v("br"),o=C(),s=v("br"),a=G(`
To filter out irrelevant events, the log level of each instance can be adjusted.`),l=v("br"),u=G(`
Log level is stored permanently in the extension settings across reloads; existing logs are not affected by log level changes.`);},m(d,h){k(d,e,h),k(d,t,h),k(d,n,h),k(d,i,h),k(d,o,h),k(d,s,h),k(d,a,h),k(d,l,h),k(d,u,h);},p:j,i:j,o:j,d(d){d&&(A(e),A(t),A(n),A(i),A(o),A(s),A(a),A(l),A(u));}}}c(m6,"create_fragment$g");const V0=class V0 extends se{constructor(e){super(),le(this,e,null,m6,re,{});}};c(V0,"Logging_info");let Mg=V0;var g6=Object.defineProperty,NE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&g6(e,t,i),i},"__decorateClass$j");const J0=class J0 extends $e{constructor(){super(...arguments);f(this,"name","Logging");f(this,"description","Collect logs of services, features, setups and event processors.");f(this,"tags",[ye.DEVELOPMENT]);f(this,"featureId",24);f(this,"toggleEnabled",!1);f(this,"developerFeature",!0);f(this,"_loggingService");f(this,"_toastService");}get featureManagementComponent(){return {componentType:Eg,props:{feature:this}}}get featureInfoComponent(){return {componentType:Mg,props:{}}}postConstruct(){this.useSetting(this._loggingService.printEnabledSetting);}get loggers(){return this._loggingService.loggers}async copyLogsToClipboard(t){const n=this._loggingService.recordedEvents,i=t?JSON.stringify(n):n.map(o=>`[${o.date.toISOString()}] [${o.logLevel}] (${o.bindingName}) ${o.message} ${o.data.join(", ")}`).join(`
`);await navigator.clipboard.writeText(i),await this._toastService.showToast("Logs copied to clipboard");}async setLogLevelOfLogger(t,n){if(n!=="debug"&&n!=="info"&&n!=="warn"&&n!=="error"){await this._toastService.showToast("Invalid log level");return}try{await this._loggingService.getLogLevelSetting(t).setValue(n);}catch(i){this._logger.error("Error updating log level",i),await this._toastService.showToast("Error updating log level");return}await this._toastService.showToast("Updated Logger",`Log level of ${t.boundTo} set to ${n}`);}async resetAllLogLevels(t){if(t!=="debug"&&t!=="info"&&t!=="warn"&&t!=="error"){await this._toastService.showToast("Invalid log level");return}const n=await this._toastService.showLoadingToast("Resetting log levels to "+t),i=this._loggingService.loggers.map(o=>this._loggingService.getLogLevelSetting(o).setValue(t));try{await Promise.all(i);}catch(o){this._logger.error("Error resetting log level to "+t,o),n.reject("Error resetting log levels");return}n.resolve();}};c(J0,"LoggingFeature");let _u=J0;NE([D(ni)],_u.prototype,"_loggingService");NE([D(ft)],_u.prototype,"_toastService");var b6=Object.defineProperty,v6=Object.getOwnPropertyDescriptor,Cb=c((r,e,t,n)=>{for(var i=n>1?void 0:n?v6(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&b6(e,t,i),i},"__decorateClass$i"),_6=c((r,e)=>(t,n)=>e(t,n,r),"__decorateParam"),za;let br=(za=class{constructor(e){f(this,"_socketService");f(this,"_logger");f(this,"_onlineItems$",new Le([]));this._logger=e(this);}postConstruct(){this.setupConnection();}async setupConnection(){const e=this._socketService.createConnection("IOnlineItemsHub");return this._socketService.createReceiver("IOnlineItemsReceiver").register(e,{onlineItemsUpdated:this.onOnlineItemsUpdated.bind(this)}),await e.start(),this._socketService.reconnectOnUserInteraction(e,()=>this.setupConnection()),e}async onOnlineItemsUpdated(e){this._logger.info("Online items updated",e),this._onlineItems$.next(e.items);}get onlineItems$(){return this._onlineItems$.asObservable()}},c(za,"LobbyItemsService"),za);Cb([D(yl)],br.prototype,"_socketService",2);Cb([zr()],br.prototype,"postConstruct",1);br=Cb([we(),_6(0,D(rt))],br);function cT(r,e,t){const n=r.slice();return n[10]=e[t],n[12]=t,n}c(cT,"get_each_context$9");function uT(r){let e;return {c(){e=v("div"),e.textContent="No filters saved.";},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(uT,"create_if_block$7");function dT(r){let e,t,n,i,o,s,a,l,u,d;function h(...m){return r[6](r[10],...m)}c(h,"change_handler"),t=new It({props:{description:r[10].name,checked:r[3][r[12]]}}),t.$on("change",h);function p(){return r[7](r[10])}return c(p,"click_handler"),o=new st({props:{icon:"file-img-trash-gif",name:"Remove Filter",greyscaleInactive:!0,hoverMove:!1,size:"1.5rem"}}),o.$on("click",p),{c(){e=v("div"),V(t.$$.fragment),n=C(),i=v("div"),V(o.$$.fragment),s=C(),_(i,"class","typo-lobby-filters-item-remove svelte-lqoucf"),_(e,"class","typo-lobby-filters-item svelte-lqoucf"),H(e,"order",r[10].createdAt);},m(m,b){k(m,e,b),x(t,e,null),g(e,n),g(e,i),x(o,i,null),g(e,s),l=!0,u||(d=oi(a=r[0].createTooltip(e,{title:`${r[0].buildFilterTooltipText(r[10])}`})),u=!0);},p(m,b){r=m;const y={};b&4&&(y.description=r[10].name),b&8&&(y.checked=r[3][r[12]]),t.$set(y),(!l||b&4)&&H(e,"order",r[10].createdAt),a&&Yr(a.update)&&b&5&&a.update.call(null,{title:`${r[0].buildFilterTooltipText(r[10])}`});},i(m){l||(T(t.$$.fragment,m),T(o.$$.fragment,m),l=!0);},o(m){M(t.$$.fragment,m),M(o.$$.fragment,m),l=!1;},d(m){m&&A(e),Z(t),Z(o),u=!1,d();}}}c(dT,"create_each_block$9");function y6(r){let e,t,n,i,o,s,a,l,u,d=r[2].length===0&&uT(),h=te(r[2]),p=[];for(let b=0;b<h.length;b+=1)p[b]=dT(cT(r,h,b));const m=c(b=>M(p[b],1,1,()=>{p[b]=null;}),"out");return s=new ke({props:{content:"Start Search",color:"green"}}),s.$on("click",r[8]),l=new ke({props:{content:"Add Lobby Filter",color:"blue"}}),l.$on("click",r[9]),{c(){e=v("div"),t=v("div"),d&&d.c(),n=C();for(let b=0;b<p.length;b+=1)p[b].c();i=C(),o=v("div"),V(s.$$.fragment),a=C(),V(l.$$.fragment),_(t,"class","typo-lobby-filters-list svelte-lqoucf"),_(o,"class","typo-lobby-filters-header svelte-lqoucf"),_(e,"class","typo-lobby-filters svelte-lqoucf");},m(b,y){k(b,e,y),g(e,t),d&&d.m(t,null),g(t,n);for(let w=0;w<p.length;w+=1)p[w]&&p[w].m(t,null);g(e,i),g(e,o),x(s,o,null),g(o,a),x(l,o,null),u=!0;},p(b,[y]){if(b[2].length===0?d||(d=uT(),d.c(),d.m(t,n)):d&&(d.d(1),d=null),y&47){h=te(b[2]);let w;for(w=0;w<h.length;w+=1){const I=cT(b,h,w);p[w]?(p[w].p(I,y),T(p[w],1)):(p[w]=dT(I),p[w].c(),T(p[w],1),p[w].m(t,null));}for(fe(),w=h.length;w<p.length;w+=1)m(w);pe();}},i(b){if(!u){for(let y=0;y<h.length;y+=1)T(p[y]);T(s.$$.fragment,b),T(l.$$.fragment,b),u=!0;}},o(b){p=p.filter(Boolean);for(let y=0;y<p.length;y+=1)M(p[y]);M(s.$$.fragment,b),M(l.$$.fragment,b),u=!1;},d(b){b&&A(e),d&&d.d(),Ie(p,b),Z(s),Z(l);}}}c(y6,"create_fragment$f");function w6(r,e,t){let n,i,o,{feature:s}=e;const a=s.savedFiltersStore;De(r,a,m=>t(2,o=m));const l=s.selectedFiltersStore;De(r,l,m=>t(1,i=m));const u=c((m,b)=>{const y=i.filter(w=>w!==m.createdAt);l.set(b.detail?[...y,m.createdAt]:y);},"change_handler"),d=c(m=>s.removeFilter(m),"click_handler"),h=c(async()=>{await s.startSearch();},"click_handler_1"),p=c(async()=>{const m=await s.promptFilterCreation();m&&await s.addFilter(m);},"click_handler_2");return r.$$set=m=>{"feature"in m&&t(0,s=m.feature);},r.$$.update=()=>{r.$$.dirty&6&&t(3,n=o.map(m=>i.includes(m.createdAt)));},[s,i,o,n,a,l,u,d,h,p]}c(w6,"instance$f");const F0=class F0 extends se{constructor(e){super(),le(this,e,w6,y6,re,{feature:0});}};c(F0,"Panel_filters");let Rg=F0;function S6(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E,P,L,O,z,$,U,N,Y,ee,B,J,q,Q,X,ne,W,he,Pe,me,Ae,Dt,xe,Te,Ze,Ne,ot,Pt,Ue,Xe,nt,Fe,Ge,at,Mn,Ct,Qt,Qn,on,Rn,ci;l=new ke({props:{content:"Add Filter",color:"blue"}}),l.$on("click",r[4]);function Zi(Be){r[12](Be);}c(Zi,"checkbox_checked_binding");let Ln={description:"Match only lobbies with typo players"};return r[1].containsTypoPlayers!==void 0&&(Ln.checked=r[1].containsTypoPlayers),Qt=new It({props:Ln}),Ve.push(()=>bt(Qt,"checked",Zi)),{c(){e=v("div"),t=v("div"),t.innerHTML=`A lobby filter checks if a lobby matches the filter criteria and skips automatically until a lobby is found.<br/>
    You can add multiple filters; at least one of them has to be matched for a lobby to be accepted.<br/>
    If you leave filter criteria empty, it will be ignored.`,n=C(),i=v("div"),o=v("div"),s=v("input"),a=C(),V(l.$$.fragment),u=C(),d=v("div"),h=v("div"),p=v("b"),p.textContent="Names:",m=C(),b=v("span"),b.textContent="Match lobbies with names containing one of the comma-separated names",y=C(),w=v("input"),I=C(),S=v("div"),R=v("b"),R.textContent="Players:",E=C(),P=v("span"),P.textContent="Match lobbies having at least",L=C(),O=v("input"),z=C(),$=v("span"),$.textContent="and at most",U=C(),N=v("input"),Y=C(),ee=v("span"),ee.textContent="players.",B=C(),J=v("div"),q=v("b"),q.textContent="Round:",Q=C(),X=v("span"),X.textContent="Match lobbies that are currently at least in round",ne=C(),W=v("input"),he=C(),Pe=v("span"),Pe.textContent="and at most in round",me=C(),Ae=v("input"),Dt=C(),xe=v("div"),Te=v("b"),Te.textContent="Average Score:",Ze=C(),Ne=v("span"),Ne.textContent="Match lobbies where the average player score is at least",ot=C(),Pt=v("input"),Ue=C(),Xe=v("span"),Xe.textContent="points and at most",nt=C(),Fe=v("input"),Ge=C(),at=v("span"),at.textContent="points.",Mn=C(),Ct=v("div"),V(Qt.$$.fragment),_(s,"type","text"),_(s,"placeholder","Filter name"),_(s,"class","svelte-9ect24"),_(o,"class","typo-filter-form-row svelte-9ect24"),_(i,"class","typo-filter-form-inputs svelte-9ect24"),_(w,"type","text"),_(w,"placeholder","ice king, princess bubblegum, finn"),_(w,"class","svelte-9ect24"),_(h,"class","typo-filter-form-row svelte-9ect24"),_(O,"type","number"),_(O,"placeholder","1"),_(O,"class","svelte-9ect24"),_(N,"type","number"),_(N,"placeholder","8"),_(N,"class","svelte-9ect24"),_(S,"class","typo-filter-form-row svelte-9ect24"),_(W,"type","number"),_(W,"placeholder","1"),_(W,"class","svelte-9ect24"),_(Ae,"type","number"),_(Ae,"placeholder","3"),_(Ae,"class","svelte-9ect24"),_(J,"class","typo-filter-form-row svelte-9ect24"),_(Pt,"type","number"),_(Pt,"placeholder","500"),_(Pt,"class","svelte-9ect24"),_(Fe,"type","number"),_(Fe,"placeholder","3000"),_(Fe,"class","svelte-9ect24"),_(xe,"class","typo-filter-form-row svelte-9ect24"),_(Ct,"class","typo-filter-form-row svelte-9ect24"),_(d,"class","typo-filter-form-inputs svelte-9ect24"),_(e,"class","typo-filter-form svelte-9ect24");},m(Be,ve){k(Be,e,ve),g(e,t),g(e,n),g(e,i),g(i,o),g(o,s),de(s,r[1].name),g(o,a),x(l,o,null),g(e,u),g(e,d),g(d,h),g(h,p),g(h,m),g(h,b),g(h,y),g(h,w),g(d,I),g(d,S),g(S,R),g(S,E),g(S,P),g(S,L),g(S,O),de(O,r[1].minAmountPlayers),g(S,z),g(S,$),g(S,U),g(S,N),de(N,r[1].maxAmountPlayers),g(S,Y),g(S,ee),g(d,B),g(d,J),g(J,q),g(J,Q),g(J,X),g(J,ne),g(J,W),de(W,r[1].minRound),g(J,he),g(J,Pe),g(J,me),g(J,Ae),de(Ae,r[1].maxRound),g(d,Dt),g(d,xe),g(xe,Te),g(xe,Ze),g(xe,Ne),g(xe,ot),g(xe,Pt),de(Pt,r[1].minAverageScore),g(xe,Ue),g(xe,Xe),g(xe,nt),g(xe,Fe),de(Fe,r[1].maxAverageScore),g(xe,Ge),g(xe,at),g(d,Mn),g(d,Ct),x(Qt,Ct,null),on=!0,Rn||(ci=[F(s,"input",r[3]),F(w,"change",r[5]),F(O,"input",r[6]),F(N,"input",r[7]),F(W,"input",r[8]),F(Ae,"input",r[9]),F(Pt,"input",r[10]),F(Fe,"input",r[11])],Rn=!0);},p(Be,[ve]){ve&2&&s.value!==Be[1].name&&de(s,Be[1].name),ve&2&&ln(O.value)!==Be[1].minAmountPlayers&&de(O,Be[1].minAmountPlayers),ve&2&&ln(N.value)!==Be[1].maxAmountPlayers&&de(N,Be[1].maxAmountPlayers),ve&2&&ln(W.value)!==Be[1].minRound&&de(W,Be[1].minRound),ve&2&&ln(Ae.value)!==Be[1].maxRound&&de(Ae,Be[1].maxRound),ve&2&&ln(Pt.value)!==Be[1].minAverageScore&&de(Pt,Be[1].minAverageScore),ve&2&&ln(Fe.value)!==Be[1].maxAverageScore&&de(Fe,Be[1].maxAverageScore);const Et={};!Qn&&ve&2&&(Qn=!0,Et.checked=Be[1].containsTypoPlayers,gt(()=>Qn=!1)),Qt.$set(Et);},i(Be){on||(T(l.$$.fragment,Be),T(Qt.$$.fragment,Be),on=!0);},o(Be){M(l.$$.fragment,Be),M(Qt.$$.fragment,Be),on=!1;},d(Be){Be&&A(e),Z(l),Z(Qt),Rn=!1,Je(ci);}}}c(S6,"create_fragment$e");function A6(r,e,t){let{feature:n}=e,{onCreate:i}=e;const o={name:"",createdAt:new Date().getTime()};function s(){o.name=this.value,t(1,o);}c(s,"input0_input_handler");const a=c(async()=>{i(o);},"click_handler"),l=c(w=>{const I=w.currentTarget.value.split(",").map(S=>S.trim());t(1,o.containsUsernames=I.length>0?I:void 0,o);},"change_handler");function u(){o.minAmountPlayers=ln(this.value),t(1,o);}c(u,"input2_input_handler");function d(){o.maxAmountPlayers=ln(this.value),t(1,o);}c(d,"input3_input_handler");function h(){o.minRound=ln(this.value),t(1,o);}c(h,"input4_input_handler");function p(){o.maxRound=ln(this.value),t(1,o);}c(p,"input5_input_handler");function m(){o.minAverageScore=ln(this.value),t(1,o);}c(m,"input6_input_handler");function b(){o.maxAverageScore=ln(this.value),t(1,o);}c(b,"input7_input_handler");function y(w){r.$$.not_equal(o.containsTypoPlayers,w)&&(o.containsTypoPlayers=w,t(1,o));}return c(y,"checkbox_checked_binding"),r.$$set=w=>{"feature"in w&&t(2,n=w.feature),"onCreate"in w&&t(0,i=w.onCreate);},[i,o,n,s,a,l,u,d,h,p,m,b,y]}c(A6,"instance$e");const W0=class W0 extends se{constructor(e){super(),le(this,e,A6,S6,re,{feature:2,onCreate:0});}};c(W0,"Filter_form");let Lg=W0;function hT(r,e,t){const n=r.slice();return n[7]=e[t],n}c(hT,"get_each_context$8");function fT(r,e,t){const n=r.slice();return n[10]=e[t],n}c(fT,"get_each_context_1");function pT(r){let e,t,n=r[10].name+"",i,o,s,a=r[0].buildFilterTooltipText(r[10])+"",l,u;return {c(){e=v("div"),t=v("b"),i=G(n),o=C(),s=v("div"),l=G(a),u=C(),_(t,"class","svelte-1apd7dj"),_(s,"class","typo-filter-search-list-item-description svelte-1apd7dj"),_(e,"class","typo-filter-search-list-item svelte-1apd7dj");},m(d,h){k(d,e,h),g(e,t),g(t,i),g(e,o),g(e,s),g(s,l),g(e,u);},p(d,h){h&2&&n!==(n=d[10].name+"")&&K(i,n),h&3&&a!==(a=d[0].buildFilterTooltipText(d[10])+"")&&K(l,a);},d(d){d&&A(e);}}}c(pT,"create_each_block_1");function mT(r){let e,t,n=r[7].players.length-1+"",i,o,s=r[7].round+"",a,l,u,d=r[7].players.filter(y).map(bT).join(", ")+"",h,p,m,b;function y(...I){return r[5](r[7],...I)}c(y,"func_1");function w(){return r[6](r[7])}return c(w,"click_handler"),{c(){e=v("div"),t=v("b"),i=G(n),o=G(" players, round "),a=G(s),l=C(),u=v("div"),h=G(d),p=C(),_(t,"class","svelte-1apd7dj"),_(u,"class","typo-filter-search-list-item-description svelte-1apd7dj"),_(e,"class","typo-filter-search-list-item lobby svelte-1apd7dj");},m(I,S){k(I,e,S),g(e,t),g(t,i),g(t,o),g(t,a),g(e,l),g(e,u),g(u,h),g(e,p),m||(b=F(e,"click",w),m=!0);},p(I,S){r=I,S&8&&n!==(n=r[7].players.length-1+"")&&K(i,n),S&8&&s!==(s=r[7].round+"")&&K(a,s),S&8&&d!==(d=r[7].players.filter(y).map(bT).join(", ")+"")&&K(h,d);},d(I){I&&A(e),m=!1,b();}}}c(mT,"create_each_block$8");function k6(r){let e,t,n,i,o,s,a,l=r[3].length+"",u,d,h,p,m,b,y,w=te(r[1]),I=[];for(let E=0;E<w.length;E+=1)I[E]=pT(fT(r,w,E));let S=te(r[3].filter(gT)),R=[];for(let E=0;E<S.length;E+=1)R[E]=mT(hT(r,S,E));return {c(){e=v("div"),t=v("div"),t.innerHTML=`Lobby search is currently running and joining through lobbies.<br/>
    The search will stop once a lobby is found that matches one of the filters:`,n=C(),i=v("div");for(let E=0;E<I.length;E+=1)I[E].c();o=C(),s=v("div"),a=G("Discovered lobbies: "),u=G(l),d=v("br"),h=G(`
    If you click on a lobby, the search will stop and join the selected lobby instead.`),p=v("br"),m=G(`
    A lobby might have changed since it was discovered.`),b=C(),y=v("div");for(let E=0;E<R.length;E+=1)R[E].c();_(i,"class","typo-filter-search-list svelte-1apd7dj"),_(y,"class","typo-filter-search-list svelte-1apd7dj"),_(e,"class","typo-filter-search svelte-1apd7dj");},m(E,P){k(E,e,P),g(e,t),g(e,n),g(e,i);for(let L=0;L<I.length;L+=1)I[L]&&I[L].m(i,null);g(e,o),g(e,s),g(s,a),g(s,u),g(s,d),g(s,h),g(s,p),g(s,m),g(e,b),g(e,y);for(let L=0;L<R.length;L+=1)R[L]&&R[L].m(y,null);},p(E,[P]){if(P&3){w=te(E[1]);let L;for(L=0;L<w.length;L+=1){const O=fT(E,w,L);I[L]?I[L].p(O,P):(I[L]=pT(O),I[L].c(),I[L].m(i,null));}for(;L<I.length;L+=1)I[L].d(1);I.length=w.length;}if(P&8&&l!==(l=E[3].length+"")&&K(u,l),P&12){S=te(E[3].filter(gT));let L;for(L=0;L<S.length;L+=1){const O=hT(E,S,L);R[L]?R[L].p(O,P):(R[L]=mT(O),R[L].c(),R[L].m(y,null));}for(;L<R.length;L+=1)R[L].d(1);R.length=S.length;}},i:j,o:j,d(E){E&&A(e),Ie(I,E),Ie(R,E);}}}c(k6,"create_fragment$d");const gT=c(r=>r.players.length>1,"func"),bT=c(r=>r.name,"func_2");function C6(r,e,t){let n,{feature:i}=e,{filters:o}=e,{lobbySelected:s}=e;const a=i.visitedLobbiesStore;De(r,a,d=>t(3,n=d));const l=c((d,h)=>h.id!==d.meId,"func_1"),u=c(d=>s(d.id??""),"click_handler");return r.$$set=d=>{"feature"in d&&t(0,i=d.feature),"filters"in d&&t(1,o=d.filters),"lobbySelected"in d&&t(2,s=d.lobbySelected);},[i,o,s,n,a,l,u]}c(C6,"instance$d");const H0=class H0 extends se{constructor(e){super(),le(this,e,C6,k6,re,{feature:0,filters:1,lobbySelected:2});}};c(H0,"Filter_search");let Pg=H0;var I6=Object.defineProperty,ju=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&I6(e,t,i),i},"__decorateClass$h");const Q0=class Q0 extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_lobbyService");f(this,"_modalService");f(this,"_toastService");f(this,"_lobbyItemsService");f(this,"name","Lobby Filters");f(this,"description","Lets you create custom filters for a quick lobby search");f(this,"tags",[ye.SOCIAL]);f(this,"featureId",5);f(this,"_component");f(this,"_savedFiltersSetting",new dt("saved_filters",[],this));f(this,"_selectedFiltersSetting",new dt("selected_filters",[],this));f(this,"_currentSearch",new be);f(this,"_overrideSearch",new be);f(this,"_visitedLobbies",new Le([]));f(this,"_searchSubscription");}async onActivate(){const t=await this._elements.complete();this._component=new Rg({target:t.filterTab,props:{feature:this}}),this._searchSubscription=this._currentSearch.pipe(lr(null),ct(),Qe(this._lobbyService.lobby$),Cr(),Oe(this._overrideSearch.pipe(lr(void 0)))).subscribe(([[[n,i],[o,s]],a])=>this.handleSearchChange(n,i,o,s,a));}onDestroy(){var t,n;(t=this._component)==null||t.$destroy(),(n=this._searchSubscription)==null||n.unsubscribe(),this._visitedLobbies.next([]);}get savedFiltersStore(){return this._savedFiltersSetting.store}get selectedFiltersStore(){return this._selectedFiltersSetting.store}get visitedLobbiesStore(){return it(this._visitedLobbies,[])}async handleSearchChange(t,n,i,o,s){if(this._logger.debug("Search changed",t,n,i,o,s),o){if(i!==null){this._visitedLobbies.next([o,...this._visitedLobbies.value.filter(l=>l.id!==o.id)]);const a=await Ee(this._lobbyItemsService.onlineItems$);i.some(l=>this.checkLobbyFilterMatch(l,o,a))?(this._logger.info("Lobby found"),this._currentSearch.next(null)):(this._logger.info("Lobby does not match filter, leaving"),this._lobbyService.leaveLobby());}}else {if(s!==void 0)if(s===null){this._overrideSearch.next(void 0),this._currentSearch.next(null);return}else {this._overrideSearch.next(void 0),this._currentSearch.next(null),await this._lobbyService.joinLobby(s);return}t===null&&i!==null&&(this._logger.info("Starting search"),await this._lobbyService.joinLobby(),await this.promptFilterSearch(i)),i!==null&&(this._logger.info("Joining next lobby"),await this._lobbyService.joinLobby());}i===null&&this._visitedLobbies.next([]);}checkLobbyFilterMatch(t,n,i){if(this._logger.info("Checking lobby filter match",t,n),t.minAmountPlayers!==void 0&&n.players.length<t.minAmountPlayers||t.maxAmountPlayers!==void 0&&n.players.length>t.maxAmountPlayers)return !1;const o=n.players.map(s=>s.score).reduce((s,a)=>s+a,0)/n.players.length;if(t.minAverageScore!==void 0&&o<t.minAverageScore||t.maxAverageScore!==void 0&&o>t.maxAverageScore||t.minRound!==void 0&&n.round<t.minRound||t.maxRound!==void 0&&n.round>t.maxRound)return !1;if(t.containsUsernames&&t.containsUsernames.length){const s=n.players.map(a=>a.name);if(!t.containsUsernames.some(a=>s.includes(a)))return !1}if(t.containsTypoPlayers===!0){const s=tr(n.id??"");return i.some(a=>a.lobbyKey===s)}return !0}async startSearch(){let t=await this._savedFiltersSetting.getValue();const n=await this._selectedFiltersSetting.getValue();if(t=t.filter(i=>n.includes(i.createdAt)),t.length===0){await this._toastService.showToast("No filters selected",`Select search filters from the list above
 or create a new filter`);return}this._logger.debug("Starting search",t),this._currentSearch.next(t);}async promptFilterSearch(t){let n;const i={componentType:Pg,propsFactory:c(s=>(n=this._currentSearch.pipe(Se(a=>a===null)).subscribe(()=>s(null)),{feature:this,filters:t,lobbySelected:c(a=>s(a),"lobbySelected")}),"propsFactory")},o=await this._modalService.showPrompt(i.componentType,i.propsFactory,"Lobby Search","card");n==null||n.unsubscribe(),o===void 0&&(await this._toastService.showToast("Search aborted"),this._overrideSearch.next(null)),typeof o=="string"&&(await this._toastService.showToast("Lobby selected",`Joining lobby ${o}`),this._overrideSearch.next(o)),o===null&&await this._toastService.showToast("Search finished");}async promptFilterCreation(){const t={componentType:Lg,propsFactory:c(i=>({feature:this,onCreate:i.bind(this)}),"propsFactory"),validate:c(i=>this.validateFilter(i),"validate")};return await this._modalService.showPrompt(t.componentType,t.propsFactory,"Add Lobby Filter","card",t.validate)}async removeFilter(t){this._logger.debug("Removing filter",t);const n=await this._toastService.showLoadingToast("Removing filter");try{let i=await this._savedFiltersSetting.getValue();i=i.filter(s=>s.createdAt!==t.createdAt),await this._savedFiltersSetting.setValue(i);const o=await this._selectedFiltersSetting.getValue();await this._selectedFiltersSetting.setValue(o.filter(s=>s!==t.createdAt)),n.resolve(`Filter "${t.name}" removed`);}catch(i){this._logger.error("Failed to remove filter",i),n.reject("Failed to remove filter");}}async addFilter(t){this._logger.debug("Adding filter",t);const n=await this._toastService.showLoadingToast("Adding filter");try{let i=await this._savedFiltersSetting.getValue();i=[t,...i],await this._savedFiltersSetting.setValue(i);const o=await this._selectedFiltersSetting.getValue();await this._selectedFiltersSetting.setValue([t.createdAt,...o]),n.resolve(`Filter "${t.name}" added`);}catch(i){return this._logger.error("Failed to add filter",i),n.reject("Failed to add filter"),!1}return !0}async validateFilter(t){var n;return this._logger.debug("Validating filter",t),t.name=t.name.trim(),t.name.length===0?(await this._toastService.showToast("Invalid Filter","Filter name cannot be empty"),!1):(((n=t.containsUsernames)==null?void 0:n.length)===0&&(t.containsUsernames=void 0),t.minRound!==void 0&&t.minRound<=0&&(t.minRound=void 0),t.maxRound!==void 0&&t.maxRound<=0&&(t.maxRound=void 0),t.minAmountPlayers!==void 0&&t.minAmountPlayers<=0&&(t.minAmountPlayers=void 0),t.maxAmountPlayers!==void 0&&t.maxAmountPlayers<=0&&(t.maxAmountPlayers=void 0),t.minAverageScore!==void 0&&t.minAverageScore<=0&&(t.minAverageScore=void 0),t.maxAverageScore!==void 0&&t.maxAverageScore<=0&&(t.maxAverageScore=void 0),t.minAverageScore!==void 0&&t.maxAverageScore!==void 0&&t.minAverageScore>t.maxAverageScore?(await this._toastService.showToast("Invalid Filter","Minimum average score cannot be higher than maximum average score"),!1):t.minRound!==void 0&&t.maxRound!==void 0&&t.minRound>t.maxRound?(await this._toastService.showToast("Invalid Filter","Minimum round cannot be higher than maximum round"),!1):t.minAmountPlayers!==void 0&&t.maxAmountPlayers!==void 0&&t.minAmountPlayers>t.maxAmountPlayers?(await this._toastService.showToast("Invalid Filter","Minimum amount of players cannot be higher than maximum amount of players"),!1):!0)}buildFilterTooltipText(t){var i;let n="";return (t.minAmountPlayers!=null||t.maxAmountPlayers!==void 0)&&(n+=`
 ${t.minAmountPlayers??"x"} - ${t.maxAmountPlayers??"x"} players`),(t.minAverageScore!=null||t.maxAverageScore!==void 0)&&(n+=`
 ${t.minAverageScore??"x"} - ${t.maxAverageScore??"x"} average score`),(t.minRound!=null||t.maxRound!==void 0)&&(n+=`
 round ${t.minRound??"x"} - ${t.maxRound??"x"}`),(i=t.containsUsernames)!=null&&i.length&&(n+=`
 ${t.containsUsernames.join(", ")}`),t.containsTypoPlayers&&(n+=`
 Typo players`),n.length===0?"Empty filter :(":n.trim()}};c(Q0,"PanelFiltersFeature");let Gr=Q0;ju([D(Me)],Gr.prototype,"_elements");ju([D(ut)],Gr.prototype,"_lobbyService");ju([D(Dn)],Gr.prototype,"_modalService");ju([D(ft)],Gr.prototype,"_toastService");ju([D(br)],Gr.prototype,"_lobbyItemsService");function vT(r,e,t){const n=r.slice();return n[6]=e[t],n[8]=t,n}c(vT,"get_each_context$7");function T6(r){let e,t=te(r[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=_T(vT(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,o){if(o&7){t=te(i[1]);let s;for(s=0;s<t.length;s+=1){const a=vT(i,t,s);n[s]?n[s].p(a,o):(n[s]=_T(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},d(i){i&&A(e),Ie(n,i);}}}c(T6,"create_else_block$3");function D6(r){let e;return {c(){e=G("No people");},m(t,n){k(t,e,n);},p:j,d(t){t&&A(e);}}}c(D6,"create_if_block$6");function _T(r){let e,t=r[6]+"",n,i,o,s;function a(){return r[5](r[6])}return c(a,"click_handler"),{c(){e=v("button"),n=G(t),i=C(),_(e,"type","button"),_(e,"class","svelte-1m0uu0k"),ue(e,"selected",r[8]==r[2]);},m(l,u){k(l,e,u),g(e,n),g(e,i),o||(s=F(e,"click",a),o=!0);},p(l,u){r=l,u&2&&t!==(t=r[6]+"")&&K(n,t),u&4&&ue(e,"selected",r[8]==r[2]);},d(l){l&&A(e),o=!1,s();}}}c(_T,"create_each_block$7");function E6(r){let e;function t(o,s){return o[1].length==0?D6:T6}c(t,"select_block_type");let n=t(r),i=n(r);return {c(){e=v("div"),i.c(),_(e,"class","typo-ping-suggestion-popover svelte-1m0uu0k");},m(o,s){k(o,e,s),i.m(e,null);},p(o,[s]){n===(n=t(o))&&i?i.p(o,s):(i.d(1),i=n(o),i&&(i.c(),i.m(e,null)));},i:j,o:j,d(o){o&&A(e),i.d();}}}c(E6,"create_fragment$c");function M6(r,e,t){let n,i,{feature:o}=e;const s=o.playerCandidatesStore;De(r,s,u=>t(1,n=u));const a=o.kbSelectedPlayerIndexStore;De(r,a,u=>t(2,i=u));const l=c(u=>o.autocompleteSelected(u),"click_handler");return r.$$set=u=>{"feature"in u&&t(0,o=u.feature);},[o,n,i,s,a,l]}c(M6,"instance$c");const X0=class X0 extends se{constructor(e){super(),le(this,e,M6,E6,re,{feature:0});}};c(X0,"Suggestion_popover");let Ng=X0;function yT(r,e,t){const n=r.slice();return n[15]=e[t],n[16]=e,n[17]=t,n}c(yT,"get_each_context$6");function R6(r){let e,t,n=te(r[0]),i=[];for(let s=0;s<n.length;s+=1)i[s]=wT(yT(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();_(e,"class","viplist-list svelte-a9egna");},m(s,a){k(s,e,a);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);t=!0;},p(s,a){if(a&195){n=te(s[0]);let l;for(l=0;l<n.length;l+=1){const u=yT(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=wT(u),i[l].c(),T(i[l],1),i[l].m(e,null));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(R6,"create_else_block$2");function L6(r){let e;return {c(){e=G("No VIPs added!");},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(L6,"create_if_block$5");function wT(r){let e,t,n=r[15].name+"",i,o,s,a,l,u,d,h,p,m;function b(...S){return r[9](r[17],...S)}c(b,"func");function y(S){r[10](S,r[15]);}c(y,"colorpickerbutton_color_binding");let w={colorChanged:b};r[1][r[15].name]!==void 0&&(w.color=r[1][r[15].name]),a=new pi({props:w}),Ve.push(()=>bt(a,"color",y));function I(){return r[11](r[17])}return c(I,"click_handler"),h=new ke({props:{content:"Remove",color:"orange"}}),h.$on("click",I),{c(){e=v("div"),t=v("div"),i=G(n),o=C(),s=v("div"),V(a.$$.fragment),u=C(),d=v("div"),V(h.$$.fragment),p=C(),_(t,"class","svelte-a9egna"),_(s,"class","svelte-a9egna"),_(d,"class","svelte-a9egna"),_(e,"class","viplist-person svelte-a9egna");},m(S,R){k(S,e,R),g(e,t),g(t,i),g(e,o),g(e,s),x(a,s,null),g(e,u),g(e,d),x(h,d,null),g(e,p),m=!0;},p(S,R){r=S,(!m||R&1)&&n!==(n=r[15].name+"")&&K(i,n);const E={};!l&&R&3&&(l=!0,E.color=r[1][r[15].name],gt(()=>l=!1)),a.$set(E);},i(S){m||(T(a.$$.fragment,S),T(h.$$.fragment,S),m=!0);},o(S){M(a.$$.fragment,S),M(h.$$.fragment,S),m=!1;},d(S){S&&A(e),Z(a),Z(h);}}}c(wT,"create_each_block$6");function P6(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R;const E=[L6,R6],P=[];function L($,U){return $[0].length==0?0:1}c(L,"select_block_type"),s=L(r),a=P[s]=E[s](r);function O($){r[13]($);}c(O,"colorpickerbutton_color_binding_1");let z={};return r[3]!==void 0&&(z.color=r[3]),m=new pi({props:z}),Ve.push(()=>bt(m,"color",O)),w=new ke({props:{content:"Add",color:"blue"}}),w.$on("click",r[14]),{c(){e=v("div"),t=v("b"),t.textContent="VIP Players",n=C(),i=v("div"),i.textContent="Highlight your friends' messages in chat!",o=C(),a.c(),l=C(),u=v("div"),d=v("div"),h=v("input"),p=C(),V(m.$$.fragment),y=C(),V(w.$$.fragment),_(t,"class","svelte-a9egna"),_(h,"type","text"),_(h,"placeholder","Name..."),_(h,"class","svelte-a9egna"),_(d,"class","svelte-a9egna"),_(u,"class","viplist-add svelte-a9egna"),_(e,"class","viplist-mgr svelte-a9egna");},m($,U){k($,e,U),g(e,t),g(e,n),g(e,i),g(e,o),P[s].m(e,null),g(e,l),g(e,u),g(u,d),g(d,h),de(h,r[2]),g(d,p),x(m,d,null),g(u,y),x(w,u,null),I=!0,S||(R=F(h,"input",r[12]),S=!0);},p($,[U]){let N=s;s=L($),s===N?P[s].p($,U):(fe(),M(P[N],1,1,()=>{P[N]=null;}),pe(),a=P[s],a?a.p($,U):(a=P[s]=E[s]($),a.c()),T(a,1),a.m(e,l)),U&4&&h.value!==$[2]&&de(h,$[2]);const Y={};!b&&U&8&&(b=!0,Y.color=$[3],gt(()=>b=!1)),m.$set(Y);},i($){I||(T(a),T(m.$$.fragment,$),T(w.$$.fragment,$),I=!0);},o($){M(a),M(m.$$.fragment,$),M(w.$$.fragment,$),I=!1;},d($){$&&A(e),P[s].d(),Z(m),Z(w),S=!1,R();}}}c(P6,"create_fragment$b");function N6(r,e,t){let n,{feature:i}=e;const o=i.vipPlayersStore;De(r,o,S=>t(0,n=S));const s={};let a,l=tt.fromHex("#26ab0f");const u=c(()=>gn(o,n=[...n,{name:a,color:l.hex}],n),"addPlayer"),d=c(S=>gn(o,n=n.filter((R,E)=>E!==S),n),"removePlayer"),h=c((S,R)=>{gn(o,n=n.map((E,P)=>P!==S?E:{...E,color:R.hex}),n);},"updateColor"),p=c((S,R)=>h(S,R),"func");function m(S,R){r.$$.not_equal(s[R.name],S)&&(s[R.name]=S,t(1,s),t(0,n));}c(m,"colorpickerbutton_color_binding");const b=c(S=>d(S),"click_handler");function y(){a=this.value,t(2,a);}c(y,"input_input_handler");function w(S){l=S,t(3,l);}c(w,"colorpickerbutton_color_binding_1");const I=c(()=>u(),"click_handler_1");return r.$$set=S=>{"feature"in S&&t(8,i=S.feature);},r.$$.update=()=>{r.$$.dirty&1&&n.forEach(S=>{t(1,s[S.name]=tt.fromHex(S.color),s);});},[n,s,a,l,o,u,d,h,i,p,m,b,y,w,I]}c(N6,"instance$b");const q0=class q0 extends se{constructor(e){super(),le(this,e,N6,P6,re,{feature:8});}};c(q0,"Vip_players_manage");let Og=q0;var O6=Object.defineProperty,Bh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&O6(e,t,i),i},"__decorateClass$g");const j6=c((r,e)=>{const t=r.parentNode;if(t===null)throw new Error("trying to replace element with no parent.");const n=e.pop();if(n===void 0)throw new Error("provide at least one child");t.replaceChild(n,r);let i=n;for(const o of e.toReversed())t.insertBefore(o,i),i=o;},"replaceMultiple"),G6=c((r,e)=>{const t=Math.min(r.length,e.length),n=r.toLowerCase(),i=e.toLowerCase();for(let o=0;o<t;o++)if(n[o]!==i[o])return o;return t},"beginIntersect"),K0=class K0 extends $e{constructor(){super(...arguments);f(this,"_elements");f(this,"_lobbySvc");f(this,"_chatSvc");f(this,"_lobbyJoinedListener");f(this,"name","Mentions & Highlighting");f(this,"description","Mentions like in Discord and highlighting your and friends' messages.");f(this,"tags",[ye.INTERFACE,ye.SOCIAL]);f(this,"featureId",54);f(this,"_enablePopover",this.useSetting(new He("ping_suggestions",!0,this).withName("Ping Autocomplete").withDescription("Shows an keyboard-navigable autocomplete window for pings.")));f(this,"_enableSelfHighlighting",this.useSetting(new He("highlight_my_messages",!1,this).withName("Highlight My Messages").withDescription("Highlights your own messages.")));f(this,"_enableReplyButton",this.useSetting(new He("enable_reply_button",!1,this).withName("Reply Button").withDescription("Add a reply button to ping people from their messages.")));f(this,"chatSubscription");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_playerCandidates$",new Le([]));f(this,"_kbSelectedPlayerIndex$",new Le(0));f(this,"_kbSelectedPlayerIndex",0);f(this,"_replyButton");f(this,"_vipPlayersSetting",new dt("vip_players",[]));f(this,"_keyupEvents");f(this,"_keydownEvents");f(this,"_messagePointeroverEvents");f(this,"_messagePointerleaveEvents");f(this,"_registeredMessageElements$",new Le(new Set));f(this,"_currentHoveringMessage$",new Le(void 0));}get featureManagementComponent(){return {componentType:Og,props:{feature:this}}}async onActivate(){const t=await this._elements.complete(),n=this._chatSvc.playerMessageReceived$.pipe(lr(void 0),Qe(this._lobbySvc.lobby$),ce(([i,o])=>{if(!o)return;const s=o.players.map(l=>l.name),a=o.players.find(l=>l.id==(o==null?void 0:o.meId));if(a!==void 0)return {msg:i,players:s,self:a}}));this.chatSubscription=n.pipe(Se(i=>i!==void 0)).subscribe(({msg:i,self:o,players:s})=>{i&&this.onMessage(i.contentElement,i.player.name,i.content,o.name,s);}),this._keyupEvents=new Xr(t.chatInput,"keyup"),this._keydownEvents=new Xr(t.chatInput,"keydown"),this._keyupEvents.events$.pipe(Kt(this._lobbyJoinedListener.events$),Oe(n.pipe(ce(i=>i===void 0?[]:i.players)))).subscribe(([,i])=>this.onChatInput(i)),this._keydownEvents.events$.pipe(Oe(this._playerCandidates$)).subscribe(([i,o])=>this.specialKeyboardHandling(i,o)),this._messagePointeroverEvents=new Xr(t.chatContent,"pointerover"),this._messagePointerleaveEvents=new Xr(t.chatContent,"pointerleave"),this._messagePointeroverEvents.events$.pipe(Qe(this._registeredMessageElements$),Oe(this._enableReplyButton.changes$)).subscribe(([[i,o],s])=>{if(!s)return;const a=i.target;for(const l of o)if(l.contains(a)){if(this._currentHoveringMessage$.next(l),!this._replyButton)return this._logger.error("reply button is not set?");l.appendChild(this._replyButton),l.style.position="relative";return}this._currentHoveringMessage$.next(void 0);}),this._messagePointerleaveEvents.events$.pipe(Qe(this._currentHoveringMessage$)).subscribe(([i,o])=>{var s;o==i.target&&(o.style.position="block",this._currentHoveringMessage$.next(void 0)),(s=this._replyButton)==null||s.remove();}),this.createReplyButton();for(const i of t.chatContent.children)this.addMouseoverListenerToMessage(i);}async onDestroy(){var t,n,i,o,s,a,l;(t=this.chatSubscription)==null||t.unsubscribe(),(n=this._flyoutComponent)==null||n.$destroy(),(i=this._flyoutSubscription)==null||i.unsubscribe(),(o=this._keyupEvents)==null||o.unsubscribe(),(s=this._keydownEvents)==null||s.unsubscribe(),this._keyupEvents=void 0,this._keydownEvents=void 0,(a=this._messagePointerleaveEvents)==null||a.unsubscribe(),(l=this._messagePointeroverEvents)==null||l.unsubscribe(),this._messagePointerleaveEvents=void 0,this._messagePointeroverEvents=void 0,this._registeredMessageElements$.getValue().clear();}async createReplyButton(){const t=(await this._elements.complete()).chatInput,n=nn(`
      <button type="button">
        <img src="/img/undo.gif" width="25" height="25" />
      </button>
    `);n.style.position="absolute",n.style.right="0",n.style.bottom="0",n.style.backgroundColor="transparent",this._replyButton=n,this._replyButton.onclick=()=>{var a;const i=this._currentHoveringMessage$.value;if(!i)return;const o=`@${(a=i.querySelector("b"))==null?void 0:a.innerText.slice(0,-2)} `;if(t===void 0)return;let s=t.value;if(s===void 0)return this._logger.error("input value is undefined somehow");s.startsWith(o)||(s=o+s),this._chatSvc.replaceChatboxContent(s);};}addMouseoverListenerToMessage(t){this._registeredMessageElements$.next(this._registeredMessageElements$.value.add(t));}async onMessage(t,n,i,o,s){var y,w;const a=t.parentElement;if(a===null)return this._logger.warn("why doesn't the parent exist");const l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT);let u;for(;u=l.nextNode();){if((y=u.parentElement)!=null&&y.classList.contains("typo-emoji"))continue;const I=((w=u.textContent)==null?void 0:w.split("@"))||[];if(I.length<=1)continue;const S=[];for(const[R,E]of I.entries()){if(R===0){S.push(document.createTextNode(E));continue}let P=null;for(const O of s)E.startsWith(O)&&O.length>((P==null?void 0:P.length)||-1)&&(P=O);if(!P){S.push(document.createTextNode(`@${E}`));continue}const L=document.createElement("b");L.innerText=`@${P}`,S.push(L),S.push(document.createTextNode(E.slice(P.length)));}j6(u,S);}this.addMouseoverListenerToMessage(a);const d=await this._vipPlayersSetting.getValue();for(const I of d)if(I.name===n){a.style.backgroundColor=I.color+"88";return}const h=await this._enableSelfHighlighting.getValue(),p=`@${o} `,m=(i+" ").includes(p),b=h&&o===n;this._logger.debug(d),(m||b)&&a.classList.add("guessed");}specialKeyboardHandling(t,n){var i;if(this._flyoutComponent!==void 0)switch(t.key){case"ArrowUp":{let o=this._kbSelectedPlayerIndex-1;o==-1&&(o=n.length-1),this._kbSelectedPlayerIndex=o,this._kbSelectedPlayerIndex$.next(o);break}case"ArrowDown":{let o=this._kbSelectedPlayerIndex+1;o>=n.length&&(o=0),this._kbSelectedPlayerIndex=o,this._kbSelectedPlayerIndex$.next(o);break}case"Enter":case"Tab":this.autocompleteSelected(n[this._kbSelectedPlayerIndex$.getValue()||0]);break;case"Escape":(i=this._flyoutComponent)==null||i.close();break}}async onChatInput(t){const n=(await this._elements.complete()).chatInput,i=n.value.toLowerCase();if(n.selectionStart!==n.selectionEnd)return this.hideAutocomplete();const o=n.selectionStart;if(!o)return this.hideAutocomplete();if(!i.includes("@"))return this.hideAutocomplete();const s=i.lastIndexOf("@",o)+1;if(s>o)return this.hideAutocomplete();const a=i.slice(s,o),l=t.filter(u=>u.toLowerCase().startsWith(a)&&u!=a);if(l.length==0)return this.hideAutocomplete();this._logger.debug("matches:",l),this._playerCandidates$.next(l),await this.showAutocomplete();}filterChatboxEvents(t){if(t.key==="Tab"||t.key==="Enter"||t.key==="ArrowUp"||t.key==="ArrowDown")return "preventDefault"}hideAutocomplete(){var t;(t=this._flyoutComponent)==null||t.close(),this._flyoutComponent=void 0;}async showAutocomplete(){if(!await this._enablePopover.getValue()||this._flyoutComponent!==void 0)return;const t=await this._elements.complete(),n={componentType:Ng,props:{feature:this}};if(!this._chatSvc.requestChatboxLock(this,this.filterChatboxEvents)){this._logger.error("Could not get chatbox lock, not opening mention flyout");return}this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",marginY:"2.5rem",title:"",closeStrategy:"explicit"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var i,o;(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0,this._chatSvc.releaseChatboxLock(this);});}async autocompleteSelected(t){var h;const n=(await this._elements.complete()).chatInput,i=n.value,o=i.lastIndexOf("@",n.selectionStart??0);if(o===-1)return;const s=`@${t} `,a=i.slice(0,o),l=i.slice(o+1),u=G6(l,t),d=l.slice(u);this._chatSvc.replaceChatboxContent(a+s+d,this),this._chatSvc.moveChatboxCursor(o+s.length,this),(h=this._flyoutComponent)==null||h.close(),n.focus(),this._kbSelectedPlayerIndex$.next(0);}get playerCandidatesStore(){return it(this._playerCandidates$,this._playerCandidates$.value)}get kbSelectedPlayerIndexStore(){return it(this._kbSelectedPlayerIndex$,this._kbSelectedPlayerIndex$.value)}get vipPlayersStore(){return this._vipPlayersSetting.store}};c(K0,"ChatMessageHighlightingFeature");let yo=K0;Bh([D(Me)],yo.prototype,"_elements");Bh([D(ut)],yo.prototype,"_lobbySvc");Bh([D(rn)],yo.prototype,"_chatSvc");Bh([D(Gi)],yo.prototype,"_lobbyJoinedListener");const Tl=c(r=>r.lobbyKey!==void 0&&r.lobbyPlayerId!==void 0,"isAnonymousPlayerIdentification");var Oi=(r=>(r[r.Award=3]="Award",r[r.Sprite=0]="Sprite",r[r.SpriteShift=1]="SpriteShift",r[r.Scene=2]="Scene",r[r.SceneTheme=6]="SceneTheme",r[r.Rewardee=5]="Rewardee",r))(Oi||{});function ST(r,e,t){const n=r.slice();return n[3]=e[t],n}c(ST,"get_each_context$5");function AT(r){let e;return {c(){e=v("div"),_(e,"class","icon visible typo-awards-icon svelte-19i0k4m"),H(e,"background-image","url("+r[3].url+")");},m(t,n){k(t,e,n);},p(t,n){n&1&&H(e,"background-image","url("+t[3].url+")");},d(t){t&&A(e);}}}c(AT,"create_each_block$5");function $6(r){let e,t=te(r[0]),n=[];for(let i=0;i<t.length;i+=1)n[i]=AT(ST(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,[o]){if(o&1){t=te(i[0]);let s;for(s=0;s<t.length;s+=1){const a=ST(i,t,s);n[s]?n[s].p(a,o):(n[s]=AT(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},i:j,o:j,d(i){i&&A(e),Ie(n,i);}}}c($6,"create_fragment$a");function Y6(r,e,t){let{playerDisplay:n}=e,{awards:i}=e;const o=c(()=>i,"getAwards");return r.$$set=s=>{"playerDisplay"in s&&t(1,n=s.playerDisplay),"awards"in s&&t(0,i=s.awards);},[i,n,o]}c(Y6,"instance$a");const e1=class e1 extends se{constructor(e){super(),le(this,e,Y6,$6,re,{playerDisplay:1,awards:0,getAwards:2});}get getAwards(){return this.$$.ctx[2]}};c(e1,"Awards_display");let jg=e1;function kT(r){let e,t,n;return t=new st({props:{hoverMove:!1,size:"48px",name:"Award this drawing",tooltipAction:r[0].createTooltip,icon:"file-img-award-gif"}}),t.$on("click",r[6]),{c(){e=v("div"),V(t.$$.fragment),_(e,"class","typo-awards-icon svelte-aldc0m");},m(i,o){k(i,e,o),x(t,e,null),n=!0;},p(i,o){const s={};o&1&&(s.tooltipAction=i[0].createTooltip),t.$set(s);},i(i){n||(T(t.$$.fragment,i),n=!0);},o(i){M(t.$$.fragment,i),n=!1;},d(i){i&&A(e),Z(t);}}}c(kT,"create_if_block_1$2");function CT(r){let e=r[1],t,n=IT(r);return {c(){n.c(),t=je();},m(i,o){n.m(i,o),k(i,t,o);},p(i,o){o&2&&re(e,e=i[1])?(n.d(1),n=IT(i),n.c(),n.m(t.parentNode,t)):n.p(i,o);},d(i){i&&A(t),n.d(i);}}}c(CT,"create_if_block$4");function IT(r){let e;return {c(){e=v("div"),_(e,"class","typo-awards-presentation svelte-aldc0m"),H(e,"background-image","url("+r[1].url+")");},m(t,n){k(t,e,n);},p(t,n){n&2&&H(e,"background-image","url("+t[1].url+")");},d(t){t&&A(e);}}}c(IT,"create_key_block");function z6(r){let e,t,n,i=r[2]!==void 0&&r[2]!==null&&r[3]&&kT(r),o=r[1]!==void 0&&CT(r);return {c(){i&&i.c(),e=C(),o&&o.c(),t=je();},m(s,a){i&&i.m(s,a),k(s,e,a),o&&o.m(s,a),k(s,t,a),n=!0;},p(s,[a]){s[2]!==void 0&&s[2]!==null&&s[3]?i?(i.p(s,a),a&12&&T(i,1)):(i=kT(s),i.c(),T(i,1),i.m(e.parentNode,e)):i&&(fe(),M(i,1,1,()=>{i=null;}),pe()),s[1]!==void 0?o?o.p(s,a):(o=CT(s),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null);},i(s){n||(T(i),n=!0);},o(s){M(i),n=!1;},d(s){s&&(A(e),A(t)),i&&i.d(s),o&&o.d(s);}}}c(z6,"create_fragment$9");function U6(r,e,t){let n,i,{feature:o}=e,{currentAwardPresentation:s=void 0}=e;const a=o.memberStore;De(r,a,d=>t(2,n=d));const l=o.playerAwardableStore;De(r,l,d=>t(3,i=d));const u=c(async()=>{const d=await o.promptAwardSelection(n);d!==void 0&&d.inventoryIds.length>0&&await o.giveAward(d.inventoryIds[0]);},"click_handler");return r.$$set=d=>{"feature"in d&&t(0,o=d.feature),"currentAwardPresentation"in d&&t(1,s=d.currentAwardPresentation);},[o,s,n,i,a,l,u]}c(U6,"instance$9");const t1=class t1 extends se{constructor(e){super(),le(this,e,U6,z6,re,{feature:0,currentAwardPresentation:1});}};c(t1,"Player_awards");let Gg=t1;function TT(r,e,t){const n=r.slice();return n[4]=e[t],n}c(TT,"get_each_context$4");function DT(r){let e,t,n,i,o,s=r[4].award.name+"",a,l,u,d=r[2](r[4].award.rarity)+"",h,p,m,b,y=r[4].inventoryIds.length+"",w,I,S,R;function E(){return r[3](r[4])}return c(E,"click_handler"),{c(){e=v("div"),t=v("div"),n=C(),i=v("span"),o=v("b"),a=G(s),l=C(),u=v("span"),h=G(d),p=C(),m=v("span"),b=G("x"),w=G(y),I=C(),_(t,"class","typo-award-picker-award-thumb svelte-9q5vog"),H(t,"background-image","url("+r[4].award.url+")"),_(i,"class","svelte-9q5vog"),_(u,"class","svelte-9q5vog"),_(m,"class","svelte-9q5vog"),_(e,"class","typo-award-picker-award svelte-9q5vog"),H(e,"order",r[4].award.id);},m(P,L){k(P,e,L),g(e,t),g(e,n),g(e,i),g(i,o),g(o,a),g(e,l),g(e,u),g(u,h),g(e,p),g(e,m),g(m,b),g(m,w),g(e,I),S||(R=F(e,"click",E),S=!0);},p(P,L){r=P,L&2&&H(t,"background-image","url("+r[4].award.url+")"),L&2&&s!==(s=r[4].award.name+"")&&K(a,s),L&2&&d!==(d=r[2](r[4].award.rarity)+"")&&K(h,d),L&2&&y!==(y=r[4].inventoryIds.length+"")&&K(w,y),L&2&&H(e,"order",r[4].award.id);},d(P){P&&A(e),S=!1,R();}}}c(DT,"create_each_block$4");function B6(r){let e,t,n,i,o=te(r[1]),s=[];for(let a=0;a<o.length;a+=1)s[a]=DT(TT(r,o,a));return {c(){e=v("div"),t=v("span"),t.textContent="Choose an award from your inventory to award the current drawing.",n=C(),i=v("div");for(let a=0;a<s.length;a+=1)s[a].c();_(t,"class","svelte-9q5vog"),_(i,"class","typo-award-picker-list color-scrollbar svelte-9q5vog"),_(e,"class","typo-award-picker svelte-9q5vog");},m(a,l){k(a,e,l),g(e,t),g(e,n),g(e,i);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(i,null);},p(a,[l]){if(l&7){o=te(a[1]);let u;for(u=0;u<o.length;u+=1){const d=TT(a,o,u);s[u]?s[u].p(d,l):(s[u]=DT(d),s[u].c(),s[u].m(i,null));}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length;}},i:j,o:j,d(a){a&&A(e),Ie(s,a);}}}c(B6,"create_fragment$8");function x6(r,e,t){let{onPick:n}=e,{awards:i}=e;const o=c(a=>{switch(a){case 0:return "Common";case 1:return "Special";case 2:return "Epic";default:return "Legendary"}},"getAwardRarityName"),s=c(a=>n(a),"click_handler");return r.$$set=a=>{"onPick"in a&&t(0,n=a.onPick),"awards"in a&&t(1,i=a.awards);},[n,i,o,s]}c(x6,"instance$8");const n1=class n1 extends se{constructor(e){super(),le(this,e,x6,B6,re,{onPick:0,awards:1});}};c(n1,"Player_awards_award_picker");let $g=n1;var Z6=Object.defineProperty,Hn=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Z6(e,t,i),i},"__decorateClass$f");const i1=class i1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_apiDataSetup");f(this,"_lobbyConnectionService");f(this,"_chatService");f(this,"_toastService");f(this,"_lobbyItemsService");f(this,"_lobbyService");f(this,"_lobbyPlayersService");f(this,"_memberService");f(this,"_apiService");f(this,"_modalService");f(this,"_cloudService");f(this,"_lobbyLeftEventListener");f(this,"name","Awards");f(this,"description","Award drawings of other typo players with special awards");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",41);f(this,"toggleEnabled",!1);f(this,"_enableAwardAnimationSetting",this.useSetting(new He("animation",!0,this).withName("Award Animation").withDescription("Show an animation over the canvas when a player is awarded")));f(this,"_awardedSubscription");f(this,"_lobbyItemsSubscription");f(this,"_lobbyLeftSubscription");f(this,"_awardsContainers",new Map);f(this,"_awardsComponent");}async onActivate(){const t=await this._elementsSetup.complete(),n=await this._apiDataSetup.complete(),i=this._awardsComponent=new Gg({target:t.canvasWrapper,props:{feature:this,currentAwardPresentation:void 0}});this._lobbyLeftSubscription=this._lobbyLeftEventListener.events$.subscribe(()=>{this._cloudService.clearPendingAwardInventoryIds(),i.$set({currentAwardPresentation:void 0});}),this._awardedSubscription=this._lobbyConnectionService.awardGifted$.pipe(Oe(this._lobbyService.lobby$)).subscribe(async([o,s])=>{var b;const a=n.awards.find(y=>y.id===o.awardId);a===void 0&&this._logger.warn("Award dto not found",o);const u=`${((b=s==null?void 0:s.players.find(y=>y.id===o.awarderLobbyPlayerId))==null?void 0:b.name)??"Unknown"} awarded this with a ${(a==null?void 0:a.name)??"Award"}!`,d=`
${a==null?void 0:a.description}`,p=await(await this._chatService.addChatMessage(d,u,"info")).message,m=nn(`<img 
        src="${a==null?void 0:a.url}" 
        alt="${a==null?void 0:a.name}"
        style="height: 2rem; width: 2rem; margin: 0 .5rem"
      >`);p.wrapperElement.insertAdjacentElement("afterbegin",m),i.$set({currentAwardPresentation:structuredClone(a)}),this._cloudService.addPendingAwardInventoryId(o.awardInventoryId);}),this._lobbyItemsSubscription=this._lobbyItemsService.onlineItems$.pipe(Oe(this._lobbyPlayersService.players$)).subscribe(([o,s])=>{this.updatePlayerAwards(s,o,n.awards);});}async onDestroy(){var t,n,i,o;(t=this._awardsComponent)==null||t.$destroy(),(n=this._awardedSubscription)==null||n.unsubscribe(),(i=this._lobbyItemsSubscription)==null||i.unsubscribe(),(o=this._lobbyLeftSubscription)==null||o.unsubscribe(),this._awardedSubscription=void 0,this._lobbyItemsSubscription=void 0,this._awardsComponent=void 0,this._lobbyLeftSubscription=void 0,this._cloudService.clearPendingAwardInventoryIds(),this._awardsContainers.forEach(s=>s.$destroy()),this._awardsContainers.clear();}get memberStore(){return it(this._memberService.member$,void 0)}get playerAwardableStore(){return it(this._lobbyItemsService.onlineItems$.pipe(Qe(this._lobbyService.lobby$),ce(([t,n])=>{if(n===null||n.id===null||n.drawerId===void 0||n.drawerId===n.meId)return !1;const i=tr(n.id);return t.some(s=>s.lobbyKey===i&&s.lobbyPlayerId===n.drawerId)})),!1)}get awardsAnimationSettingStore(){return this._enableAwardAnimationSetting.store}async updatePlayerAwards(t,n,i){this._logger.debug("Updating player awards",t);for(const[o,s]of this._awardsContainers)t.includes(o)||(s.$destroy(),this._awardsContainers.delete(o));for(const o of t){const s=o.iconsContainer;if(s===null)continue;const a=o.typoId;let l=this._awardsContainers.get(o);l||(l=new jg({target:s,props:{awards:[],playerDisplay:o}}),this._awardsContainers.set(o,l));let u=[];Tl(a)?u=this.getAwardsForAnonymousPlayerDisplay(a,n,i):Tl(a)?this._logger.warn("Unknown player identification",a):u=[];const d=l.getAwards();(u.length!==d.length||u.some((p,m)=>d[m].id!==p.id))&&l.$set({awards:u});}}getAwardsForAnonymousPlayerDisplay(t,n,i){return n.filter(a=>a.lobbyPlayerId===t.lobbyPlayerId&&a.lobbyKey===t.lobbyKey).filter(a=>a.type===Oi.Award).map(a=>i.find(l=>a.itemId===l.id)).filter(a=>a!==void 0)}async promptAwardSelection(t){this._logger.debug("Opening award picker");const n=await this._apiService.getApi(di).getMemberAvailableAwardInventory({login:Number(t.userLogin)}),i={componentType:$g,propsFactory:c(s=>({awards:n,onPick:s.bind(this)}),"propsFactory")},o=await this._modalService.showPrompt(i.componentType,i.propsFactory,"Award Picker","card");return this._logger.debug("Award picker closed",o),o}async giveAward(t){this._logger.debug("Giving award to current drawer",t);try{await this._lobbyConnectionService.connection.hub.giftAward({awardInventoryId:t});}catch(n){this._logger.error("Failed to gift award",n),await this._toastService.showToast("Failed to gift award");}}};c(i1,"PlayerAwardsFeature");let An=i1;Hn([D(Me)],An.prototype,"_elementsSetup");Hn([D(Tn)],An.prototype,"_apiDataSetup");Hn([D(go)],An.prototype,"_lobbyConnectionService");Hn([D(rn)],An.prototype,"_chatService");Hn([D(ft)],An.prototype,"_toastService");Hn([D(br)],An.prototype,"_lobbyItemsService");Hn([D(ut)],An.prototype,"_lobbyService");Hn([D(en)],An.prototype,"_lobbyPlayersService");Hn([D(Sn)],An.prototype,"_memberService");Hn([D(mi)],An.prototype,"_apiService");Hn([D(Dn)],An.prototype,"_modalService");Hn([D(co)],An.prototype,"_cloudService");Hn([D(Vn)],An.prototype,"_lobbyLeftEventListener");function ET(r){let e;return {c(){e=v("div"),_(e,"class","typo-player-scene svelte-eg9tl1"),H(e,"background-image","url('"+r[1](r[0])+"')");},m(t,n){k(t,e,n);},p(t,n){n&1&&H(e,"background-image","url('"+t[1](t[0])+"')");},d(t){t&&A(e);}}}c(ET,"create_if_block$3");function V6(r){let e,t=r[0]!==void 0&&ET(r);return {c(){t&&t.c(),e=je();},m(n,i){t&&t.m(n,i),k(n,e,i);},p(n,[i]){n[0]!==void 0?t?t.p(n,i):(t=ET(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null);},i:j,o:j,d(n){n&&A(e),t&&t.d(n);}}}c(V6,"create_fragment$7");function J6(r,e,t){let{scene:n=void 0}=e,{playerDisplay:i}=e;const o=c(()=>n,"getScene"),s=c(a=>a.shift===void 0?a.scene.url:`https://static.typo.rip/sprites/rainbow/modulate.php?url=${a.scene.url}&hue=${a.shift}`,"getUrl");return vh(()=>{t(2,i.useSafeColor=!1,i),t(2,i.useBackground=!1,i);}),r.$$set=a=>{"scene"in a&&t(0,n=a.scene),"playerDisplay"in a&&t(2,i=a.playerDisplay);},r.$$.update=()=>{r.$$.dirty&1&&(t(2,i.useSafeColor=n!==void 0,i),t(2,i.useBackground=n===void 0,i));},[n,s,i,o]}c(J6,"instance$7");const r1=class r1 extends se{constructor(e){super(),le(this,e,J6,V6,re,{scene:0,playerDisplay:2,getScene:3});}get getScene(){return this.$$.ctx[3]}};c(r1,"Scene_container");let Yg=r1;var F6=Object.defineProperty,xh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&F6(e,t,i),i},"__decorateClass$e");const o1=class o1 extends $e{constructor(){super(...arguments);f(this,"_apiDataSetup");f(this,"_lobbyItemsService");f(this,"_lobbyPlayersService");f(this,"_memberService");f(this,"name","Player Scenes");f(this,"description","Display scenes of typo players in lobbies and on the landing page");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",21);f(this,"toggleEnabled",!1);f(this,"developerFeature",!0);f(this,"_scenesSubscription");f(this,"_sceneContainers",new Map);}async onActivate(){const t=(await this._apiDataSetup.complete()).scenes;this._scenesSubscription=this._lobbyPlayersService.players$.pipe(Qe(this._lobbyItemsService.onlineItems$,this._memberService.memberData$)).subscribe(([n,i])=>{this.updatePlayerScenes(n,i,t);});}async onDestroy(){var t;(t=this._scenesSubscription)==null||t.unsubscribe(),this._sceneContainers.forEach(n=>n.$destroy()),this._sceneContainers.clear();}async updatePlayerScenes(t,n,i){var o,s;this._logger.debug("Updating player scenes",t);for(const[a,l]of this._sceneContainers)t.includes(a)||(l.$destroy(),this._sceneContainers.delete(a));for(const a of t){const l=a.typoId;let u=this._sceneContainers.get(a);u||(u=new Yg({target:a.backgroundContainer,props:{scene:void 0,playerDisplay:a}}),this._sceneContainers.set(a,u));let d=[];Tl(l)?d=this.getItemsForAnonymousPlayerDisplay(l,n):Tl(l)?this._logger.warn("Unknown player identification",l):d=await this.getItemsForConcretePlayerDisplay(l);const h=this.createSceneFromItems(d,i);(((o=u.getScene())==null?void 0:o.scene.id)!==(h==null?void 0:h.scene.id)||((s=u.getScene())==null?void 0:s.shift)!==(h==null?void 0:h.shift))&&(this._logger.info("Updating scene for player",a,h,d),u.$set({scene:h}));}}getItemsForAnonymousPlayerDisplay(t,n){return n.filter(i=>i.lobbyPlayerId===t.lobbyPlayerId&&i.lobbyKey===t.lobbyKey)}async getItemsForConcretePlayerDisplay(t){return await this.createItemsForMember(t.login)}createSceneFromItems(t,n){const i=t.find(a=>a.type===Oi.Scene),o=t.find(a=>a.type===Oi.SceneTheme&&a.slot===(i==null?void 0:i.itemId));if(i===void 0)return;const s=n.find(a=>a.id===i.itemId);if(s===void 0){this._logger.warn("Scene not found",i.itemId);return}return {scene:s,shift:o==null?void 0:o.itemId}}async createItemsForMember(t){var o;this._logger.debug("Creating demo scene items for member",t);const n=(o=await Ee(this._memberService.memberData$))==null?void 0:o.sceneInventory;if(n===void 0)return [];const i=[];return n.activeId!==void 0&&(i.push({itemId:n.activeId,type:Oi.Scene,lobbyPlayerId:0,slot:0,lobbyKey:"practice"}),n.activeShift!==void 0&&i.push({itemId:n.activeShift,type:Oi.SceneTheme,lobbyPlayerId:0,slot:n.activeId,lobbyKey:"practice"})),i}};c(o1,"PlayerScenesFeature");let wo=o1;xh([D(Tn)],wo.prototype,"_apiDataSetup");xh([D(br)],wo.prototype,"_lobbyItemsService");xh([D(en)],wo.prototype,"_lobbyPlayersService");xh([D(Sn)],wo.prototype,"_memberService");function MT(r,e,t){const n=r.slice();return n[4]=e[t],n}c(MT,"get_each_context$3");function RT(r){let e;return {c(){e=v("div"),_(e,"class","sprite-slot svelte-1uuttlm"),H(e,"background-image","url('"+r[1](r[4])+"')"),H(e,"z-index",r[4].slot+10);},m(t,n){k(t,e,n);},p(t,n){n&1&&H(e,"background-image","url('"+t[1](t[4])+"')"),n&1&&H(e,"z-index",t[4].slot+10);},d(t){t&&A(e);}}}c(RT,"create_each_block$3");function W6(r){let e,t=te(r[0]),n=[];for(let i=0;i<t.length;i+=1)n[i]=RT(MT(r,t,i));return {c(){for(let i=0;i<n.length;i+=1)n[i].c();e=je();},m(i,o){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,o);k(i,e,o);},p(i,[o]){if(o&3){t=te(i[0]);let s;for(s=0;s<t.length;s+=1){const a=MT(i,t,s);n[s]?n[s].p(a,o):(n[s]=RT(a),n[s].c(),n[s].m(e.parentNode,e));}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length;}},i:j,o:j,d(i){i&&A(e),Ie(n,i);}}}c(W6,"create_fragment$6");function H6(r,e,t){let{sprites:n=[]}=e,{playerDisplay:i}=e;const o=c(()=>n,"getSprites"),s=c(a=>a.shift===void 0?a.sprite.url:`https://static.typo.rip/sprites/rainbow/modulate.php?url=${a.sprite.url}&hue=${a.shift}`,"getUrl");return vh(()=>{t(2,i.adjustToContainSprites=!1,i);}),r.$$set=a=>{"sprites"in a&&t(0,n=a.sprites),"playerDisplay"in a&&t(2,i=a.playerDisplay);},r.$$.update=()=>{r.$$.dirty&1&&(t(2,i.adjustToContainSprites=n.length>0,i),t(2,i.hideAvatar=n.some(a=>a.sprite.isSpecial),i));},[n,s,i,o]}c(H6,"instance$6");const s1=class s1 extends se{constructor(e){super(),le(this,e,H6,W6,re,{sprites:0,playerDisplay:2,getSprites:3});}get getSprites(){return this.$$.ctx[3]}};c(s1,"Sprite_container");let zg=s1;var Q6=Object.defineProperty,Zh=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&Q6(e,t,i),i},"__decorateClass$d");const a1=class a1 extends $e{constructor(){super(...arguments);f(this,"_apiDataSetup");f(this,"_lobbyItemsService");f(this,"_lobbyPlayersService");f(this,"_memberService");f(this,"name","Player Sprites");f(this,"description","Display sprites of typo players in lobbies and on the landing page");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",20);f(this,"toggleEnabled",!1);f(this,"developerFeature",!0);f(this,"_spritesSubscription");f(this,"_spriteContainers",new Map);}async onActivate(){const t=(await this._apiDataSetup.complete()).sprites;this._spritesSubscription=this._lobbyPlayersService.players$.pipe(Qe(this._lobbyItemsService.onlineItems$,this._memberService.memberData$)).subscribe(([n,i])=>{this.updatePlayerSprites(n,i,t);});}async onDestroy(){var t;(t=this._spritesSubscription)==null||t.unsubscribe(),this._spriteContainers.forEach(n=>n.$destroy()),this._spriteContainers.clear();}async updatePlayerSprites(t,n,i){this._logger.debug("Updating player sprites",t);for(const[o,s]of this._spriteContainers)t.includes(o)||(s.$destroy(),this._spriteContainers.delete(o));for(const o of t){const s=o.typoId;let a=this._spriteContainers.get(o);a||(a=new zg({target:o.avatarContainer,props:{sprites:[],playerDisplay:o}}),this._spriteContainers.set(o,a));let l=[];Tl(s)?l=this.getItemsForAnonymousPlayerDisplay(s,n):Tl(s)?this._logger.warn("Unknown player identification",s):l=await this.getItemsForConcretePlayerDisplay(s);const u=this.createSpriteSlotsFromItems(l,i),d=a.getSprites();(u.length!==d.length||u.some(p=>{const m=d.find(b=>b.slot===p.slot);return !m||m.sprite.id!==p.sprite.id||m.shift!==p.shift}))&&(this._logger.info("Updating sprite slots for player",o,u,l),a.$set({sprites:u}));}}getItemsForAnonymousPlayerDisplay(t,n){return n.filter(i=>i.lobbyPlayerId===t.lobbyPlayerId&&i.lobbyKey===t.lobbyKey)}async getItemsForConcretePlayerDisplay(t){return await this.createItemsForMember(t.login)}createSpriteSlotsFromItems(t,n){const i=t.filter(a=>a.type===Oi.Sprite),o=t.filter(a=>a.type===Oi.SpriteShift);return i.map(a=>{var u;const l=n.find(d=>d.id===a.itemId);if(l===void 0){this._logger.warn(`Sprite with id ${a.itemId} not found`);return}return {sprite:l,slot:a.slot,shift:(u=o.find(d=>d.slot===a.slot))==null?void 0:u.itemId}}).filter(a=>a!==void 0)}async createItemsForMember(t){var o;return this._logger.debug("Creating demo items for member",t),(((o=await Ee(this._memberService.memberData$))==null?void 0:o.spriteInventory)??[]).map(s=>{const a=s.slot?{itemId:s.spriteId,type:Oi.Sprite,lobbyPlayerId:0,slot:s.slot,lobbyKey:"practice"}:void 0,l=s.colorShift!==void 0&&s.slot?{itemId:s.colorShift,type:Oi.SpriteShift,lobbyPlayerId:0,slot:s.slot,lobbyKey:"practice"}:void 0;return [a,l]}).flat().filter(s=>s!==void 0)}};c(a1,"PlayerSpritesFeature");let So=a1;Zh([D(Tn)],So.prototype,"_apiDataSetup");Zh([D(br)],So.prototype,"_lobbyItemsService");Zh([D(en)],So.prototype,"_lobbyPlayersService");Zh([D(Sn)],So.prototype,"_memberService");var X6=Object.defineProperty,q6=Object.getOwnPropertyDescriptor,K6=c((r,e,t,n)=>{for(var i=n>1?void 0:n?q6(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&X6(e,t,i),i},"__decorateClass$c"),Ua;let $r=(Ua=class{},c(Ua,"TypoChallenge"),Ua);$r=K6([we()],$r);var eB=Object.defineProperty,Ib=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&eB(e,t,i),i},"__decorateClass$b");const l1=class l1 extends $r{constructor(){super(...arguments);f(this,"_lobbyService");f(this,"_drawingService");f(this,"_elementsSetup");f(this,"name","Blind Guess");f(this,"description","You don't see what other people are drawing.");}createTriggerObservable(){return this._lobbyService.lobby$.pipe(Qe(this._drawingService.drawingState$),ce(([t,n])=>n==="drawing"&&t!==null&&t.meId!==t.drawerId&&!t.players.some(i=>i.id===t.meId&&i.guessed)),ct())}async apply(t){const n=await this._elementsSetup.complete();t?n.canvas.style.opacity="0":n.canvas.style.opacity="";}destroy(){return this.apply(!1)}};c(l1,"BlindGuessChallenge");let Dl=l1;Ib([D(ut)],Dl.prototype,"_lobbyService");Ib([D(zt)],Dl.prototype,"_drawingService");Ib([D(Me)],Dl.prototype,"_elementsSetup");var tB=Object.defineProperty,Tb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&tB(e,t,i),i},"__decorateClass$a");const c1=class c1 extends $r{constructor(){super(...arguments);f(this,"_lobbyService");f(this,"_drawingService");f(this,"_chatService");f(this,"_blurredMessages");f(this,"_style");f(this,"_messagesSubscription");f(this,"name","Deaf Guess");f(this,"description","When guessing, you don't see hints or messages from other people.");}createTriggerObservable(){return this._lobbyService.lobby$.pipe(Qe(this._drawingService.drawingState$),ce(([t,n])=>n==="drawing"&&t!==null&&t.meId!==t.drawerId&&!t.players.some(i=>i.id===t.meId&&i.guessed)),ct())}async apply(t){var n,i,o;t?(this._messagesSubscription||(this._messagesSubscription=this._chatService.playerMessageReceived$.subscribe(s=>{this._blurredMessages?this._blurredMessages.push(s.contentElement):this._blurredMessages=[s.contentElement],s.element.classList.add("typo-challenge-deaf-guess-hidden");})),this._style||(this._style=Eu(),this._style.sheet.insertRule(".typo-challenge-deaf-guess-hidden span, .player-bubble .content .text { filter: blur(3px); }"),this._style.sheet.insertRule("#game form.chat-form .characters, #game-word .hints { opacity: 0 }"))):((n=this._messagesSubscription)==null||n.unsubscribe(),this._messagesSubscription=void 0,(i=this._blurredMessages)==null||i.forEach(s=>s.classList.remove("typo-challenge-deaf-guess-hidden")),this._blurredMessages=void 0,(o=this._style)==null||o.remove(),this._style=void 0);}destroy(){return this.apply(!1)}};c(c1,"DeafGuessChallenge");let El=c1;Tb([D(ut)],El.prototype,"_lobbyService");Tb([D(zt)],El.prototype,"_drawingService");Tb([D(rn)],El.prototype,"_chatService");var nB=Object.defineProperty,Db=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&nB(e,t,i),i},"__decorateClass$9");const u1=class u1 extends $r{constructor(){super(...arguments);f(this,"_canvasClearedEvent");f(this,"_drawingService");f(this,"_toastService");f(this,"_style");f(this,"_canvasClearedSubscription");f(this,"name","Dont Clear");f(this,"description","The canvas cannot be cleared; you draw over other previous drawings.");}createTriggerObservable(){return Tt(!0)}async apply(t){t&&(this._style=Eu(),this._style.sheet.insertRule(".tool[data-tooltip='Undo'], .tool[data-tooltip='Clear'] { display: none }"),this._canvasClearedSubscription=this._canvasClearedEvent.events$.subscribe(async n=>{await this._drawingService.drawImage(n.data);}),await this._toastService.showToast("Don't Clear active","Attention: Your drawings will look different (likely as nonsense) for other people!"));}destroy(){var t;this._style&&(this._style.remove(),this._style=void 0),(t=this._canvasClearedSubscription)==null||t.unsubscribe();}};c(u1,"DontClearChallenge");let Ml=u1;Db([D(Cc)],Ml.prototype,"_canvasClearedEvent");Db([D(zt)],Ml.prototype,"_drawingService");Db([D(ft)],Ml.prototype,"_toastService");var iB=Object.defineProperty,Eb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&iB(e,t,i),i},"__decorateClass$8");const d1=class d1 extends $r{constructor(){super(...arguments);f(this,"_lobbyService");f(this,"_drawingService");f(this,"_elementsSetup");f(this,"name","Drunk Vision");f(this,"description","You can only vaguely see what other people draw.");f(this,"_overlay");}createTriggerObservable(){return this._lobbyService.lobby$.pipe(Qe(this._drawingService.drawingState$),ce(([t,n])=>n==="drawing"&&t!==null&&t.meId!==t.drawerId&&!t.players.some(i=>i.id===t.meId&&i.guessed)),ct())}async apply(t){var i;const n=await this._elementsSetup.complete();t?this._overlay===void 0&&(this._overlay=document.createElement("div"),this._overlay.style.position="absolute",this._overlay.style.width="100%",this._overlay.style.height="100%",this._overlay.style.backdropFilter="blur(40px)",this._overlay.style.pointerEvents="none",this._overlay.style.zIndex="0",n.canvasWrapper.appendChild(this._overlay)):((i=this._overlay)==null||i.remove(),this._overlay=void 0);}destroy(){return this.apply(!1)}};c(d1,"DrunkVisionChallenge");let Rl=d1;Eb([D(ut)],Rl.prototype,"_lobbyService");Eb([D(zt)],Rl.prototype,"_drawingService");Eb([D(Me)],Rl.prototype,"_elementsSetup");var rB=Object.defineProperty,Mb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&rB(e,t,i),i},"__decorateClass$7");const h1=class h1 extends $r{constructor(){super(...arguments);f(this,"_lobbyService");f(this,"_drawingService");f(this,"_colorsService");f(this,"name","Monochrome");f(this,"description","You can only use shades of a random color column.");}createTriggerObservable(){return this._lobbyService.lobby$.pipe(Qe(this._drawingService.drawingState$),ce(([t,n])=>n==="drawing"&&t!==null&&t.meId===t.drawerId),ct())}apply(t){t?this._colorsService.setColorSelector(n=>{n=n??ml.skribblPalette;const i=Math.floor(Math.random()*n.columns);return {preferredColumnWidth:Math.min(n.columns,n.colorHexCodes.length),columns:1,colorHexCodes:n.columns===1||n.colorHexCodes.length===1?n.colorHexCodes:(n==null?void 0:n.colorHexCodes.filter((o,s)=>s%n.columns===i))??[]}}):this._colorsService.resetColorSelector();}destroy(){this.apply(!1);}};c(h1,"MonochromeChallenge");let Ll=h1;Mb([D(ut)],Ll.prototype,"_lobbyService");Mb([D(zt)],Ll.prototype,"_drawingService");Mb([D(Rr)],Ll.prototype,"_colorsService");var oB=Object.defineProperty,Rb=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&oB(e,t,i),i},"__decorateClass$6");const f1=class f1 extends $r{constructor(){super(...arguments);f(this,"_lobbyService");f(this,"_drawingService");f(this,"_messageSentEventListener");f(this,"_style");f(this,"name","One Shot");f(this,"description","You have only one try to guess the word.");}createTriggerObservable(){return this._lobbyService.lobby$.pipe(Qe(this._drawingService.drawingState$),ce(([t,n])=>n==="drawing"&&t!==null&&t.meId!==t.drawerId&&!t.players.some(i=>i.id===t.meId&&i.guessed)),ct(),lt(t=>t===!1?Tt(!1):this._messageSentEventListener.events$.pipe(vt(1),ce(()=>!0))))}async apply(t){t?this._style||(this._style=Eu(),this._style.sheet.insertRule("#game form.chat-form { display: none }")):this._style&&(this._style.remove(),this._style=void 0);}destroy(){return this.apply(!1)}};c(f1,"OneShotChallenge");let Pl=f1;Rb([D(ut)],Pl.prototype,"_lobbyService");Rb([D(zt)],Pl.prototype,"_drawingService");Rb([D(rl)],Pl.prototype,"_messageSentEventListener");function LT(r,e,t){const n=r.slice();return n[5]=e[t],n}c(LT,"get_each_context$2");function PT(r){let e,t,n,i,o,s;function a(...l){return r[4](r[5],...l)}return c(a,"change_handler"),t=new It({props:{checked:r[0].includes(r[5].id),description:r[5].challenge.name}}),t.$on("change",a),{c(){e=v("div"),V(t.$$.fragment),n=C(),i=v("span"),i.textContent=`${r[5].challenge.description}`,o=C(),_(i,"class","svelte-wy9tne"),_(e,"class","challenge svelte-wy9tne");},m(l,u){k(l,e,u),x(t,e,null),g(e,n),g(e,i),g(e,o),s=!0;},p(l,u){r=l;const d={};u&1&&(d.checked=r[0].includes(r[5].id)),t.$set(d);},i(l){s||(T(t.$$.fragment,l),s=!0);},o(l){M(t.$$.fragment,l),s=!1;},d(l){l&&A(e),Z(t);}}}c(PT,"create_each_block$2");function sB(r){let e,t,n=te(r[1]),i=[];for(let s=0;s<n.length;s+=1)i[s]=PT(LT(r,n,s));const o=c(s=>M(i[s],1,1,()=>{i[s]=null;}),"out");return {c(){e=v("div");for(let s=0;s<i.length;s+=1)i[s].c();_(e,"class","typo-toolbar-challenges-list svelte-wy9tne");},m(s,a){k(s,e,a);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);t=!0;},p(s,[a]){if(a&3){n=te(s[1]);let l;for(l=0;l<n.length;l+=1){const u=LT(s,n,l);i[l]?(i[l].p(u,a),T(i[l],1)):(i[l]=PT(u),i[l].c(),T(i[l],1),i[l].m(e,null));}for(fe(),l=n.length;l<i.length;l+=1)o(l);pe();}},i(s){if(!t){for(let a=0;a<n.length;a+=1)T(i[a]);t=!0;}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)M(i[a]);t=!1;},d(s){s&&A(e),Ie(i,s);}}}c(sB,"create_fragment$5");function aB(r,e,t){let n,{feature:i}=e;const o=i.challenges,s=i.activatedChallengesSettingStore;De(r,s,l=>t(0,n=l));const a=c((l,u)=>{const d=n.filter(h=>h!==l.id);gn(s,n=u.detail?[...d,l.id]:d,n);},"change_handler");return r.$$set=l=>{"feature"in l&&t(3,i=l.feature);},[n,o,s,i,a]}c(aB,"instance$5");const p1=class p1 extends se{constructor(e){super(),le(this,e,aB,sB,re,{feature:3});}};c(p1,"Toolbar_challenges");let Ug=p1;var lB=Object.defineProperty,OE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&lB(e,t,i),i},"__decorateClass$5");const m1=class m1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_container");f(this,"name","Challenges");f(this,"description","Adds the option to enable game modifications to make the game more challenging");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",8);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_challengeStatesSubscription");f(this,"_challengeStates",new Map);f(this,"_activatedChallenges",new dt("activated_challenges",[],this));f(this,"_challenges",[{challenge:Dl,id:1},{challenge:Rl,id:2},{challenge:El,id:3},{challenge:Pl,id:4},{challenge:Ml,id:5},{challenge:Ll,id:6}]);f(this,"_flyoutComponent");f(this,"_flyoutSubscription");}async onActivate(){const t=await this._elementsSetup.complete();for(const n of this._challenges){const i=await this.resolveChallenge(n.challenge);this._challengeStates.set(n.id,{challenge:i});}this._challengeStatesSubscription=this.listenChallengeStates(),this._iconComponent=new st({target:t.toolbar,props:{icon:"file-img-challenge-gif",name:"Challenges",order:4,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{if(this._flyoutComponent)return;const n={componentType:Ug,props:{feature:this}};this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",title:"Challenges",iconName:"file-img-nochallenge-gif"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var i,o;this._logger.info("Destroyed flyout"),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;});});}onDestroy(){var t,n,i,o,s;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy(),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutSubscription=void 0,this._challengeStates.clear(),(s=this._challengeStatesSubscription)==null||s.unsubscribe(),this._challengeStatesSubscription=void 0;}get activatedChallengesSettingStore(){return this._activatedChallenges.store}get challenges(){const t=[...this._challengeStates.entries().map(([n,{challenge:i}])=>({id:n,challenge:i}))];return this._logger.debug(t),t}listenChallengeStates(){return this._activatedChallenges.changes$.subscribe(async t=>{var n;t.forEach(i=>{const o=this._challengeStates.get(i);if(!o){this._logger.warn(`Challenge with id ${i} not resolved`);return}o.destroy||(this._logger.debug(`Activating challenge ${o.challenge.name}`),o.destroy=this.activateChallenge(o.challenge));}),this._challengeStates.forEach((i,o)=>{!t.includes(o)&&i.destroy&&(this._logger.debug(`Deactivating challenge ${i.challenge.name}`),i.destroy(),i.destroy=void 0);}),(n=this._iconComponent)==null||n.$set({icon:t.length>0?"file-img-challenge-gif":"file-img-nochallenge-gif"});})}async resolveChallenge(t){const n=this._container.resolveService(t);return this._logger.debug(`Resolved challenge: ${n.name}`),n}activateChallenge(t){this._logger.debug(`Activating challenge ${t.name}`);const i=t.createTriggerObservable().subscribe(async o=>{this._logger.debug(`Challenge trigger: ${o}`);try{await t.apply(o);}catch(s){this._logger.error(`Error applying challenge: ${s}`);}});return ()=>{this._logger.debug(`Destroying challenge ${t.name}`),i.unsubscribe();try{t.destroy();}catch(o){this._logger.error(`Error destroying challenge: ${o}`);}}}};c(m1,"ToolbarChallengesFeature");let yu=m1;OE([D(Me)],yu.prototype,"_elementsSetup");OE([D(hu)],yu.prototype,"_container");var cB=Object.defineProperty,uB=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&cB(e,t,i),i},"__decorateClass$4");const g1=class g1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"name","Fullscreen");f(this,"description","Adds a toggle in-game to quickly enter/exit the browser fullscreen mode");f(this,"tags",[ye.GAMEPLAY]);f(this,"featureId",9);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_toggleHotkey",this.useHotkey(new cn("toggle_fullscreen","Toggle Fullscreen","Toggle the browser fullscreen mode",this,async()=>await this.toggleFullscreen(),!0,["ShiftLeft","KeyF"])));}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.toolbar,props:{icon:"file-img-fullscreen-gif",name:"Fullscreen",order:1,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(async()=>{await this.toggleFullscreen();});}onDestroy(){var t,n;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy();}async toggleFullscreen(){document.fullscreenElement===null?(this._logger.debug("Entering fullscreen"),await document.documentElement.requestFullscreen()):(this._logger.debug("Exiting fullscreen"),await document.exitFullscreen());}};c(g1,"ToolbarFullscreenFeature");let ah=g1;uB([D(Me)],ah.prototype,"_elementsSetup");const NT=c(async(r,e)=>{const t=document.createElement("input");return t.type="file",t.accept=r,t.multiple=e,t.click(),new Promise(n=>{t.onchange=()=>{t.files&&t.files.length>0?n(t.files):n(null);};})},"chooseFile");function OT(r,e,t){const n=r.slice();return n[17]=e[t],n}c(OT,"get_each_context$1");function jT(r){let e,t,n,i,o;return t=new st({props:{icon:"file-img-disabled-gif",name:"Abort",size:"1.5rem",hoverMove:!1}}),t.$on("click",r[7]),{c(){e=v("div"),V(t.$$.fragment),n=C(),i=v("span"),i.textContent="Drawing in progress...",_(i,"class","svelte-1tv05w9"),_(e,"class","lockedHint svelte-1tv05w9");},m(s,a){k(s,e,a),x(t,e,null),g(e,n),g(e,i),o=!0;},p:j,i(s){o||(T(t.$$.fragment,s),o=!0);},o(s){M(t.$$.fragment,s),o=!1;},d(s){s&&A(e),Z(t);}}}c(jT,"create_if_block_1$1");function GT(r){let e,t,n,i,o,s;function a(){return r[8](r[17])}c(a,"click_handler_1"),n=new st({props:{icon:"file-img-trash-gif",name:"Remove",size:"1.5rem",hoverMove:!1}}),n.$on("click",a);function l(){return r[9](r[17])}return c(l,"click_handler_2"),o=new ke({props:{content:r[17].name,color:"blue"}}),o.$on("click",l),{c(){e=v("div"),t=v("div"),V(n.$$.fragment),i=C(),V(o.$$.fragment),_(t,"class","remove svelte-1tv05w9"),_(e,"class","saved-commands svelte-1tv05w9"),ue(e,"locked",r[1]);},m(u,d){k(u,e,d),g(e,t),x(n,t,null),g(e,i),x(o,e,null),s=!0;},p(u,d){r=u;const h={};d&4&&(h.content=r[17].name),o.$set(h),(!s||d&2)&&ue(e,"locked",r[1]);},i(u){s||(T(n.$$.fragment,u),T(o.$$.fragment,u),s=!0);},o(u){M(n.$$.fragment,u),M(o.$$.fragment,u),s=!1;},d(u){u&&A(e),Z(n),Z(o);}}}c(GT,"create_each_block$1");function $T(r){let e,t,n;function i(s){r[16](s);}c(i,"checkbox_checked_binding_1");let o={description:"Paste instant (practice!)"};return r[0].pasteInstant!==void 0&&(o.checked=r[0].pasteInstant),e=new It({props:o}),Ve.push(()=>bt(e,"checked",i)),{c(){V(e.$$.fragment);},m(s,a){x(e,s,a),n=!0;},p(s,a){const l={};!t&&a&1&&(t=!0,l.checked=s[0].pasteInstant,gt(()=>t=!1)),e.$set(l);},i(s){n||(T(e.$$.fragment,s),n=!0);},o(s){M(e.$$.fragment,s),n=!1;},d(s){Z(e,s);}}}c($T,"create_if_block$2");function dB(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y,w,I,S,R,E=r[1]&&jT(r),P=te(r[2]),L=[];for(let N=0;N<P.length;N+=1)L[N]=GT(OT(r,P,N));const O=c(N=>M(L[N],1,1,()=>{L[N]=null;}),"out");i=new ke({props:{content:"Paste Image",color:"green"}}),i.$on("click",r[10]),s=new ke({props:{content:"Save Current Image",color:"green"}}),s.$on("click",r[11]),l=new ke({props:{content:"Load SKD File",color:"blue"}}),l.$on("click",r[12]),d=new ke({props:{content:"Download Current SKD",color:"blue"}}),d.$on("click",r[13]);function z(N){r[15](N);}c(z,"checkbox_checked_binding");let $={description:"Clear before paste"};r[0].clearBeforePaste!==void 0&&($.checked=r[0].clearBeforePaste),b=new It({props:$}),Ve.push(()=>bt(b,"checked",z));let U=r[3]&&$T(r);return {c(){e=v("div"),E&&E.c(),t=C();for(let N=0;N<L.length;N+=1)L[N].c();n=C(),V(i.$$.fragment),o=C(),V(s.$$.fragment),a=C(),V(l.$$.fragment),u=C(),V(d.$$.fragment),h=C(),p=v("input"),m=C(),V(b.$$.fragment),w=C(),U&&U.c(),_(p,"type","text"),_(p,"class","typo"),_(p,"placeholder","Custom save name"),_(e,"class","typo-toolbar-imagelab-actions svelte-1tv05w9");},m(N,Y){k(N,e,Y),E&&E.m(e,null),g(e,t);for(let ee=0;ee<L.length;ee+=1)L[ee]&&L[ee].m(e,null);g(e,n),x(i,e,null),g(e,o),x(s,e,null),g(e,a),x(l,e,null),g(e,u),x(d,e,null),g(e,h),g(e,p),de(p,r[0].customName),g(e,m),x(b,e,null),g(e,w),U&&U.m(e,null),I=!0,S||(R=F(p,"input",r[14]),S=!0);},p(N,[Y]){if(N[1]?E?(E.p(N,Y),Y&2&&T(E,1)):(E=jT(N),E.c(),T(E,1),E.m(e,t)):E&&(fe(),M(E,1,1,()=>{E=null;}),pe()),Y&7){P=te(N[2]);let B;for(B=0;B<P.length;B+=1){const J=OT(N,P,B);L[B]?(L[B].p(J,Y),T(L[B],1)):(L[B]=GT(J),L[B].c(),T(L[B],1),L[B].m(e,n));}for(fe(),B=P.length;B<L.length;B+=1)O(B);pe();}Y&1&&p.value!==N[0].customName&&de(p,N[0].customName);const ee={};!y&&Y&1&&(y=!0,ee.checked=N[0].clearBeforePaste,gt(()=>y=!1)),b.$set(ee),N[3]?U?(U.p(N,Y),Y&8&&T(U,1)):(U=$T(N),U.c(),T(U,1),U.m(e,null)):U&&(fe(),M(U,1,1,()=>{U=null;}),pe());},i(N){if(!I){T(E);for(let Y=0;Y<P.length;Y+=1)T(L[Y]);T(i.$$.fragment,N),T(s.$$.fragment,N),T(l.$$.fragment,N),T(d.$$.fragment,N),T(b.$$.fragment,N),T(U),I=!0;}},o(N){M(E),L=L.filter(Boolean);for(let Y=0;Y<L.length;Y+=1)M(L[Y]);M(i.$$.fragment,N),M(s.$$.fragment,N),M(l.$$.fragment,N),M(d.$$.fragment,N),M(b.$$.fragment,N),M(U),I=!1;},d(N){N&&A(e),E&&E.d(),Ie(L,N),Z(i),Z(s),Z(l),Z(d),Z(b),U&&U.d(),S=!1,R();}}}c(dB,"create_fragment$4");function hB(r,e,t){let n,i,o,{feature:s}=e;const a=s.savedDrawCommandsStore;De(r,a,E=>t(2,i=E));const l=s.devmodeStore;De(r,l,E=>t(3,o=E)),s.customName="";const u=s.locked;De(r,u,E=>t(1,n=E));const d=c(()=>s.abortPaste(),"click_handler"),h=c(E=>s.removeDrawCommands(i,E),"click_handler_1"),p=c(E=>s.pasteDrawCommands(E),"click_handler_2"),m=c(async()=>{const E=await s.pickImageFromLocal();E!=null&&await s.pasteImageToLocation(E);},"click_handler_3"),b=c(()=>s.saveCurrentDrawCommands(),"click_handler_4"),y=c(()=>s.addDrawCommandsFromFile(),"click_handler_5"),w=c(()=>s.downloadCurrentDrawCommands(),"click_handler_6");function I(){s.customName=this.value,t(0,s);}c(I,"input_input_handler");function S(E){r.$$.not_equal(s.clearBeforePaste,E)&&(s.clearBeforePaste=E,t(0,s));}c(S,"checkbox_checked_binding");function R(E){r.$$.not_equal(s.pasteInstant,E)&&(s.pasteInstant=E,t(0,s));}return c(R,"checkbox_checked_binding_1"),r.$$set=E=>{"feature"in E&&t(0,s=E.feature);},[s,n,i,o,a,l,u,d,h,p,m,b,y,w,I,S,R]}c(hB,"instance$4");const b1=class b1 extends se{constructor(e){super(),le(this,e,hB,dB,re,{feature:0});}};c(b1,"Toolbar_imagelab");let Bg=b1;function fB(r){let e,t,n,i,o,s,a,l,u,d,h,p,m;return s=new ke({props:{content:"Fit on canvas",color:"green"}}),s.$on("click",r[1]),l=new ke({props:{content:"Fill canvas",color:"green"}}),l.$on("click",r[2]),d=new ke({props:{content:"Paste top-right on click position",color:"blue"}}),d.$on("click",r[3]),p=new ke({props:{content:"Paste between two click positions",color:"blue"}}),p.$on("click",r[4]),{c(){e=v("div"),t=v("p"),t.innerHTML=`Pick a mode to paste the image on the canvas.<br/>
    &quot;Fill on canvas&quot; and &quot;Paste between click&quot; might change the source image ratio.<br/> <br/> <b>Warning: This should be used only in practice mode.</b><br/>
    No one else can see this image, and it will corrupt your drawing for others.`,n=C(),i=v("br"),o=C(),V(s.$$.fragment),a=C(),V(l.$$.fragment),u=C(),V(d.$$.fragment),h=C(),V(p.$$.fragment),_(e,"class","typo-imagelab-position-picker svelte-zwzp7f");},m(b,y){k(b,e,y),g(e,t),g(e,n),g(e,i),g(e,o),x(s,e,null),g(e,a),x(l,e,null),g(e,u),x(d,e,null),g(e,h),x(p,e,null),m=!0;},p:j,i(b){m||(T(s.$$.fragment,b),T(l.$$.fragment,b),T(d.$$.fragment,b),T(p.$$.fragment,b),m=!0);},o(b){M(s.$$.fragment,b),M(l.$$.fragment,b),M(d.$$.fragment,b),M(p.$$.fragment,b),m=!1;},d(b){b&&A(e),Z(s),Z(l),Z(d),Z(p);}}}c(fB,"create_fragment$3");function pB(r,e,t){let{onPick:n}=e;const i=c(()=>n("fit"),"click_handler"),o=c(()=>n("fill"),"click_handler_1"),s=c(()=>n("position"),"click_handler_2"),a=c(()=>n("range"),"click_handler_3");return r.$$set=l=>{"onPick"in l&&t(0,n=l.onPick);},[n,i,o,s,a]}c(pB,"instance$3");const v1=class v1 extends se{constructor(e){super(),le(this,e,pB,fB,re,{onPick:0});}};c(v1,"Imagelab_position_picker");let xg=v1;var mB=Object.defineProperty,xr=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&mB(e,t,i),i},"__decorateClass$3");const _1=class _1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_drawingService");f(this,"_drawCommandsService");f(this,"_toastService");f(this,"_modalService");f(this,"_canvasEventsSetup");f(this,"_lobbyService");f(this,"_globalSettingsService");f(this,"name","Image Laboratory");f(this,"description","Adds an icon to the typo toolbar to save or paste skribbl drawings (SKDs) to a lobby");f(this,"tags",[ye.DRAWING]);f(this,"featureId",10);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_customName");f(this,"clearBeforePaste",!1);f(this,"pasteInstant",!1);}get boundServices(){return [this._drawCommandsService]}set customName(t){const n=(t==null?void 0:t.replace(/[^a-z0-9]/gi,"_"))??void 0;this._customName=n&&n.length>0?n:void 0;}get customName(){return this._customName}get locked(){return it(this._drawingService.pasteInProgress$,!1)}get devmodeStore(){return this._globalSettingsService.settings.devMode.store}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.toolbar,props:{icon:"file-img-dna-gif",name:"Image Laboratory",order:3,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{if(this._flyoutComponent)return;const n={componentType:Bg,props:{feature:this}};this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",title:"Image Laboratory",iconName:"file-img-dna-gif"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var i,o;this._logger.info("Destroyed flyout"),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;});});}onDestroy(){var t,n,i,o;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy(),(i=this._flyoutComponent)==null||i.$destroy(),this._flyoutComponent=void 0,(o=this._flyoutSubscription)==null||o.unsubscribe();}async addDrawCommandsFromFile(){const t=await NT(".skd",!0);if(t===null)return;(await Promise.all([...t].map(async i=>{let o;try{const s=await i.text();if(o=JSON.parse(s),typeof o!="object"||!Array.isArray(o))throw new Error("Invalid format")}catch(s){throw this._logger.error("Failed to read file",i,s),s}return {name:i.name,commands:o}}))).forEach(i=>this._drawCommandsService.saveDrawCommands(i.name,i.commands));}saveCurrentDrawCommands(){Hr({commands:this._drawingService.commands$,state:this._drawingService.imageState$}).pipe(vt(1)).subscribe(({commands:t,state:n})=>{if(n===null)throw this._logger.warn("Attempted to save commands, but state null. In a lobby?"),new Error("state is null");this._drawCommandsService.saveDrawCommands(this._customName??n.word.hints,t);});}downloadCurrentDrawCommands(){Hr({commands:this._drawingService.commands$,state:this._drawingService.imageState$}).pipe(vt(1)).subscribe(({commands:t,state:n})=>{if(n===null)throw this._logger.warn("Attempted to save commands, but state null. In a lobby?"),new Error("state is null");const i=this._customName??n.word.hints,o=JSON.stringify(t);mb(o,`${i}.skd`);});}get savedDrawCommandsStore(){return it(this._drawCommandsService.savedDrawCommands$,[])}removeDrawCommands(t,n){const i=t.indexOf(n);if(i===-1)throw this._logger.warn("Tried to remove commands, but not found"),new Error;this._drawCommandsService.removeSavedDrawCommands(i);}async pasteDrawCommands(t){const n=await Ee(this._lobbyService.lobby$);if(n===null){await this._toastService.showToast("Can't paste outside of a lobby");return}if(n.drawerId!==n.meId){await this._toastService.showToast("You can only paste while you are drawing");return}this.clearBeforePaste&&this._drawingService.clearImage(),await this._drawingService.pasteDrawCommands(t.commands,!this.pasteInstant);}abortPaste(){this._drawingService.cancelPendingDrawCommands();}async pickImageFromLocal(){const t=await NT("image/*",!1);if(t===null)return null;const n=t[0],i=new FileReader,o=new Le(void 0);return i.onload=async s=>{var l;const a=(l=s.target)==null?void 0:l.result;if(typeof a!="string"){this._logger.error("Failed to read file",n),await this._toastService.showToast("Failed to read file"),o.next(null);return}o.next(a);},i.readAsDataURL(n),await Ee(o.pipe(Se(s=>s!==void 0)))}async pasteImageToLocation(t){this._logger.debug("Pasting image to location");const n={componentType:xg,propsFactory:c(h=>({onPick:h.bind(this)}),"propsFactory")},i=await this._modalService.showPrompt(n.componentType,n.propsFactory,"Paste Image");if(this._logger.debug("Selected mode",i),i===void 0)return;let o,s,a,l;const u=(await this._elementsSetup.complete()).canvas,d=new Image;if(d.src=t,await new Promise(h=>d.onload=h),i==="fit"){const h=Math.min(u.width/d.width,u.height/d.height);a=d.width*h,l=d.height*h,o=(u.width-a)/2,s=(u.height-l)/2;}else if(i==="fill")o=0,s=0,a=u.width,l=u.height;else if(i==="position"){const h=await this._toastService.showStickyToast("Paste Image","Click on the canvas to paste the image",!0);let p;try{p=await this.waitForCanvasClick(Ee(h.closed$));}catch(m){this._logger.debug("Aborted paste image",m),h.close();return}o=p.offsetX,s=p.offsetY,a=d.width,l=d.height,h.close();}else if(i==="range"){const h=await this._toastService.showStickyToast("Paste Image","Click on the canvas to select the top-left corner",!0);let p,m;try{p=await this.waitForCanvasClick(Ee(h.closed$)),h.update("Paste Image","Click on the canvas to select the bottom-right corner"),m=await this.waitForCanvasClick(Ee(h.closed$));}catch(b){this._logger.debug("Aborted paste image",b),h.close();return}o=Math.min(p.offsetX,m.offsetX),s=Math.min(p.offsetY,m.offsetY),a=Math.abs(p.offsetX-m.offsetX),l=Math.abs(p.offsetY-m.offsetY),h.close();}await this._drawingService.drawImage(t,o,s,a,l);}async waitForCanvasClick(t){const n=new be,i=c(a=>(a.stopImmediatePropagation(),n.next(a),!1),"listener");t==null||t.then(()=>{n.complete(),o.remove("pointerdown",i);});const o=await this._canvasEventsSetup.complete();o.add("preDraw")("pointerdown",i);const s=await Ee(n);return o.remove("pointerdown",i),s}};c(_1,"ToolbarImageLabFeature");let wi=_1;xr([D(Me)],wi.prototype,"_elementsSetup");xr([D(zt)],wi.prototype,"_drawingService");xr([D(uu)],wi.prototype,"_drawCommandsService");xr([D(ft)],wi.prototype,"_toastService");xr([D(Dn)],wi.prototype,"_modalService");xr([D(Er)],wi.prototype,"_canvasEventsSetup");xr([D(ut)],wi.prototype,"_lobbyService");xr([D(xn)],wi.prototype,"_globalSettingsService");function YT(r,e,t){const n=r.slice();return n[15]=e[t],n}c(YT,"get_each_context");function gB(r){let e;return {c(){e=v("div"),e.textContent="The image history is empty. Check again later!";},m(t,n){k(t,e,n);},p:j,i:j,o:j,d(t){t&&A(e);}}}c(gB,"create_else_block$1");function bB(r){let e,t,n,i,o,s,a,l,u,d=r[1][r[3]].artist+"",h,p,m=r[1][r[3]].date.toLocaleTimeString()+"",b,y,w,I,S,R,E,P,L,O,z,$,U,N,Y;a=new st({props:{icon:"file-img-arrow-left-gif",name:"Previous",size:"1.5rem",hoverMove:!1,disabled:r[3]<=0}}),a.$on("click",r[10]),w=new st({props:{icon:"file-img-arrow-right-gif",name:"Next",size:"1.5rem",hoverMove:!1,disabled:r[3]>=r[1].length-1}}),w.$on("click",r[11]);function ee(X){r[12](X);}c(ee,"checkbox_checked_binding");let B={description:"Send with Discord embed"};r[2]!==void 0&&(B.checked=r[2]),S=new It({props:B}),Ve.push(()=>bt(S,"checked",ee));let J=te(r[6].webhooks),q=[];for(let X=0;X<J.length;X+=1)q[X]=zT(YT(r,J,X));let Q=r[5]!==null&&r[4]===null&&UT(r);return {c(){e=v("input"),t=C(),n=v("img"),o=C(),s=v("div"),V(a.$$.fragment),l=C(),u=v("span"),h=G(d),p=G(" at  "),b=G(m),y=C(),V(w.$$.fragment),I=C(),V(S.$$.fragment),E=C(),P=v("div"),P.textContent="Select one of your connected discord servers. When you submit, the image will appear in a channel on the server!",L=C(),O=v("select");for(let X=0;X<q.length;X+=1)q[X].c();z=C(),Q&&Q.c(),$=je(),_(e,"type","text"),_(e,"class","typo"),_(e,"placeholder","Custom image name"),ht(n.src,i=r[1][r[3]].image.getBase64())||_(n,"src",i),_(n,"alt","Post image"),_(n,"class","svelte-f411i0"),_(s,"class","navigate-image svelte-f411i0"),_(P,"class","typo-post-info svelte-f411i0"),r[5]===void 0&&Ir(()=>r[13].call(O));},m(X,ne){k(X,e,ne),de(e,r[1][r[3]].name),k(X,t,ne),k(X,n,ne),k(X,o,ne),k(X,s,ne),x(a,s,null),g(s,l),g(s,u),g(u,h),g(u,p),g(u,b),g(s,y),x(w,s,null),k(X,I,ne),x(S,X,ne),k(X,E,ne),k(X,P,ne),k(X,L,ne),k(X,O,ne);for(let W=0;W<q.length;W+=1)q[W]&&q[W].m(O,null);Li(O,r[5],!0),k(X,z,ne),Q&&Q.m(X,ne),k(X,$,ne),U=!0,N||(Y=[F(e,"input",r[9]),F(O,"change",r[13])],N=!0);},p(X,ne){ne&10&&e.value!==X[1][X[3]].name&&de(e,X[1][X[3]].name),(!U||ne&10&&!ht(n.src,i=X[1][X[3]].image.getBase64()))&&_(n,"src",i);const W={};ne&8&&(W.disabled=X[3]<=0),a.$set(W),(!U||ne&10)&&d!==(d=X[1][X[3]].artist+"")&&K(h,d),(!U||ne&10)&&m!==(m=X[1][X[3]].date.toLocaleTimeString()+"")&&K(b,m);const he={};ne&10&&(he.disabled=X[3]>=X[1].length-1),w.$set(he);const Pe={};if(!R&&ne&4&&(R=!0,Pe.checked=X[2],gt(()=>R=!1)),S.$set(Pe),ne&64){J=te(X[6].webhooks);let me;for(me=0;me<J.length;me+=1){const Ae=YT(X,J,me);q[me]?q[me].p(Ae,ne):(q[me]=zT(Ae),q[me].c(),q[me].m(O,null));}for(;me<q.length;me+=1)q[me].d(1);q.length=J.length;}ne&96&&Li(O,X[5]),X[5]!==null&&X[4]===null?Q?(Q.p(X,ne),ne&48&&T(Q,1)):(Q=UT(X),Q.c(),T(Q,1),Q.m($.parentNode,$)):Q&&(fe(),M(Q,1,1,()=>{Q=null;}),pe());},i(X){U||(T(a.$$.fragment,X),T(w.$$.fragment,X),T(S.$$.fragment,X),T(Q),U=!0);},o(X){M(a.$$.fragment,X),M(w.$$.fragment,X),M(S.$$.fragment,X),M(Q),U=!1;},d(X){X&&(A(e),A(t),A(n),A(o),A(s),A(I),A(E),A(P),A(L),A(O),A(z),A($)),Z(a),Z(w),Z(S,X),Ie(q,X),Q&&Q.d(X),N=!1,Je(Y);}}}c(bB,"create_if_block_1");function zT(r){let e,t=r[15].name+"",n,i,o=r[15].guild.guildName+"",s,a,l;return {c(){e=v("option"),n=G(t),i=G(" ("),s=G(o),a=G(")"),e.__value=l=r[15],de(e,e.__value);},m(u,d){k(u,e,d),g(e,n),g(e,i),g(e,s),g(e,a);},p(u,d){d&64&&t!==(t=u[15].name+"")&&K(n,t),d&64&&o!==(o=u[15].guild.guildName+"")&&K(s,o),d&64&&l!==(l=u[15])&&(e.__value=l,de(e,e.__value));},d(u){u&&A(e);}}}c(zT,"create_each_block");function UT(r){let e,t;return e=new ke({props:{content:"Send to Server",color:"green"}}),e.$on("click",r[14]),{c(){V(e.$$.fragment);},m(n,i){x(e,n,i),t=!0;},p:j,i(n){t||(T(e.$$.fragment,n),t=!0);},o(n){M(e.$$.fragment,n),t=!1;},d(n){Z(e,n);}}}c(UT,"create_if_block_2");function BT(r){let e;return {c(){e=v("div"),e.textContent="Log in with your typo account to post images to one of your Discord servers!",_(e,"class","not-logged-in svelte-f411i0");},m(t,n){k(t,e,n);},d(t){t&&A(e);}}}c(BT,"create_if_block$1");function vB(r){let e,t,n,i,o;const s=[bB,gB],a=[];function l(d,h){return d[1].length>0&&d[6]!==void 0&&d[6]!==null?0:1}c(l,"select_block_type"),t=l(r),n=a[t]=s[t](r);let u=(r[6]===null||r[6]===void 0)&&BT();return {c(){e=v("div"),n.c(),i=C(),u&&u.c(),_(e,"class","typo-image-post svelte-f411i0");},m(d,h){k(d,e,h),a[t].m(e,null),g(e,i),u&&u.m(e,null),o=!0;},p(d,[h]){let p=t;t=l(d),t===p?a[t].p(d,h):(fe(),M(a[p],1,1,()=>{a[p]=null;}),pe(),n=a[t],n?n.p(d,h):(n=a[t]=s[t](d),n.c()),T(n,1),n.m(e,i)),d[6]===null||d[6]===void 0?u||(u=BT(),u.c(),u.m(e,null)):u&&(u.d(1),u=null);},i(d){o||(T(n),o=!0);},o(d){M(n),o=!1;},d(d){d&&A(e),a[t].d(),u&&u.d();}}}c(vB,"create_fragment$2");function _B(r,e,t){let n,i,{feature:o}=e,s=!0,a=0,l=null;const u=o.imageHistoryStore;De(r,u,S=>t(1,n=S));const d=o.memberStore;De(r,d,S=>t(6,i=S));let h=(i==null?void 0:i.webhooks[0])??null;function p(){n[a].name=this.value,u.set(n);}c(p,"input_input_handler");const m=c(()=>t(3,a--,a),"click_handler"),b=c(()=>t(3,a++,a),"click_handler_1");function y(S){s=S,t(2,s);}c(y,"checkbox_checked_binding");function w(){h=yc(this),t(5,h);}c(w,"select_change_handler");const I=c(()=>t(4,l=h?o.postWebhook(h,n[a],!s):null),"click_handler_2");return r.$$set=S=>{"feature"in S&&t(0,o=S.feature);},r.$$.update=()=>{r.$$.dirty&2&&t(3,a=n.length-1);},[o,n,s,a,l,h,i,u,d,p,m,b,y,w,I]}c(_B,"instance$2");const y1=class y1 extends se{constructor(e){super(),le(this,e,_B,vB,re,{feature:0});}};c(y1,"Toolbar_imagepost");let Zg=y1;var yB=Object.defineProperty,No=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&yB(e,t,i),i},"__decorateClass$2");const w1=class w1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_imagePostService");f(this,"_imageFinishedService");f(this,"_drawingService");f(this,"_memberService");f(this,"_apiService");f(this,"_toastService");f(this,"name","Image Post");f(this,"description","Adds an icon to the typo toolbar to send images from your lobby directly to one of your connected discord servers");f(this,"tags",[ye.SOCIAL,ye.PALANTIR]);f(this,"featureId",11);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_popoutOpened$",new be);f(this,"_submitted$",new be);}get boundServices(){return [this._imagePostService]}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.toolbar,props:{icon:"file-img-letter-gif",name:"Post Image",order:5,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{if(this._flyoutComponent)return;this._popoutOpened$.next();const n={componentType:Zg,props:{feature:this}};this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",title:"Post Image",iconName:"file-img-letter-gif"}}),this._flyoutSubscription=this._flyoutComponent.closed$.pipe(Kt(this._submitted$)).subscribe(()=>{var i,o;this._logger.info("Destroyed flyout"),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;});});}onDestroy(){var t,n,i,o;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy(),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;}get imageHistoryStore(){const t=this._imagePostService.history$.pipe(lt(n=>this._drawingService.drawingState$.pipe(vt(1),lt(i=>i==="drawing"?this._imageFinishedService.mapToImageState(Tt(1)):Tt(null)),ce(i=>i===null?n:[...n,i]))));return it(t,[])}get memberStore(){return it(this._memberService.memberData$,null)}async postWebhook(t,n,i){const o=await this._toastService.showLoadingToast("Posting image to "+t.name);try{await this._apiService.getApi(dp).postImageToGuild({token:t.guild.invite,id:t.name,postImageDto:{title:n.name,author:n.artist,posterName:n.player,onlyImage:i,imageBase64:n.image.base64ApiTruncated}}),this._submitted$.next(),o.resolve();}catch(s){this._logger.error("Failed to post image to discord",s),o.reject();}}};c(w1,"ToolbarImagePostFeature");let Ui=w1;No([D(Me)],Ui.prototype,"_elementsSetup");No([D(du)],Ui.prototype,"_imagePostService");No([D(lo)],Ui.prototype,"_imageFinishedService");No([D(zt)],Ui.prototype,"_drawingService");No([D(Sn)],Ui.prototype,"_memberService");No([D(mi)],Ui.prototype,"_apiService");No([D(ft)],Ui.prototype,"_toastService");const wB=c(async r=>{const e=[new ClipboardItem({[r.type]:r})];await navigator.clipboard.write(e);},"copyBlobToClipboard");function SB(r){let e,t,n,i,o,s,a,l,u,d,h,p,m,b,y;return i=new ke({props:{content:"Download PNG",color:"green"}}),i.$on("click",r[2]),s=new ke({props:{content:"Download GIF",color:"green"}}),s.$on("click",r[3]),l=new ke({props:{content:"Download Draw Progress",color:"green"}}),l.$on("click",r[4]),d=new ke({props:{content:"Copy to Clipboard",color:"blue"}}),d.$on("click",r[5]),p=new ke({props:{content:"Save in Cloud",color:"blue"}}),p.$on("click",r[6]),{c(){e=v("div"),t=v("input"),n=C(),V(i.$$.fragment),o=C(),V(s.$$.fragment),a=C(),V(l.$$.fragment),u=C(),V(d.$$.fragment),h=C(),V(p.$$.fragment),_(t,"type","text"),_(t,"class","typo"),_(t,"placeholder","Custom image name"),_(e,"class","typo-toolbar-save-actions svelte-1xyzs78");},m(w,I){k(w,e,I),g(e,t),de(t,r[0].customName),g(e,n),x(i,e,null),g(e,o),x(s,e,null),g(e,a),x(l,e,null),g(e,u),x(d,e,null),g(e,h),x(p,e,null),m=!0,b||(y=F(t,"input",r[1]),b=!0);},p(w,[I]){I&1&&t.value!==w[0].customName&&de(t,w[0].customName);},i(w){m||(T(i.$$.fragment,w),T(s.$$.fragment,w),T(l.$$.fragment,w),T(d.$$.fragment,w),T(p.$$.fragment,w),m=!0);},o(w){M(i.$$.fragment,w),M(s.$$.fragment,w),M(l.$$.fragment,w),M(d.$$.fragment,w),M(p.$$.fragment,w),m=!1;},d(w){w&&A(e),Z(i),Z(s),Z(l),Z(d),Z(p),b=!1,y();}}}c(SB,"create_fragment$1");function AB(r,e,t){let{feature:n}=e;n.customName="";function i(){n.customName=this.value,t(0,n);}c(i,"input_input_handler");const o=c(()=>n.saveAsPng(),"click_handler"),s=c(()=>n.saveAsGif(),"click_handler_1"),a=c(()=>n.saveAsDrawCommands(),"click_handler_2"),l=c(()=>n.saveToClipboard(),"click_handler_3"),u=c(()=>n.saveInCloud(),"click_handler_4");return r.$$set=d=>{"feature"in d&&t(0,n=d.feature);},[n,i,o,s,a,l,u]}c(AB,"instance$1");const S1=class S1 extends se{constructor(e){super(),le(this,e,AB,SB,re,{feature:0});}};c(S1,"Toolbar_save");let Vg=S1;var kB=Object.defineProperty,Oo=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&kB(e,t,i),i},"__decorateClass$1");const A1=class A1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_drawingService");f(this,"_lobbyService");f(this,"_toastService");f(this,"_cloudService");f(this,"_memberService");f(this,"_imageFinishedService");f(this,"name","Save Image");f(this,"description","Adds an icon to the typo toolbar to save the current image locally, to cloud, as gif or as draw command file");f(this,"tags",[ye.DRAWING]);f(this,"featureId",12);f(this,"_iconComponent");f(this,"_iconClickSubscription");f(this,"_flyoutComponent");f(this,"_flyoutSubscription");f(this,"_customName");f(this,"_saveCommand",this.useCommand(new ti("save",this,"Save Image","Downloads the current image")).withParameters(t=>t.addParam(new zd("File name","The filename of the downloaded image",n=>({name:n}))).run(async(n,i)=>(this._customName=n.name,await this.saveAsPng(),new Pi(i)))));f(this,"_copyHotkey",this.useHotkey(new cn("save","Copy to Clipboard","Copy the current image to the clipboard",this,()=>this.saveToClipboard(),!0,["AltLeft","KeyC"])));}set customName(t){const n=(t==null?void 0:t.replace(/[^a-z0-9]/gi,"_"))??void 0;this._customName=n&&n.length>0?n:void 0;}get customName(){return this._customName}async onActivate(){const t=await this._elementsSetup.complete();this._iconComponent=new st({target:t.toolbar,props:{icon:"file-img-floppy-drive-gif",name:"Save Image",order:2,tooltipAction:this.createTooltip,lockTooltip:"Y"}}),this._iconClickSubscription=this._iconComponent.click$.subscribe(()=>{if(this._flyoutComponent)return;const n={componentType:Vg,props:{feature:this}};this._flyoutComponent=new si({target:t.gameWrapper,props:{componentData:n,areaName:"chat",maxHeight:"600px",maxWidth:"300px",title:"Save Image",iconName:"file-img-floppy-drive-gif"}}),this._flyoutSubscription=this._flyoutComponent.closed$.subscribe(()=>{var i,o;this._logger.info("Destroyed flyout"),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe(),this._flyoutComponent=void 0;});});}async saveInCloud(){const t=await this._toastService.showLoadingToast("Uploading image");this._imageFinishedService.mapToImageState().pipe(Oe(this._memberService.member$),Qo(n=>{throw this._logger.error("Failed to save image",n),t.reject("Unknown error :("),n})).subscribe(async([n,i])=>{if(!n)throw this._logger.error("Failed to get image data, no drawing active?"),t.reject("Failed to get image"),new Error("No drawing active");if(!i)return this._logger.error("Failed to get member, not logged in?"),t.reject("You need to log in to use the cloud"),Tt(!1);this._customName&&(n.name=this._customName),await this._cloudService.uploadToCloud(n,i),t.resolve();});}async saveAsPng(){const t=await this._toastService.showLoadingToast("Downloading image");Hr({blob:Ri(this._drawingService.getCurrentImageData()).pipe(ce(n=>n.blob)),meta:this._drawingService.imageState$.pipe(vt(1)),lobby:this._lobbyService.lobby$.pipe(vt(1))}).pipe(Qo(n=>{throw this._logger.error("Failed to download image",n),t.reject(),n})).subscribe(({blob:n,meta:i,lobby:o})=>{var a;if(!i)throw this._logger.error("Failed to get image meta data, no drawing active?"),t.reject("Failed to get image"),new Error("No drawing active");if(!o)throw this._logger.error("Failed to get lobby, not joined?"),t.reject("failed to get lobby details"),new Error("Not joined in lobby");const s=((a=o.players.find(l=>l.id===i.drawerId))==null?void 0:a.name)??"unknown";fl(n,(this._customName??`skribbl-${i.word.hints}-by-${s}`)+".png"),t.resolve();});}async saveToClipboard(){this._logger.debug("Saving to clipboard");const t=await this._toastService.showLoadingToast("Saving image to clipboard");Hr({blob:Ri(this._drawingService.getCurrentImageData()).pipe(ce(n=>n.blob))}).pipe(Qo(n=>{throw this._logger.error("Failed to copy image",n),t.reject(),n})).subscribe(async({blob:n})=>{try{await wB(n),t.resolve();}catch(i){this._logger.error("Failed to copy image",i),t.reject("Failed to copy image");}});}async saveAsGif(){this._logger.debug("Saving as gif");const t=await this._toastService.showStickyToast("Saving as GIF");Hr({commands:this._drawingService.commands$,lobby:this._lobbyService.lobby$.pipe(vt(1)),state:this._drawingService.imageState$,duration:Ri(this._toastService.showPromptToast("Enter GIF duration","Enter the preferred duration in seconds")).pipe(lt(n=>n.result))}).pipe(vt(1)).subscribe(async({commands:n,lobby:i,state:o,duration:s})=>{var b;const a=parseFloat(s??"")*1e3;if(s===null){t.close();return}if(Number.isNaN(a)){t.resolve("Invalid duration entered");return}if(o===null)throw this._logger.warn("Attempted to gif commands, but state null. In a lobby?"),t.resolve("No drawing active"),new Error("state is null");if(!i)throw this._logger.error("Failed to get lobby, not joined?"),t.resolve("Failed to get lobby details"),new Error("Not joined in lobby");const l=c(y=>{const w="",I="",R=Math.floor(y*10),E=10-R;return `${w.repeat(R)}${I.repeat(E)}`},"progressBar"),u=((b=i.players.find(y=>y.id===o.drawerId))==null?void 0:b.name)??"unknown",d=this._customName??`skribbl-${o.word.hints}-by-${u}`,h=new Blob([wE],{type:"application/javascript"}),m=await new xd(URL.createObjectURL(h),{frameRendered:c((y,w)=>{t.update(`Rendering GIF..   ${l(y/w)} (${Math.floor(y*100/w).toString().padStart(2," ")}%)`);},"frameRendered")}).run("renderGif",n,a);if(m instanceof Error){this._logger.error("Failed to render gif",m),t.resolve("Failed to render GIF: "+m.message);return}t.resolve(`${d} saved as GIF`,3e3),fl(m,`${d}.gif`);});}async saveAsDrawCommands(){this._logger.debug("Saving as draw commands");const t=await this._toastService.showLoadingToast("Downloading commands");Hr({meta:this._drawingService.imageState$.pipe(vt(1)),lobby:this._lobbyService.lobby$.pipe(vt(1)),commands:this._drawingService.commands$.pipe(vt(1))}).pipe(Qo(n=>{throw this._logger.error("Failed to download commands",n),t.reject(),n})).subscribe(({meta:n,lobby:i,commands:o})=>{var l;if(!n)throw this._logger.error("Failed to get image meta data, no drawing active?"),t.reject("Failed to get image"),new Error("No drawing active");if(!i)throw this._logger.error("Failed to get lobby, not joined?"),t.reject("failed to get lobby details"),new Error("Not joined in lobby");const s=JSON.stringify(o),a=((l=i.players.find(u=>u.id===n.drawerId))==null?void 0:l.name)??"unknown";mb(s,(this._customName??`skribbl-${n.word.hints}-by-${a}`)+".skd"),t.resolve();});}onDestroy(){var t,n,i,o;(t=this._iconClickSubscription)==null||t.unsubscribe(),(n=this._iconComponent)==null||n.$destroy(),(i=this._flyoutComponent)==null||i.$destroy(),(o=this._flyoutSubscription)==null||o.unsubscribe();}};c(A1,"ToolbarSaveFeature");let Bi=A1;Oo([D(Me)],Bi.prototype,"_elementsSetup");Oo([D(zt)],Bi.prototype,"_drawingService");Oo([D(ut)],Bi.prototype,"_lobbyService");Oo([D(ft)],Bi.prototype,"_toastService");Oo([D(co)],Bi.prototype,"_cloudService");Oo([D(Sn)],Bi.prototype,"_memberService");Oo([D(lo)],Bi.prototype,"_imageFinishedService");function CB(r){let e,t,n,i,o,s,a;return {c(){e=v("img"),n=C(),i=v("img"),ht(e.src,t="")||_(e,"src",t),_(e,"alt","Exit Lobby"),_(e,"class","lobby-exit lobbyNavIcon exit svelte-yw7ztm"),ht(i.src,o="")||_(i,"src",o),_(i,"alt","Next Lobby"),_(i,"class","lobby-next lobbyNavIcon next svelte-yw7ztm");},m(l,u){k(l,e,u),k(l,n,u),k(l,i,u),s||(a=[F(e,"click",r[5]),oi(r[0].createTooltip(e,{title:"Exit Lobby",lock:"Y"})),F(i,"click",r[6]),oi(r[0].createTooltip(i,{title:"Next Lobby",lock:"Y"}))],s=!0);},p:j,i:j,o:j,d(l){l&&(A(e),A(n),A(i)),s=!1,Je(a);}}}c(CB,"create_else_block");function IB(r){let e,t,n,i;return e=new ke({props:{content:"Exit Lobby",color:"orange"}}),e.$on("click",r[3]),n=new ke({props:{content:"Next Lobby",color:"blue"}}),n.$on("click",r[4]),{c(){V(e.$$.fragment),t=C(),V(n.$$.fragment);},m(o,s){x(e,o,s),k(o,t,s),x(n,o,s),i=!0;},p:j,i(o){i||(T(e.$$.fragment,o),T(n.$$.fragment,o),i=!0);},o(o){M(e.$$.fragment,o),M(n.$$.fragment,o),i=!1;},d(o){o&&A(t),Z(e,o),Z(n,o);}}}c(IB,"create_if_block");function TB(r){let e,t,n,i;const o=[IB,CB],s=[];function a(l,u){return l[1]?0:1}return c(a,"select_block_type"),t=a(r),n=s[t]=o[t](r),{c(){e=v("div"),n.c(),_(e,"class","lobby-navigation svelte-yw7ztm");},m(l,u){k(l,e,u),s[t].m(e,null),i=!0;},p(l,[u]){let d=t;t=a(l),t===d?s[t].p(l,u):(fe(),M(s[d],1,1,()=>{s[d]=null;}),pe(),n=s[t],n?n.p(l,u):(n=s[t]=o[t](l),n.c()),T(n,1),n.m(e,null));},i(l){i||(T(n),i=!0);},o(l){M(n),i=!1;},d(l){l&&A(e),s[t].d();}}}c(TB,"create_fragment");function DB(r,e,t){let n,{feature:i}=e;const o=i.flatButtonsStore;De(r,o,d=>t(1,n=d));const s=c(()=>i.exitLobby(),"click_handler"),a=c(()=>i.nextLobby(),"click_handler_1"),l=c(()=>i.exitLobby(),"click_handler_2"),u=c(()=>i.nextLobby(),"click_handler_3");return r.$$set=d=>{"feature"in d&&t(0,i=d.feature);},[i,n,o,s,a,l,u]}c(DB,"instance");const k1=class k1 extends se{constructor(e){super(),le(this,e,DB,TB,re,{feature:0});}};c(k1,"Lobby_navigation");let Jg=k1;var EB=Object.defineProperty,jE=c((r,e,t,n)=>{for(var i=void 0,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=s(e,t,i)||i);return i&&EB(e,t,i),i},"__decorateClass");const C1=class C1 extends $e{constructor(){super(...arguments);f(this,"_elementsSetup");f(this,"_lobbyService");f(this,"name","Lobby Navigation");f(this,"description","Show a navigation bar in-game to exit or skip the current lobby");f(this,"tags",[ye.SOCIAL]);f(this,"featureId",2);f(this,"_component");f(this,"_overrideLogoExitSetting",this.useSetting(new He("overrideLogoExit",!0,this).withName("Enhanced Logo Exit").withDescription("Exit the lobby instead reloading skribbl when clicking the logo")));f(this,"_useFlatButtonsSetting",this.useSetting(new He("useFlatButtons",!1,this).withName("Text Buttons").withDescription("Use text buttons instead of icons")));f(this,"_nextCommand",this.useCommand(new ti("skip",this,"Skip Lobby","Leave the current lobby and join another")).run(async t=>(this.nextLobby(),new vn(t,"Skipping lobby"))));f(this,"_leaveCommand",this.useCommand(new ti("leave",this,"Left Lobby","Leave the current lobby")).run(async t=>(this.exitLobby(),new vn(t,"Skipped lobby"))));f(this,"_logoClickListener",this.onLogoClick.bind(this));f(this,"_settingChangeSubscription");}async onActivate(){const t=await this._elementsSetup.complete();this._component=new Jg({target:t.gameBar,anchor:t.gameSettings,props:{feature:this}}),this._settingChangeSubscription=this._overrideLogoExitSetting.changes$.subscribe(n=>{n?t.logoIngame.addEventListener("click",this._logoClickListener):t.logoIngame.removeEventListener("click",this._logoClickListener);});}async onDestroy(){var n;(n=this._component)==null||n.$destroy(),(await this._elementsSetup.complete()).logoIngame.removeEventListener("click",this._logoClickListener);}onLogoClick(t){var n;t.stopImmediatePropagation(),t.preventDefault(),(n=this._settingChangeSubscription)==null||n.unsubscribe(),this._settingChangeSubscription=void 0,this.exitLobby();}nextLobby(){this._lobbyService.lobby$.pipe(_t(t=>{t!==null&&this._lobbyService.leaveLobby();}),Se(t=>t===null),vt(1)).subscribe(()=>{this._lobbyService.joinLobby();});}exitLobby(){this._lobbyService.lobby$.pipe(vt(1),Se(t=>t!==null)).subscribe(()=>{this._lobbyService.leaveLobby();});}get flatButtonsStore(){return this._useFlatButtonsSetting.store}};c(C1,"LobbyNavigationFeature");let wu=C1;jE([D(Me)],wu.prototype,"_elementsSetup");jE([D(ut)],wu.prototype,"_lobbyService");const GE=new to(!0);ni.defaultLogLevel="warn";new hu(GE).registerServices({type:Dn,scope:"scoped"},{type:mi,scope:"singleton"},{type:Sn,scope:"singleton"},{type:ut,scope:"singleton"},{type:zt,scope:"singleton"},{type:dn,scope:"singleton"},{type:xn,scope:"singleton"},{type:lo,scope:"singleton"},{type:uu,scope:"singleton"},{type:du,scope:"singleton"},{type:co,scope:"singleton"},{type:ft,scope:"scoped"},{type:yl,scope:"scoped"},{type:br,scope:"singleton"},{type:en,scope:"singleton"},{type:rn,scope:"singleton"},{type:fr,scope:"singleton"},{type:Zd,scope:"singleton"},{type:go,scope:"singleton"},{type:Rr,scope:"singleton"},{type:Dc,scope:"singleton"},{type:ai,scope:"singleton"}).registerSetups(Lc,Me,el,ur,_n,Pc,Ha,Fa,Sd,Tn,Rc,Mc,Er,Vd,ro,wd,ru).registerEventProcessors(aO,rO,IN,cN,AN,$N,KN,sN,hN,LN,EN,WP,QN,ZN,XP,UN,ON,FN,gN,FL,yN).registerFeatures(gr,kl,wu,Bi,Ui,yu,ah,wi,jr,Or,mr,zi,Gr,ao,bo,Fn,Pr,_i,So,wo,dr,hr,_u,Kd,$i,Yi,ul,Cl,Nr,Lr,bi,pr,gi,bu,cl,fo,ll,Il,vi,An,so,cu,pl,Mr,iu,uU,vu,oo,oh,dl,_o,yo,yi);GE.triggerPatchInjection();const MB={"img-arrow-left-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAOttGgAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0MzY4MTg5MjdGN0ExMUVGOUYzNEJFMUNFMjc0Njc1RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0MzY4MTg5MzdGN0ExMUVGOUYzNEJFMUNFMjc0Njc1RSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzNjgxODkwN0Y3QTExRUY5RjM0QkUxQ0UyNzQ2NzVFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQzNjgxODkxN0Y3QTExRUY5RjM0QkUxQ0UyNzQ2NzVFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAApaUj6nL7Q+jnLTai7PevPsPhuJIYsEZlA2KqgoLuwccy3Rd3gHA5jcA7Il0wKLwQywadcwTJKkMNpurX1Q5pTKs1+sv+6J1x+QoLcwqq8nnBGwN7+Jm77idd0SI7/C5vs5X5veHEmhWOOi255XF9ASI1ej4CIknmVgFidmR1OJi5WkzKSMwSlq6qZJ6ytrq+gobKzurUQAAIfkEBRQAAgAsAAAAADAAMAAAApCUj6nL7Q+jnLTai7PevPsPhuJIZkFQPueaLuuLtgYMywJdpzit4wDwKvl+wN3uAiMqjcwJTblkGiNPaFSKUyWt3C4xy6h6x1aea0tOQ4Pnl/r9ZYXRcDK77a7b5Q2x/nrXR1eGZQbh91M4JYGoCOZE53iiIRZIUsXX0mQz88h5k/N5YClaanqKmqq6ytq6UAAAOw==","img-arrow-left-gif"),"img-arrow-right-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAFhY8AAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3RDM1NjE4QTdGN0ExMUVGQUQ1MERCQkMxMEFENzI4NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3RDM1NjE4QjdGN0ExMUVGQUQ1MERCQkMxMEFENzI4NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjdEMzU2MTg4N0Y3QTExRUZBRDUwREJCQzEwQUQ3Mjg1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjdEMzU2MTg5N0Y3QTExRUZBRDUwREJCQzEwQUQ3Mjg1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAApiUj6nL7Q+jnLTai7PevPsPhuJIcsEZlA+KqgsLuwgcywJduyyAp+oO4OFKwKCQNukpUcZmD7KMNp1DR3Q5nT4V12Mxq0VyYeCyOZw70M5ss3j2bcuNaQN5jveexsy8/A3X53cGmEAWN1hneKVUVtXAiJVVCBm5RqXYcRf0ONK3RXTCSSmyZHMDakOqw3Lq+gobKztLW7tRAAAh+QQFFAACACwAAAAAMAAwAAACk5SPqcvtD6OctNqLs968+w+G4kh2QVBC55oy64u2CAzLBl3LON2+ALDL7Ia/H84yTBaXOUlSuSzyVM9dNDpt4K7cLrO5oHnH3azCR05fzbOV+i0Ft0/wN3seqKePLrF+LRdW5VcWKDi4hWXYhwij+ILRSBcHWYIGtAjihlnZM2QjEAQammnJMoqaqrrK2ur6CjtRAAA7","img-arrow-right-gif"),"img-arrow-small-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAKioqAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDNTJFRTk3MDdGNzkxMUVGQjZGNUUxMjE2NTEyMzA0MSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDNTJFRTk3MTdGNzkxMUVGQjZGNUUxMjE2NTEyMzA0MSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM1MkVFOTZFN0Y3OTExRUZCNkY1RTEyMTY1MTIzMDQxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM1MkVFOTZGN0Y3OTExRUZCNkY1RTEyMTY1MTIzMDQxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAApaUj6nL7Q+jnLTai7PevPsPhuJIYsEZlA2KqgoLuwccy3Rd3gHA5jcA7Il0wKLwQywadcwTJKkMNpurX1Q5pTKs1+sv+6J1x+QoLcwqq8nnBGwN7+Jm77idd0SI7/C5vs5X5veHEmhWOOi255XF9ASI1ej4CIknmVgFidmR1OJi5WkzKSMwSlq6qZJ6ytrq+gobKzurUQAAIfkEBRQAAgAsAAAAADAAMAAAApCUj6nL7Q+jnLTai7PevPsPhuJIZkFQPueaLuuLtgYMywJdpzit4wDwKvl+wN3uAiMqjcwJTblkGiNPaFSKUyWt3C4xy6h6x1aea0tOQ4Pnl/r9ZYXRcDK77a7b5Q2x/nrXR1eGZQbh91M4JYGoCOZE53iiIRZIUsXX0mQz88h5k/N5YClaanqKmqq6ytq6UAAAOw==","img-arrow-small-gif"),"img-award-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEAAD/zv/QAP///wAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxOTNBRDQwRkVBNDAxMUVGOUEzMUMwREIwREMxNDhGRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxOTNBRDQxMEVBNDAxMUVGOUEzMUMwREIwREMxNDhGRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjE5M0FENDBERUE0MDExRUY5QTMxQzBEQjBEQzE0OEZGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjE5M0FENDBFRUE0MDExRUY5QTMxQzBEQjBEQzE0OEZGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA/9Iutz+MMpJq7046827/9sgjkNIjtV5NqijrtILEyojzw8p7LW8nDseCaILCm+oolEwzI2WR1IgIDsaW6xnNDqYTl9MJdamRXa932p5rFgPuGd0GigMsmmielgql6useyVkb25xfX10eYGDhG+Bh2gikWt2IoN6I5BefHN6e5dMlYaInFSKoUegV5KaKpunq4JtsEd+ZyMAmZ1QY1qxk5K4uqaOS720e68qALmsxJ7HjorDwrjNcZSpP9PSutYizHxF3JbbeeSs1szXypXa5o2it+qcbu+z5+jKA9fY9p9ZGhWr56rdHlEu8g0kOOwZoDt4usHxZ2icGyfdBJYi9cRFF0R7SRoCAyOECLoWG4ndAJhQIZYTIyPeiICE0bxys2RCxBeyZQ2TO+HJwtiEJs4YR40mBcG0qdOnUKNKnUq1qtWrExIAACH5BAkUAAQALAAAAAAwADAAAAP/SLrc/jDKSau9OOvNux4gyIWhRZ4DhpLTii5s48YPKgivcsLnje+1kM+3WxF6Q6LIQUoqZzbnrcQEPa2/U2B1HTyr3mxTPAiYkWQslae2CrXmc3PcTjHo4XQ5Hnc9szJ1XXyEW1FTXjRHbYOFhFyIYmxhWGKOl2hua3RXl30gn5U4iHaLeUMhnnKpq1Kbok+qKKGuS6a1e5ggAKCtTq+nsaGrALy5Qr+2yEmshqkhxb3OuGxKpKso0dLIlcCUmqDQxrvjtD+kpXjfe+LkzXikgevXzgPF2tuCgHfd6+zt77jVkfdNWD0SfJb1K6VDoL9QzeqR+iJvIr1VjxQOBGMNSp2sZVnicYyELldGdRSrdFxRiMuYfSPfpICDbYbIIIlywAECxRbOHA1d8JsJJEIRhkGL4jThE4IiD1CjSp1KtarVq1izat3KlUECADs=","img-award-gif"),"img-challenge-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAOttGsfHxwAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0Mjc2QjBFQUVBNDAxMUVGODUzQTk0OUFGQ0MwRjE0NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0Mjc2QjBFQkVBNDAxMUVGODUzQTk0OUFGQ0MwRjE0NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQyNzZCMEU4RUE0MDExRUY4NTNBOTQ5QUZDQzBGMTQ1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQyNzZCMEU5RUE0MDExRUY4NTNBOTQ5QUZDQzBGMTQ1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLRaJ7KQuuvqfU9IQmRnnl5zBoGIZe78hkk7w6xM5+tA6rl0DI2QpuIdiYvO0Rd81jYjo68XEipRVeUUa4UKxKnwd2iejtEZTtroQZq5Eac8Lr5T3XM8e/23x+dl96cnOJFVqHZ4YZCUF4hogcMo6XjjV2iDmbkVxtl5oPkZKrpZOvbTiQqIt0I3CCVmlTSJ8PGaamlbhAPaGggQO/qbChwCoMykwkbbmqEszayxnBUI5OQhbX1bPQ29p8I93Nb0DS6z+pjMzYSL3r1eHN/dJUBuSo9PLt/VX86cJ3f8/PmKBpBYtoIdCAqEh9CaQwUN29nzVDAgw4cq+0hMhOiwmkJ2IhpeLBbyxA5BKjKlo6KvTkyV+zCNLCGK0rucPHv69FkAACH5BAkUAAMALAAAAAAwADAAAAL/nI+py+0Po5y02oup2FzMDnpPGEZkuZzoqHbJGcQxZ26yvA7gfdMQx8OBdMCgUMQSGI+75WxTUzoDpCkV+iteg01hz5eUXsVj25fsymqL3fIZq0ZXmbxh1PzsvOtpSbur94b0EQiolQdX0UInmEEUwsg0iAGJyAfm+CgWKJl50MSJOJkBenjiaSh36liqamZ30Sr46tLHQFOIV8bZ0qAyNgssCovwK7xLK9UBAGBrsLgGgyzAzIz5zGFduaupvFzdnIhNDd4K1wIeLq6Z3ltM0n79+V1NkgISLz+/ka6+vk+unDOA/erpo5dvHcJwAsUh5GcQ08KHDiFqs+jvHcYQMBcnZeu4EcxHkKsInmg4ryEUewpO0RMJERaxFzKz9VERS2GObqM8dbvX0+c4oUILAAA7","img-challenge-gif"),"img-chart-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIFAFhY8APBAB8fHwAAAP///wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmViYzgzMDYyNywgMjAyNS8wMi8xNy0yMDo0MTozOCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGNDdEQTYwOEE1MUMxMUYwOEI5NjgzMUQzMDk4MUQ4MyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGNDdEQTYwOUE1MUMxMUYwOEI5NjgzMUQzMDk4MUQ4MyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkY0N0RBNjA2QTUxQzExRjA4Qjk2ODMxRDMwOTgxRDgzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY0N0RBNjA3QTUxQzExRjA4Qjk2ODMxRDMwOTgxRDgzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABQAsAAAAADAAMAAAA/9Yutz+MMpJax046837sIonjt5FnieFruO0EXAszzS9uVit7/MtZTKBkEeMZXCDmHBYJB5/OdhS0HRikMpllfeMAKXMLWAMkHUhX8JyXCWzjVdoEixwv2tuW9wbVQvtdzF2NWcPaVoEgIKDhHtofYgwgIw6hQ6HYYuUO5YNmFRbnI6GkJmhBAFwH3JZoKeoqTCdDJ+vsLEEswu1pwG+uLohpa5Vv7i5o568W789ybTLMc0002bPu9G3vjPV1quPc3TSxtPGldfC4X6g5Nrtjd+k6kvvMOTHevGXfevm3P7n9CmbJ6Tbq2Bp1tnKx6qVqYPoCiScQswWQn4UM2rUqKo14bqNIDN25BMlpEmKI8HNmcLDpDeB2PgtzIdOw0xRuljoLKFyp08kPlGAGEq0qNGjSJMySAAAIfkECRQABQAsAAAAADAAMAAAA/9Yutz+MMpJqx046807toonjl1FnugwcUTrvvB7Rmxs3/FGa3jvExoI70fMZYSZog8AMKoewxZG6WIyYUdoUjpVWq3Yj7YLJC+/TSdyIMNce2hc1rHlDuIwvFxMN2fQaQSAP3MNdWVsgoB6PYUMh4eKjD6OC5BmVDaVIX6YmWFPfYl2n3uhhp2jpaBrbaqrLpsFl6+wiK2xnrCytLasY64uAcPEwzfEv6KuxczIMMXJqKoZzcbOwtCuuHbZL9XX2sC5tc/VN7ypP8yNfNLBvuPbiPDx4qT0t/aI5KXooyknoj0iA5CEQEsEC4o4yIkfvSD68I07NdChLx1jFppKsUMSocd2oj4CNMERhMmTKFOqNJkAADs=","img-chart-gif"),"img-cloud-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAP/uANzc3AAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkYyRDc4OTIzMjMzQTExRUY4RjE5RjQ0M0VDNEJFOUNCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkYyRDc4OTI0MjMzQTExRUY4RjE5RjQ0M0VDNEJFOUNCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjJENzg5MjEyMzNBMTFFRjhGMTlGNDQzRUM0QkU5Q0IiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjJENzg5MjIyMzNBMTFFRjhGMTlGNDQzRUM0QkU5Q0IiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQJFAADACwAAAAAMAAwAAAC/5yPqcvtr4ScAtpFs977Ig6GlGeIJkhKwcq27ttm0AbXtuycZz09+q9a9XJAHWvYmNiWMcpRQgwymU4hNFIUWaXIQ3ZXDXRLX214PNBMYWox9+oNs6lV5TZhX0qfz2B+/Ldn5RLo91bxcfiyl+emcgZHJtA02dRHqASJGFe5ZcL2WIgnaLQYejja6SkA0Ooqt+XYCUgq4Xr7augYe5eoSoHbagugZifqKztMzLo8nLEL7ZiazAwM3FxpjIpsKDzhfftrOBuZVpsb7E3JO4JMGay8vA6N1ugY/u0tnj2OpbqFr1otfgT9YcqH69kleuXM7QOykIPBZKvqaCOIw509XjqW2GnAIAhUyHntGGwUqadflDUn+2Q0OdIUnY8+Yq5xWTIKh5vUNs0oE4KEQ6A0hSYRYTSp0qVMjRYAACH5BAUUAAMALAAAAAAwADAAAAL/nI+py+0Po5y0KoGz3rzb0YUiZ43mKHXByrbuu2rRSQuv/NQ6FmPQrusJFiGY8cYREoEbWDKQuTBNLI0SMT1VM9dD8+gUCW1QH5YLhqatZV47wS6HXW7huGtA2+nkvR8dddbn19NS9+cW6HXYZlint8emmMfYRoVkI2m2ODg2EpYJuEnJuAFwihq3FZo4CgLZhiqbWsqjOSTYZzoLgHGaJEo2+Wq72yvwm5HMFYxHzKp87Cu9XCzcisvZOR3N2+t4HQ4HO+0te9j8lsuHPNtOCx7pSsx+Xi4d34gjiEn7rtpsGCl29/zpCTjv2aodq+wIVGjJ061wErOtU0VIXrh9NevkYFqDjaM2kJ0+ipRSCQnJDTlgzQET4kfKNJhYyswiogJOFBR2xvzA4ATQoUSLGj2KFEEBADs=","img-cloud-gif"),"img-coin-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAMWMCvHKBQAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxRjcxOTIzOTA0QjMxMUYwQTJDOEI0NTRDREE1NEVEMiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxRjcxOTIzQTA0QjMxMUYwQTJDOEI0NTRDREE1NEVEMiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFGNzE5MjM3MDRCMzExRjBBMkM4QjQ1NENEQTU0RUQyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFGNzE5MjM4MDRCMzExRjBBMkM4QjQ1NENEQTU0RUQyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLTai7PenIkPhl+XiOYZcui6ZuwXxHLAVicNz7puTuYOnIFiIskvGBQRUxAl8BWSMR3RHdQpHVGrvGtOCNp+u0NyOatdYM3J9VTBtcbZ6DD8/FzXwe8DPn/EV2dXMoZ0g4RTVGiYGAgIQOj3l6jYWBeZNilQCcjZ9pEpcHepN4cpSvppxuIpAJCqKgflKjoq6/o4+NpncGq56hgCa6t2qldLLImg+8tKXGw8RzkLYru8iVxpAnvSgNK5NKy86LEizA1dLs3rlQ4d/W197dUdet10bw8F35KvL6ofQHI9IpwIqA5gDSPuGtpo+EIFRGwkKlq8iDFjxgIAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLTai7NuovcteeJIfmCJpualdkErWmhA1/aNUvPN92NY6uE8vN9jJ6yJfJ7jKFlcRleMJxQ2FTikSRhR2eS4oC/vmGZUfK9rMLccVp+7bdubtKgz9fSYXEAG99YXh8CXdWiXZjjHZkVIdZC4l1iS1xhIImT5BzjkSbnZAVAoqTfoBqo4WmraqPmpmkoaafCY+gW7KgBAq9WJ6YXo+5ugi4uENkJ8eSsYFOvhWwWtjInI2Qw7+cy6aKwS2M3b+82IFU1S7ic2SmzmHs9OLf3u1Uv7HrG8roKPn2Mfv3z/fBW0V0ygiHUH6wHEU8HfQ28BZcBTceIiRBAL5zBy/AgypEiOBQAAOw==","img-coin-gif"),"img-connection-loading-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAAO+AHOJ2gAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4NDZCOUY0MUVBMTYxMUVGQjM4MzhFQjY5NUE1QUM2MCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4NDZCOUY0MkVBMTYxMUVGQjM4MzhFQjY5NUE1QUM2MCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg0NkI5RjNGRUExNjExRUZCMzgzOEVCNjk1QTVBQzYwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg0NkI5RjQwRUExNjExRUZCMzgzOEVCNjk1QTVBQzYwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAtGcj6nL7Q+jnLTai7MWvPvvaQhIliFmpiqVBu4LvysExvYdg3SNk3jweXxgqpLttPAQi8WlgNGRkYRG6VMRdQVZPCAHy7FeL7wOWKA1H5jfROnsbQ/YunV9dKeb7HI8svvzFvE39JNzx5VlGKiW6NQkVqGoN9k4GJbWl6Qk5Rg3RoXplbg1M5elGXrCxIckQchqgEhW+DhmiaLICCoii2li1esHidtLmSqydYZszHsmfOkKrSo9vTll7VDpnI132N2wDQ4lOL5cbN7Knc7e7k5RAAAh+QQJFAADACwAAAAAMAAwAAAC2pyPqcvtD6OctNqLs958iA+GosiN5jle6MqCERvE8jy3zkjnum425h47AQOkhYjWEuZCilAtCX0KEiAZCrJ6Uj/WIkVJnB6qQdcYiviF09zw5wxlsr0errwe7xlScLl6eLX3NmeGM4Sk51PohPgnNShBVhbVZfbS5nZHKFkW2UanyAn5cFLBuHbpZdOnSWqJtwr7anHEY9lKy2k7WiJaO9kh+IkyKdaRB6rB15S8McvMGyw9TW26XG1Uip0tAOD9vA3iPR4d/jH+bbw9R15unri+6R7fHG9/n1AAACH5BAkUAAMALAAAAAAwADAAAALbnI+py+0Po5y02ouzFrz772kISJYhZqYqlQbuC78rBMb2HYN0jZN48Hl8YKqS7bTwEIvFpYDRkZGERulTEXUFWTwgB8uxXi+8DligNR+Y30Tp7G0P2Lp1fXSnm+xyPLL78xbxN/STc8eVZRiolujUJFahqDfZOBiW1pekJOUYN0aF6ZW4NTOXpRl6wsSHJEHIaoBI9gFge7t1CorScev7aykiy2Frgpu6wVaMnEwp7ObqxywyPbz7DJWLvTO7vTnl7dC7fB2OB1xubn2crr6nnq0Nf1Y9b3+PX1EAACH5BAkUAAMALAAAAAAwADAAAALcnI+py+0Po5y02ouz3nyID4aiyI3mOV7oyoIRG8TyPLfOSOe6bjbmHjsBA6SFiNYS5kKKUC0JfQoSIBkKsnpSP9YiRUmcHqpB1xiK+IXT3PDnDGWyvR6uvB7vGVJwuQkAGCgIeLX3Nmc2Mrg4ePLgF7KIwkiH9SGYh3lnKRCotyXSKMZJuOkT6Tn6+CmBCnDIeWfTZ3pjZphEC6viKgpbW9FLedvRq5iquoG6UrqrnAeMwddUWeJMfd2hvc0tPd3NUAhudNk8Tt6peY4tus5u7o5Y7c4aT2uPn69QAAAh+QQJFAADACwAAAAAMAAwAAAC0ZyPqcvtD6OctNqLsxa8++9pCEiWIWamKpUC7gu/KwTG9h2DdI2TOPB5fGCqku208BCLxaWA0ZGRhEbpUxF1BVk8IAfLsV4vvA5YoDUfmN9E6extD9i6dX10p5vscjyy+/MW8Tf0k3PHlWUYqJbo1CRWoag32TgYltaXpCTlGDdGhemVuDUzl6UZesLEhyRByGqASFb4OGaJosgIKiKLaWLV6weJ20uZKrJ1hmzMeyZ86QqtKj29OWXtUOmcjXfY3bANDiU4vlxs3sqdzt7uTlEAACH5BAkUAAMALAAAAAAwADAAAALUnI+py+0Po5y02ouz3nyID4aiyI3mOV7oyoIRC8TyPLfOSOe6bjbmHjsBAaSFiNYS5kKKUC0JfQoSIBkKsnpSP9YiRUmcHqpB1xiK+IXT3PDnDGWyvR6uvB7vGVJwuXp4tfc2Z4YzhKTnU+iE+Cc1KEFWFtVl9tLmdkcoWRbZRqfICflwUsG4dull06dJaom3CvtqccRj2UrLaTtaIlo72SH4iTIp1pEHqsHXlLwxy8wbLD1NbbpcbVSKnS1QuQ2N+L3VrSU+523OiiuemM7qDh9/UAAAOw==","img-connection-loading-gif"),"img-connection-open-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAP9VAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpERjRERTc2MkVBMTgxMUVGQjU3Q0FDQzFCMzQ0OUJBMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpERjRERTc2M0VBMTgxMUVGQjU3Q0FDQzFCMzQ0OUJBMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkRGNERFNzYwRUExODExRUZCNTdDQUNDMUIzNDQ5QkEwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkRGNERFNzYxRUExODExRUZCNTdDQUNDMUIzNDQ5QkEwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAtGUj6nL7Q+jnLTai7MOvPvvaQhIliFmpiqVAu4LvysExvYdg3SNkzjweXxgqpLttPAQi8VlgNGRkYRG6VMRdQVZPCAHy7FeL7wOOKA1H5jfROnsbQvYunV9dKeb7HI8svvzFvE39JNzx5VlGKiW6NQkVqGoN9k4GJbWl6Qk5Rg3RoXplbg1M5elGXrCxIckQchqgEhW+DhmiaLICCoii2li1esHidtLmSqydYZszHsmfOkKrSo9vTll7VDpnI132N2wDQ4lOL5cbN7Knc7e7k5RAAAh+QQJFAACACwAAAAAMAAwAAAC1JSPqcvtD6OctNqLs95chA+GosiN5jle6MqCEQvE8jy3zkjnum425h47AQGkhYjWEuZCilAtCX0GEiAZCrJ6Uj/WIkVJnB6qQdcYiviF09zw5wxlsr0errwe7xlScLl6eLX3NmeGM4Sk51PohPgnNShBVhbVZfbS5nZHKFkW2UanyAn5cFLBuHbpZdOnSWqJtwr7anHEY9lKy2k7WiJaO9kh+IkyKdaRB6rB15S8McvMGyw9TW26XG1Uip0dULkNjfi91a0lPudtzoornpjO6g4ff1AAADs=","img-connection-open-gif"),"img-connection-paused-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAAO+AAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmViYzgzMDYyNywgMjAyNS8wMi8xNy0yMDo0MTozOCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowRTE5RTA5NDI4MTUxMUYwOENGOEIxMjc0Q0U3MERBQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowRTE5RTA5NTI4MTUxMUYwOENGOEIxMjc0Q0U3MERBQSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBFMTlFMDkyMjgxNTExRjA4Q0Y4QjEyNzRDRTcwREFBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjBFMTlFMDkzMjgxNTExRjA4Q0Y4QjEyNzRDRTcwREFBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAuyUj6nL7Q+jnLTai7MOvPvvaQhIliFmpiqVAu4LvysExvYdg3SNkzjweXxgqpLttPAQi8VlgNGRkYRG6VMRdQVZPCAHy7FeL7wOOKA1H5jfROnsbQvYunV9dKeb7HI8svvzFvE39JNzx5VlGKiW6NQkVqGoN9k4GJbWl6Qk5Rg3RoXplbg1M5elGXrCxIckQchqgEhW+DhmiaLICCoii2li1esHidtLmSqydYZszHsmfOnqKydNi6gzKyk4bRbF/Cpq6f00voG2hJd2qp5RCfpLfv4dfS0fz94+W16eXL0fNk8YNmXQNqmpVtBCAQAh+QQJFAACACwAAAAAMAAwAAAC8pSPqcvtD6OctNqLs95chA+GosiN5jle6MqCEQvE8jy3zkjnum425h47AQGkhYjWEuZCilAtCX0GEiAZCrJ6Uj/WIkVJnB6qQdcYiviF09zw5wxlsr0errwe7xlScLl6eLX3NmeGM4Sk51PohPgnNShBVhbVZfbS5nZHKFkW2UanyAn5cFLBuHbpZdOnSWqJtwr7anHEY9lKy2k7WiJaO9kh+IkyKdaRB6rB15S8McvMG5xrjCd9Q9JsuizsYhf9VXrWOayM+UpOjqE7ih7QqY75Ljjujgpf78ZGL68SPr+WLkMiYQCzgXuWYpu1TdwWaigAADs=","img-connection-paused-gif"),"img-connection-secure-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAAO+AAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzRFMzQ0MUYwNjIxMUVGQUJFMEU4QThEMDQ1NzY3MiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzRFMzQ0MkYwNjIxMUVGQUJFMEU4QThEMDQ1NzY3MiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBDNEUzNDNGRjA2MjExRUZBQkUwRThBOEQwNDU3NjcyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjBDNEUzNDQwRjA2MjExRUZBQkUwRThBOEQwNDU3NjcyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAuiUj6nL7Q+jnLTai7MOvPvvaQhIliFmpiqVAu4LvysExvYdg3SNkzjweXxgqpLttPAQi8VlgNGRkYRG6VMRdQVZPCAHy7FeL7wOOKA1H5jfROnsbQvYunV9dKeb7HI8svvzFvE39JNzx5VlGKiW6NQkVqGoN9k4GJbWl6Qk5Rg3RoXplbg1M5elGXrCxIckQchqgEhW+DhmiaLICCoii2li1esHidtLmSqydYbcKsl75jDr7NqgxHyJqMl5raoMixaXCx5+WkVOe+iLVlvsSV6Z+Tydp0stTm1tn6E8rC9c7e8fFYEEDRQAACH5BAkUAAIALAAAAAAwADAAAALtlI+py+0Po5y02ouz3lyED4aiyI3mOV7oyoIRC8TyPLfOSOe6bjbmHjsBAaSFiNYS5kKKUC0JfQYSIBkKsnpSP9YiRUmcHqpB1xiK+IXT3PDnDGWyvR6uvB7vGVJwuXp4tfc2Z4YzhKTnU+iE+Cc1KEFWFtVl9tLmdkcoWRbZRqfICflwUsG4dull06dJaom3CvtqccRj2UrLaTtaIlo72SH4iTIp1pEHqsHXlNz3xcsMzWocjDVc7RlglZEY2oURKDwHrIJ5SyIpnYoonDlMbYrZiVdMzm0+mK6duRF+yt8LVLhjuISpw6YIIbYCADs=","img-connection-secure-gif"),"img-connection-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAAO+AAAAAP///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmI3YzY0Y2NmOSwgMjAyNC8wNy8xNi0xMjozOTowNCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI2LjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjFDRkVGNDhGOUI2OTExRUY5NDQyRkJFMDQyMEQwNkJEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjFDRkVGNDkwOUI2OTExRUY5NDQyRkJFMDQyMEQwNkJEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MUNGRUY0OEQ5QjY5MTFFRjk0NDJGQkUwNDIwRDA2QkQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MUNGRUY0OEU5QjY5MTFFRjk0NDJGQkUwNDIwRDA2QkQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQJFAACACwAAAAAMAAwAAAC0ZSPqcvtD6OctNqLsw68++9pCEiWIWamKpUC7gu/KwTG9h2DdI2TOPB5fGCqku208BCLxWWA0ZGRhEbpUxF1BVk8IAfLsV4vvA44oDUfmN9E6extC9i6dX10p5vscjyy+/MW8Tf0k3PHlWUYqJbo1CRWoag32TgYltaXpCTlGDdGhemVuDUzl6UZesLEhyRByGqASFb4OGaJosgIKiKLaWLV6weJ20uZKrJ1hmzMeyZ86QqtKj29OWXtUOmcjXfY3bANDiU4vlxs3sqdzt7uTlEAACH5BAkUAAIALAAAAAAwADAAAALUlI+py+0Po5y02ouz3lyED4aiyI3mOV7oyoIRC8TyPLfOSOe6bjbmHjsBAaSFiNYS5kKKUC0JfQYSIBkKsnpSP9YiRUmcHqpB1xiK+IXT3PDnDGWyvR6uvB7vGVJwuXp4tfc2Z4YzhKTnU+iE+Cc1KEFWFtVl9tLmdkcoWRbZRqfICflwUsG4dull06dJaom3CvtqccRj2UrLaTtaIlo72SH4iTIp1pEHqsHXlLwxy8wbLD1NbbpcbVSKnR1QuQ2N+L3VrSU+523OiiuemM7qDh9/UAAAOw==","img-connection-gif"),"img-crosshair-gif":c(()=>"data:text/plain;base64,R0lGODlhGAAYAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU1NzZBRjAwMjAwOTExRUY4NzMzQzE2Njk3MUU1MDg5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU1NzZBRjAxMjAwOTExRUY4NzMzQzE2Njk3MUU1MDg5Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTU3NkFFRkUyMDA5MTFFRjg3MzNDMTY2OTcxRTUwODkiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTU3NkFFRkYyMDA5MTFFRjg3MzNDMTY2OTcxRTUwODkiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQJFAABACwAAAAAGAAYAAACSoyPAZDtuJ6Ei01Xc71667kZ0RFilniiT6mkremOVCOj7pvUrY7v3Q8MCjOkGHFGMdJ4OuZthyw+jz3biiijXoUXqbYrBV/F5EYBACH5BAUUAAEALAAAAAAYABgAAAJHjI+pu8CvgINU0ifzvEb7DX2OVlndlmHmiaTNGsAx2NKyfMBkXYv+PvsJbSAgK6KjzRjJBC63uimhqaiLOeScPlpeF/kNGwoAOw==","img-crosshair-gif"),"img-disabled-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAP8AAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1NjgwRDQ5NUVBNDAxMUVGQTBFQkNDQjM1MjgyM0Q0MSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1NjgwRDQ5NkVBNDAxMUVGQTBFQkNDQjM1MjgyM0Q0MSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjU2ODBENDkzRUE0MDExRUZBMEVCQ0NCMzUyODIzRDQxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU2ODBENDk0RUE0MDExRUZBMEVCQ0NCMzUyODIzRDQxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAtCUj6nL7Q+jnLTai7PevPcABlIobiQInSGmrk1LUvC5zHEEAwB9tHqbUul+PN8Q6DgNlzTh8nh7hZ7MGbWKSiqvuSvRJd1SnVzewzieepFnNDawNuPc3qfqQq/v5Bay/m4iFhel4ZdGmGF4WMKhWJZVKPgHlkjyaIdYIQkFh0kps7mn9oa32cUJOWF6iso4Z/mWxxc2+rWy+knb2VqiOFtTK0rpm6sgCIhg+JsshswMK5yqy2asRD293GPjGuSMLT3iPf0BTutxjp6uvs7eXlEAACH5BAUUAAIALAAAAAAwADAAAALJlI+py+0Po5y02ouz3rzzAIZSGGwkCZ0lpqJMu1qwm8zxZNNCDlIwAFAZWsCgzvEr8gJFoyhCbDqj0mNDJVVSmyfcKQskgac9r3gMGpNlXzVYyG67tVbzeQ7PbN/dDxbd1/HH9yQ4mBVossdVFxcyR3ZzceiW55iGiMlYWEEZdkdX5iO3CRppZxr5WCqJ5GmTyemamkPY+nIoRBqKyvRJs/srOrtquWNqfMVTI9fSm7x0mYiQw+KsnHyZMu2xPdwNHi4+Tl5uvlAAADs=","img-disabled-gif"),"img-discord-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAP///wAAAFhY8AAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5MjE5RThCOUNGNzAxMUVGQjk4REFDREU2MTE2NkRDNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5MjE5RThCQUNGNzAxMUVGQjk4REFDREU2MTE2NkRDNCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkyMTlFOEI3Q0Y3MDExRUZCOThEQUNERTYxMTY2REM0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjkyMTlFOEI4Q0Y3MDExRUZCOThEQUNERTYxMTY2REM0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAvOcj6nL7Q+jnLTai7PevNsAhmIgjWFpjk9qrqzovjAjz0ut0qLA87YS6gkFrRtoSMSZkL4T8IhULplJUmJHzWqZTkRwCwb/sOEytzv4ClPb6XAM7b20rLct3gwA9gB1NLRHVgVi4FfFF4i3BoJoOOOoh5hIxSip+HhZyWcoF9kYYEeYlunZp7ioyemkWpc1F1p42krnhhoLenZqlnu768s7ivs7XNVLPLyqy1m2nCyMqusq2Gk1PRj9t1wc/EwtVQvLTfk9Ii0qnvvd1gW+7aBddMCWZ/X+JWNUg4Kj8zLBHyMHBRYeCho8iDChwoUMGzo0UAAAIfkECRQAAwAsAAAAADAAMAAAAuycj6nL7Q+jnLTai7PevNcAhiIIjWZkpk6qNiy7vG0cCvZtyyLOi8zOy+mAQUHoVysSg0nlMbEsSqfOgKJJzWp9h6j2y3wOvCaw18iNvqisMGmMFQHmWPfIbliG5nwQO8AHUJcWBxgoGPB36IdDmNgIEljXY0jHeONIGYl4WVUG+TbZlpWCB/eoOTl1hmZ1igoWW5WnKiv7xGprFlqr+4Xb60v6duokjDZLC4vZudvc6lpstyxVqglFDT1knYqdrb39LBTddRZ+Z4rwCVoi3oqkJ+ayPS8jQQ//MmGPwuXxDzCgwIEECxo8iBBgAQA7","img-discord-gif"),"img-dna-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEAFhY8LcA/////wAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2RTI0REI4QUVBNDAxMUVGQkM5RDk4M0VEMjc0MzVDOSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2RTI0REI4QkVBNDAxMUVGQkM5RDk4M0VEMjc0MzVDOSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjZFMjREQjg4RUE0MDExRUZCQzlEOTgzRUQyNzQzNUM5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZFMjREQjg5RUE0MDExRUZCQzlEOTgzRUQyNzQzNUM5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA/9Iutz+MMoJh72Wao173mDjjUNojkEaYCboqfDVbphas/NUr2SZ6xeeRdD5AS2pi2BZNFaQSSWx6WTsosMpbiGbXYVZD3cbCto6S61s1DJjMekeoFuGgtFMD2D/qQ/OPnhqA3t8Pn6AgXgYhXOHR190PYSNfU89gFYklZYik3ZCBHKNjo+aHZx/iSOkhp0Keq1um62uprCMtaUxF7qFVGO9pb8dvBa6Yg6MeiTGqcmex5/Fq5OXrnk4V9NH2HHas2wclN7ZinZ0daRS5riqoW3HtgPfa+iv45Qj9dTwJ9P8QKXzYw+OuXf+4lkStG1gFVFwIjl82CzRw0sS8V2E6OYezkZlHT1+jAZD5MhTxjR+vAHs5CloLkGSiUmzpokEACH5BAkUAAQALAAAAAAwADAAAAP/SLrc/jDKCYe9NOvLuf5OJ2IgOAZo4JVbl74kS3Hpha6yRKtjnFc23kAg+k2CQgGxYwRaYBbl0tdU7IQXJbO6QGKzUwvX+rz1tCtcCdmLhkcyNqaDbg9YcjGB/h4AAFQZV2kcdX5/gQ9tNTF0HH+AehF2A1AkbZCJZJSVZpyHiJIMmKFlnnaQkaKbj6mlnaetrqp3o7KztJa4rmp7jx2vgxe7mVStn6ZCxEVdw7SfjBbFPQ3HblsusZQh0qVSW76mn06pYG+s0cw63c/fhLBCa8Mj7nPJmut29dmeeEwi+7zgy1crHBgRL+KNAfjGUkEuAK/0G9Osh0OK1filw5jRHgsWjraSxQJZMeGXhxwlqiPJiSQ3ai5fgotJs2aGBAA7","img-dna-gif"),"img-drop-pink-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEAPaD8oUAmeAA5AAAAP///wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAzIDc5Ljk2OTBhODdmYywgMjAyNS8wMy8wNi0yMDo1MDoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI2LjEwIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowRjdCNTI0RjkzMzMxMUYwOTNCNzgyN0VGRTUzRkMwMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowRjdCNTI1MDkzMzMxMUYwOTNCNzgyN0VGRTUzRkMwMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBGN0I1MjREOTMzMzExRjA5M0I3ODI3RUZFNTNGQzAzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjBGN0I1MjRFOTMzMzExRjA5M0I3ODI3RUZFNTNGQzAzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA9VIutz+MMpJq6Vj3G1z5mDkaWHJjGZKjKTKsa17wbGMwXZH5xVd8w7fBwgZCVjEB0tw9CSDHmbT+VQsmcjqKiqd/ngsAECaTY7EYjKVGEar1+CzG4tie9Dp9zDXntPhMnJ+el8lfWNdf3suh4mENoJ5jmUqkY5ddYx3g4kBlIaWlwKemSahogGki6AZeKJMqaWsAwKSqKqFG0avXbGAIbu8sLiaGcLDxJVcwqnJKcGvzc6mIwG30rLA1dLc3NnaHt3in7Pb3TuBQuq54Ovk6e6rQO5aVQkAIfkECRQABAAsAAAAADAAMAAAA+lIutz+MMq5xqA4O2u1p1z3jU8okqjJoal6sZ97wpk801MomDhmCrtQL8cBBldDyA+oSpaKxuPNSdBFm1SFCQC4CrNVDpfrRVJD466Rd0aTo9JX0v0uT2l0NZw9zMOZXz1bY39xcnhihIVxfYl1f3wwg49wAZEtjnp/loEsk4tAnGaemaACAaJ3GpOam6mHI36mqKmSpbOonbFFlIW0ujFQpka/o7sWw8TFqjXCw7S1pMjJ0NGYA8mny8w+zovVl8EhAd/gwB4qqJXVr7DHFuzxWLbj8bkugi7m+I02Nm3+5gH0B+aJwA8JAAA7","img-drop-pink-gif"),"img-drop-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEAIPQ9gBImQCf5AAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBMTg4MjFEREQ2QTExMUVGQkYxM0RDOEQyMUQ1RUI5RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBMTg4MjFERUQ2QTExMUVGQkYxM0RDOEQyMUQ1RUI5RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkExODgyMURCRDZBMTExRUZCRjEzREM4RDIxRDVFQjlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkExODgyMURDRDZBMTExRUZCRjEzREM4RDIxRDVFQjlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA9VIutz+MMpJq6Vj3G1z5mDkaWHJjGZKjKTKsa17wbGMwXZH5xVd8w7fBwgZCVjEB0tw9CSDHmbT+VQsmcjqKiqd/ngsAECaTY7EYjKVGEar1+CzG4tie9Dp9zDXntPhMnJ+el8lfWNdf3suh4mENoJ5jmUqkY5ddYx3g4kBlIaWlwKemSahogGki6AZeKJMqaWsAwKSqKqFG0avXbGAIbu8sLiaGcLDxJVcwqnJKcGvzc6mIwG30rLA1dLc3NnaHt3in7Pb3TuBQuq54Ovk6e6rQO5aVQkAIfkECRQABAAsAAAAADAAMAAAA+lIutz+MMq5xqA4O2u1p1z3jU8okqjJoal6sZ97wpk801MomDhmCrtQL8cBBldDyA+oSpaKxuPNSdBFm1SFCQC4CrNVDpfrRVJD466Rd0aTo9JX0v0uT2l0NZw9zMOZXz1bY39xcnhihIVxfYl1f3wwg49wAZEtjnp/loEsk4tAnGaemaACAaJ3GpOam6mHI36mqKmSpbOonbFFlIW0ujFQpka/o7sWw8TFqjXCw7S1pMjJ0NGYA8mny8w+zovVl8EhAd/gwB4qqJXVr7DHFuzxWLbj8bkugi7m+I02Nm3+5gH0B+aJwA8JAAA7","img-drop-gif"),"img-enabled-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAAPBAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4NTYyQ0QxNEVBNDAxMUVGODE5MENDQzhERUY5MUFDNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4NTYyQ0QxNUVBNDAxMUVGODE5MENDQzhERUY5MUFDNCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg1NjJDRDEyRUE0MDExRUY4MTkwQ0NDOERFRjkxQUM0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg1NjJDRDEzRUE0MDExRUY4MTkwQ0NDOERFRjkxQUM0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAsOUj6nL7Q+jnLTai7PeJgSueR5oiSM5mSIaqSvruCbMuMBMIzJwv7lg4/FwOZVQSGQFj8MTzMg8+kDLaPODglqRzkZyUbV+E65YmDlVyLBg7TZNXrN1Zyn8IO923OL73nSlVxc4pyZiNzXY4/cX0HcyWGbm8TjCxzVmeBiVV6lXA8i55lk4SYm2g6pCcZaKmfkQJitZchlKWFox6/j6eaG4yFh7qyr8a7tK4xqcS5Ka/NPoCB0tTV0NRIutud3t/Q0OUwAAIfkEBRQAAgAsAAAAADAAMAAAArWUj6nL7Q+jnLTai7PevPsdhMFXiSMpmSf6qCHruC+8yCKduICKGyoA3N1wv6BwyNIZjyuScmlKFqFR59Tois0iTypSkYV0vducrHUllw+2tVm0DJ7BOh4dHme6fVc725Sn1/SGB+QnkCZ3eBcSZzdmuMiYx5MoOFhTqJYYJgZIKeMo2QAZ+Yk1qnWKqnl5Ubo6h1G62UFr+gViKesx1okSKtjTVjVM3IPQhpy5t+z8DB0tzVIAADs=","img-enabled-gif"),"img-floppy-drive-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEAMfHx1hY8P///wAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NkI2MzAwMkVBNDAxMUVGODY3MUExN0FEMjIzM0NGQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NkI2MzAwM0VBNDAxMUVGODY3MUExN0FEMjIzM0NGQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk2QjYzMDAwRUE0MDExRUY4NjcxQTE3QUQyMjMzQ0ZCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjk2QjYzMDAxRUE0MDExRUY4NjcxQTE3QUQyMjMzQ0ZCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA/9Iutz+MMpJq724js27/2CmgGRJYmaqXmpbWl0QdEBt1xzOzZ+2ybzN7ZYDxIIdyk5GG+oGzwEQOVD+mEVn8YhNSpZI5zMqBfYi4KYWSp5Sv9eweOhxvyHp7Lxt9z7yLh92XVV/cVSBZX0ceIeJdYNBjYqEgZFdk5eam1OMhpScoW6eDmCip5ifqKuSqqOPh50bmbKwpqmljraQhLSVu4p+DaYdAsbHyMnGvMIMxBvK0cpczQvPA8kf0tSkw7rYyyrH3LOuXeHi6MHdzt/qJuOAhbmUHOrx9sjk89710NIABezzFSQgwIHmkOgjkU0ewWL4tC2MU22EPHACGUZcV44h3hUP+AIeOfMJWCA0Jl1YSWkCBTARMGPKnEmzps2bExIAACH5BAkUAAQALAAAAAAwADAAAAP/SLrc/jDKSWsdOOvNs4VdKGpfM55iqaAsV2pBoAF0DWR0FncWLOO2HEY42LkumNhvGLwxdcrjBLpsCmtUI2ma1Fqd2K5y6ZFQZ81nNrqNnIFfp3hMxrjF6LiPrrWD8HlWe3xkd0V9LYeEhX+KdSyLfYZjiWt0bQ6WkZuEmCZznKGXZQ+aoqGeDKanm6kLmpWRriuglRt8swRZthyjfqVzvL1sv5nBGQLJysvMAoO5uxjN08zRxZ+OyNTb1gOTxMki093fWuEtzsfXqurnLOnZpMbxA9Ti5I2U0tv26t754PiN81duSbMQy/ABo5dQnDKF8/TVe+jQncR/CyU21DZQJtEGQ104CqQY8mMjhCNJpjgprAWFlolUwAyhoqbNmzhz6tzJk0ICADs=","img-floppy-drive-gif"),"img-fullscreen-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAOttGgAAAP///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkM1QTUyQUNFMkU2NTExRUZBRjM2QTJBMTI1RDA0M0U3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkM1QTUyQUNGMkU2NTExRUZBRjM2QTJBMTI1RDA0M0U3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzVBNTJBQ0MyRTY1MTFFRkFGMzZBMkExMjVEMDQzRTciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzVBNTJBQ0QyRTY1MTFFRkFGMzZBMkExMjVEMDQzRTciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQJFAACACwAAAAAMAAwAAACrZSPqcvtD6OctNqLs9ah+y154ggq44kG5ZG23+qOACCuQjvneQ17+q/j9TrAn9AmKu5eNkNSeUT6oEzpFBgtyZbLTvP2pD2znHDMeo2ptNtZDVWpgq9uJinuZYXreX0/xNMmJue0RhETRIaB2PUH4pLo+DhFd9e0FynJFkBFuMmJpThJFOr52ak5Ctr5NbeK+oVZJHohO3hyqQaXq9vql+K7kBpMXGx8jJysfFwAACH5BAUUAAIALAAAAAAwADAAAAKzlI+py+0Po5y02otr2DxbDoIeFJbduJggwJ7ooW7sDLivSuc2aua0+DKsfLrdKET8bYIIZLK2ZMKGPqBUyEkag85q9EqFBmbbY5a8KnvCsQD43Gozu+Kolce23idfLLzuduNCFzInQri31qakdrGI1ujYw9gnKANVFCl56aW5qZVoOdZZachJGXglEJaZajr6FKp4Cuoq+hTnyUebayIF16a7G1z66quqoIK8zNzs/AwNXQAAOw==","img-fullscreen-gif"),"img-grid_cur-png":c(()=>"data:text/plain;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABoUlEQVRYhe1ZSQ7DIAy0q/z/y+6hSkSJtzEgUqlzqhpsxisOYRGhIjxBriqNcIDrs9YJLSKNEL6RZf7m1EXLIj0UmVe0wNTMd93afx2iCIURzHq4nOiWjtY4pI4yHg5TAZHV5AF9qofrbUP3FKrPLdjewzNC70LzZjUllpMFIGTwMYsOyStPZuBgIlLSgxuF148K2dkQESaFcLkP74JKeDCMS2F6+KmkW8K3xN1F2spfou+iu9Z7yqyCzBhX6CI3AS0l9reID1QeVg5DpKve9ZZbD7y2tsPTHO0b9eGlpLvIpPaKCJsz7AKkWtLU8XICzr33jpeFyJg8pkxrlSkt0VlSB4dYBFbDMCB1cGxB1kn/aW013HuJlvTqvM46qCd8jnVDm6DGZQuOCL8MhAkUX0yh4Wf3eFkbfoo5G05bo7LlPqyENUUUyVcNqw4OxMtQRA5KdgURecQFi9kltNA94TA5iMyrfyYiCT4LnDBd30ZmhsEsc9yGfsuIZE1k25qndCSxYdlXIxT1Qe3ZiCElQ8+iywqjm0xvK48Z4LP4uXn4DcalnWAUAAtmAAAAAElFTkSuQmCC","img-grid_cur-png"),"img-inspect-gif":c(()=>"data:text/plain;base64,R0lGODlhGAAYAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkQzNDgxODNEMjAwQTExRUZBMTU5RjY2MzMwMzJGQzMyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkQzNDgxODNFMjAwQTExRUZBMTU5RjY2MzMwMzJGQzMyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDM0ODE4M0IyMDBBMTFFRkExNTlGNjYzMzAzMkZDMzIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDM0ODE4M0MyMDBBMTFFRkExNTlGNjYzMzAzMkZDMzIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQJFAABACwAAAAAGAAYAAACO4yPqcvtCWJ8S1p6rJ70Zu5IFTgCjcig5WmG7fiQkIyo653ahj5rO9/bAGsoX2x4pGE8GKJy+YQ2p9MCACH5BAUUAAEALAAAAAAYABgAAAI7jI+py+0PE5gURFOzhfnU9ykTOC6UUzKpuakt+yInGnsrLN55F4SNpiGVeMLLzijRXXzInnJZa0qniwIAOw==","img-inspect-gif"),"img-letter-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDANHR0f///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBODk3REMxNEVBNDAxMUVGQkY3MTk3NTg3RjJGQjU0MCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBODk3REMxNUVBNDAxMUVGQkY3MTk3NTg3RjJGQjU0MCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE4OTdEQzEyRUE0MDExRUZCRjcxOTc1ODdGMkZCNTQwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE4OTdEQzEzRUE0MDExRUZCRjcxOTc1ODdGMkZCNTQwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAuCcj6nL7Q+jnLTai7PevPsPhiInlOaJpuoZre4LN/BMs4oa5PrO9726SPmGxJ8tgSsqjUfEagkNAG8lACpaPFlLwSpgW8L6tOCu4Pu9inOoNJd6RoPD2DbaZJa7T1D7/Y3kpTcnoESmhwc3+Gcy5IcI6CS4qLbzCCmQt8hIx3ZIGXlgsrnHt0KaGBgHWjMplyq5ill1ermn+fr4OTcIK+qaQto7mpupyCkrXCzoa0DMq7wZXKZoGz171jxweq28YrbbLZ0C7iqO2qTauo4iw/6u/QvfOlJvf4+fr7/P349fAAAh+QQJFAADACwAAAAAMAAwAAAC3pyPqcvtD6OctNqLs968+w+G4iaU5ommagqt7gs38EyfDBrk+s73fo664X7EIkuhKip5q8VquXQ5SwDACUpEWU1TQXVrwjJPXy6SWr6KA9q0oPutqrFtNzwOFtDJeHPChCc391MX54cAGJin51PYV3KnOLTj+Ph25qUoGKajogkWGZjEtqJ5eJAoSrMoCYmpSla6iWbo+kc7i+vIV3t5m+mG+xlsGVo5PNt7l4L8yXtqAHjcHJwJPSBL7Rxri8isjdyEmQo+rCJUky6Ort7uy+5OMzJPX29/j5+vv39fAAA7","img-letter-gif"),"img-light-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDALCwsP/zFwAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQ0M1MEExMzdFQkIxMUVGQTY5MEFENjlFQzhBNkEwNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQ0M1MEExNDdFQkIxMUVGQTY5MEFENjlFQzhBNkEwNCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkFDQzUwQTExN0VCQjExRUZBNjkwQUQ2OUVDOEE2QTA0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkFDQzUwQTEyN0VCQjExRUZBNjkwQUQ2OUVDOEE2QTA0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAuGcj6nL7Q+jnLTai5XYvOfZheHniOZIIufqpSwXxLFInvKNo5iJ9zK9C/mGAWBFSCTqKJ2ks3WEOZVQkPR2TVYlTaxIy7Egi6vhNjJmmcPRa7fbO0OQcLLAt+S+N15+XF5C5zeT9QPI8GXXN7goYCX0cpeT9xCZOEkZaAl2iLgBYIO50iYAADpm90JaavpluSEWYnr62ukpMlsLG8tBy+pr4tLrm2skPNwx65uSkFz8a8v7+dzKxnyQPH0KfK3Sq/3s2I09PVxtPZ5dnsks+2k8PvAar6FKX39y38Cu3++fUgAAIfkECRQAAwAsAAAAADAAMAAAAtqcj6nL7Q+jnLTai5HYvIsseaIHMuNJlge6BQGqDqdLu6cq1jo9lvkOFIE6wKKtkyEajUiMcllsWp7QnbRCrdauFOpoyQ1xeLMo5/JEFWXn6fg4flvDkbRg2wrSHx44PK8j1NXHcje3Z1L4E5gyoZhF1lj3aKgnCUHJ1OOoWDOAJ8jZ+fLo1gGAShkqNoIKoPphyvG64UpbmORxK+B6E6ObWmt7mStyO4woezob3BbDZiy8+6zRKkyMM3va60wNzXu8u+G9sly76q1KnlC6zs7ivgATT19vf69QAAA7","img-light-gif"),"img-line-dash-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDQUEyMURDRUVBNDAxMUVGQUY1OUJGRjA1QTVDMTI0RiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDQUEyMURDRkVBNDAxMUVGQUY1OUJGRjA1QTVDMTI0RiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkNBQTIxRENDRUE0MDExRUZBRjU5QkZGMDVBNUMxMjRGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkNBQTIxRENERUE0MDExRUZBRjU5QkZGMDVBNUMxMjRGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAAnaMj6nL7Q+jnLTai7PeF/jvcRNIfuJTpqeTkoi5Gi14uPFb1vadhPrOa6iCLCBxkTsKaUqGsfnzQXHMaaBlvWKzQ+7TKs2Ke2Fw0nyebtVd9vfYdlfRMHEcupbP9XXtW9M20wcIJDi4EWZ4GKNYppQ3Fik5GVMAACH5BAUUAAEALAAAAAAwADAAAAJ9jI+py+0Po5y02ouz3hr4z03fSIYOiYJICmBsur7Xi8ayRatH3prQ7XuwgpIa8Tc6RkrKE7O5MEIVsGmiarXpsgYpt5v8XnvZrTjg/WK5Q/Xa+i4/3eFzml2358V3+X5pJtLWAERBQ8XjUsjjkbGY2JEGudFIOHiGmakJVQAAOw==","img-line-dash-gif"),"img-line-dot-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFMEQzNjJCNEVBNDAxMUVGQjI4NzhCNURBRkFBOERFNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFMEQzNjJCNUVBNDAxMUVGQjI4NzhCNURBRkFBOERFNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkUwRDM2MkIyRUE0MDExRUZCMjg3OEI1REFGQUE4REU3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkUwRDM2MkIzRUE0MDExRUZCMjg3OEI1REFGQUE4REU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAAmuMj6nL7Q+jnLQigIHdKmcOBh4WcqNWWme6jd3HMvDlxtKJ2hCuR3y/8wCHxKLxWDsmfsoDsylaQQ1SopBGKlanW2i3+QXPpmTqlfwUh7Vp5Ro5Lsvnvrg3ycXfz+i4Xs0HaAf35xZIh2hRAAAh+QQFFAABACwAAAAAMAAwAAACeYyPqcvtD6OctNobgda4hw16FxgmpWiSHKKiKamogMvC70l/2yLnk+2T7ILEogNn5AGTtyGzuXrWllIDleZUzoit6kG29YK93y65R7Yiz9G0u9xmr59o+ZxZt4fd8fd0rwdYVXeH1ZXngzZWBLRo1OY4aKbnV2lJUwAAOw==","img-line-dot-gif"),"img-line-grid-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGMkJCQkRFQkVBNDAxMUVGQTY2REY3QUMwRDE1RjA4MCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGMkJCQkRFQ0VBNDAxMUVGQTY2REY3QUMwRDE1RjA4MCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkYyQkJCREU5RUE0MDExRUZBNjZERjdBQzBEMTVGMDgwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkYyQkJCREVBRUE0MDExRUZBNjZERjdBQzBEMTVGMDgwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAApmMj6nL7Q+jnLTai7PevPsAhMBHiSIpmSEaqaNzfi4cezOjWrexK3nlCtZ8Jp3wOPyVkEzhpQlFTqJUJbDafFqxK2Nx8Qtieghrx1z+ytQJMgfNg2vk7mkWLIdUiewl16n1R9UiOHhVKHbYFccVuMh3NNeXNnQ2eZA3dsn4aFlJ+UKSt5lRx4liCvK5kUpauprGIjtLW2tLUQAAIfkEBRQAAQAsAAAAADAAMAAAApGMj6nL7Q+jnLTai7PevHsDhMBHiSIpmaFzfurKqK7c0N1bmyQe69gLtAWEpaDxSGQhl8Yi89maQKeWKXPDWyQ1WcU28x2GL+Eup+zzmBHjKjp6+64rVFD6Z0WS83o3P4j3N+ckeHZndxQHl9DmB6N1aLjIFok1Sfk4k+l1abnJ2MkVKvYZB1GKkqq6ytrqSlIAADs=","img-line-grid-gif"),"img-line-mandala-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowMzhFRjAwRUVBNDExMUVGODQ1QkY0RTQ2NkVDODhEMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowMzhFRjAwRkVBNDExMUVGODQ1QkY0RTQ2NkVDODhEMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAzOEVGMDBDRUE0MTExRUY4NDVCRjRFNDY2RUM4OEQzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAzOEVGMDBERUE0MTExRUY4NDVCRjRFNDY2RUM4OEQzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAAqmMj6nL7Q+jnLTai7PevPs/ASJIiSYpmScKqWPkcnHjzpqN1Lq85vp/6xl+REDGVjQGasHXEnfYYVRR6kJqQQoVzIvWSduGhFZHuXQ+M9SpspbLbqWt6ric3JuL7+CnU69UAfXk82f3cFiVtwfDWBg42NYHtzg5ZtflF+gViZPItwX1CZqUMIqYVHdqlrqp6DpVtLZ6aTmUyTIbmftqy6v4Gyw8TFxsPFwAACH5BAUUAAEALAAAAAAwADAAAAKrjI+py+0Po5y02ouz3hd4jnkiaIkjSZkfOqkAK7lwrD5uHZrNzXf6wgv6ToigsPQ79Iq4SjNwYzxbSeg0cYU8s0wi1ctVVmlgr3Qc2ZqBaG21jV2nk81V154q28fh3ZtYB2fD9yIGKOjQJ2OAmIgYKDcXaUU36dYWxWh5iae52Md5uEhZqGE0Sgpyatb4dXRXyvEat4kUywY6Q1o7k6nryKsb/EtcbHyMTFIAADs=","img-line-mandala-gif"),"img-line-noise-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxOTdCQjFGNEVBNDExMUVGQTJDNThFNzA5RjhGRjYwMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxOTdCQjFGNUVBNDExMUVGQTJDNThFNzA5RjhGRjYwMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjE5N0JCMUYyRUE0MTExRUZBMkM1OEU3MDlGOEZGNjAxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjE5N0JCMUYzRUE0MTExRUZBMkM1OEU3MDlGOEZGNjAxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAAnqMj6nL7Q+jnLTai7OGoINdeWIHPuNJlgnKfmrQsmosvzDt2WusN2cPDO6EnBEj1asdRMHWMtd0Mok3HtVAu2JxV662ivpmu1aiceuinr9PKBuNfK/l7jcYURdOwWm9ex4VBwgUB1coNqj1Y8d3SJaotmgH+choeZlRAAAh+QQFFAABACwAAAAAMAAwAAACeIyPqcvtD6OctNqLs94cgv91EkiColGmaoitrqu9chnP62mfjar3vmjq0RhDYGpxxN0OPJ0s0BTaWD9orsp8YRPPLULrRYG3V+wxWUVbAV51WBx8Z0nyb7GOprbjUTMb3rcH89YVVkg4KLdUt0bHCPj3KDlJWXlSAAA7","img-line-noise-gif"),"img-line-parallel-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyQTM1MzU2NUVBNDExMUVGOTNCMkM3OTdGMTIzRDE3OCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyQTM1MzU2NkVBNDExMUVGOTNCMkM3OTdGMTIzRDE3OCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjJBMzUzNTYzRUE0MTExRUY5M0IyQzc5N0YxMjNEMTc4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjJBMzUzNTY0RUE0MTExRUY5M0IyQzc5N0YxMjNEMTc4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAApGMj6nL7Q+jnLTai7PeFvgPcBNIfqJTpuaZqK7HHq8bM3NYP2oOpbxeOu0WQc6tRRLdcLKk8YgobpZRZ4zWBPGGBunV6/1qs+OajwzbWgNhVrgtXMOV8rW5zJ4/V2jmHX/2x9cV6IaXV0h3CDVlh4jVePiYiDH3ojhYRXmxqekX6fjTF6oGKUrIdTqqytrqGlEAACH5BAUUAAEALAAAAAAwADAAAAKWjI+py+0Po5y02ouzBLz7rznfSAKhUqbeiagum7gpLMomXc94PmZkVLq8eKuK7fGj2G6MoPLYSD5l0Z5GVS2GdCjtidsC0ZwxL0sa7uzIB+vY3Ra/4QH6mW7/otEwfn6L9+cTKDdnxqdXWAcGaLbIdqVowBjp+Gg5iIlYqbYgKETZiYO1k7VZOgmJmia52sXkGis7W1EAADs=","img-line-parallel-gif"),"img-line-pressure-ink-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIFAKSkpEFBQWtra4mJiQAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmViYzgzMDYyNywgMjAyNS8wMi8xNy0yMDo0MTozOCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2RjdERTg5NkE3OTExMUYwQTQxMkNERTM5NDlCQ0MzNiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2RjdERTg5N0E3OTExMUYwQTQxMkNERTM5NDlCQ0MzNiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjZGN0RFODk0QTc5MTExRjBBNDEyQ0RFMzk0OUJDQzM2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZGN0RFODk1QTc5MTExRjBBNDEyQ0RFMzk0OUJDQzM2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABQAsAAAAADAAMAAAA41Yutz+MMpJq7046827/2AojhRgniY5oeypPm38NjE63Pes1ADu67ST7wdkmIbE4gKJUzaYOSeDKX0Oq1MkdnndFnCC8MD7DZvJBXMYrV572wIynK2m19/zd2AfiOv5e2SAgV6DhFiGfFuJh06DBJCRVXyRlZVKe5aakjoBm59Fn5pOopxYo2ipqqusGgkAIfkEBRQABQAsAAAAADAAMAAAA5BYutz+MMpJq7046827/2B4ASQgZmVKnpTqspH7wo873PhA12We7xCADweEDIlFx1GXVB6bziG08ZwultarNFvAcnGCsIDbHYjFZPN5/F2Hye53Ni630tl2cWC/n4f5gH6AgXaDhFOGg1mGBI2OiHyOko1QkZOSiJeXUJqbTZ2TU6CUXJ1kmmQFnqePqa6vGgkAOw==","img-line-pressure-ink-gif"),"img-line-rainbow-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEAFzJO/rlTNs0JAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNkZFM0Q1NkVBNDExMUVGOTE5MTk1RkQ2OEM3N0IzRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNkZFM0Q1N0VBNDExMUVGOTE5MTk1RkQ2OEM3N0IzRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM2RkUzRDU0RUE0MTExRUY5MTkxOTVGRDY4Qzc3QjNEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM2RkUzRDU1RUE0MTExRUY5MTkxOTVGRDY4Qzc3QjNEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA/RIutz+MMpJq7046827t0MojuT3kGgamoTqpt8rzHQ9i51q7za+pbwgzYcBCo9EEOlYCzifziQFxRRAr9GVcnTEegPSCJX3/Y4qS3LZrJ2kbesAYE6nhx1vWrnOr98bXHBefYRzfwt5VliFfDBigXpXjAAvbSciglCFlWePIZlOhJwlEJCRoX2jhwqmik+pjhqYTZqNpByttX63uLMzuna8vQOgtp0xn6eowatFyb/AKCymwJTHyM+ucruW2JnG3R6+0NvM4TnZruAsiOmv5gPsrOPvhtcm1MvWzRmmItznxKm6h28gv34G48lbyLChw4cQHyQAACH5BAUUAAQALAAAAAAwADAAAAP/SLrc/jDKSau9OOvNu49DOBBiaZafcq4surVwq8WiYN+4YGJx7v+iy+pHJAYrp6LSd5wkl7eAdBrANUEmJXXLlV4fT193vP06sjmymmpmhG1rKmBOp7cX6Ki6zuffSSViY32EdiFYIYJchYwAd3lwXY0sjodgNTiSfTQ7lwOKU5ucnQ2BmXKio4+YeqF+pGcusYmnUqmWHqaRroayHboCW6+4H8DCvSMpKrStAcPJyqy7znW+xczT1X8v2MG2yNDR3byVxOKftdrmKcbfc9bs0uTbHO3U5eHKgNi88PH832Dps/fO378SUwbgyzdQFcNznPRBiCjRE4uKGDNqhJAAADs=","img-line-rainbow-gif"),"img-line-random-color-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEANs0JPrlTFzJOwAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0NjM4NUIzMkVFRDAxMUVGOTZGRDlDODk1MDYzQ0JDRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0NjM4NUIzM0VFRDAxMUVGOTZGRDlDODk1MDYzQ0JDRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2Mzg1QjMwRUVEMDExRUY5NkZEOUM4OTUwNjNDQkNEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ2Mzg1QjMxRUVEMDExRUY5NkZEOUM4OTUwNjNDQkNEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA/9Iutz+MMpJq704683f+F34jUO4kaR5oaw6sR8Auw4M3PdM23gvoy6Wb5gDcoTDEbGVQfpIxJ+R4kwql8xX9XnlZiOwbtSrk4Sh4yJKIBhRR4FAOApjs93aT1x+xoXtdyB5e4RndYCBJYOEhYYDiIB4ZnpxcI1riCN2kmCUfAOMlSSZo22Ck6CiqXyqj6Sapoqoe5a1sJG3nBCWoby3uK6xb6uMvh+QyLoevKGXyJDKNbbEzs/Aw6nM1aWvFdPNn4nHwLKzvZ6wmJvR0p606OPc4uWd2sbBySkWLI3v+K+n9vE7928ePYEoCAIMeCJhNYM7HJYqE9GRPhoMLLLD6AgOY54pHvOEHEmypMkJCQAAIfkEBRQABAAsAAAAADAAMAAAA/9Iutz+MMpJq704683f+EMngqSIkehnVmm7Ri0guy+TyjjQhmuc/7uODwf66VKbG7BoDFqUTWYUSRkuP1OaZIc1ermgKnjgJbYE6PAEFGhzczu0XKDeftru8XmeVq3veHh6H3xzdTCAgXlxhXyHEGyKgXuNhn52AwEkkpoklY6XiJmbnCCVnnShkHekkqaNqI8eiYqRr4WxqrOZpYC3oANysg62icXBn5Y8mJ3GvoTJwrrErJGu0NGpy6LNvNfI2qfTDdacgtiowGLe5ovS2H3D5OXn1eDp2vI2KLVsv7glnvCrNwqeMn2iWtUDGDBJin7g8iEUOLDZu4kZHnbTUoMVwCCMI8Z0/MNx5KqGJlOqXMmyZYcEADs=","img-line-random-color-gif"),"img-line-sculpt-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAcHBwAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0NDNFODk1QUVBNDExMUVGQkY1NkVDQ0I5QjNDMjEzRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0NDNFODk1QkVBNDExMUVGQkY1NkVDQ0I5QjNDMjEzRSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ0M0U4OTU4RUE0MTExRUZCRjU2RUNDQjlCM0MyMTNFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ0M0U4OTU5RUE0MTExRUZCRjU2RUNDQjlCM0MyMTNFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAAnWMj6nL7Q+jnLTai7PeFXiOeSJoiSNJmScaqSYLuS/MyDOt2B+e63zv+x10O6GBCDAOkcojselEymhSG6xqJWGz2u2t6y2Cwt8NeWU+izXqdabtvsCT4zb4jFKz9HsyNYzj97fFA/izNgW1VKYYENcIGSkJUgAAIfkEBRQAAQAsAAAAADAAMAAAAnKMj6nL7Q+jnLTaizMFXGveeRcIihZZmhvKqg8Luw3cyguN2gqe6wdP8v2AKR+xqDuGjEqhoekMKGmuKdVkjdmySBUXkORuxbIvuGpGf73ms6jt9sDVZGyavaZny3m+lfknNBXFUEO4E3R4s6TY6Pj4WAAAOw==","img-line-sculpt-gif"),"img-line-tilt-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAIABAAcHBwAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1NDE5Njg4Q0VBNDExMUVGOUVCQTlDOTNBNkFGREFBNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1NDE5Njg4REVBNDExMUVGOUVCQTlDOTNBNkFGREFBNCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjU0MTk2ODhBRUE0MTExRUY5RUJBOUM5M0E2QUZEQUE0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU0MTk2ODhCRUE0MTExRUY5RUJBOUM5M0E2QUZEQUE0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAQAsAAAAADAAMAAAApyMj6nL7Q+jnLTai7PevPsPhuJIlubZAADKqG6qiu67zGtLS/at2Pis2/1iNSFkx0MYe0tH84Ac5mDAoo/5xFa1U2iWm0x8kWFr17sVf7nUcyB6vIKlxIecbXbPpfRy3v+WprSmJoimRzh4p1hXaPhHFxm3aLCWePhoSfnnB+fY6DQm+sgHaRqxGUiaShUKWsgSKztLW2t7i5srUgAAIfkEBRQAAQAsAAAAADAAMAAAAqOMj6nL7Q+jnLTai7PevPsPhuIIlGNUpueTmowbtnDSxjKwyOCNK/c7Q/18tVxRqCMeaUsHr8dsGoYQnlE6TbKsUSx1q0V8xeHGU+kdA8tZdkB9Tbvf864KfbdDnVzyHI4X1Jant7fG1qeHJMdIaAYHCFh4KEiHFVdp6XggqYhpyHn5SUkJ+rg5mNlpV9o6gRqaqSm7oll7i5uru8vb6/sLPFEAADs=","img-line-tilt-gif"),"img-lock-restricted-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAA//M2lqagAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NDM5RDdBN0VBNDExMUVGQkNEMkJFRkVFMDBCNjUxMiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2NDM5RDdBOEVBNDExMUVGQkNEMkJFRkVFMDBCNjUxMiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY0MzlEN0E1RUE0MTExRUZCQ0QyQkVGRUUwMEI2NTEyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY0MzlEN0E2RUE0MTExRUZCQ0QyQkVGRUUwMEI2NTEyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLRCgbOwVvuPcQ5IfqJSptp5fMELx7B5evJ9r3UWp7Le4c1Ugl6IoxkSi6+MKNkEDkDRYwUqTWCdQUx10xAGuFfvd2QeWyliMqO9nsDB4bRbbo+j8nQ2/zGH9Fc3WMbkQWiWBbjUiBjhGHmXKNl44YKTiUODJqa5uTW55/mpZKOmN8pUapQBEMi42grqCvC6KqqVZiqLKmALXEj4g+kLbAvb2fp7W6Rx3Iybqitbi+xxfFp1WY2R/RwMpcRN7H3NfL67HZtjjR7du67cbh5O2sodb5yufxbbX6LUIlUAi9HKRU3dMoEDF5BglYlTvkopulAk8eTiIxYGHDt6dFAAACH5BAkUAAMALAAAAAAwADAAAAL/nI+py+0Po5y0PoGztlx7z0nfmIUOiWLmMgbu634r8sH2C86a7d3buoOReKVQEJdCFi0ZYaoZW1KOAdmgFlUxodUfLeidYpRaxVE64YbN42yn3S2z4GgRXT4XKN969+kuwLf31xcnGIf3BVUX8eQ4IvYoycgwaZnYgHWzuWl1QcXpA7ZWyRUq2oMY+Al36qRJytYax6kBcAu4SkhkmiVwi1sYm2Da4vsLXIxJnBus5wEMcEapqBT9cU01XE2WjBEtDbp90GuLC576qps5iwge3uvb2O7uHC8PAXqc3kmtWMiLX79lzO4dc5WDlUFX6tYppIeQRJpLkrZQhATkor8ZBhw7ejRQAAA7","img-lock-restricted-gif"),"img-lock-unrestricted-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAP8ABGlqagAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3QUVGRjNGRUVBNDExMUVGOTlCRkY0Q0RFODg0NTY1NCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3QUVGRjNGRkVBNDExMUVGOTlCRkY0Q0RFODg0NTY1NCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjdBRUZGM0ZDRUE0MTExRUY5OUJGRjRDREU4ODQ1NjU0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjdBRUZGM0ZERUE0MTExRUY5OUJGRjRDREU4ODQ1NjU0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLRCgbOwVvuPcQ5IfqJSptp5fMELx7B5evJ9r3UWp7Le4c1Ugl6IoxkSi6+MKNkEDkDRYwUqTWCdQV5Wi1EiS6NwdQx6CAPc7rTNWMNZEbmVXjez7/iyft4Xt8WntmToIXGoCCi4qHjhgiOJQ+OnVwWFeYlYuKYpRGJEiOJZBQBAcorKJNZJmaHqEXu5t+H6ijEroMt6dpujEau62uvrNyk7TFxcC8ksujucKeo8WRutK8kI9owpfDpt3FCqhA0LXrqNQH7Na06r3pJ+vkxvN8pdfJ6UfG9r2SvUJzOVAEKjdY0VJ2c2rCFbyNBRii4SSTypCDGQxo0DJwoAACH5BAkUAAMALAAAAAAwADAAAAL+nI+py+0Po5y0PoGztlx7z0nfmIUOiWLmMgbu634r8sH2C86a7d3buoOReKVQEJdCFi0ZYaoZW1KOAdmgFlUxgzkaVzp5Mo5gEeqEUXY2v3E6u9Ze5ax3lT6DQO+CfNhe5lcHFaj3dGhlhrhYOMjI+Ed1M0nUhraXZZep2XUpUEnWooTnWAkA0KRxSmXppsl3iuoRu/o5amjrhBGryovZOjjZK0sryYdLOeyLmYmcvFtszNd38apLK2vdXJ1rWrvcvX0pDJ0tEN0NHOxtnrF8ixvuvjMbSlqqa98Dz/2KtZlOnYJ/WZ4FbDRwHyWDieI9OrTlIQkdEgUKuojRRAEAOw==","img-lock-unrestricted-gif"),"img-mask-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAOMAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowODlFQjYwRkUyODMxMUVGOEJGMTlBRTFDMzk3ODVCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowODlFQjYxMEUyODMxMUVGOEJGMTlBRTFDMzk3ODVCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA4OUVCNjBERTI4MzExRUY4QkYxOUFFMUMzOTc4NUI3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA4OUVCNjBFRTI4MzExRUY4QkYxOUFFMUMzOTc4NUI3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAs6Uj6nL7Q+jnLTai7PevPsPhuJIlk8QIKiZoKvgpiwcG7FL3q/O12ffswGDjCFQaOSpkkcaCsCMAqE4ZwCAzWqpzK2XK7t9v8Ox9naImb289dlnfbrnZvTStdXVxXl7XI7VQ9b2VoWkFjiVZVT4cshmiLcYKZloh9iYBgimuWm5UznpGAqHmWk1qNdI2Aca+mkKGysaNgvmSft6ykfHS8d5eDWn+gv3Jzwm2Gt8/Irmm8scHDVNvSA1iu3YYF3dRKGkYDRDXm5+jp6uvs5SAAAh+QQJFAACACwAAAAAMAAwAAACxZSPqcvtD6OctNqLs968+w+G4kgGZkAyp3CuqdHGcinXtgnd+r4nPA/4zVjCU1AGOBaXxqQtCY1KlcCp82bNPrPTFrHF7cbC0hhsTIaC01fvucmOl81vk3g9R95xB7R626aXh9KH9weItUf4ZTdYd1gYoOVmeEiI5/I16VIZ+Bjop8hopWMZujdKWjMIp4giyCrnennKVas6BIh7G2XjszrbuEv3m1hlSrywVFf00Bz5I8GjPI2RTF3zor3N3e39DR4u3lAAADs=","img-mask-gif"),"img-nochallenge-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAFhY8MfHxwAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5Rjk2NjhBN0VBNDExMUVGOTY4MUQwQjkyNDQ4NUU3MSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5Rjk2NjhBOEVBNDExMUVGOTY4MUQwQjkyNDQ4NUU3MSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjlGOTY2OEE1RUE0MTExRUY5NjgxRDBCOTI0NDg1RTcxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjlGOTY2OEE2RUE0MTExRUY5NjgxRDBCOTI0NDg1RTcxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLRaJ7KQuuvqfU9IQmRnnl5zBoGIZe78hkk7w6xM5+tA6rl0DI2QpuIdiYvO0Rd81jYjo68XEipRVeUUa4UKxKnwd2iejtEZTtroQZq5Eac8Lr5T3XM8e/23x+dl96cnOJFVqHZ4YZCUF4hogcMo6XjjV2iDmbkVxtl5oPkZKrpZOvbTiQqIt0I3CCVmlTSJ8PGaamlbhAPaGggQO/qbChwCoMykwkbbmqEszayxnBUI5OQhbX1bPQ29p8I93Nb0DS6z+pjMzYSL3r1eHN/dJUBuSo9PLt/VX86cJ3f8/PmKBpBYtoIdCAqEh9CaQwUN29nzVDAgw4cq+0hMhOiwmkJ2IhpeLBbyxA5BKjKlo6KvTkyV+zCNLCGK0rucPHv69FkAACH5BAkUAAMALAAAAAAwADAAAAL/nI+py+0Po5y02oup2FzMDnpPGEZkuZzoqHbJGcQxZ26yvA7gfdMQx8OBdMCgUMQSGI+75WxTUzoDpCkV+iteg01hz5eUXsVj25fsymqL3fIZq0ZXmbxh1PzsvOtpSbur94b0EQiolQdX0UInmEEUwsg0iAGJyAfm+CgWKJl50MSJOJkBenjiaSh36liqamZ30Sr46tLHQFOIV8bZ0qAyNgssCovwK7xLK9UBAGBrsLgGgyzAzIz5zGFduaupvFzdnIhNDd4K1wIeLq6Z3ltM0n79+V1NkgISLz+/ka6+vk+unDOA/erpo5dvHcJwAsUh5GcQ08KHDiFqs+jvHcYQMBcnZeu4EcxHkKsInmg4ryEUewpO0RMJERaxFzKz9VERS2GObqM8dbvX0+c4oUILAAA7","img-nochallenge-gif"),"img-palantir-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIFAOrK/4g8BFgAk5BIwAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1RTI4MTIxREYwNkExMUVGQTBBRDk1RTM4QTY4QkVEMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1RTI4MTIxRUYwNkExMUVGQTBBRDk1RTM4QTY4QkVEMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjVFMjgxMjFCRjA2QTExRUZBMEFEOTVFMzhBNjhCRUQwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjVFMjgxMjFDRjA2QTExRUZBMEFEOTVFMzhBNjhCRUQwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABQAsAAAAADAAMAAAA/9Yutz+MMpJq704Q8K7/1r1jSQXbmUKnovqriEpzPRg22r80bxw/4NSZtTjAY+jC7E4OzqDHsuO+azCIsti1dqhTKlVgBhpmkxvvbAYAIxKPDW00bke/7rvTlzefNbbZSh6ewOEdHY3bg9ffYU+W1yBDnBMjZBOipODYJdPmQ2UWnydiXiLm2l8j52fDKGpNrCQra4clUBzl6aCt7iWW7untpykd8Gaw73FOMegqJW/kQQiz42ymM3CyYTExpJmr6ux11C0gs8/0DNJGDJ70CRDL0wvSi/38dQcAQH4KvzfsHTgR9AfAYIIsznbh7Chw4cNFdY6CLGixX4BhV3c6FAgYosPHC9eETgiZMR8UkhszKHBYD0WLtmxWHhvpk0NCQAAIfkECRQABQAsAAAAADAAMAAAA/9Yutz+MMpJq7046827f0Qoip80nuhYKmnrEt47DvTboUKu03yfbiedoEcsojLBXXHJO15GwiFzOjg9RVGeklpTVbBRqZDbJFGgYVqWB2gvvSZwejBmtwFGc5wQ3m4Hd25EehFya1SBeTAThnVcd4pnIX1kXIQQjVKVU5cgjZtUnQ5of6CDIV+Tjqani4yqpUuxXaiSsHNEq2W1r7d9OVq6VaKefI6HdKVwtsbAwcfOu67MzbnIrdOptz2/mrS8FjjR3UJO2uLk5S3hMuQy2Zjv8iMBy4X0AfXzJ/n5xA34+vmTJ7DfPwYBCypcuPDggoQMIyq0Fw+iRIbm9ry4qG8U3bl98zSAfLeiwEh4JVOqXMlyQgIAOw==","img-palantir-gif"),"img-palette-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAP///99xJgAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmViYzgzMDYyNywgMjAyNS8wMi8xNy0yMDo0MTozOCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4MTk4QjlCMDk5NjIxMUYwQUFBRThCMjM4NDUyOTRBMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4MTk4QjlCMTk5NjIxMUYwQUFBRThCMjM4NDUyOTRBMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjgxOThCOUFFOTk2MjExRjBBQUFFOEIyMzg0NTI5NEEzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjgxOThCOUFGOTk2MjExRjBBQUFFOEIyMzg0NTI5NEEzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAv+cj6nL7Q+jnLQqgbPe3DIOhpp3iGZInurmccELxzLcUduM5wEr3fpP4z18wGKt4YppijLhIhkkMp2JZRQDAGRw0l3mY31pstnt1XwFY5oZcllwDosxT7kX617P8Vr9vu53RhbYNkhId4GmFLIokOc3khjYKFX4BrcnIDk5o3jHBxmJYPeJySWStknpyQaSWoWGquP6OhoLymokChvqaGjKVKoJaGrZByx8gnTre7mq4hBmKbfyFc1Mm2kSQc0YxYsIUQn1R1Jil/tpfp5+am3e9QOyHi8/b0E+dWRTD0Q1kc/fvx4BZw0k6C3HvhTVRKxj13DXwwERJU40EPGixo0FHDteLAAAIfkECRQAAwAsAAAAADAAMAAAAu+cj6nL7Q+jnLTai7NmovvfbRxIloJ4mCq5qcELvyoGxvYdg1aN97Y+4cmEvgAQQnQVjR/kJ7eCCn4eZ4fqAWg9MCIz1PB+tNvrUNgMP6UCMoD7JZ1Pang3W76O89P0whtX8uX25KcAOGeH91ZYNWLWkxRliICGeGcy92imhKPk+LcWFSkXV8fZQba2hEUXCpdKCMmqeTrF5MZ4S8tieya7W1TywNMkuQLqG7iKTKm8HNybcTxrKnJ5czS9uqS9bdctfYGdPTxO3uosge7pTSFIW/sNLpw8z11uf9+srsHvjsIAv4ARzBE8iDChwgoFAAA7","img-palette-gif"),"img-pipette_cur-png":c(()=>"data:text/plain;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE7mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuYjdjNjRjYywgMjAyNC8wNy8xNi0wNzo1OTo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI2LjAgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNC0xMS0yMVQwMTo0NDo1NSswMTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjQtMTEtMjFUMDI6MDA6MzQrMDE6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjQtMTEtMjFUMDI6MDA6MzQrMDE6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE5ZGJlZGNkLTAwNTktZjg0My04YzFiLTA4ZGY1NjFjY2Y4OSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxOWRiZWRjZC0wMDU5LWY4NDMtOGMxYi0wOGRmNTYxY2NmODkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxOWRiZWRjZC0wMDU5LWY4NDMtOGMxYi0wOGRmNTYxY2NmODkiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjE5ZGJlZGNkLTAwNTktZjg0My04YzFiLTA4ZGY1NjFjY2Y4OSIgc3RFdnQ6d2hlbj0iMjAyNC0xMS0yMVQwMTo0NDo1NSswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI2LjAgKFdpbmRvd3MpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Po5YI9IAAAJHSURBVFiFzZk9bsMwDIXJIFfokrt07R5kzZ6pp+nUzNmKIDfo0it07dClS4deoIA6JHIomqR+TCt9gAHHf/r0/ETLDoYQ4MYqAcC4spwRxFKVS4h4Xb+Bw2KDFAoAQOJCRPR22Oo98v0cUtrHwRfNaGPlblUxrCUvYJdcrTdbWG+2eiMhBPdBpzlHby0/xoJExORcD4eL3NU6IsFaHXB1OJfL1txSeQ66kXKZtPZpcgXWanoLmKZuT7r1Zgun42FYlxT3U7HBih4OJ8GkDUgA0vbT8aAey+WeYT6wKAh1Nm63QKWIzTroJEnQVCGEYZHkMfkZLmCVLSm3HFhhQXrdKQ4HyMDmqgMve0qHk160AmdvC4e1BhaHNmdxjZEwZ14SrKZ4rBUPmokW4CpYqtLSBaAD10aiGXa/eq1sijRKqkbNky47AX95+FRPXu6+RhAlU1EutzpsTgl3byIQr7dW/Y1CqadxGznZdPf3+T75/fP+MazfPY2drdR1wCHqkaiFpZBRDrAjVc3WOsGas/wcsPok4zGgKoBtfvVIBh27sGoJheXuzgkLIDisfHEZ1ntnlkuLhNlSI+z0N1AoqMM8uxIslwU79c25qkp8P67E7dTdEtgp0Cow/+IiwdbEwOObBEDDWzOHjJors6OLKiM5RIctZ4wqkJzk5S7A2WGzImhzDUPuMUguHvyK5aygUUupgUsfEC7REPZRdQEd2pjgcFfQqNKyJhL1BI1awBmGLsW6xX98k1+RekO7fG7tCa06/A/+0hX1B0kNQenek4JbAAAAAElFTkSuQmCC","img-pipette_cur-png"),"img-settings-gif":c(()=>"data:text/plain;base64,R0lGODlhLQAtAPEAAAAAAGlqagAAAAAAACH5BAkUAAIAIf4RQ3JlYXRlZCB3aXRoIEdJTVAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAALQAtAAAC15SPqQftvqKc4llIc7xce2QF4oh9WjiKD9iYi5OqKzO7xhNbrG5XTRwo0QDBVg+Wqt1+RaMLSXIOZdIPlJrAYW1aKmDZFVqvTU6yOmZGLzn0qbsmKz1soH3Nhd+B87d6z9dHodemdvFEVsghlkF4tug2mPi4mFZnd5i3uMeDCMkp2HgJWNbjM3kXKoqKyZhGqvh1lDipuhr712QKFjfq+ur1BWcrSbQFZnysSTR39Uv3IzYcCd2JHLeLLDuUXJp9muVMbKo3Tv5n/a0A+ax+muk+AR9P/1EAACH5BAkUAAIAIf4RQ3JlYXRlZCB3aXRoIEdJTVAALAAAAAAtAC0AAALVlI+pCO2wopzmWUjzvFf7ZAViYH3fM6aP6TnpuB4Oq6BvXJV0DrzkzOjQbDCgzGU0uVRJXhGjbNyaxKZm+WwcsdYM8cfBgodiMGcKjfZ8ZzRZ6ouj09evPN7dhO54XL3Ml0VHsScnJvQHKBg2GMR4x6gTEblmOMOhF8kneXIRKPgG9ynC2Sk6WtqiuJnntQqptSMA6Okmexg2dyuqyRT7Bjp7SvrLguJn10qICTKsvJxa9gxd7OTbaExXSFwtWyM9vZPs5/19Sl5uzphOjcguEfYuT1MAADs=","img-settings-gif"),"img-status-gif":c(()=>"data:text/plain;base64,R0lGODdhMAAwAHcAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJFAAAACwAAAAAMAAwAIAAAAD///8Ca4SPqcvtD6OctNqLs968+w+GVECWgdiYKoke61ui8HyCNP3dd6frXL/TAH2YYa9oDFqSxBFTOXk2JVJopIpzYl/L7arrNYHDrApZbD6XteeLupYmZ9pI78bOe8qALQSsDxgoOEhYaHiIKFIAACH5BAkUAAAALAgACQAeACAAgAAAAP///wJAhI8Wy5sPQZssWoqdPbmHLXndJXpQWSZoiqxs6IpwbNKpjef6zvf+DwwKhzQF0OhrJZW7R++k2+BAyBeVk9kUAAA7","img-status-gif"),"img-tasks-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIFAISEhIaGht7e3v///wAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzQ3NzU0NjA0NkQxMUYwODVGNUI5REE3NDZFMUQyMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzQ3NzU0NzA0NkQxMUYwODVGNUI5REE3NDZFMUQyMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBDNDc3NTQ0MDQ2RDExRjA4NUY1QjlEQTc0NkUxRDIwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjBDNDc3NTQ1MDQ2RDExRjA4NUY1QjlEQTc0NkUxRDIwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABQAsAAAAADAAMAAAA/9Yutz+MMpJq20ka6W7593FeGRpbiIZBCqrrSeRejDtZrV5dQLuCj3CzUcCoCo8ElCZzACMmZ1myaNmrIQg4XmkTIHgsHis5UaRX7JarDHL0Ne13Oq2pMPxeRn69ubBd2QDAx1mdlNxX39gg4RtUIdXSlgdjY5OkHCUWZsZlo+Zfpxao4KWl3WaemGnqHxwpautj10RVWyxjKe0ZxOBpGqzmLUQilm3Y8Jbr6JUWmoan7x9EsZ3JtLDvdWJgSW7mMy+ed6x4Muh47lzyk/p3Oty7YaquOvz77aLwMnn7sQPEI36BQRfvoCSEpbyYHCbvmMe8GAbBOqgA2t/rlzyRDFFnEUM5Ba1wgfw4p+RKLP9c1iMY8qXHdGVBEkAps02IeDYhKkD1s5GMWaaDEq0xIyiSFmqS1pUxIKeTqNKnUq1qtWrEhIAACH5BAkUAAUALAAAAAAwADAAAAP/WLrc/jDKR+q8ONatNi8e0XlZE55oSpagFwThe8opO8Munqt2jAsVmgBIoKFKHmLyNEzpRJllSLlpop7IKpVgrQyHg4Hvc0l+z2h0eGzBmNNw8HrXLmvPXnh4Xnzp3HddXGl7fH5/dl55gV2FG4dkElpMXyh7j36REGaUWx6GmXUad29njgSgRomDVnGFp32qE4xxAq+XmLKSebVft3yxiLuseMS/wJCim7yCgp/IoVDDRFSVltC6o1ydtrivOdnLg6Xdx2K5wtpdaubY6eK95cfg7xTM1nLm9Jr2xOtK89Dxc1Bl0qIQ3wQq6+eJ1TmE7gaaOPgGFqqICwnyqtjuSWEwiQwCVemIK1g9jf7ykUR3cqI/kgk/glxwB+atXCES2QxYY9XFncCO+PwJU8XMkEaTJs2itGnOHk6VspgVdarVq1izat2qNQEAOw==","img-tasks-gif"),"img-themes-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAClrnOLi4gAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCMDM1Qzc2QUVBNDExMUVGOTBDRUQ0Nzk3Q0E2QUZCRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCMDM1Qzc2QkVBNDExMUVGOTBDRUQ0Nzk3Q0E2QUZCRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkIwMzVDNzY4RUE0MTExRUY5MENFRDQ3OTdDQTZBRkJEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkIwMzVDNzY5RUE0MTExRUY5MENFRDQ3OTdDQTZBRkJEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAwAsAAAAADAAMAAAAt+cj6nL7Q+jnDSKi0Vt+bKebQqIjaQmIieqlinUmewLe4lL17OB507P2/k+woGNszoOZcnY0thMDqPUVxOAzTZFyawXG6WQApiveSvpBNZlszdDBlng7Iv7fFnHQz96XXD3haG3B9QySNgWCOCnx7fQ+Ae4GCkJiUhYSImZ+XgokOmoKFhZWKQWCvKG2ul5U0oFmurKJNu6EiqpRMSZCJJrustbCnxLi/RbPCtXgau8khJbZSV98lRtODX9xN1i0s0rAy7+WtRtmM1Ne3yNTrJkXe7k837JHj0/rr/PL1EAACH5BAkUAAMALAAAAAAwADAAAALMnI+py+0Po5xUiotrw3lxrjHf5Y2hYybfGYFqx0LwMcco+Qp2iyP1LtIpesCi8YhMKmmjprIJXQGjVOmpirVOsoCuN7ulesfkKu8TCGDIbAAmDb290/BLe8yh113DvF69duc2p5eSI/BHx3HnlwhIxHTh+BjYNTKp5UP4lzVJKVTSyBnlaRi6OSqaaBqE5vn6CbnRBJvK+lCFaVaR1Qsa4ktVFPwz1btkJGugjPRT3Cz7fOTMPB3Nl4S9fGuTuc0NDD4gzuuNfI6ejlAAADs=","img-themes-gif"),"img-thumbsdown-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAPEBAAAAAHMLC7EPD3MLCyH5BAkUAAMAIf4RQ3JlYXRlZCB3aXRoIEdJTVAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAMAAwAAAC/pyPqcvtD6OctNqLFdi898s13kgCUpmUqgetBynE8iywz1rSuhx8IjdT7YaCQG/jAOpGxKHRt1AuN83mE8mQVre0K1ZD5Yp53mx4LDYeTeAzeqsOtQHvdLkdqNuhr01eD7fGhsDxB2h1R+h3WBUn1wdgxEiktpbiZzg5U2mpGFmpSeY4aNDBqdaYqcP5WFro9akqirp52jqAs7hzysv6BbnitNbrSwqM5bErSAxb0bEqGGt7G/EMnWvjrBUDm5thvYn9C7LdmdFSbn6epJW4zk4XTv1+6eZOH2UviP8Tz73PL5++eQFxDRxX0FWkf+oSKpxmzKGpZg7njKhokQ/GBWMIHxQAACH5BAkUAAMAIf4RQ3JlYXRlZCB3aXRoIEdJTVAALAAAAAAwADAAAAL+nI+py+0Po5y02osR2Lz7yzXeSFIkoJ1qB62qAMeyMLauN+dywIqdfNIJBQFeiPHLJYfC4nHBYUqZzmciOs3mqijoRguOcZHfMHjsBZjDxk06sNairxt4fDpPAex3arurx9fX9KfAITg4U5RncJhIyAXYWIf4SLTYRrdXmYjJeOj56PlJObo4FCpmajXQgelRpGM6G6npwrlYStujt4L7tzlaYzi8tAN8IylhDBOZDMJ8maxcgXPMm+FTtoOdTbbdXOitrXbNOm57nIlObu7GnlYe3g1/gKV6Xt8KLv2ur8mH0b99e/D5GzhpU7+DCF3lYoiQ4EOIDU9EjEfPQQEAOw==","img-thumbsdown-gif"),"img-thumbsup-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAPECAAAAADBzC0qxD0qxDyH5BAkUAAMAIf4RQ3JlYXRlZCB3aXRoIEdJTVAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAMAAwAAAC/pyPqcvtD6OcoFowc7tce8R1n3YJ5jWSlWkGgZVSK+vCcWTRdXVDZbvD9Bw5HWq4mQGPSMVP4Hrxmovi0kYFWaFSYfbwvHq/g3CQDN5yQ+zpJyxui1RKXVc+l9W5dwDrHzSmdcTxB3RnCHjnhLdn5KjYldAImWgZiWXwBHfZiemmqeY5ahmVWVZJqsp3Krq6agqK6vdayyc5aFsbK+uqe8nLCBDwqxoo7FLsySs4O6zcGSz8DJ0YhYtMbJ1se32aNqwdGfV6jT1ZwX1oLj7q/R0ars1rTmoOH8/eJ39tqM807R0bfQSlJaF0oSA7gFXkgEuoMM9BiQgd6plYsRmSB4poOnpcUAAAIfkECRQAAwAh/hFDcmVhdGVkIHdpdGggR0lNUAAsAAAAADAAMAAAAv6cj6nL7b+AlLDaMzO4nOnchcgklKDYZaUQTGgqrez5VuQatFRtx2Wu2/Aet1/ONXQUWcddMrJsOp8JlTEopI6iUm11yaR5B9arWFs2nqkaWRjpbcuAn3o2lFbb7Y26Ia+356cgCIaDBeC28vFVmKioB3l4liYneekmdUfmg+npSTfF+fhZChm6aWhaChTUuAp75bpFGsuq+Wp725WrC4rb63uJujkqjNkKRxtwLJks+ieR05xJDAUwfcoc+1wcjb0917rayksonS07/luuvAzEVC6vKG99Dd4+Ub8v706LrikDP35r/jnCN9Ben4MaEjLq8fAbQw0c/GGYCO3JxAYxHDtaKAAAOw==","img-thumbsup-gif"),"img-trash-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAExMTAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCRjhBOTZGNEVBNDExMUVGQkNEREJDNjJBNzc1OTAwNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCRjhBOTZGNUVBNDExMUVGQkNEREJDNjJBNzc1OTAwNCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJGOEE5NkYyRUE0MTExRUZCQ0REQkM2MkE3NzU5MDA0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkJGOEE5NkYzRUE0MTExRUZCQ0REQkM2MkE3NzU5MDA0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAueUj6nL7Q+jnLTaO4PevHOseOLYgeQ5YugqVicAaPBMw20m1voel1HOC9J8EI/wOPMUjUih8jFqBp8NlNRGgrICuq1G6w1/HB2suNz7kjfJM7c2rrKd0R2RwbnyZObAcp52BRgnNwjYYzd3h4eGFgjHl6a2ltf2JjmkSEgZ+YhpaTkJ1llZ+Snp9+Noahi5yUnqqnkpSeH4WRqbimP6mJe74XI7ywUsqtpLjPv6p2uGlXkswQTtS8vcHPvcKo18mLmHnR0e3j192yTuTZsebAJ0pH7u5g4iQC/Pe2afQM//DzCgwIEKCgAAIfkEBRQAAgAsAAAAADAAMAAAAuGUj6nL7Q+jnLTai7NGofsPBlsSlqaonWp5re45vcBMz29U1vq+m1DICwpDv4/w2AMVPcimTekAOpvQxmmaJEZX2NX2BYZZw2QtQwooG9PVBSjI5bXPzFqnG6DN3eun/G6Xx/axBPhUdxgoaDaGeCiY+PiIUgg5aImYSYjTd6moB8j4ZegJCgq510g6GHg6SVmJSWpIm6paKxt5CcvZ57sYajuKa8p26tHyG8y6yxvzVnpXJ9xLbDy9iSG1mtWxgXZELQE+lJ0CHW6eQd7tvK7mPWIA7/5dJq8Qhr/P3++fUQAAOw==","img-trash-gif"),"img-typo-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAKIEABcrcJ2v8D5RlAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4N0U4OUJGN0U0QTYxMUVGQTU4QUFGRDdFRjZEQ0Q4RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4N0U4OUJGOEU0QTYxMUVGQTU4QUFGRDdFRjZEQ0Q4RSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg3RTg5QkY1RTRBNjExRUZBNThBQUZEN0VGNkRDRDhFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg3RTg5QkY2RTRBNjExRUZBNThBQUZEN0VGNkRDRDhFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQABAAsAAAAADAAMAAAA+pIutz+MMpJq704692G/2AojmTolGiqesvqvqACz6tMAniu7zyP2h6BUNgrGosmAmjIbDqfzV5yCa1ambvpRxjoXr/OnDYo6JrN4Ks4ptyWz/BA+rn+AMnx8zyMG7v3YCUtK01eUC4MMENoTi8dioxNiA8vXIZDkxgilnJMSRwnVJECn6CPbqOlpomol6R2q5StnUJssacDnJ6wt6x4rra9d7qYvMJtv7SvLMfDb8rBwqLAxtKzu8zN09DVvdvYA83Oqd2338XZxyFvkuWx60/R3lSN7qsl6OnWjuIz4ncp/g0KKLCgwYO9EgAAIfkECRQABAAsAAAAADAAMAAAA/NIutz+MMpJq724js27/2A4RGJpnuOCriyntPBKgEJtC0Cu73zPg7PObegrGn8uz3DJbDKRm+DGSa0Sd0mOLcC1eq+57FTALQe+aJ14UDO7z2inOipsv7vx53ykvL3zeh5SfYA2LYModkwxLzBkcEMwDI5lS4cOLZWRHxkkSng3gp0Sn6A1oqMQpZCnLqmeWpqGrq8Pq5tRtbZCsq25ug23obTAKrymAh3FwcesycTLwrO/y4iPzsrVjbHIqNHNuNTF0r7iwHW9z9DnWtfhKdXo3dnx7ene4+1N+Ox1lvTfJGmLAa8eC22TZCBkVmKhw4epEgAAOw==","img-typo-gif"),"img-wand-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJEDAN9xJv/sWwAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkE3RTJCRDcyMjMzMzExRUZCQzQzRTYzQjk2NDc2NjUyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkE3RTJCRDczMjMzMzExRUZCQzQzRTYzQjk2NDc2NjUyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTdFMkJENzAyMzMzMTFFRkJDNDNFNjNCOTY0NzY2NTIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTdFMkJENzEyMzMzMTFFRkJDNDNFNjNCOTY0NzY2NTIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQJFAADACwAAAAAMAAwAAACz5yPqcvtD6OctNqLs2ZCbN2FTuh9B0kqaGcaazq8bBt3QSDbcBve+Orb8QS+Xy84o9WISGZTeXIWiyKoyzalJpWkbHP76Xq/4Ix4rK2Cjuis0MKeYsdvCorcNpbgubN+ZSYDEJdD0wGASFg2JIA4OPdjddWYKKbGdeh4Z2QV4vh4d2lCoinSI7pBWlmFgpkJure0iOH5iVpj+LoqmaC6GivpC8sbpVsHJXycW/tLLEvZzCsMC4ysS13t+kntPGk72+nZ2l08Tl4O3n17zm5QAAAh+QQFFAADACwAAAAAMAAwAAACyJyPqcvtD6OctNqLjdi5jw0KTeglIWmeYqltQXC2IMyx7Uur7lvbM6/C5WwyYc44JH4ESGaz59shhSDl8jfNraLYaYzrzOK+nq6YWu2Yz2hoJZSVPt2UIHDd3lp0ujz5wicA0MVHBAKASEjHcpgId2d1hegIh2K4MTkYZMk1iaKj1Ei59VciqunGWYaZmRaJcIr6msJKOQt76nob0qr7yuvp+1uLqjebq2oFPGqsjCzsLNgLHSqafHxYenulvc296C0TPk5eblUAADs=","img-wand-gif"),"img-wrench-gif":c(()=>"data:text/plain;base64,R0lGODlhMAAwAJECAGlqagAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMS1jMDAyIDc5LmE2YTYzOTY4YSwgMjAyNC8wMy8wNi0xMTo1MjowNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjEyIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDQ0U0NDQxMUVBNDExMUVGOEI2RkMzMDI1RTNDQkVBRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDQ0U0NDQxMkVBNDExMUVGOEI2RkMzMDI1RTNDQkVBRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkNDRTQ0NDBGRUE0MTExRUY4QjZGQzMwMjVFM0NCRUFEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkNDRTQ0NDEwRUE0MTExRUY4QjZGQzMwMjVFM0NCRUFEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECRQAAgAsAAAAADAAMAAAAsGUj6nL7Q+jnLTai1fYfGfbhd4niSEZdcC6cuijskB3jK/BybOLn3cus/UCu5sA2BICeShkEbEUfpzSaOC3CY5CyevLuROxmM2sNtbFmsfo9Bes00kz3Hic9oZb55j62aS21mXiRSL2J2JIKOdTtvhndERIBGl0aIdnCcfIR0dpxxkJptfZJ3j5pEn5mBQpuepCVXphVXNamBeGe+uaRSbb2/jKhhsIdVvsOvQZpqyxlul8TCj9nFhtPYu9zd3t7VoAACH5BAkUAAIALAAAAAAwADAAAALKlI+py+0Po5y02otb2Dxk24XeN4khGXXACpyotrFy98IySxtcrcd33tuhVDjhgdPaDH0r4DFQHGWQUWkwSqI2gcSk9dI1db1Zrdc0U5ahP1H7Czbf5uc1kz43Ytz4t3of0ucHR8GXJqZXiDYoVoIodyKi+Mh2mAgSKHhGWJGp6WKnifUyJuj0Udp3OnW3WVlUYyb2RsqESLtUmQP5h4qkN3YZB/r0Kjx8Kdtbi+C5xclTehzNu8xTbGx9jW2yDdPozQAeTl5ufi5QAAA7","img-wrench-gif")};document.documentElement.dataset.typo_loading_screen_disabled=(window.location.pathname==="/terms"||window.location.pathname==="/credits")+"";const RB=new Promise(r=>{(document.readyState==="interactive"||document.readyState==="complete"||Object.keys(window).includes("io"))&&r(),document.addEventListener("DOMContentLoaded",()=>r());}),$E=new MutationObserver(r=>{r.forEach(e=>{e instanceof HTMLScriptElement&&e.src.includes("game.js")&&(e.addEventListener("beforescriptexecute",t=>t.preventDefault(),{once:!0}),e.src="",e.remove());});});$E.observe(document,{childList:!0,subtree:!0});const LB=new Promise(async r=>{let e=await(await fetch(window.location.href)).text();e=e.replaceAll("game.js","game.jsblocked");const t=document.createElement("html");t.innerHTML=e;const n=Ye("body",t);n.dataset.typo_loader="true",r(n);});RB.then(async()=>{const r=await LB;document.body=r,$E.disconnect(),OB();});const PB=`
:root {
  ${Object.entries(MB).map(([r,e])=>`--file-${r}: url("${e()}");`).join(`
`)}
}
`,NB=nn(`<style>${PB}</style>`);document.head.append(NB);const OB=c(()=>{console.clear(),console.log(`%c
        _             _   _       _       _   _                           
       | |           (_) | |     | |     | | | |     %cskribbl modded with%c
  ___  | | __  _ __   _  | |__   | |__   | | | |_   _   _   _ __     ___  
 / __| | |/ / | '__| | | | '_ \\  | '_ \\  | | | __| | | | | | '_ \\   / _ \\ 
 \\__ \\ |   <  | |    | | | |_) | | |_) | | | | |_  | |_| | | |_) | | (_) |
 |___/ |_|\\_\\ |_|    |_| |_.__/  |_.__/  |_|  \\__|  \\__, | | .__/   \\___/ 
                                                     __/ | | |            
                                                    |___/  |_|     %cby @tobeh %c

         Typo & all its backend is open source: https://github.com/toobeeh/skribbltypo
         Join the community: https://discord.com/invite/pAapmUmWAM
         Find more infos at: https://www.typo.rip/
         Support development: https://patreon.com/skribbltypo
        
        [ ${Jt.getReleaseDetails().versionName} @ ${Jt.getReleaseDetails().runtime} ]
                                                                    
                                                    `,"color: lightblue","color:#2596be; font-family:'Arial'; font-weight:bold; font-style:italic; letter-spacing:2em","color: lightblue","color:#2596be; font-family:'Arial'; font-weight:bold; font-style:italic; letter-spacing:2em","color:#f39656");},"signature");

})();